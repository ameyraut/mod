(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("zUnb")},"Re/O":function(e,t,n){"use strict";n.d(t,"sd",(function(){return Fl})),n.d(t,"Db",(function(){return zl})),n.d(t,"jb",(function(){return Bl})),n.d(t,"pc",(function(){return Ul})),n.d(t,"te",(function(){return Ol})),n.d(t,"Cc",(function(){return Cu})),n.d(t,"ob",(function(){return Ne})),n.d(t,"Nb",(function(){return gl})),n.d(t,"jc",(function(){return vl})),n.d(t,"rd",(function(){return _l})),n.d(t,"de",(function(){return Il})),n.d(t,"oe",(function(){return X})),n.d(t,"ue",(function(){return Sl})),n.d(t,"a",(function(){return Tl})),n.d(t,"b",(function(){return Al})),n.d(t,"c",(function(){return Pl})),n.d(t,"d",(function(){return Dl})),n.d(t,"i",(function(){return Ml})),n.d(t,"j",(function(){return kl})),n.d(t,"k",(function(){return jl})),n.d(t,"n",(function(){return Rl})),n.d(t,"o",(function(){return ie})),n.d(t,"p",(function(){return te})),n.d(t,"re",(function(){return se})),n.d(t,"q",(function(){return ae})),n.d(t,"l",(function(){return Ot})),n.d(t,"m",(function(){return Bs})),n.d(t,"f",(function(){return _e})),n.d(t,"g",(function(){return xe})),n.d(t,"h",(function(){return Vt})),n.d(t,"e",(function(){return Lt})),n.d(t,"Mb",(function(){return xu})),n.d(t,"Vb",(function(){return gu})),n.d(t,"hc",(function(){return pu})),n.d(t,"Hd",(function(){return eu})),n.d(t,"Jc",(function(){return ut})),n.d(t,"J",(function(){return Qi})),n.d(t,"K",(function(){return Ji})),n.d(t,"L",(function(){return Yi})),n.d(t,"I",(function(){return ea})),n.d(t,"S",(function(){return ht})),n.d(t,"bd",(function(){return pt})),n.d(t,"Lb",(function(){return dt})),n.d(t,"T",(function(){return No})),n.d(t,"U",(function(){return Eo})),n.d(t,"V",(function(){return Co})),n.d(t,"W",(function(){return Io})),n.d(t,"X",(function(){return Oo})),n.d(t,"Id",(function(){return So})),n.d(t,"Y",(function(){return da})),n.d(t,"Z",(function(){return fa})),n.d(t,"ab",(function(){return ma})),n.d(t,"hb",(function(){return ga})),n.d(t,"qd",(function(){return ya})),n.d(t,"bb",(function(){return va})),n.d(t,"ic",(function(){return ua})),n.d(t,"mb",(function(){return la})),n.d(t,"Kc",(function(){return ca})),n.d(t,"fd",(function(){return ba})),n.d(t,"gd",(function(){return wa})),n.d(t,"hd",(function(){return xa})),n.d(t,"id",(function(){return _a})),n.d(t,"jd",(function(){return Na})),n.d(t,"lc",(function(){return Ia})),n.d(t,"G",(function(){return Oa})),n.d(t,"Qc",(function(){return Sa})),n.d(t,"yd",(function(){return ka})),n.d(t,"zd",(function(){return Ta})),n.d(t,"Ad",(function(){return Aa})),n.d(t,"Bd",(function(){return Pa})),n.d(t,"Cd",(function(){return Da})),n.d(t,"r",(function(){return vi})),n.d(t,"s",(function(){return bi})),n.d(t,"t",(function(){return wi})),n.d(t,"B",(function(){return xi})),n.d(t,"C",(function(){return _i})),n.d(t,"D",(function(){return Ni})),n.d(t,"F",(function(){return Ei})),n.d(t,"P",(function(){return Ci})),n.d(t,"Q",(function(){return Ii})),n.d(t,"cb",(function(){return Oi})),n.d(t,"db",(function(){return Si})),n.d(t,"rb",(function(){return ki})),n.d(t,"sb",(function(){return Ti})),n.d(t,"ub",(function(){return Ai})),n.d(t,"yb",(function(){return Pi})),n.d(t,"Yb",(function(){return Di})),n.d(t,"Zb",(function(){return Ri})),n.d(t,"ac",(function(){return Mi})),n.d(t,"Bc",(function(){return ji})),n.d(t,"cd",(function(){return Li})),n.d(t,"ld",(function(){return Vi})),n.d(t,"md",(function(){return Fi})),n.d(t,"ud",(function(){return zi})),n.d(t,"vd",(function(){return Bi})),n.d(t,"wd",(function(){return Ui})),n.d(t,"xd",(function(){return Wi})),n.d(t,"Ed",(function(){return $i})),n.d(t,"Jd",(function(){return qi})),n.d(t,"Kd",(function(){return Hi})),n.d(t,"Pd",(function(){return Gi})),n.d(t,"Ud",(function(){return Ki})),n.d(t,"Vd",(function(){return Xi})),n.d(t,"x",(function(){return Ma})),n.d(t,"y",(function(){return ja})),n.d(t,"z",(function(){return La})),n.d(t,"A",(function(){return Va})),n.d(t,"cc",(function(){return Fa})),n.d(t,"kc",(function(){return za})),n.d(t,"oc",(function(){return Ba})),n.d(t,"qc",(function(){return Ua})),n.d(t,"vc",(function(){return Wa})),n.d(t,"Td",(function(){return $a})),n.d(t,"Vc",(function(){return qa})),n.d(t,"pb",(function(){return Ha})),n.d(t,"qb",(function(){return Ga})),n.d(t,"Gb",(function(){return Ka})),n.d(t,"Hb",(function(){return Xa})),n.d(t,"Ib",(function(){return Za})),n.d(t,"Jb",(function(){return Qa})),n.d(t,"Rb",(function(){return Ja})),n.d(t,"Sb",(function(){return Ya})),n.d(t,"Tb",(function(){return es})),n.d(t,"Ub",(function(){return ts})),n.d(t,"Ec",(function(){return ns})),n.d(t,"Fc",(function(){return rs})),n.d(t,"u",(function(){return os})),n.d(t,"v",(function(){return is})),n.d(t,"w",(function(){return as})),n.d(t,"E",(function(){return ss})),n.d(t,"kb",(function(){return us})),n.d(t,"lb",(function(){return ls})),n.d(t,"zb",(function(){return cs})),n.d(t,"mc",(function(){return hs})),n.d(t,"nc",(function(){return ps})),n.d(t,"rc",(function(){return ds})),n.d(t,"sc",(function(){return fs})),n.d(t,"tc",(function(){return ms})),n.d(t,"uc",(function(){return gs})),n.d(t,"xc",(function(){return ys})),n.d(t,"yc",(function(){return vs})),n.d(t,"Rc",(function(){return bs})),n.d(t,"Sc",(function(){return ws})),n.d(t,"Ld",(function(){return xs})),n.d(t,"Md",(function(){return _s})),n.d(t,"Rd",(function(){return Ns})),n.d(t,"Sd",(function(){return Es})),n.d(t,"nb",(function(){return As})),n.d(t,"Qb",(function(){return Ps})),n.d(t,"Tc",(function(){return Ds})),n.d(t,"dd",(function(){return Rs})),n.d(t,"pd",(function(){return Ms})),n.d(t,"dc",(function(){return Cs})),n.d(t,"ec",(function(){return Is})),n.d(t,"fc",(function(){return Os})),n.d(t,"gc",(function(){return Ss})),n.d(t,"ve",(function(){return ks})),n.d(t,"we",(function(){return Ts})),n.d(t,"N",(function(){return zo})),n.d(t,"he",(function(){return Fo})),n.d(t,"Uc",(function(){return Bo})),n.d(t,"M",(function(){return Uo})),n.d(t,"O",(function(){return Wo})),n.d(t,"R",(function(){return $o})),n.d(t,"eb",(function(){return qo})),n.d(t,"gb",(function(){return Ho})),n.d(t,"tb",(function(){return Go})),n.d(t,"vb",(function(){return Ko})),n.d(t,"Ab",(function(){return Xo})),n.d(t,"Ac",(function(){return Zo})),n.d(t,"Gc",(function(){return Qo})),n.d(t,"Lc",(function(){return Jo})),n.d(t,"Mc",(function(){return Yo})),n.d(t,"Nc",(function(){return ei})),n.d(t,"Oc",(function(){return ti})),n.d(t,"Pc",(function(){return ni})),n.d(t,"Xc",(function(){return ri})),n.d(t,"Yc",(function(){return oi})),n.d(t,"Zc",(function(){return ii})),n.d(t,"ed",(function(){return ai})),n.d(t,"Fd",(function(){return si})),n.d(t,"Nd",(function(){return ui})),n.d(t,"Od",(function(){return li})),n.d(t,"fe",(function(){return ci})),n.d(t,"le",(function(){return hi})),n.d(t,"ne",(function(){return pi})),n.d(t,"td",(function(){return di})),n.d(t,"xb",(function(){return Et})),n.d(t,"Wb",(function(){return Ct})),n.d(t,"Hc",(function(){return _t})),n.d(t,"ad",(function(){return It})),n.d(t,"nd",(function(){return mt})),n.d(t,"Wd",(function(){return ft})),n.d(t,"Xd",(function(){return gt})),n.d(t,"Yd",(function(){return yt})),n.d(t,"Zd",(function(){return vt})),n.d(t,"ae",(function(){return bt})),n.d(t,"be",(function(){return wt})),n.d(t,"ce",(function(){return xt})),n.d(t,"xe",(function(){return Nt})),n.d(t,"Ic",(function(){return Pt})),n.d(t,"ye",(function(){return Dt})),n.d(t,"ke",(function(){return js})),n.d(t,"Dd",(function(){return lt})),n.d(t,"bc",(function(){return ct})),n.d(t,"Xb",(function(){return Ls})),n.d(t,"Dc",(function(){return Vs})),n.d(t,"Bb",(function(){return Us})),n.d(t,"me",(function(){return Ws})),n.d(t,"H",(function(){return $s})),n.d(t,"zc",(function(){return qs})),n.d(t,"wc",(function(){return Hs})),n.d(t,"Qd",(function(){return Gs})),n.d(t,"ie",(function(){return Ks})),n.d(t,"od",(function(){return Xs})),n.d(t,"wb",(function(){return Zs})),n.d(t,"Kb",(function(){return Qs})),n.d(t,"kd",(function(){return Js})),n.d(t,"Ob",(function(){return Ys})),n.d(t,"Gd",(function(){return tu})),n.d(t,"Cb",(function(){return nu})),n.d(t,"je",(function(){return Vl})),n.d(t,"ee",(function(){return Ae})),n.d(t,"Pb",(function(){return Pe})),n.d(t,"ib",(function(){return De})),n.d(t,"ge",(function(){return Re})),n.d(t,"Wc",(function(){return Me})),n.d(t,"fb",(function(){return ke})),n.d(t,"Eb",(function(){return Ee})),n.d(t,"Fb",(function(){return Ce})),n.d(t,"pe",(function(){return Ie})),n.d(t,"qe",(function(){return Oe})),n.d(t,"se",(function(){return Se}));var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var u={},l={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function c(e){e in u||(document.createElement("canvas").addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete u[e]}),!1),u[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=document.createElement("canvas");return 1===e?t.getContext("webgl",l)||t.getContext("experimental-webgl",l):t.getContext("webgl2",l)}(e));var t=u[e];return t.isContextLost()?(delete u[e],c(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),u[e])}function h(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function p(e,t,n){return Math.max(e,Math.min(t,n))}function d(e){return e%2==0?e:e+1}function f(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function m(e,t){var n=Math.random();return t*n+(1-n)*e}function g(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function y(e,t,n){void 0===n&&(n=""),g(x(e,t),n+" Shapes "+e+" and "+t+" must match")}function v(e){g(null!=e,"The input to the tensor constructor must be a non-null value.")}function b(e,t){if(void 0===t&&(t=[]),Array.isArray(e))for(var n=0;n<e.length;++n)b(e[n],t);else t.push(e);return t}function w(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function x(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function _(e){return e%1==0}function N(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function E(e){for(var t=Math.floor(Math.sqrt(e));t>1;--t)if(e%t==0)return[t,e/t];return[1,e]}function C(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function I(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var i=0,a=function(){if(e())r();else{var s=t(++i);null!=n&&i>=n?o():setTimeout(a,s)}};a()}))}function O(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function S(e,t){for(var n=[],r=[],o=0,i=0;i<e.length;++i){if(null!=t){if(t[o]===i&&1!==e[i])throw new Error("Can't squeeze axis "+i+" since its dim '"+e[i]+"' is not 1");(null==t[o]||t[o]>i)&&1===e[i]&&(n.push(e[i]),r.push(i)),t[o]<=i&&o++}1!==e[i]&&(n.push(e[i]),r.push(i))}return{newShape:n,keptDims:r}}function k(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function T(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function A(e,t,n){if("float32"===t)for(var r=0;r<e.length;r++)if(isNaN(e[r]))throw Error("The result of the '"+n+"' has NaNs.")}function P(e,t){if("float32"!==t)for(var n=0;n<e.length;n++)if(isNaN(e[n]))throw Error("NaN is not a valid value for dtype: '"+t+"'.")}function D(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function R(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function M(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function j(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=2*e.length})),t}function L(e){return"string"==typeof e||e instanceof String}function V(e){return"boolean"==typeof e}function F(e){return"number"==typeof e}function z(e){return e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":F(e)||e instanceof Array&&F(K(e))?"float32":L(e)||e instanceof Array&&L(K(e))?"string":V(e)||e instanceof Array&&V(K(e))?"bool":"float32"}function B(e){return!!(e&&e.constructor&&e.call&&e.apply)}function U(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function W(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function $(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(Array.isArray(e)&&(e=b(e)),null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return n&&P(e,t),new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)0!==Math.round(e[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function q(e,t){for(var n=H(e,t),r=0;r<n.length;r++)n[r]=1;return n}function H(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function G(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")}function K(e){for(;e instanceof Array;)e=e[0];return e}var X=Object.freeze({shuffle:h,clamp:p,nearestLargerEven:d,sum:f,randUniform:m,distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},assert:g,assertShapesMatch:y,assertNonNull:v,flatten:b,sizeFromShape:w,isScalarShape:function(e){return 0===e.length},arraysEqual:x,isInt:_,tanh:N,sizeToSquarishShape:E,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return h(t),t},rightPad:C,repeatedTry:I,inferFromImplicitShape:O,squeezeShape:S,getTypedArrayFromDType:k,getArrayFromDType:T,checkComputationForNaN:A,checkConversionForNaN:P,hasEncodingLoss:D,isTypedArray:R,bytesPerElement:M,bytesFromStringArray:j,isString:L,isBoolean:V,isNumber:F,inferDtype:z,isFunction:B,nearestDivisor:U,computeStrides:W,toTypedArray:$,makeOnesTypedArray:q,makeZerosTypedArray:H,now:G}),Z=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Q)}return e.prototype.profileKernel=function(e,t){var n,r=this,o=this.backendTimer.time((function(){n=t()}));return(Array.isArray(n)?n:[n]).forEach((function(t){var n=t.dataSync();A(n,t.dtype,e),o.then((function(o){var i="";null!=o.getExtraProfileInfo&&(i=o.getExtraProfileInfo()),r.logger.logKernelProfile(e,t,n,o.kernelMs,i)}))})),n},e}(),Q=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,o){var i=C(r+"ms",9),a=C(e,25),s=t.rank,u=t.size,l=C(t.shape.toString(),14);console.log("%c"+a+"\t%c"+i+"\t%c"+s+"D "+l+"\t%c"+u+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green")},e}(),J=7;function Y(e,t){return C(Array.isArray(e)?parseFloat(e[0].toFixed(J))+" + "+parseFloat(e[1].toFixed(J))+"j":L(e)?"'"+e+"'":parseFloat(e.toFixed(J)).toString(),t)}function ee(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var te=function(){function e(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=w(e),null!=n){var r=n.length;g(r===this.size,"Length of values '"+r+"' does not match the size inferred by the shape '"+this.size+"'.")}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||T(t,w(this.shape)),this.strides=W(e)}return e.prototype.set=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];0===t.length&&(t=[0]),g(t.length===this.rank,"The number of provided coordinates ("+t.length+") must match the rank ("+this.rank+")");var r=this.locToIndex(t);this.values[r]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return ie.make(this.shape,{values:this.values},this.dtype)},e}(),ne=null,re=null;function oe(e){ne=e}var ie=function(){function e(e,t,n,r){this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=w(e),null!=n&&g(this.size===n.length,"Based on the provided shape, ["+e+"], and dtype "+this.dtype+", the tensor should have "+this.size+" values but has "+n.length),this.strides=W(e),this.dataId=null!=r?r:{},this.id=ne().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",ne().registerTensor(this),null!=n&&ne().write(this.dataId,n)}return e.make=function(t,n,r){return new e(t,r,n.values,n.dataId)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),g(1===this.size,"The array must have only 1 element."),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.asType=function(e){return this.throwIfDisposed(),re.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g(e.length===this.rank,"Number of coordinates in get() must match the rank of the tensor"),g("complex64"!==this.dtype,"Tensor.get() is not supported for complex64 tensors yet."),this.throwIfDisposed(),0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.dataSync()[n]},e.prototype.buffer=function(){return re.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return this.throwIfDisposed(),[2,ne().read(this.dataId)]}))}))},e.prototype.dataSync=function(){return this.throwIfDisposed(),ne().readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(ne().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),re.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),re.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),re.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),re.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),re.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),re.clone(this)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var o=W(t),i=function(e,t,n,r){var o=w(t),i=r[r.length-1],a=new Array(i).fill(0),s=t.length,u="complex64"===n?ee(e):e;if(s>1)for(var l=0;l<o/i;l++)for(var c=l*i,h=0;h<i;h++)a[h]=Math.max(a[h],Y(u[c+h],0).length);return a}(e,t,n,o),a=t.length,s=function e(t,n,r,o,i,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[Y(ee(t)[0],0)]:[t[0].toString()];if(1===l){if(u>20){var c=Array.from(t.slice(0,3*s)),h=Array.from(t.slice(u-3*s,u));return"complex64"===r&&(c=ee(c),h=ee(h)),["["+c.map((function(e,t){return Y(e,i[t])})).join(", ")+", ..., "+h.map((function(e,t){return Y(e,i[u-3+t])})).join(", ")+"]"]}return["["+("complex64"===r?ee(t):Array.from(t)).map((function(e,t){return Y(e,i[t])})).join(", ")+"]"]}var p=n.slice(1),d=o.slice(1),f=o[0]*s,m=[];if(u>20){for(var g=0;g<3;g++){var y=(v=g*f)+f;m.push.apply(m,e(t.slice(v,y),p,r,d,i,!1))}for(m.push("..."),g=u-3;g<u;g++)y=(v=g*f)+f,m.push.apply(m,e(t.slice(v,y),p,r,d,i,g===u-1))}else for(g=0;g<u;g++){var v;y=(v=g*f)+f,m.push.apply(m,e(t.slice(v,y),p,r,d,i,g===u-1))}var b=2===l?",":"";for(m[0]="["+m[0]+b,g=1;g<m.length-1;g++)m[g]=" "+m[g]+b;var w=",\n";for(g=2;g<l;g++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":w),m}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),re.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),re.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),re.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),re.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),re.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),re.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),re.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),re.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),re.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),re.stack([this,e],t)},e.prototype.unstack=function(e,t){return void 0===t&&(t=0),re.unstack(this,t)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),re.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),this.throwIfDisposed(),re.batchNormalization(this,e,t,n,r,o)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),re.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),re.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),re.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),re.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),re.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),re.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),re.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),re.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),re.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),re.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),re.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),re.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),re.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),re.div(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),re.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),re.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),re.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),re.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),re.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),re.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),re.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),re.modStrict(this,e)},e.prototype.squaredDifference=function(e){return this.throwIfDisposed(),re.squaredDifference(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),re.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),re.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),re.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),re.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),re.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),re.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),re.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),re.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),re.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),re.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),re.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),re.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),re.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),re.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),re.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),re.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),re.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),re.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),re.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),re.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),re.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),re.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),re.sign(this)},e.prototype.exp=function(){return this.throwIfDisposed(),re.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),re.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),re.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),re.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),re.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),re.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),re.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),re.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),re.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),re.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),re.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),re.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),re.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),re.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),re.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),re.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),re.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),re.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),re.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),re.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),re.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),re.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),re.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),re.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),re.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),re.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),re.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),re.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),re.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),re.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),re.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),re.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),re.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),re.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),re.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),re.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),re.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),re.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),re.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,i){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),re.conv1d(this,e,t,n,r,o,i)},e.prototype.conv2d=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),re.conv2d(this,e,t,n,r,o,i)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),re.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),re.depthwiseConv2d(this,e,t,n,r,o,i)},e.prototype.separableConv2d=function(e,t,n,r,o,i){return void 0===o&&(o=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),re.separableConv2d(this,e,t,n,r,o,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),re.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),re.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),re.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,o){return this.throwIfDisposed(),re.pool(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),ae.variable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),re.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),re.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),re.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),re.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,o){return void 0===r&&(r=0),void 0===o&&(o=0),this.throwIfDisposed(),re.stridedSlice(this,e,t,n,r,o)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),re.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),re.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),re.spectral.ifft(this)},e}();Object.defineProperty(ie,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.shape&&null!=e.dtype}});var ae=function(e){function t(t,n,r){void 0===n&&(n=!0);var o=e.call(this,t.shape,t.dtype,null,t.dataId)||this;o.trainable=n,o.name=r,null==o.name&&(o.name=ne().nextVariableId().toString());try{ne().registerVariable(o)}catch(e){throw ne().disposeTensor(o),e}return o}return o(t,e),t.variable=function(e,n,r,o){return void 0===n&&(n=!0),null!=o&&o!==e.dtype&&(e=e.asType(o)),new t(e,n,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!x(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");ne().disposeTensor(this),this.dataId=e.dataId,ne().registerTensor(this)},t}(ie);Object.defineProperty(ae,Symbol.hasInstance,{value:function(e){return e instanceof ie&&null!=e.assign&&e.assign instanceof Function}});var se=ae.variable;function ue(e,t){g(e.dtype===t.dtype,"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match")}function le(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof ie)n.push(t);else if(function(e){return Array.isArray(e)||"object"==typeof e}(t)){var o=t;for(var i in o){var a=o[i];r.has(a)||(r.add(a),e(a,n,r))}}}(e,t,new Set),t}var ce,he,pe=function(){function e(e,t,n){this.backend=e,this.safeMode=t,this.debugMode=n,this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.profiling=!1,this.gradientScopeCount=0,this.customGradientDepth=0,this.keepTensors=new Set,this.tensorInfo=new WeakMap,this.activeScope={track:[],name:"default scope"},this.scopeStack=[this.activeScope],this.profiler=new Z(e),this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.moveData=function(e){this.write(e,this.readSync(e))},e.prototype.tidy=function(e,t,n){var r=this;void 0===n&&(n=!1);var o,i=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun((function(){return r.startScope(i,n)}),(function(){return r.endScope(o,n)}),(function(){return(o=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.runKernel=function(e,t,n){var r,o=this,i=[],a=function(e){return i.push(e),e},s=this.activeScope.name,u=this.numBytes,l=this.numTensors;if(this.scopedRun((function(){return o.customGradientDepth++}),(function(){return o.customGradientDepth--}),(function(){r=o.debugMode()?o.profiler.profileKernel(s,(function(){return e(o.backend,a)})):e(o.backend,a)})),this.shouldRecord()){var c={id:this.nextTapeNodeId++,name:s,inputs:t,outputs:Array.isArray(r)?r:[r]};null!=n&&(c.gradient=function(e){return n(e,i)}),this.activeTape.push(c)}return this.profiling&&this.activeProfile.kernels.push({name:s,bytesAdded:this.numBytes-u,totalBytesSnapshot:this.numBytes,tensorsAdded:this.numTensors-l,totalTensorsSnapshot:this.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShape:Array.isArray(r)?r.map((function(e){return e.shape})):r.shape}),r},e.prototype.registerTensor=function(e){var t=this.tensorInfo.has(e.dataId)?this.tensorInfo.get(e.dataId).refCount:0;if(this.numTensors++,"string"===e.dtype&&this.numStringTensors++,0===t){this.numDataBuffers++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=w(e.shape)*M(e.dtype)),this.tensorInfo.set(e.dataId,{backend:this.backend,dtype:e.dtype,shape:e.shape,bytes:n,refCount:0}),this.numBytes+=n,this.backend.register(e.dataId,e.shape,e.dtype)}this.tensorInfo.get(e.dataId).refCount++,e instanceof ae||this.track(e)},e.prototype.registerVariable=function(e){if(null!=this.registeredVariables[e.name])throw new Error("Variable with name "+e.name+" was already registered");this.registeredVariables[e.name]=e},e.prototype.disposeTensor=function(e){if(this.tensorInfo.has(e.dataId)){this.keepTensors.has(e.id)&&this.keepTensors.delete(e.id),this.numTensors--,"string"===e.dtype&&this.numStringTensors--;var t=this.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.numBytes-=t.bytes),this.numDataBuffers--,t.backend.disposeData(e.dataId),this.tensorInfo.delete(e.dataId)):this.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.registeredVariables)this.disposeTensor(this.registeredVariables[e]),delete this.registeredVariables[e]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.numTensors,e.numDataBuffers=this.numDataBuffers,e.numBytes=this.numBytes,this.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){return this.profiling=!0,t=this.numBytes,n=this.numTensors,this.activeProfile.kernels=[],this.activeProfile.result=e(),this.profiling=!1,this.activeProfile.peakBytes=Math.max.apply(Math,this.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.activeProfile.newBytes=this.numBytes-t,this.activeProfile.newTensors=this.numTensors-n,[2,this.activeProfile]}))}))},e.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},e.prototype.addTapeNode=function(e,t,n){var r={};e.forEach((function(e,t){r[t]=e}));var o={id:this.nextTapeNodeId++,name:this.activeScope.name,inputs:r,outputs:[t],gradient:function(e){var t={};return n(e).forEach((function(e,n){t[n]=function(){return e}})),t}};this.activeTape.push(o)},e.prototype.keep=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {...}) to avoid memory leaks.");return this.keepTensors.add(e.id),e},e.prototype.startScope=function(e,t){void 0===t&&(t=!1),t&&0===this.gradientScopeCount&&(this.activeTape=[]),t&&this.gradientScopeCount++;var n={track:[],name:"unnamed scope"};e&&(n.name=e),this.scopeStack.push(n),this.activeScope=n},e.prototype.endScope=function(e,t){var n=this;void 0===t&&(t=!1),t&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null));var r=new Set(this.keepTensors),o=le(e);o.forEach((function(e){return r.add(e.id)}));for(var i=0;i<this.activeScope.track.length;i++){var a=this.activeScope.track[i];r.has(a.id)||(null!=this.activeTape?o.push(a):a.dispose())}var s=this.scopeStack.pop();this.activeScope=0===this.scopeStack.length?{track:[],name:"default scope"}:this.scopeStack[this.scopeStack.length-1],o.forEach((function(e){!n.keepTensors.has(e.id)&&function(e,t){for(var n=0;n<t.length;n++)if(t[n].id===e.id)return!0;return!1}(e,s.track)&&n.track(e)}))},e.prototype.gradients=function(e,t,n,r){var o=this;if(void 0===r&&(r=!1),g(t.length>0,"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");return this.tidy("gradients",(function(){var i=e();g(i instanceof ie,"The result y returned by f() must be a tensor.");var a=function(e,t,n){for(var r={},o={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var a=(f=e[i]).inputs;for(var s in a){for(var u=a[s],l=!1,c=0;c<t.length;c++)if(r[u.id]){f.outputs.forEach((function(e){return r[e.id]=!0})),l=!0,o[f.id]=!0;break}if(l)break}}var h={};h[n.id]=!0;var p={};for(i=e.length-1;i>=0;i--)for(a=(f=e[i]).inputs,c=0;c<f.outputs.length;c++)if(h[f.outputs[c].id]){for(var s in a)h[a[s].id]=!0,p[f.id]=!0;break}var d=[];for(i=0;i<e.length;i++){var f;if(o[(f=e[i]).id]&&p[f.id]){var m={};for(var s in f.inputs){var g=f.inputs[s];r[g.id]&&(m[s]=g)}var y=Object.assign({},f);y.inputs=m,y.outputs=f.outputs,d.push(y)}}return d}(o.activeTape,t,i);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");var s={};return s[i.id]=null==n?function(e){var t=q(w(e),"float32");return ie.make(e,{values:t})}(i.shape):n,function(e,t){for(var n=function(n){var r=t[n],o=[];if(r.outputs.forEach((function(t){var n=e[t.id];if(null!=n)o.push(n);else{var r=ie.make(t.shape,{values:H(t.size,t.dtype)},t.dtype);o.push(r)}})),null==r.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+r.name+".");var i=r.gradient(1===r.outputs.length?o[0]:o);for(var a in r.inputs){if(!(a in i))throw new Error("Cannot backprop through input "+a+". Available gradients found: "+Object.keys(i)+".");var s=i[a]();if("float32"!==s.dtype)throw new Error("Error in gradient for op "+r.name+". The gradient of input "+a+" must have 'float32' dtype, but has '"+s.dtype+"'");var u=r.inputs[a];if(!x(s.shape,u.shape))throw new Error("Error in gradient for op "+r.name+". The gradient of input '"+a+"' has shape '"+s.shape+"', which does not match the shape of the input '"+u.shape+"'");if(null==e[u.id])e[u.id]=s;else{var l=e[u.id];e[u.id]=l.add(s),l.dispose()}}},r=t.length-1;r>=0;r--)n(r)}(s,a),{value:i,grads:t.map((function(e){return s[e.id]}))}}),!0)},e.prototype.customGrad=function(e){var t=this;return g(B(e),"The f passed in customGrad(f) must be a function."),function(){for(var n,r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return g(o.every((function(e){return e instanceof ie})),"The args passed in customGrad(f)(x1, x2,...) must all be tensors"),t.scopedRun((function(){return t.customGradientDepth++}),(function(){return t.customGradientDepth--}),(function(){r=t.tidy(e.name,(function(){var t=e.apply(void 0,o),r=t.value,i=t.gradFunc;return g(r instanceof ie,"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),g(B(i),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n=i,r}),!0)})),t.shouldRecord()&&t.addTapeNode(o,r,(function(e){var t=n(e),r=Array.isArray(t)?t:[t];return g(r.length===o.length,"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),g(r.every((function(e){return e instanceof ie})),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."),r})),r}},e.prototype.write=function(e,t){var n=this.tensorInfo.get(e);if("string"===n.dtype){var r=j(t);this.numBytes+=r-n.bytes,n.bytes=r}this.backend!==n.backend&&(n.backend.disposeData(e),n.backend=this.backend,this.backend.register(e,n.shape,n.dtype)),this.backend.write(e,t)},e.prototype.readSync=function(e){return this.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.tensorInfo.get(e).backend.read(e)},e.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},e.prototype.time=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=G(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=G()-t,[2,n]}}))}))},e.prototype.track=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {op();...}); to avoid memory leaks.");return this.activeScope.track.push(e),e},e.nextTensorId=0,e.nextVariableId=0,e}();(he=ce||(ce={}))[he.NUMBER=0]="NUMBER",he[he.BOOLEAN=1]="BOOLEAN",he[he.STRING=2]="STRING";var de,fe=[{name:"DEBUG",type:ce.BOOLEAN},{name:"IS_BROWSER",type:ce.BOOLEAN},{name:"WEBGL_LAZILY_UNPACK",type:ce.BOOLEAN},{name:"WEBGL_CPU_FORWARD",type:ce.BOOLEAN},{name:"WEBGL_PACK_BATCHNORMALIZATION",type:ce.BOOLEAN},{name:"WEBGL_CONV_IM2COL",type:ce.BOOLEAN},{name:"WEBGL_MAX_TEXTURE_SIZE",type:ce.NUMBER},{name:"WEBGL_PAGING_ENABLED",type:ce.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",type:ce.NUMBER},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:ce.BOOLEAN},{name:"WEBGL_VERSION",type:ce.NUMBER},{name:"WEBGL_RENDER_FLOAT32_ENABLED",type:ce.BOOLEAN},{name:"WEBGL_DOWNLOAD_FLOAT_ENABLED",type:ce.BOOLEAN},{name:"WEBGL_FENCE_API_ENABLED",type:ce.BOOLEAN},{name:"WEBGL_SIZE_UPLOAD_UNIFORM",type:ce.NUMBER},{name:"BACKEND",type:ce.STRING},{name:"EPSILON",type:ce.NUMBER},{name:"PROD",type:ce.BOOLEAN},{name:"TENSORLIKE_CHECK_SHAPE_CONSISTENCY",type:ce.BOOLEAN}];function me(e){try{if(null!=c(e))return!0}catch(e){return!1}return!1}var ge="tfjsflags";function ye(){var e={};if("undefined"==typeof window||void 0===window.location||void 0===window.location.search)return e;var t=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return we(t,n[0],n[1]),n.join("=")})),t}(window.location.search);if(ge in t){var n={};t[ge].split(",").forEach((function(e){var t=e.split(":");n[t[0]]=t[1]})),fe.forEach((function(t){t.name in n&&(console.log("Setting feature override from URL "+t.name+": "+n[t.name]),t.type===ce.NUMBER?e[t.name]=+n[t.name]:t.type===ce.BOOLEAN?e[t.name]="true"===n[t.name]:t.type===ce.STRING?e[t.name]=n[t.name]:console.warn("Unknown URL param: "+t.name+"."))}))}return e}function ve(e,t){return null!=e.getExtension(t)}function be(e,t){var n=e.createFramebuffer(),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,2===t?e.RGBA32F:e.RGBA,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(n),o}function we(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}var xe=function(){function e(e){this.features={},this.registry={},null!=e&&(this.features=e),this.get("DEBUG")&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}return e.setBackend=function(e,t){if(void 0===t&&(t=!1),!(e in _e.registry))throw new Error("Backend name '"+e+"' not found in registry");_e.engine.backend=_e.findBackend(e),_e.backendName=e},e.getBackend=function(){return _e.initEngine(),_e.backendName},e.disposeVariables=function(){_e.engine.disposeVariables()},e.memory=function(){return _e.engine.memory()},e.profile=function(e){return _e.engine.profile(e)},e.tidy=function(e,t){return _e.engine.tidy(e,t)},e.dispose=function(e){le(e).forEach((function(e){return e.dispose()}))},e.keep=function(e){return _e.engine.keep(e)},e.time=function(e){return _e.engine.time(e)},e.prototype.get=function(e){return e in this.features?this.features[e]:(this.features[e]=this.evaluateFeature(e),this.features[e])},e.prototype.getFeatures=function(){return this.features},e.prototype.set=function(e,t){this.features[e]=t},e.prototype.getBestBackendName=function(){var e=this;if(0===Object.keys(this.registry).length)throw new Error("No backend found in registry.");return Object.keys(this.registry).map((function(t){return{name:t,entry:e.registry[t]}})).sort((function(e,t){return t.entry.priority-e.entry.priority}))[0].name},e.prototype.evaluateFeature=function(e){if("DEBUG"===e)return!1;if("IS_BROWSER"===e)return"undefined"!=typeof window;if("IS_NODE"===e)return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node;if("IS_CHROME"===e)return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);if("WEBGL_CPU_FORWARD"===e)return!0;if("WEBGL_PACK_BATCHNORMALIZATION"===e)return!1;if("WEBGL_LAZILY_UNPACK"===e)return!1;if("WEBGL_CONV_IM2COL"===e)return!1;if("WEBGL_PAGING_ENABLED"===e)return this.get("IS_BROWSER")&&!this.get("PROD");if("WEBGL_MAX_TEXTURE_SIZE"===e)return function(e){if(null==de){var t=c(e);de=t.getParameter(t.MAX_TEXTURE_SIZE)}return de}(this.get("WEBGL_VERSION"));if("IS_TEST"===e)return!1;if("BACKEND"===e)return this.getBestBackendName();if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"===e){var t=this.get("WEBGL_VERSION");return 0===t?0:function(e){if(0===e)return 0;var t=c(e);return ve(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:ve(t,"EXT_disjoint_timer_query")?1:0}(t)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===e)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}();if("HAS_WEBGL"===e)return this.get("WEBGL_VERSION")>0;if("WEBGL_VERSION"===e)return me(2)?2:me(1)?1:0;if("WEBGL_RENDER_FLOAT32_ENABLED"===e)return function(e){if(0===e)return!1;var t=c(e);if(1===e){if(!ve(t,"OES_texture_float"))return!1}else if(!ve(t,"EXT_color_buffer_float"))return!1;return be(t,e)}(this.get("WEBGL_VERSION"));if("WEBGL_DOWNLOAD_FLOAT_ENABLED"===e)return function(e){if(0===e)return!1;var t=c(e);if(1===e){if(!ve(t,"OES_texture_float"))return!1;if(!ve(t,"WEBGL_color_buffer_float"))return!1}else if(!ve(t,"EXT_color_buffer_float"))return!1;return be(t,e)}(this.get("WEBGL_VERSION"));if("WEBGL_FENCE_API_ENABLED"===e)return function(e){return 2===e&&null!=c(e).fenceSync}(this.get("WEBGL_VERSION"));if("WEBGL_SIZE_UPLOAD_UNIFORM"===e)return this.get("WEBGL_RENDER_FLOAT32_ENABLED")?4:0;if("TEST_EPSILON"===e)return 32===this.backend.floatPrecision()?.001:.1;if("EPSILON"===e)return 32===this.backend.floatPrecision()?1e-7:1e-4;if("PROD"===e)return!1;if("TENSORLIKE_CHECK_SHAPE_CONSISTENCY"===e)return!this.get("PROD");throw new Error("Unknown feature "+e+".")},e.prototype.setFeatures=function(e){this.features=Object.assign({},e)},e.prototype.reset=function(){this.features=ye(),null!=this.globalEngine&&(this.globalEngine=null)},Object.defineProperty(e.prototype,"backend",{get:function(){return this.engine.backend},enumerable:!0,configurable:!0}),e.prototype.findBackend=function(e){return e in this.registry?this.registry[e].backend:null},e.prototype.registerBackend=function(e,t,n,r){var o=this;if(void 0===n&&(n=1),e in this.registry)return console.warn(e+" backend was already registered. Reusing existing backend"),null!=r&&r((function(){return o.engine})),!1;try{var i=t();return i.setDataMover({moveData:function(e){return o.engine.moveData(e)}}),this.registry[e]={backend:i,priority:n},!0}catch(t){return console.warn("Registration of backend "+e+" failed"),console.warn(t.stack||t.message),!1}},e.prototype.removeBackend=function(e){if(!(e in this.registry))throw new Error(e+" backend not found in registry");this.registry[e].backend.dispose(),delete this.registry[e]},Object.defineProperty(e.prototype,"engine",{get:function(){return this.initEngine(),this.globalEngine},enumerable:!0,configurable:!0}),e.prototype.initEngine=function(){var e=this;if(null==this.globalEngine){this.backendName=this.get("BACKEND");var t=this.findBackend(this.backendName);this.globalEngine=new pe(t,!1,(function(){return e.get("DEBUG")}))}},e}(),_e=function(){var e=function(){var e;if("undefined"!=typeof window)e=window;else{if("undefined"==typeof process)throw new Error("Could not find a global object");e=process}return e}();return null==e.ENV&&(e.ENV=new xe(ye()),oe((function(){return e.ENV.engine}))),e.ENV}(),Ne=Object.freeze({EPSILON_FLOAT16:1e-4,EPSILON_FLOAT32:1e-7,Environment:xe,ENV:_e});function Ee(e){return g(B(e),"The f passed in grad(f) must be a function"),function(t,n){return g(t instanceof ie,"The x passed in grad(f)(x) must be a tensor"),g(null==n||n instanceof ie,"The dy passed in grad(f)(x, dy) must be a tensor"),_e.engine.tidy((function(){var r=_e.engine.gradients((function(){return e(t)}),[t],n),o=r.grads;return null!=n&&y(r.value.shape,n.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Te(o),o[0]}))}}function Ce(e){return g(B(e),"The f passed in grads(f) must be a function"),function(t,n){return g(Array.isArray(t)&&t.every((function(e){return e instanceof ie})),"The args passed in grads(f)(args) must be an array of tensors"),g(null==n||n instanceof ie,"The dy passed in grads(f)(args, dy) must be a tensor"),_e.engine.tidy((function(){var r=_e.engine.gradients((function(){return e.apply(void 0,t)}),t,n),o=r.grads;return null!=n&&y(r.value.shape,n.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Te(o),o}))}}function Ie(e){return g(B(e),"The f passed in valueAndGrad(f) must be a function"),function(t,n){g(t instanceof ie,"The x passed in valueAndGrad(f)(x) must be a tensor"),g(null==n||n instanceof ie,"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");var r=_e.engine.gradients((function(){return e(t)}),[t],n),o=r.grads,i=r.value;return Te(o),{grad:o[0],value:i}}}function Oe(e){return g(B(e),"The f passed in valueAndGrads(f) must be a function"),function(t,n){g(Array.isArray(t)&&t.every((function(e){return e instanceof ie})),"The args passed in valueAndGrads(f)(args) must be array of tensors"),g(null==n||n instanceof ie,"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");var r=_e.engine.gradients((function(){return e.apply(void 0,t)}),t,n);return null!=n&&y(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Te(r.grads),r}}function Se(e,t){if(g(B(e),"The f passed in variableGrads(f) must be a function"),g(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof ae})),"The varList passed in variableGrads(f, varList) must be an array of variables"),null==t)for(var n in t=[],_e.engine.registeredVariables)t.push(_e.engine.registeredVariables[n]);var r=t.length;g((t=t.filter((function(e){return e.trainable}))).length>0,"variableGrads() expects at least one of the input variables to be trainable, but none of the "+r+" variables is trainable.");var o=_e.engine.gradients(e,t,null,!0),i=o.value,a=o.grads;g(a.some((function(e){return null!=e})),"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),g(0===i.rank,"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+i.rank+" tensor");var s={};return t.forEach((function(e,t){null!=a[t]&&(s[e.name]=a[t])})),{value:i,grads:s}}function ke(e){return _e.engine.customGrad(e)}function Te(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var Ae=xe.tidy,Pe=xe.keep,De=xe.dispose,Re=xe.time,Me=xe.profile;function je(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_e.get("IS_TEST")||console.warn.apply(console,e)}function Le(e,t,n,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Ve(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Fe(e,t,n,r){void 0===r&&(r=!0);var o=[];o.push(r?e[0]/n:e[0]*n);for(var i=1;i<e.length;++i)o.push(i<=t.length?r?t[i-1]*e[i]:e[i]/t[i-1]:e[i]);return o}function ze(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Be(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function Ue(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function We(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((function(t){return e[t]}))]}function $e(e,t){return function(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[i++]):o.push(t[a++]);return o}(e,t.map((function(e){return 1})),t)}function qe(e,t){var n=t.length;return g((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e),g(e.every((function(e){return _(e)})),"All values in axis param must be integers but got axis "+e),e.map((function(e){return e<0?n+e:e}))}function He(e,t,n){g(Ue(t,n),e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input.")}function Ge(e,t){if(Ue(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Ke(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Xe(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function Ze(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Qe(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=W(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,o,u,l]}var Je=30;function Ye(e){return e<=Je?e:U(e,Math.floor(Math.sqrt(e)))}function et(e,t,n){for(var r=t.rank>1?t.shape[t.rank-1]:1,o=n.length,i=1,a=r;a<o;++a)i*=n[a];var s=t.size/(r<1?1:r),u=W(n).concat([1]);return{sliceRank:r,numUpdates:s,sliceSize:i,strides:u.slice(u.length-r,u.length),outputSize:w(n)}}function tt(e,t,n,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),0!==a)throw new Error("ellipsis mask is not yet supported");if(0!==s)throw new Error("new axis mask is not yet supported");for(var l=[],c=[],h=[],p=0;p<e.length;p++)l[p]=nt(o,t,r,e,p),c[p]=rt(i,n,r,e,p),u&1<<p&&(c[p]=l[p]+1,h.push(p));var d=new Array(e.length).fill(0);return d=d.map((function(e,t){for(var n=0,o=l[t];!(r[t]>0?o>=c[t]:o<=c[t]);o+=r[t])n+=1;return n})),[l,d,h]}function nt(e,t,n,r,o){var i=t[o];e&1<<o&&(i=n[o]>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[o];return i<0&&(i+=a),p(0,i,a-1)}function rt(e,t,n,r,o){var i=t[o];e&1<<o&&(i=n[o]>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[o];return i<0&&(i+=a),n[o]>0?p(0,i,a):p(-1,i,a-1)}function ot(e){var t=e;if(R(e))return[e.length];if(!Array.isArray(e))return[];for(var n=[];t instanceof Array;)n.push(t.length),t=t[0];return e instanceof Array&&_e.get("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],t instanceof Array){g(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),g(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var o=n.slice(1),i=0;i<t.length;++i)e(t[i],o,r.concat(i))}else g(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array of "+n[0]+" elements"}))}(e,n,[]),n}function it(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function at(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof ie)return it(r,e.dtype,t,n),e;var o=z(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),it(r,o,t,n),!R(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+e.constructor.name+"'");var i=ot(e);R(e)||Array.isArray(e)||(e=[e]);var a="string"!==o?$(e,o,_e.get("DEBUG")):b(e);return ie.make(i,{values:a},o)}function st(e,t,n){if(!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return at(e,t+"["+r+"]",n)}))}function ut(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_e.engine.startScope(n);try{var o=r.apply(void 0,e);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),_e.engine.endScope(o),o}catch(e){throw _e.engine.endScope(null),e}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}var lt=ut({softmax_:function(e,t){void 0===t&&(t=-1);var n=at(e,"logits","softmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return ke((function(e){var n=e.logSumExp([t],!0),r=e.toFloat().sub(n).exp();return{value:r,gradFunc:function(e){var n=e.mul(r);return n.sub(n.sum([t],!0).mul(r))}}}))(n)}}),ct=ut({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=at(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return ke((function(e){var n=e.max(t,!0),r=e.sub(n),o=r.toFloat().sub(r.exp().sum(t,!0).log());return{value:o,gradFunc:function(e){var n=o.exp();return e.sub(e.sum(t,!0).mul(n))}}}))(n)}}),ht=ut({complex_:function(e,t){var n=at(e,"real","complex"),r=at(t,"imag","complex");return y(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),_e.engine.runKernel((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),pt=ut({real_:function(e){var t=at(e,"input","real");return _e.engine.runKernel((function(e){return e.real(t)}),{$input:t})}}),dt=ut({imag_:function(e){var t=at(e,"input","imag");return _e.engine.runKernel((function(e){return e.imag(t)}),{$input:t})}});function ft(e,t,n){if(null==n&&(n=z(e)),"complex64"===n)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!R(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");var r=ot(e);return null!=t&&1!==r.length&&y(t,r,"Error creating a new Tensor. Inferred shape ("+r+") does not match the provided shape ("+t+"). "),R(e)||Array.isArray(e)||(e=[e]),t=t||r,e="string"!==n?$(e,n,_e.get("DEBUG")):b(e),ie.make(t,{values:e},n)}function mt(e,t){if((R(e)||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");return ft(e,[],t)}function gt(e,t){v(e);var n=ot(e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ft(e,n,t)}function yt(e,t,n){if(v(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=ot(e);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ft(e,t=t||r,n)}function vt(e,t,n){if(v(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=ot(e);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ft(e,t=t||r,n)}function bt(e,t,n){if(v(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=ot(e);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ft(e,t=t||r,n)}function wt(e,t,n){if(v(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=ot(e);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ft(e,t=t||r,n)}function xt(e,t,n){if(v(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=ot(e);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ft(e,t=t||r,n)}function _t(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=_t(e,"float32"),r=_t(e,"float32");return ht(n,r)}var o=q(w(e),t);return ie.make(e,{values:o},t)}function Nt(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=Nt(e,"float32"),r=Nt(e,"float32");return ht(n,r)}var o=H(w(e),t);return ie.make(e,{values:o},t)}function Et(e,t,n){var r=T(n=n||z(t),w(e));return r.fill(t),ie.make(e,{values:r},n)}function Ct(e,t,n){if(0===n)throw new Error("Cannot request zero samples");var r=(t-e)/(n-1),o=H(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return gt(o,"float32")}function It(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Nt([0],r);var o=H(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return gt(o,r)}var Ot,St,kt,Tt,At,Pt=ut({onesLike_:function(e){var t=at(e,"x","onesLike");return _t(t.shape,t.dtype)}}),Dt=ut({zerosLike_:function(e){var t=at(e,"x","zerosLike");return Nt(t.shape,t.dtype)}});!function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Ot||(Ot={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(St||(St={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(kt||(kt={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Tt||(Tt={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(At||(At={}));var Rt={float32:Tt,int32:St,bool:kt,complex64:At};function Mt(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return Rt[e][t]}function jt(e){return Mt(e,"int32")}var Lt=function(){function e(e){this.dataMover=e,this.data=new WeakMap}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(e),this.data.get(e)},e.prototype.set=function(e,t){this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.data.delete(e)},e}(),Vt=function(){function e(){}return e.prototype.time=function(e){throw new Error("Not yet implemented.")},e.prototype.read=function(e){throw new Error("Not yet implemented.")},e.prototype.readSync=function(e){throw new Error("Not yet implemented.")},e.prototype.disposeData=function(e){throw new Error("Not yet implemented.")},e.prototype.write=function(e,t){throw new Error("Not yet implemented.")},e.prototype.fromPixels=function(e,t){throw new Error("Not yet implemented.")},e.prototype.register=function(e,t,n){throw new Error("Not yet implemented.")},e.prototype.memory=function(){throw new Error("Not yet implemented.")},e.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},e.prototype.batchMatMul=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.slice=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s,u){throw new Error("Not yet implemented")},e.prototype.reverse=function(e,t){throw new Error("Not yet implemented")},e.prototype.concat=function(e,t){throw new Error("Not yet implemented")},e.prototype.neg=function(e){throw new Error("Not yet implemented")},e.prototype.add=function(e,t){throw new Error("Not yet implemented")},e.prototype.addN=function(e){throw new Error("Not yet implemented")},e.prototype.subtract=function(e,t){throw new Error("Not yet implemented")},e.prototype.multiply=function(e,t){throw new Error("Not yet implemented")},e.prototype.realDivide=function(e,t){throw new Error("Not yet implemented")},e.prototype.floorDiv=function(e,t){throw new Error("Not yet implemented")},e.prototype.sum=function(e,t){throw new Error("Not yet implemented")},e.prototype.prod=function(e,t){throw new Error("Not yet implemented")},e.prototype.unsortedSegmentSum=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.argMin=function(e,t){throw new Error("Not yet implemented")},e.prototype.argMax=function(e,t){throw new Error("Not yet implemented")},e.prototype.equal=function(e,t){throw new Error("Not yet implemented")},e.prototype.notEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.less=function(e,t){throw new Error("Not yet implemented")},e.prototype.lessEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.greater=function(e,t){throw new Error("Not yet implemented")},e.prototype.greaterEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.logicalNot=function(e){throw new Error("Not yet implemented")},e.prototype.logicalAnd=function(e,t){throw new Error("Not yet implemented")},e.prototype.logicalOr=function(e,t){throw new Error("Not yet implemented")},e.prototype.where=function(e){throw new Error("Not yet implemented")},e.prototype.select=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.topk=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.min=function(e,t){throw new Error("Not yet implemented")},e.prototype.minimum=function(e,t){throw new Error("Not yet implemented")},e.prototype.mod=function(e,t){throw new Error("Not yet implemented")},e.prototype.max=function(e,t){throw new Error("Not yet implemented")},e.prototype.maximum=function(e,t){throw new Error("Not yet implemented")},e.prototype.all=function(e,t){throw new Error("Not yet implemented")},e.prototype.any=function(e,t){throw new Error("Not yet implemented")},e.prototype.squaredDifference=function(e,t){throw new Error("Not yet implemented")},e.prototype.ceil=function(e){throw new Error("Not yet implemented")},e.prototype.floor=function(e){throw new Error("Not yet implemented")},e.prototype.round=function(e){throw new Error("Not yet implemented")},e.prototype.sign=function(e){throw new Error("Not yet implemented")},e.prototype.pow=function(e,t){throw new Error("Not yet implemented")},e.prototype.exp=function(e){throw new Error("Not yet implemented")},e.prototype.expm1=function(e){throw new Error("Not yet implemented")},e.prototype.log=function(e){throw new Error("Not yet implemented")},e.prototype.log1p=function(e){throw new Error("Not yet implemented")},e.prototype.sqrt=function(e){throw new Error("Not yet implemented")},e.prototype.rsqrt=function(e){throw new Error("Not yet implemented")},e.prototype.square=function(e){throw new Error("Not yet implemented")},e.prototype.reciprocal=function(e){throw new Error("Not yet implemented")},e.prototype.relu=function(e){throw new Error("Not yet implemented")},e.prototype.elu=function(e){throw new Error("Not yet implemented")},e.prototype.eluDer=function(e,t){throw new Error("Not yet implemented")},e.prototype.selu=function(e){throw new Error("Not yet implemented")},e.prototype.int=function(e){throw new Error("Not yet implemented")},e.prototype.clip=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.abs=function(e){throw new Error("Not yet implemented")},e.prototype.complexAbs=function(e){throw new Error("Not yet implemented")},e.prototype.sigmoid=function(e){throw new Error("Not yet implemented")},e.prototype.softplus=function(e){throw new Error("Not yet implemented")},e.prototype.sin=function(e){throw new Error("Not yet implemented")},e.prototype.cos=function(e){throw new Error("Not yet implemented")},e.prototype.tan=function(e){throw new Error("Not yet implemented")},e.prototype.asin=function(e){throw new Error("Not yet implemented")},e.prototype.acos=function(e){throw new Error("Not yet implemented")},e.prototype.atan=function(e){throw new Error("Not yet implemented")},e.prototype.atan2=function(e,t){throw new Error("Not yet implemented")},e.prototype.sinh=function(e){throw new Error("Not yet implemented")},e.prototype.cosh=function(e){throw new Error("Not yet implemented")},e.prototype.tanh=function(e){throw new Error("Not yet implemented")},e.prototype.asinh=function(e){throw new Error("Not yet implemented")},e.prototype.acosh=function(e){throw new Error("Not yet implemented")},e.prototype.atanh=function(e){throw new Error("Not yet implemented")},e.prototype.erf=function(e){throw new Error("Not yet implemented")},e.prototype.step=function(e,t){throw new Error("Not yet implemented")},e.prototype.conv2d=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv2dDerInput=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv2dDerFilter=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.depthwiseConv2D=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.maxPool=function(e,t){throw new Error("Not yet implemented")},e.prototype.maxPoolBackprop=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.avgPool=function(e,t){throw new Error("Not yet implemented")},e.prototype.avgPoolBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.reshape=function(e,t){throw new Error("Not yet implemented")},e.prototype.cast=function(e,t){throw new Error("Not yet implemented")},e.prototype.tile=function(e,t){throw new Error("Not yet implemented")},e.prototype.pad=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.transpose=function(e,t){throw new Error("Not yet implemented")},e.prototype.gather=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.gatherND=function(e,t){throw new Error("Not yet implemented")},e.prototype.scatterND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.batchToSpaceND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.spaceToBatchND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.resizeBilinear=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.resizeBilinearBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.batchNormalization=function(e,t,n,r,o,i){throw new Error("Not yet implemented")},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){throw new Error("Not yet implemented")},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){throw new Error("Not yet implemented")},e.prototype.multinomial=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.oneHot=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.cumsum=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.nonMaxSuppression=function(e,t,n,r,o){throw new Error("Not yet implemented")},e.prototype.fft=function(e){throw new Error("Not yet implemented")},e.prototype.ifft=function(e){throw new Error("Not yet implemented")},e.prototype.complex=function(e,t){throw new Error("Not yet implemented")},e.prototype.real=function(e){throw new Error("Not yet implemented")},e.prototype.imag=function(e){throw new Error("Not yet implemented")},e.prototype.cropAndResize=function(e,t,n,r,o,i){throw new Error("Not yet implemented")},e.prototype.depthToSpace=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.split=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.sparseToDense=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.setDataMover=function(e){throw new Error("Not yet implemented")},e.prototype.dispose=function(){throw new Error("Not yet implemented")},e}();function Ft(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Nt(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!D(e.dtype,t))return ie.make(e.shape,{dataId:e.dataId},t);if("complex64"===e.dtype){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=mt(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: unknown dtype argument ("+t+")")}function zt(e,t){return ie.make(t,{dataId:e.dataId},e.dtype)}function Bt(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ut(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Wt(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function $t(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function qt(e,t,n,r,o){for(var i=Array.from(t).map((function(e,t){return{score:e,boxIndex:t}})).filter((function(e){return e.score>o})).sort((function(e,t){return t.score-e.score})),a=[],s=0;s<i.length;s++){var u=i[s],l=u.boxIndex;if(u.score<o)break;for(var c=!1,h=a.length-1;h>=0;--h)if(Ht(e,l,a[h])>=r){c=!0;break}if(!c&&(a.push(l),a.length>=n))break}return gt(a,"int32")}function Ht(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),h=Math.max(o[0],o[2]),p=Math.max(o[1],o[3]),d=(s-i)*(u-a),f=(h-l)*(p-c);if(d<=0||f<=0)return 0;var m=Math.max(i,l),g=Math.max(a,c),y=Math.min(s,h),v=Math.min(u,p),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(d+f-b)}function Gt(e,t,n){var r=Array(e.rank).fill(0),o=e.shape.slice();return t.map((function(t){o[n]=t;var i=e.slice(r,o);return r[n]+=t,i}))}function Kt(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=k(n,s*r),c=k("int32",s*r),h=0;h<s;h++){for(var p=h*u,d=e.subarray(p,p+u),f=[],m=0;m<d.length;m++)f.push({value:d[m],index:m});f.sort((function(e,t){return t.value-e.value}));var g=h*r,y=l.subarray(g,g+r),v=c.subarray(g,g+r);for(m=0;m<r;m++)y[m]=f[m].value,v[m]=f[m].index}var b=t.slice();return b[b.length-1]=r,[ft(l,b,n),ft(c,b,"int32")]}var Xt=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=Math.ceil(e.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===t?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "},Zt=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.effectiveFilterHeight,n=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(e.filterHeight*e.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+";\n            wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+e.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};function Qt(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o;(t[t.length-1-o]||1)>1&&1===(e[i]||1)&&r.unshift(i)}return r}function Jt(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1;(null==o||1===o&&t[i]>1)&&n.unshift(i)}return n}function Yt(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];null==i&&(i=1);var a=t[t.length-o-1];if(null==a&&(a=1),1===i)n.unshift(a);else if(1===a)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}var en=function(e,t,n,r,o,i){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],Yt(e,t),Yt(e,n);var a="0.0";null!=r&&(Yt(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(Yt(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},tn=function(e,t,n,r,o,i){this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],Yt(e,t),Yt(e,n);var a=nn("mean",t.length),s=nn("variance",n.length),u="vec4 offset = vec4(0.0)";null!=r&&(Yt(e,r),this.variableNames.push("offset"),u=nn("offset",r.length));var l="vec4 scale = vec4(1.0)";null!=o&&(Yt(e,o),this.variableNames.push("scale"),l=nn("scale",o.length)),this.outputShape=e,this.userCode="\n      void main() {\n        ivec4 rc = getOutputCoords();\n\n        "+u+";\n        "+l+";\n\n        vec4 x = getX(rc.x, rc.y, rc.z, rc.w);\n        "+a+";\n        "+s+";\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "};function nn(e,t){var n="get"+e.charAt(0).toUpperCase()+e.slice(1);return 1===t?"\n      vec4 "+e+"Sample = "+n+"(rc.w);\n      vec4 "+e+" = vec4("+e+"Sample.xy, "+e+"Sample.xy);\n    ":"vec4 "+e+" = "+n+"(rc.x, rc.y, rc.z, rc.w)"}var rn=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.supportsBroadcasting=!0,this.outputShape=Yt(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},on="return a + b;",an="return a - b;",sn=function(){function e(e,t,n){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=Yt(t,n),this.userCode="\n      uniform float NAN;\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(){var e=this;return function(t,n){null==e.startLoc&&(e.startLoc=t.getUniformLocationNoThrow(n,"NAN"),null==e.startLoc)||t.gl.uniform1f(e.startLoc,NaN)}},e}(),un=function(e,t,n){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, float("+t+"), float("+n+")));\n      }\n    "},ln=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},cn=function(e,t){this.variableNames=["A","B"],this.outputShape=[],this.outputShape=Ze([e,t],1),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        float value = 0.0;\n        if (yC < "+e[1]+") {\n          value = getA(yR, yC);\n        } else {\n          yC -= "+e[1]+";\n          value = getB(yR, yC);\n        }\n\n        setOutput(value);\n      }\n    "},hn=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},pn=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},dn=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+e.outChannels/e.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TODO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},fn=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TODO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},mn=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.top,n=e.padInfo.left,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.filterHeight,u=e.filterWidth,l=4*Math.floor(e.inChannels/4),c=e.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+o+");\n      const ivec2 pads = ivec2("+t+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+"; wR++) {\n          int xR = xRCorner + wR * "+i+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+u+"; wC++) {\n            int xC = xCCorner + wC * "+a+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+l+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===c)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+l+") *\n                getW(wR, wC, "+l+", d2);\n            } else if ("+(2===c)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+l+"),\n                getX(batch, xR, xC, "+l+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+l+", d2),\n                getW(wR, wC, "+l+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===c)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+l+"),\n                getX(batch, xR, xC, "+l+" + 1),\n                getX(batch, xR, xC, "+l+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+l+", d2),\n                getW(wR, wC, "+l+" + 1, d2),\n                getW(wR, wC, "+l+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},gn=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+e.strideHeight+", "+e.strideWidth+");\n      const ivec2 pads = ivec2("+e.padInfo.top+", "+e.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+t+";\n        int q = d2 - d1 * "+t+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+e.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+e.dilationHeight+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+e.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+e.dilationWidth+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yn=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=n[0],l=n[1];this.outputShape=[t[0],u,l,e[3]];var c=[a-1+".0",s-1+".0"],h=c[0],p=c[1],d=u>1?[""+(a-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],f=l>1?[""+(s-1)/(l-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p];this.userCode="\n      const float height_ratio = float("+d[0]+");\n      const float width_ratio = float("+f[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+d[1]+";\n        float width_scale = "+f[1]+";\n\n        float in_y = "+d[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+f[2]+";\n        if( in_x < 0.0 || in_x > "+p+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexRC = vec2(in_y,in_x);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n          ivec2 sourceCeilRC = ivec2(ceil(sourceFracIndexRC));\n\n          float topLeft = getImage(b, sourceFloorRC.x, sourceFloorRC.y, d);\n          float bottomLeft = getImage(b, sourceCeilRC.x, sourceFloorRC.y, d);\n          float topRight = getImage(b, sourceFloorRC.x, sourceCeilRC.y, d);\n          float bottomRight = getImage(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n          vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n          float top = topLeft + (topRight - topLeft) * fracRC.y;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n          float newValue = top + (bottom - top) * fracRC.x;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestRC = ivec2(floor(\n            sourceFracIndexRC + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestRC.x, sourceNearestRC.y, d);\n          setOutput(newValue);\n        }\n      }\n    "};function vn(e,t,n){void 0===n&&(n="index");var r=W(t);return r.map((function(t,o){return"int "+e[o]+" = "+n+" / "+t+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+t:"index -= "+e[o]+" * "+t)+";"})).join("")}function bn(e){return 1===e.length?""+e[0]:"vec"+e.length+"("+e.join(",")+")"}var wn="\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n  }\n",xn="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",_n="\n  void setOutput(vec4 val) {\n    gl_FragColor = val;\n  }\n",Nn="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  struct ivec5\n  {\n    int x;\n    int y;\n    int z;\n    int w;\n    int u;\n  };\n\n  struct ivec6\n  {\n    int x;\n    int y;\n    int z;\n    int w;\n    int u;\n    int v;\n  };\n\n  bool isNaN(float val) {\n    return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  //Based on the work of Dave Hoskins\n  //https://www.shadertoy.com/view/4djSRW\n  #define HASHSCALE1 443.8975\n  float random(float seed){\n    vec2 p = resultUV * seed;\n    vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n  }\n\n  \nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom4D(int texNumR, int texNumC, int texelsInBatch2,\n    int texelsInBatch, int texelsInLogicalRow, int b2, int b,\n    int row, int col) {\n  int index = b2 * texelsInBatch2 + b * texelsInBatch +\n    (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom5D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int stride3, int row, int col, int depth,\n    int depth2, int depth3) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 +\n              depth * stride2 + depth2 * stride3 + depth3;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom6D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int stride3, int stride4,\n    int row, int col, int depth, int depth2, int depth3, int depth4) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2 *\n    stride3 + depth3 * stride4 + depth4;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n",En="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Cn(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function In(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function On(e,t){return t.map((function(t){return e[t]})).join(", ")}var Sn=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Cn(r)+" coords = getOutputCoords();\n        int end = "+kn(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+kn(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function kn(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Tn,An,Pn=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Dn=function(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      const float FLOAT_MAX = 1.70141184e38;\n      const float FLOAT_MIN = 1.17549435e-38;\n\n      lowp vec4 encode_float(highp float v) {\n        if (isNaN(v)) {\n          return vec4(255, 255, 255, 255);\n        }\n\n        highp float av = abs(v);\n\n        if(av < FLOAT_MIN) {\n          return vec4(0.0, 0.0, 0.0, 0.0);\n        } else if(v > FLOAT_MAX) {\n          return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n        } else if(v < -FLOAT_MAX) {\n          return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n        }\n\n        highp vec4 c = vec4(0,0,0,0);\n\n        highp float e = floor(log2(av));\n        highp float m = exp2(fract(log2(av))) - 1.0;\n\n        c[2] = floor(128.0 * m);\n        m -= c[2] / 128.0;\n        c[1] = floor(32768.0 * m);\n        m -= c[1] / 32768.0;\n        c[0] = floor(8388608.0 * m);\n\n        highp float ebias = e + 127.0;\n        c[3] = floor(ebias / 2.0);\n        ebias -= c[3] * 2.0;\n        c[2] += floor(ebias) * 128.0;\n\n        c[3] += 128.0 * step(0.0, -v);\n\n        return c / 255.0;\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        gl_FragColor = encode_float(x);\n      }\n    "},Rn=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Mn=function(e){this.variableNames=["A"];var t=e[0],n=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+n+".0, "+t+".0);\n\n        vec4 values = texture2D(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},jn=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Cn(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)o.push(i===t?"int(getIndices("+r[i]+"))":""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Ln=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Cn(t.length),o=Cn(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function Vn(e,t){return[t,e]}function Fn(e,t){return e*t}function zn(e,t,n){var r=function(e,t){if(e%t!=0)throw new Error("unpackedSize ("+e+") must be a multiple of "+t);return e/t}(e.length,n);if(t.length<r)throw new Error("matrix length ("+t.length+") must be >= "+r);for(var o=0,i=0;i<e.length;i+=n)t[o++]=e[i]}function Bn(e,t){return[Math.ceil(t/2),Math.ceil(e/2)]}function Un(e,t){var n=Bn(e,t);return n[0]*n[1]*4}function Wn(e,t){var n=t();return Hn(e),n}!function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Tn||(Tn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(An||(An={}));var $n=!1;function qn(e){$n=e}function Hn(e){if($n){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Gn(e,t))}}function Gn(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Kn(e,t){return gr(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function Xn(e,t){var n=gr(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Wn(e,(function(){return e.shaderSource(n,t)})),Wn(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Zn(e,t){var n=gr(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Wn(e,(function(){return e.shaderSource(n,t)})),Wn(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=Qn.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],o=e.split("\n"),i=o.length.toString().length+2,a=o.map((function(e,t){return C((t+1).toString(),i)+e})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var l=a.slice(0,r-1),c=a.slice(r-1,r),h=a.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+C(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Qn=/ERROR: [0-9]+:([0-9]+):/g;function Jn(e){return gr(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function Yn(e,t){if(Wn(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function er(e,t){if(Wn(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function tr(e,t){var n=gr(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Wn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),Wn(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}function nr(e,t){var n=gr(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Wn(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),Wn(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}function rr(){return 2===_e.get("WEBGL_VERSION")?1:4}function or(e){return gr(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function ir(e,t){var n=_e.get("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function ar(e){return gr(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function sr(e,t,n,r,o,i,a){var s=e.getAttribLocation(t,n);return-1!==s&&(Wn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),Wn(e,(function(){return e.vertexAttribPointer(s,o,e.FLOAT,!1,i,a)})),Wn(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function ur(e,t,n){yr(e,n),Wn(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}function lr(e,t,n){return gr(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function cr(e,t,n){return e.getUniformLocation(t,n)}function hr(e,t,n,r,o){Wn(e,(function(){return ur(e,n,o)})),Wn(e,(function(){return e.uniform1i(r,o)}))}function pr(e,t,n){Wn(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),Wn(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function dr(e,t){Wn(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),Wn(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function fr(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+mr(e,t))}function mr(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function gr(e,t,n){var r=Wn(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function yr(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function vr(e,t){void 0===t&&(t=!1);var n=_e.get("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,e=e.map((function(t,n){return n>=e.length-2?d(e[n]):e[n]}))),2!==e.length){var r=S(e);e=r.newShape}var o=w(e);return e.length<=1&&o<=n?[1,o]:2===e.length&&e[0]<=n&&e[1]<=n?e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n?[e[0],e[1]*e[2]*e[3]]:E(o)}function br(e){return e%2==0}function wr(e,t){if(x(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(br(n)&&br(r)&&(1===e[0]||1===t[0]))return!0}else if(br(e[0])&&br(t[0])){if(br(e[1])&&br(t[1]))return!0;if(e[1]===t[1])return!0}return!1}var xr=Object.freeze({callAndCheck:Wn,enableDebugWebGLErrorChecking:qn,checkWebGLError:Hn,getWebGLErrorMessage:Gn,getExtensionOrThrow:Kn,createVertexShader:Xn,createFragmentShader:Zn,createProgram:Jn,linkProgram:Yn,validateProgram:er,createStaticVertexBuffer:tr,createStaticIndexBuffer:nr,getNumChannels:rr,createTexture:or,validateTextureSize:ir,createFramebuffer:ar,bindVertexBufferToProgramAttribute:sr,bindTextureUnit:ur,unbindTextureUnit:function(e,t){yr(e,t),Wn(e,(function(){return e.activeTexture(e.TEXTURE0+t)})),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:lr,getProgramUniformLocation:cr,bindTextureToProgramUniformSampler:hr,bindCanvasToFramebuffer:function(e){Wn(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Wn(e,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),Wn(e,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:pr,unbindColorTextureFromFramebuffer:dr,validateFramebuffer:fr,getFramebufferErrorMessage:mr,getTextureShapeFromLogicalShape:vr,isReshapeFree:wr});function _r(e){return Xn(e,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Nr(e){return tr(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Er(e){return nr(e,new Uint16Array([0,1,2,2,1,3]))}function Cr(e,t){var n,r,o,i,a,s,u,l=e;return 2===_e.get("WEBGL_VERSION")?(n=l.R32F,r=l.R16F,o=l.RGBA32F,i=l.RED,a=4,s=1,u=l.HALF_FLOAT):(n=e.RGBA,r=e.RGBA,o=l.RGBA,i=e.RGBA,a=4,s=4,u=null!=t?t.HALF_FLOAT_OES:null),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:s,textureTypeHalfFloat:u}}function Ir(e,t,n,r,o,i){ir(t,n);var a=or(e),s=e.TEXTURE_2D;return Wn(e,(function(){return e.bindTexture(s,a)})),Wn(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),Wn(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),Wn(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),Wn(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),Wn(e,(function(){return e.texImage2D(s,0,r,t,n,0,o,i,null)})),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),a}function Or(e,t,n,r){var o=Vn(t,n);return Ir(e,o[0],o[1],r.internalFormatFloat,r.textureFormatFloat,e.FLOAT)}function Sr(e,t,n,r){var o=Vn(t,n);return Ir(e,o[0],o[1],r.internalFormatFloat,r.textureFormatFloat,r.textureTypeHalfFloat)}function kr(e,t,n,r){var o=Vn(t,n);return Ir(e,o[0],o[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function Tr(e,t,n,r){var o=Bn(t,n);return Ir(e,o[0],o[1],r.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function Ar(e,t,n,r){var o=Bn(t,n);return Ir(e,o[0],o[1],r.internalFormatHalfFloat,e.RGBA,r.textureTypeHalfFloat)}function Pr(e,t,n){return Wn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),sr(e,t,"clipSpacePos",n,3,20,0)&&sr(e,t,"uv",n,2,20,12)}function Dr(e,t,n){Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),Wn(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function Rr(e,t,n,r,o,i){ir(n,r),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),Wn(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,i,e.FLOAT,o)})),Wn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function Mr(e,t,n,r,o,i,a){var s,u=Vn(n,r),l=u[0],c=u[1];1===a.defaultNumChannels?s=o:function(e,t,n){var r=Fn(e.length,n);if(t.length<r)throw new Error("unpackedArray length ("+t.length+") must be >= "+r);for(var o=0,i=0;i<e.length;++i)t[o]=e[i],o+=n}(o,s=new Float32Array(Fn(o.length,i)),i),Rr(e,t,l,c,s,a.textureFormatFloat)}function jr(e,t,n,r,o,i,a,s,u){var l=Bn(i,a),c=l[0],h=l[1],p=new Float32Array(n*Un(r,o));(function(e,t,n,r,o){var i=Un(n,r);if(o.length<i)throw new Error("packedRGBA length ("+o.length+") must be >=\n        "+i);for(var a=r%2==1,s=n%2==1,u=Math.floor(r/2),l=Math.floor(n/2),c=Math.ceil(r/2),h=c*Math.ceil(n/2),p=d(n)*d(r),f=0;f<t;f++){for(var m=f*n*r,g=f*p,y=a?4:0,v=r,b=g,w=0;w<l;++w){for(var x=2*w*r,_=0;_<u;++_){var N=m+x+2*_;o[b]=e[N],o[b+1]=e[N+1],o[b+2]=e[N+v],o[b+3]=e[N+v+1],b+=4}b+=y}if(a){N=m+r-1,b=g+4*(c-1);var E=2*r;for(y=4*c,w=0;w<l;++w)o[b]=e[N],o[b+2]=e[N+r],N+=E,b+=y}if(s){for(N=m+(n-1)*r,b=g+4*(h-c),_=0;_<u;++_)o[b++]=e[N++],o[b++]=e[N++],b+=2;a&&s&&(o[g+p-4]=e[N])}}})(s,n,r,o,p),Rr(e,t,c,h,p,e.RGBA)}function Lr(e,t,n,r,o){var i=t;if(2===_e.get("WEBGL_VERSION")){var a=e,s=a.createBuffer();Wn(e,(function(){return e.bindBuffer(a.PIXEL_PACK_BUFFER,s)}));var u=4*Fn(n*r,o.downloadUnpackNumChannels);Wn(e,(function(){return e.bufferData(a.PIXEL_PACK_BUFFER,u,e.STATIC_DRAW)})),Wn(e,(function(){return a.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),Wn(e,(function(){return e.bindBuffer(a.PIXEL_PACK_BUFFER,null)})),i=s}return i}function Vr(e,t,n,r,o){var i=e,a=new Float32Array(Fn(n*r,o.downloadUnpackNumChannels));i.bindBuffer(e.ARRAY_BUFFER,t),i.getBufferSubData(e.ARRAY_BUFFER,0,a),i.bindBuffer(e.ARRAY_BUFFER,null);var s=new Float32Array(n*r);return zn(a,s,o.downloadUnpackNumChannels),s}function Fr(e,t,n,r){var o=Vn(t,n),i=o[0],a=o[1],s=new Float32Array(Fn(t*n,r.downloadUnpackNumChannels));Wn(e,(function(){return e.readPixels(0,0,i,a,r.downloadTextureFormat,e.FLOAT,s)}));var u=new Float32Array(t*n);return zn(s,u,r.downloadUnpackNumChannels),u}function zr(e,t,n,r){var o=Vn(t,n),i=o[0],a=o[1],s=new Uint8Array(Fn(t*n,4));return Wn(e,(function(){return e.readPixels(0,0,i,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}function Br(e,t,n,r,o,i,a){var s=Bn(o,i),u=s[0],l=s[1],c=new Float32Array(Un(o,i));Wn(e,(function(){return e.readPixels(0,0,u,l,e.RGBA,e.FLOAT,c)}));var h=new Float32Array(w([t,n,r]));return function(e,t,n,r,o){var i=n*r;if(o.length<i)throw new Error("matrix length ("+o.length+") must be >= "+i);for(var a=r%2==1,s=n%2==1,u=Math.floor(r/2),l=Math.floor(n/2),c=Math.ceil(r/2),h=c*Math.ceil(n/2),p=d(n)*d(r),f=0;f<t;f++){for(var m=f*n*r,g=f*p,y=a?4:0,v=r+(a?1:0),b=g,w=m,x=m+r,_=0;_<l;++_){for(var N=0;N<u;++N)o[w++]=e[b++],o[w++]=e[b++],o[x++]=e[b++],o[x++]=e[b++];b+=y,w+=v,x+=v}if(a){b=g+4*(c-1);var E=m+r-1;for(y=4*c,v=2*r,_=0;_<l;++_)o[E]=e[b],o[E+r]=e[b+2],b+=y,E+=v}if(s){for(b=g+4*(h-c),E=m+(n-1)*r,N=0;N<u;++N)o[E++]=e[b++],o[E++]=e[b++],b+=2;a&&(o[m+n*r-1]=e[b])}}return o}(c,t,n,r,h)}var Ur=Object.freeze({createVertexShader:_r,createVertexBuffer:Nr,createIndexBuffer:Er,getTextureConfig:Cr,createFloat32MatrixTexture:Or,createFloat16MatrixTexture:Sr,createUnsignedBytesMatrixTexture:kr,createPackedMatrixTexture:Tr,createFloat16PackedMatrixTexture:Ar,bindVertexProgramAttributeStreams:Pr,uploadPixelDataToTexture:Dr,uploadMatrixToTexture:Mr,uploadMatrixToPackedTexture:jr,maybeCreateBufferFromOutputTexture:Lr,downloadFloat32MatrixFromBuffer:Vr,downloadFloat32MatrixFromOutputTexture:Fr,downloadByteEncodedFloatMatrixFromOutputTexture:zr,downloadMatrixFromPackedOutputTexture:Br}),Wr=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[],this.gl=null!=e?e:c(_e.get("WEBGL_VERSION")),1===_e.get("WEBGL_VERSION")?(this.textureFloatExtension=Kn(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),_e.get("WEBGL_RENDER_FLOAT32_ENABLED")||(this.textureHalfFloatExtension=Kn(this.gl,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float"))):this.colorBufferFloatExtension=Kn(this.gl,"EXT_color_buffer_float"),this.vertexBuffer=Nr(this.gl),this.indexBuffer=Er(this.gl),this.framebuffer=ar(this.gl),this.textureConfig=Cr(this.gl,this.textureHalfFloatExtension)}return e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Wn(t,(function(){return t.finish()})),Wn(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Wn(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),Wn(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Wn(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Wn(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.enableAutomaticDebugValidation=function(e){this.autoDebugValidate=e,qn(e)},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Or(this.gl,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),Sr(this.gl,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),kr(this.gl,e,t)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),Dr(this.gl,e,t)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Ar(this.gl,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Tr(this.gl,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(dr(this.gl,this.framebuffer),this.outputTexture=null),Wn(this.gl,(function(){return t.gl.deleteTexture(e)}))},e.prototype.uploadMatrixToTexture=function(e,t,n,r){this.throwIfDisposed();var o=rr();return Mr(this.gl,e,t,n,r,o,this.textureConfig)},e.prototype.uploadMatrixToPackedTexture=function(e,t,n,r,o,i,a){return this.throwIfDisposed(),jr(this.gl,e,t,n,r,o,i,a)},e.prototype.downloadFloat32MatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return Fr(r.gl,t,n,r.textureConfig)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return zr(r.gl,t,n,r.textureConfig)}))},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t,n){return Vr(this.gl,e,t,n,this.textureConfig)},e.prototype.maybeCreateBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=Lr(this.gl,e,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(_e.get("WEBGL_FENCE_API_ENABLED")){var o=e,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=o.clientWaitSync(i,0,0);return e===o.ALREADY_SIGNALED||e===o.CONDITION_SATISFIED},t=i}else _e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n,r,o,i){var a=this;return this.downloadMatrixDriver(e,(function(){return Br(a.gl,t,n,r,o,i)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=Zn(t,e),r=_r(t),o=Jn(t);return Wn(t,(function(){return t.attachShader(o,r)})),Wn(t,(function(){return t.attachShader(o,n)})),Yn(t,o),this.autoDebugValidate&&er(t,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=Pr(t,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&Wn(this.gl,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.autoDebugValidate&&er(this.gl,this.program),Wn(this.gl,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?lr(this.gl,e,t):cr(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),Wn(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),hr(this.gl,0,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=Bn(t,n);this.setOutputMatrixTextureDriver(e,r[0],r[1])},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&er(this.gl,this.program),fr(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.autoDebugValidate&&this.debugValidate(),Wn(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Wn(this.gl,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Kn(this.gl,2===_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,I((function(){return t.disposed||t.isQueryAvailable(e,_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,_e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0,n=e.length-1,r=-1;t<=n;){var o=t+n>>1;e[o]()?(r=o,t=o+1):n=o-1}return r}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||I((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),pr(this.gl,e,this.framebuffer),this.autoDebugValidate&&fr(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(pr(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&fr(this.gl)):dr(this.gl,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;pr(r,e,this.framebuffer),this.autoDebugValidate&&fr(r),this.outputTexture=e,Wn(r,(function(){return r.viewport(0,0,t,n)})),Wn(r,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),Wn(this.gl,(function(){return o.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function $r(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,o=t[n],i=o.shape;if(!x(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!o.isUniform){var a=e.texShape,s=o.isUniform?null:o.texData.texShape;if(!x(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var qr=function(e,t,n){this.variableNames=["A"],this.outputShape=e;var r=n.inChannels,o=n.padInfo,i=n.outWidth,a=r*n.filterWidth;this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            int blockIndex = rc.y + col;\n            int pos = rc.x + row;\n\n            if(blockIndex >= "+e[1]+" || pos >= "+e[0]+") continue;\n\n            int offsetY = int(blockIndex / ("+i+")) * "+n.strideHeight+" - "+o.top+";\n            int d0 = offsetY + "+n.dilationHeight+" * (pos / "+a+");\n\n            if(d0 >= "+t[0]+" || d0 < 0) continue;\n\n            int offsetX = int(mod(float(blockIndex), "+i+".) * "+n.strideWidth+". - "+o.left+".);\n            int d1 = offsetX + "+n.dilationWidth+" * (int(mod(float(pos), "+a+".) / "+r+".));\n\n            if(d1 >= "+t[1]+" || d1 < 0) continue;\n\n            result[row * 2 + col] = getA(d0, d1, int(mod(float(pos), "+r+".)));\n          }\n        }\n\n        gl_FragColor = result;\n      }\n    "},Hr=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i=t,a=e[3]-1;this.outputShape=e;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+i+"; j <= "+i+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===o?"inversesqrt("+s+")":1===o?"1.0/("+s+")":"exp(log("+s+") * float(-"+o+"));")+";\n        setOutput(val);\n      }\n    "},Gr=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Kr=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.effectiveFilterHeight,n=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+";\n          wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(t*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Xr=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.variableNames=["matrixA","matrixB"];var o=n?e[1]:e[2];this.outputShape=[e[0],n?e[2]:e[1],r?t[1]:t[2]];var i=function(e,t){return n?"batch, "+t+" + "+e+", aRow":"batch, aRow, "+t+" + "+e},a=function(e,t){return r?"batch, bCol, "+t+" + "+e:"batch, "+t+" + "+e+", bCol"},s=4*Math.floor(o/4),u=o%4;this.userCode=" float dotARowBCol(int batch, int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+s+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+i(0,"i")+"),\n          getMatrixA("+i(1,"i")+"),\n          getMatrixA("+i(2,"i")+"),\n          getMatrixA("+i(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+a(0,"i")+"),\n          getMatrixB("+a(1,"i")+"),\n          getMatrixB("+a(2,"i")+"),\n          getMatrixB("+a(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===u)+") {\n        result += getMatrixA("+i(0,s)+") *\n          getMatrixB("+a(0,s)+");\n      } else if ("+(2===u)+") {\n        vec2 a = vec2(\n          getMatrixA("+i(0,s)+"),\n          getMatrixA("+i(1,s)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+a(0,s)+"),\n          getMatrixB("+a(1,s)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===u)+") {\n        vec3 a = vec3(\n          getMatrixA("+i(0,s)+"),\n          getMatrixA("+i(1,s)+"),\n          getMatrixA("+i(2,s)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+a(0,s)+"),\n          getMatrixB("+a(1,s)+"),\n          getMatrixB("+a(2,s)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec3 resBRC = getOutputCoords();\n      setOutput(dotARowBCol(resBRC.x, resBRC.y, resBRC.z));\n    }\n    "},Zr=function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=n;var i=Math.ceil((r?e[0]:e[1])/2),a=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],s=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];this.userCode="\n      const float sharedDimension = "+i+".0;\n\n      vec4 dot2x2ARowBCol(ivec2 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+i+"; i++) {\n          vec4 a = getMatrixA("+(r?"i * 2, rc.x":"rc.x, i * 2")+");\n          vec4 b = getMatrixB("+(o?"rc.y, i * 2":"i * 2, rc.y")+");\n\n          result += ("+a[0]+" * "+s[0]+") + ("+a[1]+" * "+s[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n        setOutput(dot2x2ARowBCol(rc));\n      }\n    "},Qr=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),Jr=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "};function Yr(e,t){return 1===t?[e]:function(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}(e,t)}var eo=function(e){this.variableNames=["A"],this.isPackShader=!0,this.outputShape=e;var t=e.length,n=Yr("rc",t),r=Cn(t),o=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",o=e-2;o<e;o++)r+=n[o]+" >= "+t[o],o<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var o=r.slice(-2);return"\n    int r = "+o[0]+";\n    int c = "+o[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),a=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var o=0;o<=1;o++){for(var i=(0===r?"r":"rp1")+", "+(0===o?"c":"cp1"),a=2;a<e;a++)i=t[t.length-1-a]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n\n        if("+o+") {\n          gl_FragColor = vec4(0);\n        } else {\n          "+i+"\n\n          setOutput(vec4("+a+"));\n        }\n      }\n    "},to=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,o=Cn(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},no=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p="avg"===t,d="0.0";if(p||(d="-1.0 / 0.0"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+c+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var f=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(f="avgValue / count");var m=4*Math.floor(r/4),g=r%4,y="\n      if ("+p+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+c+", "+h+");\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+d+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+y+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+y+"\n          }\n        }\n        setOutput("+f+");\n      }\n    "}},ro=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 0.0",s="min"):"max"===t&&(a="-1.0 / 0.0",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,h="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===t?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===t&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var d="";o%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},oo=function(e,t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      "+function(e){return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+vn(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  "}(t)+"\n      "+function(e){return"\n    int getFlatIndex(ivec3 coords) {\n      return round("+function(e,t){if(e.length!==t.length)throw new Error("Vectors to be dotted must be of the same length -got "+e.length+" and "+t.length);for(var n=[],r=Math.floor(e.length/4),o=e.length%4,i=0;i<r;i++){var a=e.slice(4*i,4*i+4),s=t.slice(4*i,4*i+4);n.push(bn(a)+", "+bn(s))}return 0!==o&&(a=e.slice(4*r),s=t.slice(4*r),1===a.length&&(a=a.map((function(e){return"float("+e+")"})),s=s.map((function(e){return"float("+e+")"}))),n.push(bn(a)+", "+bn(s))),n.map((function(e,t){return"dot("+e+")"})).join("+")}(["coords.x","coords.y","coords.z"],W(e).map((function(e){return e.toString()})).concat(["1."]))+");\n    }\n  "}(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},io=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],p=l[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},ao=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[1],i=e[2];this.outputShape=[e[0],t,n,e[3]];var a=[r&&t>1?o-1:o,r&&n>1?i-1:i],s=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+i+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},so=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],p=l[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},uo=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[1],i=e[2];this.outputShape=[e[0],t,n,e[3]];var a=[r&&t>1?o-1:o,r&&n>1?i-1:i],s=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+i+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},lo=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),o=Cn(n);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},co=function(e,t,n,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Cn(o.length),u=Cn(i.length),l="";1===n?l="i":2===n&&(l="i, j");var c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round(getIndices("+l+"));\n              flattenedIndex += index * "+(t>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+c+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},ho=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, filter);\n    ",c="";o%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var h="";o%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 filter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 filter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 filter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 filter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},po=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Cn(n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},fo=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t=Cn(this.rank),n=function(e){if(1===e)return"sourceLoc";if(2===e)return"sourceLoc.x, sourceLoc.y";if(3===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);this.userCode="\n      uniform "+t+" start;\n\n      void main() {\n        "+t+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+n+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){if(null!=t.startLoc||(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null!=t.startLoc))if(1===t.rank)n.gl.uniform1i(t.startLoc,e[0]);else if(2===t.rank)n.gl.uniform2i(t.startLoc,e[0],e[1]);else if(3===t.rank)n.gl.uniform3i(t.startLoc,e[0],e[1],e[2]);else{if(4!==t.rank)throw Error("Slicing for rank "+t.rank+" is not yet supported");n.gl.uniform4i(t.startLoc,e[0],e[1],e[2],e[3])}}},e}(),mo=function(e,t,n,r){this.variableNames=["x"];var o=n.filter((function(e,t){return-1===r.indexOf(t)}));this.outputShape=o;var i=n.length,a=Cn(n.length),s=Cn(o.length),u="";if(1===i)u="coords * strides + begin";else{var l=0;u=n.map((function(e,t){return-1===r.indexOf(t)?(l++,1===o.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(l-1)+"] * strides["+t+"] + begin["+t+"]"):"begin["+t+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+e+");\n      "+a+" strides = "+a+"("+t+");\n\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+u+"));\n      }\n    "},go=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,o=yo(t,n),i=vo(e,o,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[i].shift();return this.usedTextures[i].push(a),a}return this.numUsedTextures++,this.log(),o===An.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===An.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===An.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===An.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===An.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var o=vo(t,yo(n,r),r);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[o],a=i.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(a,1),this.log()}},e.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function yo(e,t){if(e===Tn.UPLOAD)return t?An.PACKED_2X2_FLOAT32:An.UNPACKED_FLOAT32;if(e===Tn.RENDER||null==e)return t?_e.get("WEBGL_RENDER_FLOAT32_ENABLED")?An.PACKED_2X2_FLOAT32:An.PACKED_2X2_FLOAT16:_e.get("WEBGL_RENDER_FLOAT32_ENABLED")?An.UNPACKED_FLOAT32:An.UNPACKED_FLOAT16;if(e===Tn.DOWNLOAD||e===Tn.PIXELS)return An.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function vo(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var bo=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Cn(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],o=0;o<e.length;o++)r.push("imod("+n[o]+", "+e[o]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},wo=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Cn(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},xo=function(){function e(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float NAN;\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(){var e=this;return function(t,n){null==e.startLoc&&(e.startLoc=t.getUniformLocationNoThrow(n,"NAN"),null==e.startLoc)||t.gl.uniform1f(e.startLoc,NaN)}},e}(),_o=function(e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e;var t=e.length,n=Yr("rc",t),r=Cn(t),o=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),a=1===t?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},No=ut({concat_:function(e,t){void 0===t&&(t=0),g(e.length>=1,"Pass at least one tensor to concat");var n=st(e,"tensors","concat");t=qe(t,n[0].shape)[0];var r=Ze(n.map((function(e){return e.shape})),t);if(0===w(r))return ft([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var o=n.map((function(e){return e.shape}));return function(e,t){var n=e[0].length;e.forEach((function(e,t){g(e.length===n,"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")")})),g(t>=0&&t<n,"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+".");var r=e[0];e.forEach((function(e,o){for(var i=0;i<n;i++)g(i===t||e[i]===r[i],"Error in concat"+n+"D: Shape of tensors["+o+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+".")}))}(o,t),_e.engine.runKernel((function(e){return e.concat(n,t)}),n,(function(e){var n=o.map((function(e){return e[t]}));return So(e,n,t).map((function(e){return function(){return e}}))}))}}),Eo=ut({concat1d_:function(e){return No(e,0)}}),Co=ut({concat2d_:function(e,t){return No(e,t)}}),Io=ut({concat3d_:function(e,t){return No(e,t)}}),Oo=ut({concat4d_:function(e,t){return No(e,t)}}),So=ut({split_:function(e,t,n){void 0===n&&(n=0);var r,o=at(e,"x","split");return n=qe(n,o.shape)[0],"number"==typeof t?(g(o.shape[n]%t==0,"Number of splits must evenly divide the axis."),r=Array(t).fill(o.shape[n]/t)):(g(o.shape[n]===t.reduce((function(e,t){return e+t})),"The sum of sizes must match the size of the axis dimension."),r=t),_e.engine.runKernel((function(e){return e.split(o,r,n)}),{$x:o},(function(e){return{$x:function(){return No(e,n)}}}))}});function ko(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var To=ko((function(e){!function(e,t,n){function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new function(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}(e),o=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.alea=o}(0,e)})),Ao=ko((function(e){!function(e,t,n){function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new function(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xor128=o}(0,e)})),Po=ko((function(e){!function(e,t,n){function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xorwow=o}(0,e)})),Do=ko((function(e){!function(e,t,n){function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.x&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xorshift7=o}(0,e)})),Ro=ko((function(e){!function(e,t,n){function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n=o[i]=(n^=n>>>15)^(e^=e>>>12),t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),o=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=0==(n=s[127&i]^=r+(a=a+1640531527|0))?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,s[o]=(r^=r>>>15)^(n^=n>>>12);e.w=a,e.X=s,e.i=o}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.X&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xor4096=o}(0,e)})),Mo=ko((function(e){!function(e,t,n){function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.tychei=o}(0,e)})),jo=ko((function(e){!function(t,r){var o,i=this,a=256,s=6,u="random",l=r.pow(a,s),c=r.pow(2,52),h=2*c,p=a-1;function d(e,n,d){var y=[],v=m(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(a):(e=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,g(t)]}}():e,3),y),b=new function(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=p&i+e[o%n]+(t=s[o])],s[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,s=r.S;e--;)t=s[o=p&o+1],n=n*a+s[p&(s[o]=s[i=p&i+t])+(s[i]=t)];return r.i=o,r.j=i,n})(a)}(y),w=function(){for(var e=b.g(s),t=l,n=0;e<c;)e=(e+n)*a,t*=a,n=b.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,m(g(b.S),t),(n.pass||d||function(e,t,n,o){return o&&(o.S&&f(o,b),e.state=function(){return f(b,{})}),n?(r[u]=e,t):e})(w,v,"global"in n?n.global:this==r,n.state)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",o=0;o<r.length;)t[p&o]=p&(n^=19*t[p&o])+r.charCodeAt(o++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+u]=d,m(r.random(),t),e.exports){e.exports=d;try{o=n(!function(){var e=new Error("Cannot find module 'crypto'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){}}}([],Math)}));jo.alea=To,jo.xor128=Ao,jo.xorwow=Po,jo.xorshift7=Do,jo.xor4096=Ro,jo.tychei=Mo;var Lo=jo.alea,Vo=function(){function e(e,t,n,r,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=Lo(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,i=void 0,a=void 0;do{a=(o=2*this.random()-1)*o+(i=2*this.random()-1)*i}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}();function Fo(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_;return s(this,(function(s){switch(s.label){case 0:if(n=at(e,"img","toPixels"),e instanceof ie||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return u=n.min(),l=n.max(),[4,u.data()];case 1:return c=s.sent()[0],[4,l.data()];case 2:if(h=s.sent()[0],u.dispose(),l.dispose(),"float32"===n.dtype){if(c<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+c+" - "+h+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(c<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+c+" - "+h+"].")}return[4,n.data()];case 3:for(p=s.sent(),d="float32"===n.dtype?255:1,f=new Uint8ClampedArray(i*o*4),m=0;m<o*i;++m)g=void 0,y=void 0,v=void 0,b=void 0,1===a?(g=p[m]*d,y=p[m]*d,v=p[m]*d,b=255):3===a?(g=p[3*m]*d,y=p[3*m+1]*d,v=p[3*m+2]*d,b=255):4===a&&(g=p[4*m]*d,y=p[4*m+1]*d,v=p[4*m+2]*d,b=p[4*m+3]*d),f[0+(w=4*m)]=Math.round(g),f[w+1]=Math.round(y),f[w+2]=Math.round(v),f[w+3]=Math.round(b);return null!=t&&(t.width=i,t.height=o,x=t.getContext("2d"),_=new ImageData(f,i,o),x.putImageData(_,0,0)),n!==e&&n.dispose(),[2,f]}}))}))}function zo(e,t,n){return void 0===t&&(t="float32"),new te(e,t=t||"float32",n)}function Bo(e,t){void 0===t&&(t=!1),console.log(e.toString(t))}var Uo=ut({batchToSpaceND_:function(e,t,n){var r=at(e,"x","batchToSpaceND"),o=t.reduce((function(e,t){return e*t}));return g(r.rank>=1+t.length,"input rank is "+r.rank+" but should be > than blockShape.length "+t.length),g(n.length===t.length,"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length),g(r.shape[0]%o==0,"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o),_e.engine.runKernel((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),Wo=ut({cast_:function(e,t){var n=at(e,"x","cast");return _e.engine.runKernel((function(e){return e.cast(n,t)}),{$x:n},(function(e){return{$x:function(){return e.clone()}}}))}}),$o=ut({clone_:function(e){var t=at(e,"x","clone",null);return _e.engine.runKernel((function(e){return ie.make(t.shape,{dataId:t.dataId},t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),qo=ut({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=at(e,"x","cumsum"),i=Ge([t|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=Xe(1,o.rank)[0],u=_e.engine.runKernel((function(e){return e.cumsum(a,s,n,r)}),{permutedX:a},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),Ho=ut({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=at(e,"x","depthToSpace"),o="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return g(o*t>=0,"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+"  for depthToSpace with input shape\n      "+r.shape),g(i*t>=0,"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape),g(a%(t*t)==0,"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape),_e.engine.runKernel((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),Go=ut({expandDims_:function(e,t){void 0===t&&(t=0);var n=at(e,"x","expandDims");g(t<=n.rank,"Axis must be <= rank of the tensor");var r=n.shape.slice();return t<0&&(g(-(n.rank+1)<=t,"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"),t=n.rank+t+1),r.splice(t,0,1),ai(n,r)}}),Ko=ut({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var o=zo([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return ci(Go(s,0),[n[0],1,1]);if(2===n.length)return ci(Go(Go(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return ci(Go(Go(Go(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Xo=ut({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return _e.engine.fromPixels(e,t)}}),Zo=ut({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var o=at(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?o.as2D(1,-1):o,u=_e.engine.runKernel((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===a?u.as1D():u}}),Qo=ut({oneHot_:function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=0);var o=at(e,"indices","oneHot","int32");if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);return _e.engine.runKernel((function(e){return e.oneHot(o,t,n,r)}),{$indices:o},(function(e){return{$indices:function(){return Nt(o.shape,"float32")}}}))}}),Jo=ut({pad_:function(e,t,n){void 0===n&&(n=0);var r=at(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o=t.map((function(e){return e[0]}));return _e.engine.runKernel((function(e){return e.pad(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.slice(o,r.shape)}}}))}}),Yo=ut({pad1d_:function(e,t,n){return void 0===n&&(n=0),g(2===t.length,"Invalid number of paddings. Must be length of 2."),Jo(e,[t],n)}}),ei=ut({pad2d_:function(e,t,n){return void 0===n&&(n=0),g(2===t.length&&2===t[0].length&&2===t[1].length,"Invalid number of paddings. Must be length of 2 each."),Jo(e,t,n)}}),ti=ut({pad3d_:function(e,t,n){return void 0===n&&(n=0),g(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,"Invalid number of paddings. Must be length of 2 each."),Jo(e,t,n)}}),ni=ut({pad4d_:function(e,t,n){return void 0===n&&(n=0),g(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,"Invalid number of paddings. Must be length of 2 each."),Jo(e,t,n)}}),ri=ut({rand_:function(e,t,n){var r=w(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return ie.make(e,{values:o},n)}}),oi=ut({randomNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Vo(t,n,r,!1,o),a=zo(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),ii=ut({randomUniform_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=zo(e,r),i=0;i<o.values.length;i++)o.values[i]=m(t,n);return o.toTensor()}}),ai=ut({reshape_:function(e,t){var n=at(e,"x","reshape",null);return t=O(t,n.size),g(n.size===w(t),"new shape and old shape must have the same number of elements."),_e.engine.runKernel((function(e){return e.reshape(n,t)}),{$x:n},(function(e){return{$x:function(){return e.reshape(n.shape)}}}))}}),si=ut({spaceToBatchND_:function(e,t,n){var r=at(e,"x","spaceToBatchND");return g(r.rank>=1+t.length,"input rank "+r.rank+" should be > than [blockShape] "+t.length),g(n.length===t.length,"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length),g(r.shape.reduce((function(e,r,o){return o>0&&o<=t.length?e&&(r+n[o-1][0]+n[o-1][1])%t[o-1]==0:e}),!0),"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()),_e.engine.runKernel((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),ui=ut({squeeze_:function(e,t){var n=at(e,"x","squeeze");return ai(n,S(n.shape,t).newShape)}}),li=ut({stack_:function(e,t){void 0===t&&(t=0);var n=st(e,"tensors","stack");if(g(n.length>=1,"Pass at least one tensor to tf.stack"),1===n.length)return n[0].expandDims(t);var r=n[0].shape,o=n[0].dtype;g(t<=n[0].rank,"Axis must be <= rank of the tensor"),n.forEach((function(e){y(r,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){g(o===e.dtype,"All tensors passed to stack must have matching dtypes")}));var i=n.map((function(e){return e.expandDims(t)}));return No(i,t)}}),ci=ut({tile_:function(e,t){var n=at(e,"x","tile");return g(n.rank===t.length,"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."),_e.engine.runKernel((function(e){return e.tile(n,t)}),{$x:n},(function(e){return{$x:function(){var r=Dt(n);if(1===n.rank)for(var o=0;o<t[0];++o)r=r.add(e.slice([o*n.shape[0]],[n.shape[0]]));else if(2===n.rank)for(o=0;o<t[0];++o)for(var i=0;i<t[1];++i)r=r.add(e.slice([o*n.shape[0],i*n.shape[1]],[n.shape[0],n.shape[1]]));else if(3===n.rank)for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(var a=0;a<t[2];++a)r=r.add(e.slice([o*n.shape[0],i*n.shape[1],a*n.shape[2]],[n.shape[0],n.shape[1],n.shape[2]]));else{if(4!==n.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+n.rank+" tensors yet.");for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(a=0;a<t[2];++a)for(var s=0;s<t[3];++s)r=r.add(e.slice([o*n.shape[0],i*n.shape[1],a*n.shape[2],s*n.shape[3]],[n.shape[0],n.shape[1],n.shape[2],n.shape[3]]))}return r}}}))}}),hi=ut({truncatedNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Vo(t,n,r,!0,o),a=zo(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),pi=ut({unstack_:function(e,t){void 0===t&&(t=0);for(var n,r=at(e,"x","unstack"),o=r.shape[t],i=Array(r.rank-1).fill(0),a=0,s=0;s<r.rank;s++)s!==t&&(i[a]=r.shape[s],a++);n=Array(o).fill(1);var u=Array(r.rank).fill(0),l=r.shape.slice();return n.map((function(e){l[t]=e;var n=r.slice(u,l);return u[t]+=e,n.reshape(i)}))}}),di=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,c,h,p;return s(this,(function(s){switch(s.label){case 0:return n=at(e,"x","setdiff1d"),r=at(t,"y","setdiff1d"),g(n.dtype===r.dtype,"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."),g(1===n.rank,"x should be 1D tensor, but got x ("+n.shape+")."),g(1===r.rank,"y should be 1D tensor, but got y ("+r.shape+")."),[4,n.data()];case 1:return o=s.sent(),[4,r.data()];case 2:for(i=s.sent(),a=new Set(i),u=0,h=0;h<o.length;h++)a.has(o[h])||u++;for(l=new te([u],n.dtype),c=new te([u],"int32"),h=0,p=0;h<o.length;h++)a.has(o[h])||(l.values[p]=o[h],c.values[p]=h,p++);return[2,[l.toTensor(),c.toTensor()]]}}))}))};function fi(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=zo(e,"int32"),i=zo([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]);i.values.set(a,r*e.length)}return i.toTensor()}var mi=300,gi=function(){function e(e,t){if(void 0===t&&(t=!0),this.gpgpu=e,this.delayedStorage=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.lruDataGPU=[],this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,_e.get("WEBGL_VERSION")<1)throw new Error("WebGL is not supported on this device");if(null==e){var n=c(_e.get("WEBGL_VERSION"));this.gpgpu=new Wr(n),this.canvas=n.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpuCreatedLocally=!1,this.canvas=e.gl.canvas;_e.get("WEBGL_PAGING_ENABLED")&&(this.NUM_BYTES_BEFORE_PAGING=window.screen.height*window.screen.width*window.devicePixelRatio*mi),this.textureManager=new go(this.gpgpu)}return e.prototype.register=function(e,t,n){if(this.texData.has(e))throw new Error("Data buffer is already registered");this.texData.set(e,{shape:t,dtype:n})},e.prototype.setDataMover=function(e){this.texData=new Lt(e)},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("pixels passed to tf.fromPixels() can not be null");var n=[e.height,e.width],r=[e.height,e.width,t];if(!(e instanceof HTMLVideoElement||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageData))throw new Error("pixels passed to tf.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement or ImageData, but was "+e.constructor.name);if(e instanceof HTMLVideoElement){if(null==this.fromPixels2DContext){if(!_e.get("IS_BROWSER"))throw new Error("Can't read pixels from HTMLImageElement outside the browser.");if("complete"!==document.readyState)throw new Error("The DOM is not ready yet. Please call tf.fromPixels() once the DOM is ready. One way to do that is to add an event listener for `DOMContentLoaded` on the document object");this.fromPixels2DContext=document.createElement("canvas").getContext("2d")}this.fromPixels2DContext.canvas.width=e.width,this.fromPixels2DContext.canvas.height=e.height,this.fromPixels2DContext.drawImage(e,0,0,e.width,e.height),e=this.fromPixels2DContext.canvas}var o=this.makeTensorHandle(n,"int32");this.texData.get(o.dataId).usage=Tn.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),e);var i=new Mn(r),a=this.compileAndRun(i,[o]);return this.disposeData(o.dataId),a},e.prototype.makeTensorHandle=function(e,t){var n={};return this.register(n,e,t),{dataId:n,shape:e,dtype:t}},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendWebGL.write(): values can not be null");var n=this.texData.get(e),r=n.texture,o=n.texShape,i=n.usage,a=n.isPacked;if("complex64"===n.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");null!=r&&(this.releaseTexture(e,r,o,i,a),n.texture=null,n.texShape=null),n.usage=Tn.UPLOAD,n.values=t,this.delayedStorage||this.uploadToGPU(e)},e.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,o=t.complexTensors;if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var i,a,s=null!=this.activeTimers;return s&&(i=performance.now()),a="complex64"===r?Bt(o.real.dataSync(),o.imag.dataSync()):this.getValuesFromTexture(e),s&&(this.downloadWaitMs+=performance.now()-i),this.convertAndCacheOnCPU(e,a)},e.prototype.read=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,l;return s(this,(function(s){switch(s.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.texture,o=n.texShape,null!=n.values)return[2,this.convertAndCacheOnCPU(e)];if(this.pendingRead.set(e,[]),!_e.get("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===_e.get("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return i=this.gpgpu.maybeCreateBufferFromTexture(r,o[0],o[1]),[4,this.gpgpu.createAndWaitForFence()];case 1:return s.sent(),a=i instanceof WebGLTexture?this.getValuesFromTexture(e):this.gpgpu.downloadFloat32MatrixFromBuffer(i,o[0],o[1]),u=this.convertAndCacheOnCPU(e,a),l=this.pendingRead.get(e),this.pendingRead.delete(e),l.forEach((function(e){return e(u)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)),[2,u]}}))}))},e.prototype.getValuesFromTexture=function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,o=t.texture,i=t.texShape;if(_e.get("WEBGL_DOWNLOAD_FLOAT_ENABLED")){if(this.texData.get(e).isPacked){var a=w(n.slice(0,n.length-2));return this.gpgpu.downloadMatrixFromPackedTexture(o,a,n.length>1?n[n.length-2]:1,n[n.length-1],i[0],i[1])}return this.gpgpu.downloadFloat32MatrixFromOutputTexture(o,i[0],i[1])}var s=this.makeTensorHandle(n,"float32");s.size=w(n),this.texData.get(s.dataId).usage=Tn.DOWNLOAD;var u=new Dn(n);this.compileAndRun(u,[{shape:n,dtype:r,dataId:e}],s,null,!1);var l=this.texData.get(s.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture,l.texShape[0],l.texShape[1]);return this.disposeData(s.dataId),c},e.prototype.time=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,u;return s(this,(function(s){switch(s.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),o=b(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=b(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),[4,Promise.all(o)];case 1:return a=s.sent(),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:f(a),getExtraProfileInfo:function(){return a.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return _e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},e.prototype.endTimer=function(e){return _e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=performance.now(),e)},e.prototype.getQueryTime=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){return _e.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},e.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e))if(this.pendingRead.has(e))this.pendingDisposal.add(e);else if(this.texData.has(e)){var t=this.texData.get(e),n=t.texture,r=t.complexTensors;null!=n&&this.releaseTexture(e,n,t.texShape,t.usage,t.isPacked),null!=r&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}},e.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},e.prototype.getCPUBackend=function(){return _e.get("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=_e.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=10),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&e.size<t}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.getCanvas=function(){return this.canvas},e.prototype.complex=function(e,t){var n=this.makeOutputArray(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:_e.engine.keep(e.clone()),imag:_e.engine.keep(t.clone())},n},e.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},e.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},e.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);var r=new fo(n),o=r.getCustomSetupFunc(t);return this.compileAndRun(r,[e],null,o)},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s,u){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r,o,i,a,s,u);var l=tt(e.shape,t,n,r,o,i,a,s,u),c=l[0],h=l[1],p=l[2],d=h.filter((function(e,t){return-1===p.indexOf(t)}));if(d.some((function(e){return 0===e})))return ft([],d);var f=new mo(c,r,h,p);return this.compileAndRun(f,[e])},e.prototype.reverse=function(e,t){var n=new lo(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.concat2Tensors=function(e,t,n){var r=Ze([e.shape,t.shape],n),o=e.as2D(-1,w(e.shape.slice(n))),i=t.as2D(-1,w(t.shape.slice(n))),a=new cn(o.shape,i.shape);return this.compileAndRun(a,[o,i]).reshape(r)},e.prototype.concat=function(e,t){if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];for(var n=e[0],r=1;r<e.length;++r)n=this.concat2Tensors(n,e[r],t);return n},e.prototype.neg=function(e){var t=new xo(e.shape,"return -x;");return this.compileAndRun(t,[e])},e.prototype.batchMatMul=function(e,t,n,r){var o=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],a=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===o||1===i)&&a>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===i?e:e.as3D(s,a,1),l=1===i?2:1,c=1===i?t.as3D(s,1,a):t;return this.multiply(u,c).sum(l,!0)}if(1===s){var h=e.as2D(e.shape[1],e.shape[2]),p=t.as2D(t.shape[1],t.shape[2]),d=new Zr(h.shape,p.shape,[o,i],n,r),f=this.compileAndRun(d,[h,p]);return f.reshape([1,f.shape[0],f.shape[1]])}return this.compileAndRun(new Xr(e.shape,t.shape,n,r),[e,t])},e.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),o=new rn("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new rn("return areal * bimag + aimag * breal;",e.shape,t.shape),a=[this.makeComplexComponentTensorHandle(e,n.complexTensors.real),this.makeComplexComponentTensorHandle(e,n.complexTensors.imag),this.makeComplexComponentTensorHandle(t,r.complexTensors.real),this.makeComplexComponentTensorHandle(t,r.complexTensors.imag)],s=this.compileAndRun(o,a),u=this.compileAndRun(i,a),l=this.complex(s,u);return s.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);var c=new sn("return a * b;",e.shape,t.shape),h=this.makeOutputArray(c.outputShape,e.dtype);return this.compileAndRun(c,[e,t],h)},e.prototype.batchNormalization=function(e,t,n,r,o,i){var a=[e,t,n],s=null;null!=i&&(s=i.shape,a.push(i));var u=null;if(null!=o&&(u=o.shape,a.push(o)),_e.get("WEBGL_PACK_BATCHNORMALIZATION")){var l=new tn(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,a)}var c=new en(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,a)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){var i=new Hr(e.shape,t,n,r,o);return this.compileAndRun(i,[e])},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){var s=new Gr(t.shape,r,o,i,a);return this.compileAndRun(s,[t,n,e])},e.prototype.tile=function(e,t){var n=new bo(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.pad=function(e,t,n){var r=new to(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.transpose=function(e,t){var n=new wo(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.gather=function(e,t,n){var r=new jn(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},e.prototype.batchToSpaceND=function(e,t,n){g(e.rank<=4,"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");var r=t.reduce((function(e,t){return e*t})),o=Le(e.shape,t,r),i=Ve(o.length,t.length),a=Fe(e.shape,t,r),s=ze(n,t.length),u=Be(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},e.prototype.spaceToBatchND=function(e,t,n){g(e.rank<=4,"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=Le(a.shape,t,r,!1),u=Ve(s.length,t.length,!1),l=Fe(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},e.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],i=Ye(o),a=new ro({windowSize:i,inSize:o,batchSize:r},t),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],n);return this.compileAndRun(a,[e],u),1===u.shape[1]?u:this.reduce(u,t,n)},e.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var i=Ye(o),a=new Xt({windowSize:i,inSize:o,batchSize:r},t,null==n),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],"int32"),l=[e];return null!=n&&l.push(n),this.compileAndRun(a,l,u),1===u.shape[1]?u:this.argReduce(e,t,u)},e.prototype.sum=function(e,t){He("sum",t,e.rank);var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o),a=jt(e.dtype);return this.reduce(i,"sum",a).reshape(r)},e.prototype.prod=function(e,t){var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o),a=jt(e.dtype);return this.reduce(i,"prod",a).reshape(r)},e.prototype.unsortedSegmentSum=function(e,t,n){var r=0,o=Ge([r],e.rank),i=e;null!=o&&(i=e.transpose(o),r=Xe(1,e.rank)[0]);var a=function(e,t,n){for(var r=[],o=e.length,i=0;i<o;i++)r.push(i!==t?e[i]:n);return r}(i.shape,r,n),s=w([i.shape[r]]),u=i.as2D(-1,s),l=jt(e.dtype),c=this.segOpCompute(u,"unsortedSegmentSum",t,l,n).reshape(a);return null!=o&&(c=c.transpose(Ke(o))),c},e.prototype.segOpCompute=function(e,t,n,r,o){var i=e.shape[0],a=e.shape[1],s=function(e,t){var n,r=!1;for(e<=Je?(n=e,r=!0):n=U(e,Math.floor(Math.sqrt(e)));!r;){if(n>t||n===e){r=!0;break}n=U(e,n+1)}return n}(a,o),u=new ho({windowSize:s,inSize:a,batchSize:i,numSegments:o},t),l=u.outputShape,c=this.makeOutputArray([l[0],l[1]],r);return this.compileAndRun(u,[e,n],c),c.shape[1]===o?c:(n=It(0,o).tile([a/s]),this.segOpCompute(c,t,n,r,o))},e.prototype.argMin=function(e,t){var n=[t];He("argMin",n,e.rank);var r=We(e.shape,n),o=r[0],i=w(r[1]),a=e.as2D(-1,i);return this.argReduce(a,"min").reshape(o)},e.prototype.argMax=function(e,t){var n=[t];He("argMax",n,e.rank);var r=We(e.shape,n),o=r[0],i=w(r[1]),a=e.as2D(-1,i);return this.argReduce(a,"max").reshape(o)},e.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var o=new Sn(e.shape,n,r);return this.compileAndRun(o,[e])},e.prototype.equal=function(e,t){var n=new sn("return float(a == b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.notEqual=function(e,t){var n=new sn("return float(a != b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);var n=new sn("return float(a < b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.lessEqual=function(e,t){var n=new sn("return float(a <= b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);var n=new sn("return float(a > b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.greaterEqual=function(e,t){var n=new sn("return float(a >= b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalNot=function(e){var t=new xo(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},e.prototype.logicalAnd=function(e,t){var n=new sn("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalOr=function(e,t){var n=new sn("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.select=function(e,t,n){var r=new po(e.rank,t.shape,t.rank),o=this.makeOutputArray(r.outputShape,Mt(t.dtype,n.dtype));return this.compileAndRun(r,[e,t,n],o)},e.prototype.where=function(e){je("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return fi(e.shape,t)},e.prototype.topk=function(e,t,n){return Kt(e.dataSync(),e.shape,e.dtype,t)},e.prototype.min=function(e,t){He("min",t,e.rank);var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o);return this.reduce(i,"min",i.dtype).reshape(r)},e.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=new sn("\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.mod=function(e,t){var n=new sn("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape),r=n.getCustomSetupFunc();return this.compileAndRun(n,[e,t],null,r)},e.prototype.max=function(e,t){He("max",t,e.rank);var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o);return this.reduce(i,"max",i.dtype).reshape(r)},e.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=new sn("\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.all=function(e,t){He("all",t,e.rank);var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o);return this.reduce(i,"all",i.dtype).reshape(r)},e.prototype.any=function(e,t){He("any",t,e.rank);var n=We(e.shape,t),r=n[0],o=w(n[1]),i=e.as2D(-1,o);return this.reduce(i,"any",i.dtype).reshape(r)},e.prototype.squaredDifference=function(e,t){var n=new sn("return (a - b) * (a - b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.realDivide=function(e,t){var n=new sn("if (a == b) return 1.0;\n  return a / b;",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e,t],r)},e.prototype.floorDiv=function(e,t){var n=new sn("\n  float resultSign = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  int result = ia / ib;\n  int amodb = ia - ib * result;\n\n  if (resultSign < 0.0 && amodb != 0) {\n    result -= 1;\n  }\n  return float(result);\n",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[e,t],r)},e.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,on);var n=new sn(on,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,Mt(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,o=this.texData.get(e.dataId),i=this.texData.get(t.dataId),a=[[o.complexTensors.real,i.complexTensors.real],[o.complexTensors.imag,i.complexTensors.imag]].map((function(o){var i=o[0],a=o[1],s=new sn(n,e.shape,t.shape),u=r.makeOutputArray(s.outputShape,Mt(i.dtype,a.dtype)),l=r.makeComplexComponentTensorHandle(e,i),c=r.makeComplexComponentTensorHandle(t,a);return r.compileAndRun(s,[l,c],u)})),s=a[0],u=a[1],l=this.complex(s,u);return s.dispose(),u.dispose(),l},e.prototype.makeComplexComponentTensorHandle=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},e.prototype.addN=function(e){for(var t=e[0],n=1;n<e.length;n++)t=this.add(t,e[n]);return t},e.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,an);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=new sn(an,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,Mt(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.pow=function(e,t){var n=new sn("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nreturn (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=n.getCustomSetupFunc(),o=this.makeOutputArray(n.outputShape,Mt(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],o,r)},e.prototype.ceil=function(e){var t=new xo(e.shape,"return ceil(x);");return this.compileAndRun(t,[e])},e.prototype.floor=function(e){var t=new xo(e.shape,"return floor(x);");return this.compileAndRun(t,[e])},e.prototype.sign=function(e){var t=new xo(e.shape,"\n  if (isNaN(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},e.prototype.round=function(e){var t=new xo(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},e.prototype.exp=function(e){var t=new xo(e.shape,"return exp(x);");return this.compileAndRun(t,[e])},e.prototype.expm1=function(e){var t=new xo(e.shape,"return exp(x) - 1.0;");return this.compileAndRun(t,[e])},e.prototype.log=function(e){var t=new xo(e.shape,"if (x < 0.0) return NAN;\n  return log(x);"),n=t.getCustomSetupFunc();return this.compileAndRun(t,[e],null,n)},e.prototype.log1p=function(e){var t=new xo(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},e.prototype.sqrt=function(e){var t=new xo(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},e.prototype.rsqrt=function(e){var t=new xo(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},e.prototype.square=function(e){var t=new xo(e.shape,"return x * x;");return this.compileAndRun(t,[e])},e.prototype.reciprocal=function(e){var t=new xo(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},e.prototype.relu=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n");return this.compileAndRun(t,[e])},e.prototype.elu=function(e){var t=new xo(e.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(t,[e])},e.prototype.eluDer=function(e,t){var n=new sn("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.selu=function(e){var t=new xo(e.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(t,[e])},e.prototype.int=function(e){var t=new xo(e.shape,"return float(int(x));"),n=this.makeOutputArray(t.outputShape,"int32");return this.compileAndRun(t,[e],n)},e.prototype.clip=function(e,t,n){var r=new un(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.abs=function(e){var t=new xo(e.shape,"return abs(x);");return this.compileAndRun(t,[e])},e.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new ln(e.shape),r=[this.makeComplexComponentTensorHandle(e,t.complexTensors.real),this.makeComplexComponentTensorHandle(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(e){var t=new xo(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},e.prototype.softplus=function(e){var t=new xo(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},e.prototype.sin=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])},e.prototype.cos=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])},e.prototype.tan=function(e){var t=new xo(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},e.prototype.asin=function(e){var t=new xo(e.shape,"return asin(x);");return this.compileAndRun(t,[e])},e.prototype.acos=function(e){var t=new xo(e.shape,"return acos(x);");return this.compileAndRun(t,[e])},e.prototype.atan=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])},e.prototype.atan2=function(e,t){var n=new sn("\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.sinh=function(e){var t=new xo(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},e.prototype.cosh=function(e){var t=new xo(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},e.prototype.tanh=function(e){var t=new xo(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},e.prototype.asinh=function(e){var t=new xo(e.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])},e.prototype.acosh=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));"),n=t.getCustomSetupFunc();return this.compileAndRun(t,[e],null,n)},e.prototype.atanh=function(e){var t=new xo(e.shape,"if (isNaN(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;"),n=t.getCustomSetupFunc();return this.compileAndRun(t,[e],null,n)},e.prototype.erf=function(e){var t=new xo(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(t,[e])},e.prototype.step=function(e,t){var n=new xo(e.shape,function(e){return void 0===e&&(e=0),"if (isNaN(x)) return x;\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},e.prototype.conv2dWithIm2Row=function(e,t,n){var r=n.outWidth,o=n.outHeight,i=n.filterWidth*n.filterHeight*n.inChannels,a=o*r,s=[i,a],u=e.squeeze([0]),l=t.reshape([i,-1]),c=new qr(s,u.shape,n),h=this.compileAndRun(c,[u]),p=new Zr(h.shape,l.shape,[a,n.outChannels],!0,!1);return this.compileAndRun(p,[h,l]).reshape([1,o,r,n.outChannels])},e.prototype.conv2d=function(e,t,n){if(_e.get("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new mn(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerInput=function(e,t,n){var r=new pn(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerFilter=function(e,t,n){var r=new hn(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2D=function(e,t,n){var r=new gn(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new fn(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new dn(n);return this.compileAndRun(r,[e,t])},e.prototype.maxPool=function(e,t){var n=new no(t,"max",!1),r=this.makeOutputArray(n.outputShape,e.dtype);return this.compileAndRun(n,[e],r)},e.prototype.avgPool=function(e,t){var n=new no(t,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e],r)},e.prototype.maxPoolBackprop=function(e,t,n,r){var o=new no(r,"max",!0),i=this.compileAndRun(o,[t]),a=new Kr(r),s=this.makeOutputArray(a.outputShape,t.dtype),u=this.compileAndRun(a,[e,i],s);return i.dispose(),u},e.prototype.avgPoolBackprop=function(e,t,n){var r=new Zt(n),o=this.makeOutputArray(r.outputShape,t.dtype);return this.compileAndRun(r,[e],o)},e.prototype.cast=function(e,t){return Ft(e,t,this)},e.prototype.reshape=function(e,t){return this.texData.get(e.dataId).isPacked&&!wr(e.shape,t)?this.packedReshape(e,t):zt(e,t)},e.prototype.resizeBilinear=function(e,t,n,r){var o=new ao(e.shape,t,n,r);return this.compileAndRun(o,[e])},e.prototype.resizeBilinearBackprop=function(e,t,n){var r=new io(e,t,n);return this.compileAndRun(r,[e])},e.prototype.resizeNearestNeighbor=function(e,t,n,r){var o=new uo(e.shape,t,n,r);return this.compileAndRun(o,[e])},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new so(e,t,n);return this.compileAndRun(r,[e])},e.prototype.multinomial=function(e,t,n,r){var o=t?e:lt(e),i=new Qr(o.shape[0],o.shape[1],n),a=this.makeOutputArray(i.outputShape,"int32"),s=i.getCustomSetupFunc(r);return this.compileAndRun(i,[o],a,s)},e.prototype.oneHot=function(e,t,n,r){var o=new Jr(e.size,t,n,r);return this.compileAndRun(o,[e])},e.prototype.nonMaxSuppression=function(e,t,n,r,o){return je("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),qt(e.dataSync(),t.dataSync(),n,r,o)},e.prototype.cropAndResize=function(e,t,n,r,o,i){var a=new yn(e.shape,t.shape,r,o,i);return this.compileAndRun(a,[e,t,n])},e.prototype.depthToSpace=function(e,t,n){g(t>1,"blockSize should be > 1 for depthToSpace, but was: "+t);var r=e.shape[0],o=("NHWC"===n?e.shape[1]:e.shape[2])*t,i=("NHWC"===n?e.shape[2]:e.shape[3])*t,a=("NHWC"===n?e.shape[3]:e.shape[1])/(t*t),s=new Pn("NHWC"===n?[r,o,i,a]:[r,a,o,i],t,n);return this.compileAndRun(s,[e])},e.prototype.split=function(e,t,n){return Gt(e,t,n)},e.prototype.scatterND=function(e,t,n){var r=et(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=[u/a,a],c=e.reshape([i,o]),h=t.reshape([i,a]);if(0===u)return zt(ft([]),n);var p=mt(0),d=new co(i,o,c.rank,h.rank,s,l);return this.compileAndRun(d,[h,c,p]).reshape(n)},e.prototype.sparseToDense=function(e,t,n,r){var o=et(0,e,n),i=new co(o.numUpdates,o.sliceRank,e.rank,t.rank,o.strides,[o.outputSize,1],!1);return this.compileAndRun(i,[t,e,r]).reshape(n)},e.prototype.fft=function(e){return this.fftImpl(e,!1)},e.prototype.ifft=function(e){return this.fftImpl(e,!0)},e.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Rn("return real * expR - imag * expI;",e.shape,t),o=new Rn("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorHandle(e,n.complexTensors.real),this.makeComplexComponentTensorHandle(e,n.complexTensors.imag)],a=this.compileAndRun(r,i),s=this.compileAndRun(o,i),u=this.complex(a,s).as2D(e.shape[0],e.shape[1]);return a.dispose(),s.dispose(),u},e.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Qe(e,t),i=o[0],a=o[1],s=o[2],u=o[3],l=t.reshape([a,r]),c=e.reshape([e.size/s,s]),h=new Ln(r,u,[a,s]);return this.compileAndRun(h,[c,l]).reshape(i)},e.prototype.makeOutputArray=function(e,t){return ie.make(e,{},t)},e.prototype.makePackedTensor=function(e){var t=ie.make(e,{});return this.texData.get(t.dataId).isPacked=!0,t},e.prototype.unpackTensor=function(e){var t=new _o(e.shape);return this.compileAndRun(t,[e],ie.make(t.outputShape,{}))},e.prototype.getBatchDim=function(e,t){return void 0===t&&(t=2),w(e.slice(0,e.length-t))},e.prototype.getRowsCols=function(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]},e.prototype.packedReshape=function(e,t){var n=e.reshape([this.getBatchDim(e.shape)].concat(this.getRowsCols(e.shape))),r=[this.getBatchDim(t)].concat(this.getRowsCols(t)),o=new oo(r,n.shape);return this.compileAndRun(o,[n]).reshape(t)},e.prototype.compileAndRun=function(e,t,n,r,o){var i=this;if(void 0===o&&(o=!0),null==n&&(n=e.usesPackedTextures?this.makePackedTensor(e.outputShape):this.makeOutputArray(e.outputShape,t[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=k(n.dtype,0),n;var a=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture&&(n.isPacked||!e.usesPackedTextures)&&w(t.shape)<=_e.get("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:i.readSync(t.dataId)};if(!!n.isPacked!=!!e.usesPackedTextures){var r=void 0,o=void 0;n.isPacked?(r=new _o(t.shape),o=i.compileAndRun(r,[t],ie.make(r.outputShape,{}))):(r=new eo(t.shape),o=i.compileAndRun(r,[t],i.makePackedTensor(t.shape))),n=i.texData.get(o.dataId),t=o}else if(n.isPacked&&!wr(n.shape,t.shape)){i.delayedStorage=!1;var a=t.dataSync();i.delayedStorage=!0,t=ie.make(t.shape,{values:a},t.dtype),(n=i.texData.get(t.dataId)).isPacked=!0}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var s,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},l=function(e,t,n){var r="";t.concat(n).forEach((function(e){r+=e.shape+"_"+(e.isUniform?"uniform":e.texData.texShape)}));var o=e.userCode,i=(!0===e.supportsBroadcasting).toString();return e.constructor.name+"_"+i+"_"+r+"_"+o}(e,a,u),c=this.getAndSaveBinary(l,(function(){return function(e,t,n,r){for(var o=t.userCode,i=n.map((function(e,n){return{name:t.variableNames[n],shapeInfo:{logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked}}})),a=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked},u=function(e,t,n,r,o){var i=e.map((function(e){var t=w(e.shapeInfo.logicalShape);return e.shapeInfo.isUniform?"uniform float "+e.name+(t>1?"["+t+"]":"")+";":"uniform sampler2D "+e.name+";"}));i=i.join("\n");var a,s,u=e.map((function(e){return function(e,t,n){var r=function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1)+"Flat",r=w(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform)return 1===r?"float "+n+"(int index) {return "+t+";}":"\n      float "+n+"(int index) {\n        for (int i = 0; i < "+r+"; i++) {\n          if (i == index) {\n            return "+t+"[i];\n          }\n        }\n      }\n    ";var o=e.shapeInfo.texShape,i=o[0],a=o[1];return 1===a&&1===i?"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+i+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+a+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = UVfrom1D("+i+", "+a+", index);\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);return r+=e.shapeInfo.isPacked?function e(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+o[0]+", "+o[1]+", index);\n      return texture2D("+t+", uv);\n    }\n  "}(t);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=o[0],a=o[1];if(null!=o&&x(t,o))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+i+".0);\n\n        return texture2D("+n+", uv);\n      }\n    ";var s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+s[0]+", "+s[1]+", row, col);\n      return texture2D("+n+", uv);\n    }\n  "}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0])return"\n        "+e(In(t,n.slice(1)))+"\n        vec4 "+o+"(int b, int row, int col) {\n          return "+o+"("+On(["b","row","col"],[1,2])+");\n        }\n      ";var s=a[0],u=a[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+o+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+s+", "+u+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return texture2D("+r+", uv);\n    }\n  "}(t);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],a=i[0],s=i[1],u=Math.ceil(t[3]/2),l=u*Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b2, int b, int row, int col) {\n      vec2 uv = packedUVfrom4D(\n        "+a+", "+s+", "+l*t[1]+",\n        "+l+", "+u+", b2, b, row, col);\n      return texture2D("+n+", uv);\n    }\n  "}(t);default:throw new Error("Packed "+n.length+"-D input sampling is not yet supported")}}(e):function e(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);return e.shapeInfo.isUniform?"float "+n+"() {return "+t+";}":"\n    float "+n+"() {\n      return sampleTexture("+t+", halfCR);\n    }\n  "}(t);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);return"\n    float "+n+"(int index) {\n      return "+n+"Flat(index);\n    }\n  "}(t);case 2:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(null!=i&&x(n,i))return"\n    float "+o+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+i[1]+".0, "+i[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var a=S(n),s=a.keptDims,u=a.newShape;if(u.length<n.length)return"\n      "+e(In(t,u))+"\n      float "+o+"(int row, int col) {\n        return "+o+"("+On(["row","col"],s)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+o+"(int row, int col) {\n        float index = dot(vec2(row, col), vec2("+n[1]+", 1));\n        return "+o+"Flat(round(index));\n      }\n    ";var l=i[0],c=i[1];return 1===c?"\n    float "+o+"(int row, int col) {\n      float index = dot(vec2(row, col), vec2("+n[1]+", 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===l?"\n    float "+o+"(int row, int col) {\n      float index = dot(vec2(row, col), vec2("+n[1]+", 1));\n      vec2 uv = vec2((index + 0.5) / "+c+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+o+"(int row, int col) {\n    vec2 uv = UVfrom2D("+l+", "+c+", "+n[1]+", row, col);\n    return sampleTexture("+r+", uv);\n  }\n"}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],a=n[2],s=S(n),u=s.keptDims,l=s.newShape;if(l.length<n.length)return"\n        "+e(In(t,l))+"\n        float "+o+"(int row, int col, int depth) {\n          return "+o+"("+On(["row","col","depth"],u)+");\n        }\n      ";if(t.shapeInfo.isUniform)return"\n      float "+o+"(int row, int col, int depth) {\n        float index = dot(vec3(row, col, depth),\n                          vec3("+i+", "+a+", 1));\n        return "+o+"Flat(round(index));\n      }\n    ";var c=t.shapeInfo.texShape,h=c[0],p=c[1];return p===i?"\n        float "+o+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+p+".0, "+h+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":p===a?"\n    float "+o+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+".0, "+h+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+o+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+h+", "+p+", "+i+", "+a+", row, col, depth);\n        return sampleTexture("+r+", uv);\n      }\n  "}(t);case 4:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],a=n[2]*i,s=n[1]*a,u=S(n),l=u.newShape,c=u.keptDims;if(l.length<n.length)return"\n      "+e(In(t,l))+"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        return "+o+"("+On(["row","col","depth","depth2"],c)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        float index = dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+a+", "+i+", 1));\n        return "+o+"Flat(round(index));\n      }\n    ";var h=t.shapeInfo.texShape,p=h[0],d=h[1];return d===s?"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2), vec3("+a+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":d===i?"\n      float "+o+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+p+", "+d+", "+s+", "+a+",\n          "+i+", row, col, depth, depth2);\n      return sampleTexture("+r+", uv);\n    }\n  "}(t);case 5:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[4],a=n[3]*i,s=n[2]*a,u=n[1]*s,l=S(n),c=l.newShape,h=l.keptDims;if(c.length<n.length)return"\n      "+e(In(t,c))+"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+o+"("+On(["row","col","depth","depth2","depth3"],h)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+s+", "+a+", "+i+")) +\n          depth3;\n        return "+o+"Flat(index);\n      }\n    ";var p=t.shapeInfo.texShape,d=p[0],f=p[1];return f===u?"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(\n          vec4(col, depth, depth2, depth3),\n          vec4("+s+", "+a+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+d+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":f===i?"\n      float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+", "+n[2]*n[3]+",\n            "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+d+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int row, int col, int depth, int depth2, int depth3) {\n      vec2 uv = UVfrom5D("+d+", "+f+", "+u+", "+s+",\n          "+a+", "+i+", row, col, depth, depth2, depth3);\n      return sampleTexture("+r+", uv);\n    }\n  "}(t);case 6:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[5],a=n[4]*i,s=n[3]*a,u=n[2]*s,l=n[1]*u,c=S(n),h=c.newShape,p=c.keptDims;if(h.length<n.length)return"\n      "+e(In(t,h))+"\n      float "+o+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+o+"("+On(["row","col","depth","depth2","depth3","depth4"],p)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+o+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+l+", "+u+", "+s+", "+a+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+i+", 1));\n        return "+o+"Flat(index);\n      }\n    ";var d=t.shapeInfo.texShape,f=d[0],m=d[1];return m===l?"\n      float "+o+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(\n          vec4(col, depth, depth2, depth3),\n          vec4("+u+", "+s+", "+a+", "+i+")) + depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===i?"\n      float "+o+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + depth3;\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      vec2 uv = UVfrom6D("+f+", "+m+", "+l+", "+u+",\n          "+s+", "+a+", "+i+"\n          ,row, col, depth, depth2, depth3, depth4);\n      return sampleTexture("+r+", uv);\n    }\n  "}(t);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(e),(n||x(e.shapeInfo.logicalShape,t.logicalShape))&&(r+=function(e,t,n){var r=e.name,o=r.charAt(0).toUpperCase()+r.slice(1),i="get"+o+"AtOutCoords",a=Qt(e.shapeInfo.logicalShape,t.logicalShape),s=n&&(t.logicalShape.length>e.shapeInfo.logicalShape.length||a.length>0),u=function(e){for(var t=0;t<e.length;t++)if(e[t]!==t)return!1;return!0}(a),l=e.shapeInfo.isUniform;if(s&&!u)return function(e,t,n,r){var o=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,a="int";2===i?a="ivec2":3===i?a="ivec3":4===i&&(a="ivec4");var s=Qt(e.shapeInfo.logicalShape,t.logicalShape),u=i-o;return"\n    float "+r+"() {\n      "+a+" coords = getOutputCoords();\n      "+(0===o?"":i<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords["+(e+u)+"] = 0;"})).join("\n"))+"\n      return get"+n+"("+(i<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords["+(t+u)+"]"})).join(", "))+");\n    }\n  "}(e,t,o,i);var c=w(e.shapeInfo.logicalShape),h="";s&&u&&(h="\n        int mainPart = index / "+c+";\n        index -= mainPart * "+c+";\n      ");var p=t.texShape;if(l)return 1===c?"float "+i+"() {return "+r+";}":"\n      float "+i+"() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                              vec2("+p[0]+", "+p[1]+"));\n        int index = resTexRC.x * "+p[1]+" + resTexRC.y;\n        "+h+"\n        return get"+o+"Flat(index);\n      }\n    ";var d=e.shapeInfo.texShape;return x(d,p)?"\n      float "+i+"() {\n        return sampleTexture("+r+", resultUV);\n      }\n    ":"\n    float "+i+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+p[0]+", "+p[1]+"));\n      int index = resTexRC.x * "+p[1]+" + resTexRC.y;\n      "+h+"\n      int texR = index / "+d[1]+";\n      int texC = index - texR * "+d[1]+";\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+d[1]+".0, "+d[0]+".0);\n\n      return sampleTexture("+r+", uv);\n    }\n  "}(e,t,n)),r}(e,t,r)})).join("\n"),l=t.texShape,c=Nn;return t.isPacked?(a=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===t[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return resTexRC.x * "+n[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(x(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),o=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  "}(e,t);case 4:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[3]/2),o=r*Math.ceil(e[2]/2),i=o*e[1];return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      int b2 = index / "+i+";\n      index -= b2 * "+i+";\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  "}(e,t);default:throw new Error(e.length+"-D packed output coordinate fetching is not yet supported")}}(t.logicalShape,l),s=_n):(a=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return x(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return function(e,t){var n=vn(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec3(r, c, d);\n    }\n  "}(e,t);case 4:return function(e,t){var n=vn(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=vn(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=vn(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}}(t.logicalShape,l),s=xn),o&&(c+=En),[c,wn,s,i,a,u,n].join("\n")}(i,s,o,!0===t.supportsBroadcasting,t.usesPackedTextures),l=e.createProgram(u),c={},h=0;h<t.variableNames.length;h++){var p=t.variableNames[h];c[p]=e.getUniformLocation(l,p,!1)}return{program:t,source:u,webGLProgram:l,uniformLocations:c,gpgpu:e,inShapeInfos:a,outShapeInfo:s}}(i.gpgpu,e,a,u)})),h=null!=this.activeTimers;if(h&&(s=this.startTimer()),function(e,t,n,r){$r(e.inShapeInfos,t),$r([e.outShapeInfo],[n]);var o=n.texData.texture,i=n.texData.texShape,a=e.gpgpu;n.texData.isPacked?a.setOutputPackedMatrixTexture(o,i[0],i[1]):a.setOutputMatrixTexture(o,i[0],i[1]),a.setProgram(e.webGLProgram),t.forEach((function(t,n){var r=e.uniformLocations[e.program.variableNames[n]];if(null!=r){if(t.isUniform){if(1===w(t.shape))a.gl.uniform1f(r,t.uniformValues[0]);else{var o=t.uniformValues;o instanceof Float32Array||(o=new Float32Array(o)),a.gl.uniform1fv(r,o)}return}a.setInputMatrixTexture(t.texData.texture,r,n)}})),null!=r&&r(a,e.webGLProgram),a.executeProgram()}(c,a,u,r),_e.get("WEBGL_PAGING_ENABLED")&&o&&this.numBytesInGPU>this.NUM_BYTES_BEFORE_PAGING)for(var p=this.numBytesInGPU-this.NUM_BYTES_BEFORE_PAGING;p>0&&this.lruDataGPU.length>0;){var d=this.lruDataGPU.shift(),f=this.texData.get(d);p-=this.computeBytes(f.shape,f.dtype),this.read(d)}return h&&(s=this.endTimer(s),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(s)})),_e.get("WEBGL_LAZILY_UNPACK")||!this.texData.get(n.dataId).isPacked||e.isPackShader?n:this.unpackTensor(n)},e.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){if(!this.disposed){for(var e in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},e.prototype.floatPrecision=function(){var e=this;return Ae((function(){return e.abs(mt(1e-8)).get()>0?32:16}))},e.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.values,i=n.usage,a=n.isPacked;if(null==n.texture){var s,u=null!=this.activeTimers;u&&(s=performance.now());var l=vr(r,a);n.texShape=l;var c=this.acquireTexture(e,l,i,a);if(n.texture=c,null!=o){if(a){var h=this.getBatchDim(r),p=1,d=1;r.length&&(p=(t=this.getRowsCols(r))[0],d=t[1]),this.gpgpu.uploadMatrixToPackedTexture(c,h,p,d,l[0],l[1],yi(o))}else this.gpgpu.uploadMatrixToTexture(c,l[0],l[1],yi(o));n.values=null,u&&(this.uploadWaitMs+=performance.now()-s)}}else _e.get("WEBGL_PAGING_ENABLED")&&this.lruDataGPU.indexOf(e)>=0&&(this.lruDataGPU.splice(this.lruDataGPU.indexOf(e),1),this.lruDataGPU.push(e))},e.prototype.convertAndCacheOnCPU=function(e,t){var n=this.delayedStorage,r=this.texData.get(e),o=r.texture,i=r.dtype;return n&&null!=o&&(this.releaseTexture(e,o,r.texShape,r.usage,r.isPacked),r.texture=null,r.texShape=null),r.usage=Tn.UPLOAD,null!=t&&(r.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,i)),r.values},e.prototype.releaseTexture=function(e,t,n,r,o){var i=this.texData.get(e),a=i.shape,s=i.dtype;if(_e.get("WEBGL_PAGING_ENABLED")){var u=this.lruDataGPU.indexOf(e);u>=0&&this.lruDataGPU.splice(u,1)}this.numBytesInGPU-=this.computeBytes(a,s),this.textureManager.releaseTexture(t,n,r,o)},e.prototype.acquireTexture=function(e,t,n,r){var o=this.texData.get(e),i=o.shape,a=o.dtype;return _e.get("WEBGL_PAGING_ENABLED")&&this.lruDataGPU.push(e),this.numBytesInGPU+=this.computeBytes(i,a),this.textureManager.acquireTexture(t,n,r)},e.prototype.computeBytes=function(e,t){return w(e)*M(t)},e}();function yi(e){return e instanceof Float32Array?e:new Float32Array(e)}_e.get("IS_BROWSER")&&_e.registerBackend("webgl",(function(){return new gi}),2,oe);var vi=ut({abs_:function(e){var t=at(e,"x","abs");return"complex64"===t.dtype?_e.engine.runKernel((function(e){return e.complexAbs(t)}),{$x:t}):_e.engine.runKernel((function(e){return e.abs(t)}),{$x:t},(function(e){return{$x:function(){return e.mulStrict(t.toFloat().step(-1))}}}))}}),bi=ut({acos_:function(e){var t=at(e,"x","acos");return _e.engine.runKernel((function(e){return e.acos(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(mt(1).sub(t.toFloat().square()).sqrt()).neg()}}}))}}),wi=ut({acosh_:function(e){var t=at(e,"x","acosh");return _e.engine.runKernel((function(e){return e.acosh(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(t.toFloat().square().sub(1).sqrt())}}}))}}),xi=ut({asin_:function(e){var t=at(e,"x","asin");return _e.engine.runKernel((function(e){return e.asin(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(mt(1).sub(t.toFloat().square()).sqrt())}}}))}}),_i=ut({asinh_:function(e){var t=at(e,"x","asinh");return _e.engine.runKernel((function(e){return e.asinh(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(mt(1).add(t.toFloat().square()).sqrt())}}}))}}),Ni=ut({atan_:function(e){var t=at(e,"x","atan");return _e.engine.runKernel((function(e){return e.atan(t)}),{$x:t},(function(e){return{$x:function(){return e.div(t.toFloat().square().add(1))}}}))}}),Ei=ut({atanh_:function(e){var t=at(e,"x","atanh");return _e.engine.runKernel((function(e){return e.atanh(t)}),{$x:t},(function(e){return{$x:function(){return e.div(mt(1).sub(t.toFloat().square()))}}}))}}),Ci=ut({ceil_:function(e){var t=at(e,"x","ceil");return _e.engine.runKernel((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return Dt(e)}}}))}}),Ii=ut({clipByValue_:function(e,t,n){var r=at(e,"x","clipByValue");return g(t<=n,"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."),_e.engine.runKernel((function(e){return e.clip(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.where(r.greaterEqual(t).logicalAnd(r.lessEqual(n)),Dt(e))}}}))}}),Oi=ut({cos_:function(e){var t=at(e,"x","cos");return _e.engine.runKernel((function(e){return e.cos(t)}),{$x:t},(function(e){return{$x:function(){return t.toFloat().sin().neg().mulStrict(e)}}}))}}),Si=ut({cosh_:function(e){var t=at(e,"x","cosh");return _e.engine.runKernel((function(e){return e.cosh(t)}),{$x:t},(function(e){return{$x:function(){return t.toFloat().sinh().mulStrict(e)}}}))}}),ki=ut({erf_:function(e){var t=at(e,"x","erf");return g("int32"===t.dtype||"float32"===t.dtype,"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=t.toFloat()),_e.engine.runKernel((function(e){return e.erf(t)}),{$x:t},(function(e){return{$x:function(){return e.mul(t.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Ti=ut({exp_:function(e){var t=at(e,"x","exp");return _e.engine.runKernel((function(e,n){return n(e.exp(t))}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mulStrict(n)}}}))}}),Ai=ut({expm1_:function(e){var t=at(e,"x","expm1");return _e.engine.runKernel((function(e){return e.expm1(t)}),{$x:t},(function(e){return{$x:function(){return e.mulStrict(t.exp())}}}))}}),Pi=ut({floor_:function(e){var t=at(e,"x","floor");return _e.engine.runKernel((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return Dt(e)}}}))}}),Di=ut({log_:function(e){var t=at(e,"x","log");return _e.engine.runKernel((function(e){return e.log(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(t.toFloat())}}}))}}),Ri=ut({log1p_:function(e){var t=at(e,"x","log1p");return _e.engine.runKernel((function(e){return e.log1p(t)}),{$x:t},(function(e){return{$x:function(){return e.div(t.add(1))}}}))}}),Mi=ut({logSigmoid_:function(e){var t=at(e,"x","logSigmoid");return _e.engine.runKernel((function(e){return e.softplus(t.neg()).neg()}),{$x:t},(function(e){return{$x:function(){return e.mulStrict(t.neg().sigmoid())}}}))}}),ji=ut({neg_:function(e){var t=at(e,"x","neg");return _e.engine.runKernel((function(e){return e.neg(t)}),{$x:t},(function(e){return{$x:function(){return e.neg()}}}))}}),Li=ut({reciprocal_:function(e){var t=at(e,"x","reciprocal");return _e.engine.runKernel((function(e){return e.reciprocal(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(t.square().neg())}}}))}}),Vi=ut({round_:function(e){var t=at(e,"x","round");return _e.engine.runKernel((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return Dt(e)}}}))}}),Fi=ut({rsqrt_:function(e){var t=at(e,"x","rsqrt");return _e.engine.runKernel((function(e){return e.rsqrt(t)}),{$x:t},(function(e){return{$x:function(){return e.div(t.pow(1.5).mul(2)).neg()}}}))}}),zi=ut({sigmoid_:function(e){var t=at(e,"x","sigmoid");return _e.engine.runKernel((function(e,n){return n(e.sigmoid(t))}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.mul(mt(1).sub(n)))}}}))}}),Bi=ut({sign_:function(e){var t=at(e,"x","sign");return _e.engine.runKernel((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return Dt(e)}}}))}}),Ui=ut({sin_:function(e){var t=at(e,"x","sin");return _e.engine.runKernel((function(e){return e.sin(t)}),{$x:t},(function(e){return{$x:function(){return t.toFloat().cos().mulStrict(e)}}}))}}),Wi=ut({sinh_:function(e){var t=at(e,"x","sinh");return _e.engine.runKernel((function(e){return e.sinh(t)}),{$x:t},(function(e){return{$x:function(){return t.toFloat().cosh().mulStrict(e)}}}))}}),$i=ut({softplus_:function(e){var t=at(e,"x","softplus");return _e.engine.runKernel((function(e){return e.softplus(t)}),{$x:t},(function(e){return{$x:function(){return e.mulStrict(t.sigmoid())}}}))}}),qi=ut({sqrt_:function(e){var t=at(e,"x","sqrt");return _e.engine.runKernel((function(e){return e.sqrt(t)}),{$x:t},(function(e){return{$x:function(){return e.div(t.toFloat().sqrt().mul(2))}}}))}}),Hi=ut({square_:function(e){var t=at(e,"x","square");return _e.engine.runKernel((function(e){return e.square(t)}),{$x:t},(function(e){return{$x:function(){return e.mul(t.toFloat().mul(2))}}}))}}),Gi=ut({step_:function(e,t){void 0===t&&(t=0);var n=at(e,"x","step");return _e.engine.runKernel((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return Dt(e)}}}))}}),Ki=ut({tan_:function(e){var t=at(e,"x","tan");return _e.engine.runKernel((function(e){return e.tan(t)}),{$x:t},(function(e){return{$x:function(){return e.divStrict(t.cos().square())}}}))}}),Xi=ut({tanh_:function(e){var t=at(e,"x","tanh");return _e.engine.runKernel((function(e,n){return n(e.tanh(t))}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return mt(1).sub(n.square()).mulStrict(e)}}}))}});function Zi(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var Qi=ut({batchNormalization2d_:function(e,t,n,r,o,i){void 0===r&&(r=.001);var a,s,u=at(e,"x","batchNormalization"),l=at(t,"mean","batchNormalization"),c=at(n,"variance","batchNormalization");return null!=o&&(a=at(o,"scale","batchNormalization")),null!=i&&(s=at(i,"offset","batchNormalization")),g(2===u.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+u.rank+"."),g(2===l.rank||1===l.rank,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."),g(2===c.rank||1===c.rank,"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."),null!=a&&g(2===a.rank||1===a.rank,"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."),null!=s&&g(2===s.rank||1===s.rank,"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."),ea(u,l,c,r,a,s)}}),Ji=ut({batchNormalization3d_:function(e,t,n,r,o,i){void 0===r&&(r=.001);var a,s,u=at(e,"x","batchNormalization"),l=at(t,"mean","batchNormalization"),c=at(n,"variance","batchNormalization");return null!=o&&(a=at(o,"scale","batchNormalization")),null!=i&&(s=at(i,"offset","batchNormalization")),g(3===u.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+u.rank+"."),g(3===l.rank||1===l.rank,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."),g(3===c.rank||1===c.rank,"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."),null!=a&&g(3===a.rank||1===a.rank,"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."),null!=s&&g(3===s.rank||1===s.rank,"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."),ea(u,l,c,r,a,s)}}),Yi=ut({batchNormalization4d_:function(e,t,n,r,o,i){void 0===r&&(r=.001);var a,s,u=at(e,"x","batchNormalization"),l=at(t,"mean","batchNormalization"),c=at(n,"variance","batchNormalization");return null!=o&&(a=at(o,"scale","batchNormalization")),null!=i&&(s=at(i,"offset","batchNormalization")),g(4===u.rank,"Error in batchNormalization4D: x must be rank 4 but got rank "+u.rank+"."),g(4===l.rank||1===l.rank,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."),g(4===c.rank||1===c.rank,"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."),null!=a&&g(4===a.rank||1===a.rank,"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."),null!=s&&g(4===s.rank||1===s.rank,"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."),ea(u,l,c,r,a,s)}}),ea=ut({batchNormalization_:function(e,t,n,r,o,i){void 0===r&&(r=.001);var a,s,u,l=at(e,"x","batchNormalization"),c=at(t,"mean","batchNormalization"),h=at(n,"variance","batchNormalization");return null!=o&&(a=at(o,"scale","batchNormalization")),null!=i&&(s=at(i,"offset","batchNormalization")),g(c.rank===h.rank,"Batch normalization gradient requires mean and variance to have equal ranks."),g(null==s||c.rank===s.rank,"Batch normalization gradient requires mean and offset to have equal ranks."),g(null==a||c.rank===a.rank,"Batch normalization gradient requires mean and scale to have equal ranks."),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l,_e.engine.runKernel((function(e){return e.batchNormalization(u,Zi(c),Zi(h),r,Zi(a),Zi(s))}),{$x:l,$mean:c,$variance:h,$scale:a,$offset:s},(function(e){var t=null==a?mt(1):a,n=Jt(c.shape,u.shape),o=[];if(1===c.rank){for(var i=0;i<u.shape.length-1;++i)o.push(u.shape[i]);o.push(1)}var s=l.sub(c),p=e.mul(t),d=Fi(h.add(mt(r))),f=d.mul(d).mul(d).mul(mt(-.5));return{$x:function(){return 1===c.rank?e.mul(ci(d.as4D(1,1,1,c.shape[0]),o)).mul(t).reshape(l.shape):e.mul(d).mul(t).reshape(l.shape)},$mean:function(){var e=d.mul(mt(-1)).mul(p);return 1===c.rank&&(e=e.sum(n)),e.reshape(c.shape)},$variance:function(){var e=f.mul(s).mul(p);return 1===c.rank&&(e=e.sum(n)),e.reshape(c.shape)},$scale:function(){var t=s.mul(d),r=e.mul(t);return 1===c.rank&&(r=r.sum(n)),r.reshape(c.shape)},$offset:function(){var t=e;return 1===c.rank&&(t=t.sum(n)),t.reshape(c.shape)}}})).reshape(l.shape)}});function ta(e,t,n,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=ra(t),l=u[0],c=u[1];if("channelsLast"===a)s=[l,c,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return na(e,s,n,r,o,i,!1,a)}function na(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],p=u[3];if("channelsLast"===s)l=e[0],c=e[1],h=e[2],p=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);l=e[0],p=e[1],c=e[2],h=e[3]}var d,f=t[0],m=t[1],y=t[3],v=ra(n),b=v[0],w=v[1],x=ra(r),N=x[0],E=x[1],C=oa(f,N),I=oa(m,E),O=function(e,t,n,r,o,i,a,s){var u,l,c;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,o,i){null==o&&(o=function(e,t,n,r){void 0===r&&(r=1);var o=oa(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}(e,t,r));var a=e[1],s=ia((e[0]-t+2*o)/r+1,i);g(_(s),"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters");var u=ia((a-t+2*o)/r+1,i);return g(_(u),"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"),[s,u,1]}([t,n,1],i,0,r,e,s);l=h[0],c=h[1]}else if("same"===e){var p=((l=Math.ceil(t/r))-1)*r+i-t,d=((c=Math.ceil(n/o))-1)*o+a-n,f=Math.floor(p/2),m=p-f,y=Math.floor(d/2);u={top:f,bottom:m,left:y,right:d-y,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),c=Math.ceil((n-a+1)/o)}return{padInfo:u,outHeight:l,outWidth:c}}(o,c,h,b,w,C,I,i),S=O.outHeight,k=O.outWidth,T=a?y*p:y;return"channelsFirst"===s?d=[l,T,S,k]:"channelsLast"===s&&(d=[l,S,k,T]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:h,inChannels:p,outHeight:S,outWidth:k,outChannels:T,padInfo:O.padInfo,strideHeight:b,strideWidth:w,filterHeight:f,filterWidth:m,effectiveFilterHeight:C,effectiveFilterWidth:I,dilationHeight:N,dilationWidth:E,inShape:e,outShape:d,filterShape:t}}function ra(e){return"number"==typeof e?[e,e]:e}function oa(e,t){return t<=1?e:e+(e-1)*(t-1)}function ia(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function aa(e){var t=ra(e);return 1===t[0]&&1===t[1]}function sa(e,t){return aa(e)||aa(t)}var ua=ut({matMul_:function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var o=at(e,"a","matMul"),i=at(t,"b","matMul"),a=n?o.shape[o.rank-2]:o.shape[o.rank-1],s=r?i.shape[i.rank-1]:i.shape[i.rank-2],u=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?i.shape[i.rank-2]:i.shape[i.rank-1],c=o.shape.slice(0,-2),h=i.shape.slice(0,-2),p=w(c),d=w(h);g(o.rank>=2&&i.rank>=2&&o.rank===i.rank,"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+i.rank+"."),g(x(c,h),"Error in matMul: outer dimensions ("+c+") and ("+h+") of Tensors with shapes "+o.shape+" and "+i.shape+" must match."),g(a===s,"Error in matMul: inner shapes ("+a+") and ("+s+") of Tensors with shapes "+o.shape+" and "+i.shape+" and transposeA="+n+" and transposeB="+r+" must match.");var f=o.shape.slice(0,-2).concat([u,l]),m=n?o.as3D(p,a,u):o.as3D(p,u,a),y=r?i.as3D(d,l,s):i.as3D(d,s,l);return _e.engine.runKernel((function(e){return e.batchMatMul(m,y,n,r)}),{$a:m,$b:y},(function(e){return n||r?!n&&r?{$a:function(){return e.matMul(y.toFloat(),!1,!1)},$b:function(){return e.matMul(m.toFloat(),!0,!1)}}:n&&!r?{$a:function(){return y.toFloat().matMul(e,!1,!0)},$b:function(){return m.toFloat().matMul(e,!1,!1)}}:{$a:function(){return y.toFloat().matMul(e,!0,!0)},$b:function(){return e.matMul(m.toFloat(),!0,!0)}}:{$a:function(){return e.matMul(y.toFloat(),!1,!0)},$b:function(){return m.toFloat().matMul(e,!0,!1)}}})).reshape(f)}}),la=ut({dot_:function(e,t){var n=at(e,"t1","dot"),r=at(t,"t2","dot");g(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+".");var o=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return g(o===i,"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ca=ut({outerProduct_:function(e,t){var n=at(e,"v1","outerProduct"),r=at(t,"v2","outerProduct");return g(1===n.rank&&1===r.rank,"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."),n.as2D(-1,1).matMul(r.as2D(1,-1))}});function ha(e,t,n,r,o,i){g(e.length===t.rank,"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match");var a=e,s=t,u=!1;3===t.rank&&(u=!0,s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),a=[1,e[0],e[1],e[2]]);var l=a[3],c=s.shape[3];g(4===a.length,"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."),g(4===s.rank,"Error in conv2dDerInput: dy must be rank 4, but got rank "+s.rank),g(4===n.rank,"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank),g(l===n.shape[2],"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."),g(c===n.shape[3],"Error in conv2dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[3]+"."),null!=i&&g(_(o),"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+".");var h=na(a,n.shape,r,1,o,i),p=_e.engine.runKernel((function(e){return e.conv2dDerInput(s,n,h)}),{dy4D:s,filter:n},(function(e){return{dy4D:function(){return fa(e,n,r,o,"NHWC",1,i)},filter:function(){return ma(e,s,n.shape,r,o,i)}}}));return u?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function pa(e,t,n,r,o,i){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=t;3===s.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),g(4===a.rank,"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."),g(4===s.rank,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+s.shape+"."),g(4===n.length,"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."),g(a.shape[3]===n[2],"Error in conv2dDerFilter: depth of input "+a.shape[3]+") must match input depth in filter ("+n[2]+"."),g(s.shape[3]===n[3],"Error in conv2dDerFilter: depth of dy ("+s.shape[3]+") must match output depth for filter ("+n[3]+")."),null!=i&&g(_(o),"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+".");var u=na(a.shape,n,r,1,o,i);return _e.engine.runKernel((function(e){return e.conv2dDerFilter(a,s,u)}),{x4D:a,dy4D:s})}var da=ut({conv1d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=at(e,"x","conv1d"),u=at(t,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),g(3===l.rank,"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."),g(3===u.rank,"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."),null!=a&&g(_(r),"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."),g(l.shape[2]===u.shape[1],"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."),g(sa(n,i),"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"),g("NWC"===o,"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported.");var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),d=fa(p,h,[1,n],r,"NHWC",[1,i],a);return c?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),fa=ut({conv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=at(e,"x","conv2d"),u=at(t,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),g(4===l.rank,"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."),g(4===u.rank,"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."),null!=a&&g(_(r),"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."),g(l.shape[3]===u.shape[2],"Error in conv2d: depth of input ("+l.shape[3]+") must match input depth for filter "+u.shape[2]+"."),g(sa(n,i),"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"),g("NHWC"===o,"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported.");var h,p=na(l.shape,u.shape,n,i,r,a);if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)h=_e.engine.runKernel((function(e){return e.conv2d(l,u,p)}),{x:l,$filter:u},(function(e){return g(aa(i),"Error in gradient of conv2D: dilation rates greater than 1 are notyet supported in gradients. Got dilations '"+i+"'"),{x:function(){return ha(l.shape,e,u,n,r)},$filter:function(){return pa(l,e,u.shape,n,r)}}}));else{var d=l.reshape([-1,p.inChannels]),f=u.reshape([p.inChannels,p.outChannels]);h=ua(d,f).reshape(p.outShape)}return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),ma=ut({conv2dDerFilter_:pa}),ga=ut({depthwiseConv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=at(e,"x","depthwiseConv2d"),u=at(t,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),g(4===l.rank,"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."),g(4===u.rank,"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."),g(l.shape[3]===u.shape[2],"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."),null==i&&(i=[1,1]),g(sa(n,i),"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"),null!=a&&g(_(r),"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+".");var h=na(l.shape,u.shape,n,i,r,a,!0),p=_e.engine.runKernel((function(e){return e.depthwiseConv2D(l,u,h)}),{x:l,$filter:u},(function(e){return g(aa(i),"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"),{x:function(){return function(e,t,n,r){var o=t,i=!1;3===t.rank&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=_e.engine.runKernel((function(e){return e.depthwiseConv2DDerInput(o,n,r)}),{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}(0,e,u,h)},$filter:function(){return function(e,t,n,r){var o=e;3===e.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),_e.engine.runKernel((function(e){return e.depthwiseConv2DDerFilter(o,i,r)}),{x4D:o,dy4D:i})}(l,e,0,h)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),ya=ut({separableConv2d_:function(e,t,n,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=at(e,"x","separableConv2d"),u=at(t,"depthwiseFilter","separableConv2d"),l=at(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");g(4===c.rank,"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."),g(4===u.rank,"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."),g(4===l.rank,"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."),g(1===l.shape[0],"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."),g(1===l.shape[1],"Error in separableConv2d: the second dimension of pointwise filter  must be 1, but got "+l.shape[1]+".");var p=u.shape[2],d=u.shape[3];g(l.shape[2]===p*d,"Error in separableConv2d: the third dimension of pointwise filter must be "+p*d+", but got "+l.shape[2]+".");var f=ga(c,u,r,o,a,i),m=fa(f,l,1,"valid",a);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),va=ut({conv2dTranspose_:function(e,t,n,r,o,i){return ha(n,at(e,"x","conv2dTranspose"),at(t,"filter","conv2dTranspose"),r,o,i)}}),ba=ut({reverse_:function(e,t){var n=at(e,"x","reverse");if(0===n.rank)return n.clone();var r=qe(t,n.shape);return _e.engine.runKernel((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),wa=ut({reverse1d_:function(e){var t=at(e,"x","reverse");return g(1===t.rank,"Error in reverse1D: x must be rank 1 but got\n             rank "+t.rank+"."),ba(t,0)}}),xa=ut({reverse2d_:function(e,t){var n=at(e,"x","reverse");return g(2===n.rank,"Error in reverse2D: x must be rank 2 but got\n             rank "+n.rank+"."),ba(n,t)}}),_a=ut({reverse3d_:function(e,t){var n=at(e,"x","reverse");return g(3===n.rank,"Error in reverse3D: x must be rank 3 but got\n             rank "+n.rank+"."),ba(n,t)}}),Na=ut({reverse4d_:function(e,t){var n=at(e,"x","reverse");return g(4===n.rank,"Error in reverse4D: x must be rank 4 but got\n             rank "+n.rank+"."),ba(n,t)}});function Ea(e,t,n,r,o,i){var a=at(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),g(4===s.rank,"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."),g(sa(n,r),"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"),null!=i&&g(_(o),"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+".");var l=ta(s.shape,t,n,r,o,i),c=_e.engine.runKernel((function(e,t){return t(e.maxPool(s,l))}),{x:s},(function(e,i){var a=i[0];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=at(e,"dy","maxPoolBackprop"),l=at(t,"input","maxPoolBackprop"),c=at(n,"output","maxPoolBackprop");g(l.rank===u.rank,"Rank of input ("+l.rank+") does not match rank of dy ("+u.rank+")"),null==i&&(i=[1,1]),g(sa(o,i),"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"),g(4===u.rank,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."),g(4===l.rank,"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+".");var h=ta(l.shape,r,o,i,a,void 0);return _e.engine.runKernel((function(e){return e.maxPoolBackprop(u,l,c,h)}),{$dy:u,$input:l})}(e,s,a,t,n,r,o)}}}));return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function Ca(e,t,n,r,o,i){var a=at(e,"x","avgPool","float32");null==r&&(r=[1,1]),g(sa(n,r),"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'");var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),g(4===s.rank,"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."),null!=i&&g(_(o),"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+".");var l=ta(s.shape,t,n,r,o),c=_e.engine.runKernel((function(e){return e.avgPool(s,l)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,o,i){var a=at(e,"dy","avgPoolBackprop"),s=at(t,"input","avgPoolBackprop");g(s.rank===a.rank,"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"),null==o&&(o=[1,1]),g(sa(r,o),"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'");var u=s,l=a,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),g(4===l.rank,"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."),g(4===u.rank,"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+".");var h=ta(u.shape,n,r,o,i),p=_e.engine.runKernel((function(e){return e.avgPoolBackprop(l,u,h)}),{dy4D:l,input4D:u});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}(e,s,t,n,r,o)}}}));return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Ia=ut({maxPool_:function(e,t,n,r,o){return Ea(e,t,n,1,r,o)}}),Oa=ut({avgPool_:function(e,t,n,r,o){return Ca(e,t,n,1,r,o)}}),Sa=ut({pool_:function(e,t,n,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=at(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),g(sa(i,o),"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'");var l,c=ta(s.shape,t,i,o,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),o=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],o[t]]}))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var p=1===h[0]&&1===h[1],d=function(e,t,n){var r=n.map((function(e){return e[0]})),o=n.map((function(e){return e[1]})),i=e.concat(r,o),a=t.map((function(e,t){return(e-i[t]%e)%e})),s=o.map((function(e,t){return e+a[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,a[t]]}))]}([c.inHeight,c.inWidth],h,l),f=d[1],m=p?r:"valid",y=p?s:si(s,h,d[0]),v=("avg"===n?function(){return Ca(y,t,i,1,m)}:function(){return Ea(y,t,i,1,m)})(),b=p?v:Uo(v,h,f);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),ka=ut({slice_:function(e,t,n){var r,o,i=at(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice(),o=(o=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(g(-1===e,"Bad value in size"),i.shape[t]-r[t])})),function(e,t,n){g(e.rank===t.length,"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."),g(e.rank===n.length,"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+").");for(var r=0;r<e.rank;++r)g(t[r]+n[r]<=e.shape[r],"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")")}(i,r,o);var a=i.shape;return _e.engine.runKernel((function(e){return e.slice(i,r,o)}),{$x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],a[n]-r[n]-o[n]]);return{$x:function(){return e.pad(t)}}}))}}),Ta=ut({slice1d_:function(e,t,n){var r=at(e,"x","slice1d");return g(1===r.rank,"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"),ka(r,[t],[n])}}),Aa=ut({slice2d_:function(e,t,n){var r=at(e,"x","slice2d");return g(2===r.rank,"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"),ka(r,t,n)}}),Pa=ut({slice3d_:function(e,t,n){var r=at(e,"x","slice3d");return g(3===r.rank,"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"),ka(r,t,n)}}),Da=ut({slice4d_:function(e,t,n){var r=at(e,"x","slice4d");return g(4===r.rank,"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"),ka(r,t,n)}});function Ra(e,t,n,r,o){var i=t[0];return i.rank<n.rank&&(i=i.reshape($e(i.shape,r))),e.rank<n.rank&&(e=e.reshape($e(e.shape,r))),{$x:function(){var t=e.mul(n.equal(i).cast(e.dtype));return null==o?t:t.transpose(o)}}}var Ma=ut({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","all","bool"),o=qe(t,r.shape),i=o,a=Ge(i,r.rank);null!=a&&(r=r.transpose(a),i=Xe(i.length,r.rank));var s=_e.engine.runKernel((function(e){return e.all(r,i)}),{$x:r});if(n){var u=$e(s.shape,o);return s.reshape(u)}return s}}),ja=ut({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","any","bool"),o=qe(t,r.shape),i=o,a=Ge(i,r.rank);null!=a&&(r=r.transpose(a),i=Xe(i.length,r.rank));var s=_e.engine.runKernel((function(e){return e.any(r,i)}),{$x:r});if(n){var u=$e(s.shape,o);return s.reshape(u)}return s}}),La=ut({argMax_:function(e,t){void 0===t&&(t=0);var n=at(e,"x","argMax");null==t&&(t=0);var r=qe(t,n.shape),o=Ge(r,n.rank);return null!=o&&(n=n.transpose(o),r=Xe(r.length,n.rank)),_e.engine.runKernel((function(e){return e.argMax(n,r[0])}),{$x:n},(function(e){return{$x:function(){return Dt(n)}}}))}}),Va=ut({argMin_:function(e,t){void 0===t&&(t=0);var n=at(e,"x","argMin");null==t&&(t=0);var r=qe(t,n.shape),o=Ge(r,n.rank);return null!=o&&(n=n.transpose(o),r=Xe(r.length,n.rank)),_e.engine.runKernel((function(e){return e.argMin(n,r[0])}),{$x:n},(function(e){return{$x:function(){return Dt(n)}}}))}}),Fa=ut({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","logSumExp"),o=qe(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=$e(s.shape,o);return s.reshape(u)}return s}}),za=ut({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","max"),o=r,i=qe(t,r.shape),a=i,s=Ge(a,r.rank);null!=s&&(r=r.transpose(s),a=Xe(a.length,r.rank));var u=_e.engine.runKernel((function(e,t){return t(e.max(r,a))}),{$x:r},(function(e,t){return Ra(e,t,o,i,s)}));if(n){var l=$e(u.shape,i);u=u.reshape(l)}return u}}),Ba=ut({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","mean"),o=qe(t,r.shape),i=w(We(r.shape,o)[1]);return ke((function(e){var r=mt(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(_t(e.shape,"float32")).div(r)}}}))(r)}}),Ua=ut({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","min"),o=r,i=qe(t,r.shape),a=i,s=Ge(a,r.rank);null!=s&&(r=r.transpose(s),a=Xe(a.length,r.rank));var u=_e.engine.runKernel((function(e,t){return t(e.min(r,a))}),{$x:r},(function(e,t){return Ra(e,t,o,i,s)}));if(n){var l=$e(u.shape,i);u=u.reshape(l)}return u}}),Wa=ut({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=qe(t,(e=at(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;return n||(i=$e(o.shape,r)),{mean:o,variance:e.toFloat().sub(o.reshape(i)).square().mean(r,n)}}}),$a=ut({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=qe(t,r.shape);return ke((function(e){var t=Ge(o,e.rank),r=o,i=e;null!=t&&(i=e.transpose(t),r=Xe(r.length,e.rank));var a=_e.engine.runKernel((function(e){return e.sum(i,r)}),{permutedX:i});if(n){var s=$e(a.shape,o);a=a.reshape(s)}return{value:a,gradFunc:function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(_t(e.shape,"float32"))}}}))(r)}}),qa=ut({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=at(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=qe(t,r.shape),i=Ge(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=Xe(a.length,r.rank));var u=_e.engine.runKernel((function(e){return e.prod(s,a)}),{permutedX:s});if(n){var l=$e(u.shape,o);u=u.reshape(l)}return u}}),Ha=ut({equal_:function(e,t){var n=at(e,"a","equal"),r=at(t,"b","equal");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.equal(n,r)}),{$a:n,$b:r})}}),Ga=ut({equalStrict_:function(e,t){var n=at(e,"a","equalStrict"),r=at(t,"b","equalStrict");return y(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Ka=ut({greater_:function(e,t){var n=at(e,"a","greater"),r=at(t,"b","greater");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.greater(n,r)}),{$a:n,$b:r})}}),Xa=ut({greaterEqual_:function(e,t){var n=at(e,"a","greaterEqual"),r=at(t,"b","greaterEqual");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.greaterEqual(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){return Dt(n)},$b:function(){return Dt(r)}}}))}}),Za=ut({greaterEqualStrict_:function(e,t){var n=at(e,"a","greaterEqualStrict"),r=at(t,"b","greaterEqualStrict");return y(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Qa=ut({greaterStrict_:function(e,t){var n=at(e,"a","greaterStrict"),r=at(t,"b","greaterStrict");return y(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Ja=ut({less_:function(e,t){var n=at(e,"a","less"),r=at(t,"b","less");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.less(n,r)}),{$a:n,$b:r})}}),Ya=ut({lessEqual_:function(e,t){var n=at(e,"a","lessEqual"),r=at(t,"b","lessEqual");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.lessEqual(n,r)}),{$a:n,$b:r})}}),es=ut({lessEqualStrict_:function(e,t){var n=at(e,"a","lessEqualStrict"),r=at(t,"b","lessEqualStrict");return y(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),ts=ut({lessStrict_:function(e,t){var n=at(e,"a","lessStrict"),r=at(t,"b","lessStrict");return y(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),ns=ut({notEqual_:function(e,t){var n=at(e,"a","notEqual"),r=at(t,"b","notEqual");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.notEqual(n,r)}),{$a:n,$b:r})}}),rs=ut({notEqualStrict_:function(e,t){var n=at(e,"a","notEqualStrict"),r=at(t,"b","notEqualStrict");return y(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),os=ut({add_:function(e,t){var n=at(e,"a","add"),r=at(t,"b","add");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.add(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=e,r=Jt(n.shape,o);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},$b:function(){var t=e,n=Jt(r.shape,o);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)}}}))}}),is=ut({addN_:function(e){g(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),g(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return at(e,"tensors"+t,"addN")})),n=t[0];return t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!x(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),_e.engine.runKernel((function(e){return e.addN(t)}),t,(function(e){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}))}}),as=ut({addStrict_:function(e,t){var n=at(e,"a","addStrict"),r=at(t,"b","addStrict");return y(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),ss=ut({atan2_:function(e,t){var n=at(e,"a","atan2"),r=at(t,"b","atan2");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.atan2(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=os(n.square(),r.square()),i=e.mul(r.div(t)),a=Jt(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var t=os(n.square(),r.square()),i=ji(e.mul(n.div(t))),a=Jt(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}}))}}),us=ut({div_:function(e,t){var n,r=at(e,"a","div"),o=at(t,"b","div");if(ue(r,o),"int32"===r.dtype&&"int32"===o.dtype)return cs(r,o);n=function(e){return e.realDivide(r,o)};var i=Yt(r.shape,o.shape);return _e.engine.runKernel(n,{$a:r,$b:o},(function(e){return{$a:function(){var t=e.div(o.toFloat()),n=Jt(r.shape,i);return n.length>0?t.sum(n).reshape(r.shape):t},$b:function(){var t=e.mul(r.toFloat()),n=Jt(o.shape,i);n.length>0&&(t=t.sum(n).reshape(o.shape));var a=o.square();return t.div(a.toFloat()).neg()}}}))}}),ls=ut({divStrict_:function(e,t){var n=at(e,"a","div"),r=at(t,"b","div");return y(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),cs=ut({floorDiv_:function(e,t){var n=at(e,"a","floorDiv"),r=at(t,"b","floorDiv");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.floorDiv(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=e.div(r.toFloat()),i=Jt(n.shape,o);return i.length>0?t.sum(i).reshape(n.shape):t},$b:function(){var t=e.mul(n.toFloat()),i=Jt(r.shape,o);i.length>0&&(t=t.sum(i).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}))}}),hs=ut({maximum_:function(e,t){var n=at(e,"a","maximum"),r=at(t,"b","maximum");return ue(n,r),"bool"===n.dtype&&(n=n.toInt()),"bool"===r.dtype&&(r=r.toInt()),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.maximum(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){return e.mul(n.greaterEqual(r).toFloat())},$b:function(){return e.mul(n.less(r).toFloat())}}}))}}),ps=ut({maximumStrict_:function(e,t){var n=at(e,"a","maximumStrict"),r=at(t,"b","maximumStrict");return y(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),ds=ut({minimum_:function(e,t){var n=at(e,"a","minimum"),r=at(t,"b","minimum");return ue(n,r),"bool"===n.dtype&&(n=n.toInt()),"bool"===r.dtype&&(r=r.toInt()),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.minimum(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){return e.mul(n.lessEqual(r).toFloat())},$b:function(){return e.mul(n.greater(r).toFloat())}}}))}}),fs=ut({minimumStrict_:function(e,t){var n=at(e,"a","minimumStrict"),r=at(t,"b","minimumStrict");return y(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),ms=ut({mod_:function(e,t){var n=at(e,"a","mod"),r=at(t,"b","mod");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.mod(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=Jt(n.shape,o);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),i=Jt(r.shape,o);return i.length>0?t.sum(i).reshape(r.shape):t}}}))}}),gs=ut({modStrict_:function(e,t){var n=at(e,"a","modStrict"),r=at(t,"b","modStrict");return y(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),ys=ut({mul_:function(e,t){var n=at(e,"a","mul"),r=at(t,"b","mul");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.multiply(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=e.mul(r.toFloat()),i=Jt(n.shape,o);return i.length>0?t.sum(i).reshape(n.shape):t},$b:function(){var t=e.mul(n.toFloat()),i=Jt(r.shape,o);return i.length>0?t.sum(i).reshape(r.shape):t}}}))}}),vs=ut({mulStrict_:function(e,t){var n=at(e,"a","mul"),r=at(t,"b","mul");return y(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),bs=ut({pow_:function(e,t){var n=at(e,"base","pow"),r=at(t,"exp","pow"),o=Yt(n.shape,r.shape);return e=n.cast(Mt(n.dtype,r.dtype)),t=r.cast(Mt(n.dtype,r.dtype)),_e.engine.runKernel((function(e,t){return t(e.pow(n,r))}),{$base:n,$exp:r},(function(e,t){var i=t[0];return{$base:function(){var t=r.toFloat(),i=e.mul(t.mul(n.pow(t.sub(mt(1))))),a=Jt(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$exp:function(){var t=e.mul(i.mul(n.log()).toFloat()),a=Jt(r.shape,o);return a.length>0&&(t=t.sum(a)),t.reshape(r.shape)}}}))}}),ws=ut({powStrict_:function(e,t){return y(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),xs=ut({squaredDifference_:function(e,t){var n=at(e,"a","squaredDifference"),r=at(t,"b","squaredDifference");return ue(n,r),Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.squaredDifference(n,r)}),{$a:n,$b:r},(function(e){var t=mt(2);return{$a:function(){return e.mul(n.sub(r).mul(t))},$b:function(){return e.mul(r.sub(n).mul(t))}}}))}}),_s=ut({squaredDifferenceStrict_:function(e,t){var n=at(e,"a","squaredDifferenceStrict"),r=at(t,"b","squaredDifferenceStrict");return y(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ns=ut({sub_:function(e,t){var n=at(e,"a","sub"),r=at(t,"b","sub");ue(n,r);var o=Yt(n.shape,r.shape);return _e.engine.runKernel((function(e){return e.subtract(n,r)}),{$a:n,$b:r},(function(e){return{$a:function(){var t=e,r=Jt(n.shape,o);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},$b:function(){var t=e,n=Jt(r.shape,o);return n.length>0&&(t=t.sum(n)),t.neg().reshape(r.shape)}}}))}}),Es=ut({subStrict_:function(e,t){var n=at(e,"a","subStrict"),r=at(t,"b","subStrict");return y(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Cs=ut({logicalAnd_:function(e,t){var n=at(e,"a","logicalAnd","bool"),r=at(t,"b","logicalAnd","bool");return Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.logicalAnd(n,r)}),{$a:n,$b:r})}}),Is=ut({logicalNot_:function(e){var t=at(e,"x","logicalNot","bool");return _e.engine.runKernel((function(e){return e.logicalNot(t)}),{$x:t})}}),Os=ut({logicalOr_:function(e,t){var n=at(e,"a","logicalOr","bool"),r=at(t,"b","logicalOr","bool");return Yt(n.shape,r.shape),_e.engine.runKernel((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),Ss=ut({logicalXor_:function(e,t){var n=at(e,"a","logicalXor","bool"),r=at(t,"b","logicalXor","bool");return Yt(n.shape,r.shape),Os(e,t).logicalAnd(Cs(e,t).logicalNot())}}),ks=ut({where_:function(e,t,n){var r=at(t,"a","where"),o=at(n,"b","where"),i=at(e,"condition","where","bool");return y(r.shape,o.shape,"Error in where: "),1===i.rank?g(i.shape[0]===r.shape[0],"The first dimension of `a` must match the size of `condition`."):y(i.shape,o.shape,"Error in where: "),_e.engine.runKernel((function(e){return e.select(i,r,o)}),{$condition:i,$a:r,$b:o},(function(e){return{$condition:function(){return Dt(i).toFloat()},$a:function(){return e.mul(i.cast(e.dtype))},$b:function(){return e.mul(i.logicalNot().cast(e.dtype))}}}))}}),Ts=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(o){switch(o.label){case 0:return[4,(t=at(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=fi(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},As=ut({elu_:function(e){var t=at(e,"x","elu");return _e.engine.runKernel((function(e,n){return n(e.elu(t))}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return _e.engine.runKernel((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),Ps=ut({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=at(e,"x","leakyRelu");return hs(mt(t).mul(n),n)}}),Ds=ut({prelu_:function(e,t){var n=at(e,"x","prelu"),r=at(t,"alpha","prelu"),o=mt(0);return hs(o,n).add(r.mul(ds(o,n)))}}),Rs=ut({relu_:function(e){var t=at(e,"x","relu");return"bool"===t.dtype?t.toInt():_e.engine.runKernel((function(e){return e.relu(t)}),{$x:t},(function(e){var n=t.step();return{$x:function(){return e.mulStrict(n.toFloat())}}}))}}),Ms=ut({selu_:function(e){var t=at(e,"x","selu");return _e.engine.runKernel((function(e){return e.selu(t)}),{$x:t},(function(e){return{$x:function(){var n=t.greater(mt(0)),r=mt(1.7580993408473768),o=mt(1.0507009873554805),i=e.mul(o),a=e.mul(r).mul(t.toFloat().exp());return ks(n,i,a)}}}))}}),js=ut({transpose_:function(e,t){var n=at(e,"x","transpose");return null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),g(n.rank===t.length,"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."),t.forEach((function(e){g(e>=0&&e<n.rank,"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t)})),n.rank<=1?n.clone():_e.engine.runKernel((function(e){return e.transpose(n,t)}),{$x:n},(function(e){var n=Ke(t);return{$x:function(){return e.transpose(n)}}}))}}),Ls=ut({localResponseNormalization_:function(e,t,n,r,o){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=at(e,"x","localResponseNormalization");g(4===i.rank||3===i.rank,"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."),g(_(t),"Error in localResponseNormalization: depthRadius must be an integer\n                     but got depthRadius "+t+".");var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=_e.engine.runKernel((function(e,i){return i(e.localResponseNormalization4D(a,t,n,r,o))}),{x4D:a},(function(e,i){var s=i[0];return{x4D:function(){return _e.engine.runKernel((function(i){return i.LRNGrad(e,a,s,t,n,r,o)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Vs=ut({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||r instanceof Array&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(mt(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(r instanceof Array&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=at(e,"x","norm"),t,n),i=o.shape;if(r){var a=qe(n,e.shape);i=$e(o.shape,a)}return o.reshape(i)}});function Fs(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function zs(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Bs,Us=ut({gather_:function(e,t,n){void 0===n&&(n=0);var r=at(e,"x","gather"),o=at(t,"indices","gather","int32");return n=qe(n,r.shape)[0],_e.engine.runKernel((function(e){return e.gather(r,o,n)}),{$x:r},(function(e){return{$x:function(){if(0===n)return Ws(e,o,r.shape[n]);var t=r.shape,i=o.size,a=t.slice(0,n),s=a.length,u=t.slice(n,t.length).slice(1),l=u.length,c=Fs(0,s),h=Fs(s+1,s+1+l),p=zs([a,[i],u]),d=e.reshape(p),f=o.reshape([i]),m=zs([[s],c,h]),g=d.transpose(m),y=Ws(g,f,r.shape[n]),v=Ke(m);return y.transpose(v)}}}))}}),Ws=ut({unsortedSegmentSum_:function(e,t,n){var r=at(e,"x","unsortedSegmentSum"),o=at(t,"segmentIds","unsortedSegmentSum","int32");return g(_(n),"numSegments must be of dtype int"),_e.engine.runKernel((function(e){return e.unsortedSegmentSum(r,o,n)}),{$x:r},(function(e){return{$x:function(){return function(e,t){for(var n=hs(t,Dt(t)),r=Us(e,n),o=Xa(t,mt(0,"int32")),i=r.rank-o.rank,a=0;a<i;++a)o=Go(o,a+1);o=Cs(o,_t(r.shape,"bool"));var s=Dt(r);return ks(o,r,s)}(e,o)}}}))}}),$s=ut({basicLSTMCell_:function(e,t,n,r,o,i){var a=at(e,"forgetBias","basicLSTMCell"),s=at(t,"lstmKernel","basicLSTMCell"),u=at(n,"lstmBias","basicLSTMCell"),l=at(r,"data","basicLSTMCell"),c=at(o,"c","basicLSTMCell"),h=at(i,"h","basicLSTMCell"),p=l.concat(h,1).matMul(s).add(u),d=p.shape[1]/4,f=[p.shape[0],d],m=p.slice([0,0],f),g=p.slice([0,d],f),y=p.slice([0,2*d],f),v=p.slice([0,3*d],f),b=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid()));return[b,b.tanh().mulStrict(v.sigmoid())]}}),qs=ut({multiRNNCell_:function(e,t,n,r){for(var o=at(t,"data","multiRNNCell"),i=st(n,"c","multiRNNCell"),a=st(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var h=[],p=[];for(l=0;l<u.length;l+=2)h.push(u[l]),p.push(u[l+1]);return[h,p]}}),Hs=ut({movingAverage_:function(e,t,n,r,o){void 0===o&&(o=!0);var i=at(e,"v","movingAverage"),a=at(t,"x","movingAverage"),s=at(n,"decay","movingAverage");ue(i,a),g(x(i.shape,a.shape),"Shape mismatch in v and x");var u=mt(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){g(null!=r,"When using zeroDebias: true, step is required.");var h=at(r,"step","movingAverage");c=c.div(u.sub(bs(s,h)))}return i.add(c)}}),Gs=ut({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),0!==a)throw new Error("ellipsis mask is not yet supported");if(0!==s)throw new Error("new axis mask is not yet supported");var l=at(e,"x","stridedSlice");return _e.engine.runKernel((function(e){return e.stridedSlice(l,t,n,r,o,i,a,s,u)}),{$x:l})}}),Ks=ut({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=at(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=_e.engine.runKernel((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),Xs=ut({scatterND_:function(e,t,n){var r=at(e,"indices","scatterND","int32"),o=at(t,"updates","scatterND");return function(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}(n,t,e)}(o,r,n),_e.engine.runKernel((function(e){return e.scatterND(r,o,n)}),{$indices:r,$updates:o})}}),Zs=ut({fft_:function(e){g("complex64"===e.dtype,"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+".");var t=e.shape[e.shape.length-1],n=e.as2D(e.size/t,t);return _e.engine.runKernel((function(e){return e.fft(n)}),{input:e}).reshape(e.shape)}}),Qs=ut({ifft_:function(e){g("complex64"===e.dtype,"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+".");var t=e.shape[e.shape.length-1],n=e.as2D(e.size/t,t);return _e.engine.runKernel((function(e){return e.ifft(n)}),{input:e}).reshape(e.shape)}}),Js=ut({rfft_:function(e){g("float32"===e.dtype,"The dtype for rfft() must be real value but\n    got "+e.dtype);var t=e.shape[e.shape.length-1],n=e.size/t,r=e.zerosLike(),o=ht(e,r).as2D(n,t),i=Zs(o),a=Math.floor(t/2)+1,s=pt(i),u=dt(i),l=s.split([a,t-a],s.shape.length-1),c=u.split([a,t-a],u.shape.length-1),h=e.shape.slice();return h[e.shape.length-1]=a,ht(l[0],c[0]).reshape(h)}}),Ys=ut({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Qs(r);return pt(o)}var i=[n,2*(t-1)],a=pt(e).as2D(n,t),s=dt(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(mt(-1)),c=a.concat(u,1),h=s.concat(l,1);return r=ht(c,h).as2D(i[0],i[1]),o=Qs(r),pt(o)}}),eu=Object.freeze({fft:Zs,ifft:Qs,rfft:Js,irfft:Ys}),tu=ut({sparseToDense_:function(e,t,n,r){var o=at(e,"sparseIndices","sparseToDense","int32"),i=at(t,"sparseValues","sparseToDense"),a=at(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var o=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");if(0!==t.rank&&(1!==t.rank||t.size!==o))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+o+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),_e.engine.runKernel((function(e){return e.sparseToDense(o,i,n,a)}),{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),nu=ut({gatherND_:function(e,t){var n=at(t,"indices","gatherND","int32"),r=at(e,"x","gatherND");return _e.engine.runKernel((function(e){return e.gatherND(r,n)}),{$x:r,$indices:n})}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Bs||(Bs={}));var ru=ut({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=Bs.SUM_BY_NONZERO_WEIGHTS);var o=at(e,"labels","absoluteDifference"),i=at(t,"predictions","absoluteDifference"),a=null;null!=n&&(a=at(n,"weights","absoluteDifference")),y(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return ou(s,a,r)}}),ou=ut({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=Bs.SUM_BY_NONZERO_WEIGHTS);var r=at(e,"losses","computeWeightedLoss"),o=null;null!=t&&(o=at(t,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(n===Bs.NONE)return i;if(n===Bs.SUM)return i.sum();if(n===Bs.MEAN){if(null==o)return i.mean();var a=w(r.shape)/w(o.shape),s=i.sum().div(o.sum());return a>1?s.div(mt(a)):s}if(n===Bs.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(mt(r.size));var u=o.mul(_t(r.shape)).notEqual(mt(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),iu=ut({cosineDistance_:function(e,t,n,r,o){void 0===o&&(o=Bs.SUM_BY_NONZERO_WEIGHTS);var i=at(e,"labels","cosineDistance"),a=at(t,"predictions","cosineDistance"),s=null;null!=r&&(s=at(r,"weights","cosineDistance")),y(i.shape,a.shape,"Error in cosineDistance: ");var u=mt(1).sub(i.mul(a).sum(n,!0));return ou(u,s,o)}}),au=ut({hingeLoss_:function(e,t,n,r){void 0===r&&(r=Bs.SUM_BY_NONZERO_WEIGHTS);var o=at(e,"labels","hingeLoss"),i=at(t,"predictions","hingeLoss"),a=null;null!=n&&(a=at(n,"weights","hingeLoss")),y(o.shape,i.shape,"Error in hingeLoss: ");var s=mt(1);o=mt(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return ou(u,a,r)}}),su=ut({huberLoss_:function(e,t,n,r,o){void 0===r&&(r=1),void 0===o&&(o=Bs.SUM_BY_NONZERO_WEIGHTS);var i=at(e,"labels","huberLoss"),a=at(t,"predictions","huberLoss"),s=null;null!=n&&(s=at(n,"weights","huberLoss")),y(i.shape,a.shape,"Error in huberLoss: ");var u=mt(r),l=a.sub(i).abs(),c=ds(l,u),h=l.sub(c),p=mt(.5).mul(c.square()).add(u.mul(h));return ou(p,s,o)}}),uu=ut({logLoss_:function(e,t,n,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=Bs.SUM_BY_NONZERO_WEIGHTS);var i=at(e,"labels","logLoss"),a=at(t,"predictions","logLoss"),s=null;null!=n&&(s=at(n,"weights","logLoss")),y(i.shape,a.shape,"Error in logLoss: ");var u=mt(1),l=mt(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return ou(c,s,o)}}),lu=ut({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=Bs.SUM_BY_NONZERO_WEIGHTS);var o=at(e,"labels","meanSquaredError"),i=at(t,"predictions","meanSquaredError"),a=null;null!=n&&(a=at(n,"weights","meanSquaredError")),y(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return ou(s,a,r)}}),cu=ut({sigmoidCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=Bs.SUM_BY_NONZERO_WEIGHTS);var i=at(e,"multiClassLabels","sigmoidCrossEntropy"),a=at(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=at(n,"weights","sigmoidCrossEntropy")),y(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=mt(r),l=mt(1),c=mt(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var h=function(e,t){var n=at(e,"labels","sigmoidCrossEntropyWithLogits"),r=at(t,"logits","sigmoidCrossEntropyWithLogits");y(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=r.relu(),i=r.mul(n),a=r.abs().neg().exp().log1p();return o.sub(i).add(a)}(i,a);return ou(h,s,o)}}),hu=ut({softmaxCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=Bs.SUM_BY_NONZERO_WEIGHTS);var i=at(e,"onehotLabels","softmaxCrossEntropy"),a=at(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=at(n,"weights","softmaxCrossEntropy")),y(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=mt(r),l=mt(1),c=mt(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var h=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return ke((function(e,t){var r=t.logSumExp([n],!0),o=t.toFloat().sub(r);return{value:o.mul(e).neg().sum([n]),gradFunc:function(t){var r=$e(t.shape,[n]);return[t.reshape(r).mul(e.toFloat().sub(o.exp())),t.reshape(r).mul(o.exp().sub(e.toFloat()))]}}}))(e,t)}(i,a);return ou(h,s,o)}}),pu=Object.freeze({get Reduction(){return Bs},absoluteDifference:ru,computeWeightedLoss:ou,cosineDistance:iu,hingeLoss:au,huberLoss:su,logLoss:uu,meanSquaredError:lu,sigmoidCrossEntropy:cu,softmaxCrossEntropy:hu});function du(e,t){return void 0===t&&(t=!1),_e.engine.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=Ko(n),i=e.clone(),a=yt([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(e){var t,u=i,l=s,c=o;t=_e.engine.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),l=i.slice([e,e],[1,1]),c=l.sign().neg(),h=l.sub(c.mul(u)),p=t.div(h);s=1===p.shape[0]?a.clone():a.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0);var d=c.matMul(h).div(u).neg(),f=i.slice([e,0],[n-e,r]),m=d.mul(s);i=0===e?f.sub(m.matMul(s.transpose().matMul(f))):i.slice([0,0],[e,r]).concat(f.sub(m.matMul(s.transpose().matMul(f))),0);var g=o.slice([0,e],[n,o.shape[1]-e]);return o=0===e?g.sub(g.matMul(s).matMul(m.transpose())):o.slice([0,0],[n,e]).concat(g.sub(g.matMul(s).matMul(m.transpose())),1),[s,i,o]})),s=t[0],i=t[1],o=t[2],De([u,l,c])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]}))}var fu=ut({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,g(null!=e&&e.length>0,"Gram-Schmidt process: input must not be null, undefined, or empty");for(var n=e[0].shape[0],r=1;r<e.length;++r)g(e[r].shape[0]===n,"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[r].shape[0]+" vs. "+n+")")}else t=!0,e=So(e,e.shape[0],0).map((function(e){return ui(e,[0])}));g(e.length<=e[0].shape[0],"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+").");var o=[],i=e,a=function(e){o.push(_e.engine.tidy((function(){var t=i[e];if(e>0)for(var n=0;n<e;++n){var r=$a(o[n].mulStrict(t)).mul(o[n]);t=t.sub(r)}return t.div(Vs(t,"euclidean"))})))};for(r=0;r<e.length;++r)a(r);return t?li(o,0):o}}),mu=ut({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return du(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=[],o=[];return pi(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0).forEach((function(e){var n=du(e,t),i=n[1];r.push(n[0]),o.push(i)})),[li(r,0).reshape(e.shape),li(o,0).reshape(e.shape)]}}),gu=Object.freeze({gramSchmidt:fu,qr:mu});function yu(e,t,n,r,o){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY);var i=e.shape[0];return n=Math.min(n,i),g(0<=r&&r<=1,"iouThreshold must be in [0, 1], but was '"+r+"'"),g(2===e.rank,"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"),g(4===e.shape[1],"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]),g(1===t.rank,"scores must be a 1D tensor"),g(t.shape[0]===i,"scores has incompatible shape with boxes. Expected "+i+", but was "+t.shape[0]),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o}}var vu=ut({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=at(e,"images","resizeBilinear");g(3===r.rank||4===r.rank,"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."),g(2===t.length,"Error in resizeBilinear: new shape must 2D, but got shape "+t+".");var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=_e.engine.runKernel((function(e,t){return e.resizeBilinear(o,a,s,n)}),{batchImages:o},(function(e,t){return{batchImages:function(){return _e.engine.runKernel((function(t){return t.resizeBilinearBackprop(e,o,n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),bu=ut({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=at(e,"images","resizeNearestNeighbor");g(3===r.rank||4===r.rank,"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."),g(2===t.length,"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."),g("float32"===r.dtype||"int32"===r.dtype,"`images` must have `int32` or `float32` as dtype");var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=_e.engine.runKernel((function(e,t){return e.resizeNearestNeighbor(o,a,s,n)}),{batchImages:o},(function(e,t){return{batchImages:function(){return _e.engine.runKernel((function(t){return t.resizeNearestNeighborBackprop(e,o,n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),wu=ut({nonMaxSuppression_:function(e,t,n,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=at(e,"boxes","nonMaxSuppression"),a=at(t,"scores","nonMaxSuppression"),s=yu(i,a,n,r,o);return n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,_e.engine.runKernel((function(e){return e.nonMaxSuppression(i,a,n,r,o)}),{$boxes:i})}}),xu=Object.freeze({resizeBilinear:vu,resizeNearestNeighbor:bu,nonMaxSuppression:wu,nonMaxSuppressionAsync:function(e,t,n,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),a(this,void 0,void 0,(function(){var i,a,u,l,c,h;return s(this,(function(s){switch(s.label){case 0:return i=at(e,"boxes","nonMaxSuppressionAsync"),a=at(t,"scores","nonMaxSuppressionAsync"),u=yu(i,a,n,r,o),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,[4,i.data()];case 1:return l=s.sent(),[4,a.data()];case 2:return c=s.sent(),h=qt(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,h]}}))}))},cropAndResize:function(e,t,n,r,o,i){var a=at(e,"image","cropAndResize","float32"),s=at(t,"boxes","cropAndResize","float32"),u=at(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return g(4===a.rank,"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."),g(2===s.rank&&4===s.shape[1],"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."),g(1===u.rank&&u.shape[0]===l,"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."),g(2===r.length,"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."),g(r[0]>=1&&r[1]>=1,"cropSize must be atleast [1,1], but was "+r),g("bilinear"===o||"nearest"===o,"method must be bilinear or nearest, but was "+o),_e.engine.runKernel((function(e,t){return e.cropAndResize(a,s,u,r,o,i)}),{$image:a,$boxes:s})}}),_u=Object.freeze({image:xu,linalg:gu,losses:pu,spectral:eu,op:ut,batchNormalization2d:Qi,batchNormalization3d:Ji,batchNormalization4d:Yi,batchNormalization:ea,complex:ht,real:pt,imag:dt,concat:No,concat1d:Eo,concat2d:Co,concat3d:Io,concat4d:Oo,split:So,conv1d:da,conv2d:fa,conv2dDerFilter:ma,depthwiseConv2d:ga,separableConv2d:ya,conv2dTranspose:va,matMul:ua,dot:la,outerProduct:ca,reverse:ba,reverse1d:wa,reverse2d:xa,reverse3d:_a,reverse4d:Na,maxPool:Ia,avgPool:Oa,pool:Sa,slice:ka,slice1d:Ta,slice2d:Aa,slice3d:Pa,slice4d:Da,abs:vi,acos:bi,acosh:wi,asin:xi,asinh:_i,atan:Ni,atanh:Ei,ceil:Ci,clipByValue:Ii,cos:Oi,cosh:Si,erf:ki,exp:Ti,expm1:Ai,floor:Pi,log:Di,log1p:Ri,logSigmoid:Mi,neg:ji,reciprocal:Li,round:Vi,rsqrt:Fi,sigmoid:zi,sign:Bi,sin:Ui,sinh:Wi,softplus:$i,sqrt:qi,square:Hi,step:Gi,tan:Ki,tanh:Xi,all:Ma,any:ja,argMax:La,argMin:Va,logSumExp:Fa,max:za,mean:Ba,min:Ua,moments:Wa,sum:$a,prod:qa,equal:Ha,equalStrict:Ga,greater:Ka,greaterEqual:Xa,greaterEqualStrict:Za,greaterStrict:Qa,less:Ja,lessEqual:Ya,lessEqualStrict:es,lessStrict:ts,notEqual:ns,notEqualStrict:rs,add:os,addN:is,addStrict:as,atan2:ss,div:us,divStrict:ls,floorDiv:cs,maximum:hs,maximumStrict:ps,minimum:ds,minimumStrict:fs,mod:ms,modStrict:gs,mul:ys,mulStrict:vs,pow:bs,powStrict:ws,squaredDifference:xs,squaredDifferenceStrict:_s,sub:Ns,subStrict:Es,elu:As,leakyRelu:Ps,prelu:Ds,relu:Rs,selu:Ms,logicalAnd:Cs,logicalNot:Is,logicalOr:Os,logicalXor:Ss,where:ks,whereAsync:Ts,buffer:zo,toPixels:Fo,print:Bo,batchToSpaceND:Uo,cast:Wo,clone:$o,cumsum:qo,depthToSpace:Ho,expandDims:Go,eye:Ko,fromPixels:Xo,multinomial:Zo,oneHot:Qo,pad:Jo,pad1d:Yo,pad2d:ei,pad3d:ti,pad4d:ni,rand:ri,randomNormal:oi,randomUniform:ii,reshape:ai,spaceToBatchND:si,squeeze:ui,stack:li,tile:ci,truncatedNormal:hi,unstack:pi,setdiff1dAsync:di,fill:Et,linspace:Ct,ones:_t,range:It,scalar:mt,tensor:ft,tensor1d:gt,tensor2d:yt,tensor3d:vt,tensor4d:bt,tensor5d:wt,tensor6d:xt,zeros:Nt,onesLike:Pt,zerosLike:Dt,transpose:js,softmax:lt,logSoftmax:ct,localResponseNormalization:Ls,norm:Vs,gather:Us,unsortedSegmentSum:Ws,basicLSTMCell:$s,multiRNNCell:qs,movingAverage:Hs,stridedSlice:Gs,topk:Ks,scatterND:Xs,fft:Zs,ifft:Qs,rfft:Js,irfft:Ys,sparseToDense:tu,gatherND:nu}),Nu=function(){function e(){this.blockSize=48,this.firstUse=!0,_e.get("IS_BROWSER")&&(this.fromPixels2DContext=document.createElement("canvas").getContext("2d"))}return e.prototype.setDataMover=function(e){this.data=new Lt(e)},e.prototype.register=function(e,t,n){if(this.firstUse&&(this.firstUse=!1,_e.get("IS_NODE")&&je("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(e))throw new Error("Data buffer is already registered");this.data.set(e,{dtype:n})},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(e).values=t},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("pixels passed to tf.fromPixels() can not be null");var n,r;if(_e.get("IS_NODE")&&null==e.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=e.getContext)n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;else if(e instanceof ImageData)n=e.data;else{if(!(e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("pixels passed to tf.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement or ImageData, but was "+e.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=e.width,this.fromPixels2DContext.canvas.height=e.height,this.fromPixels2DContext.drawImage(e,0,0,e.width,e.height),n=this.fromPixels2DContext.getImageData(0,0,e.width,e.height).data}if(4===t)r=new Int32Array(n);else{var o=e.width*e.height;r=new Int32Array(o*t);for(var i=0;i<o;i++)for(var a=0;a<t;++a)r[i*t+a]=n[4*i+a]}return vt(r,[e.height,e.width,t],"int32")},e.prototype.read=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.readSync(e)]}))}))},e.prototype.readSync=function(e){var t=this.data.get(e),n=t.complexTensors;return"complex64"===t.dtype?Bt(n.real.dataSync(),n.imag.dataSync()):this.data.get(e).values},e.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},e.prototype.time=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){return t=G(),e(),[2,{kernelMs:G()-t}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(e,t){var n=ie.make(e.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:_e.engine.keep(e.clone()),imag:_e.engine.keep(t.clone())},n},e.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},e.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},e.prototype.assertNotComplex=function(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&g("complex64"!==e.dtype,t+" does not support complex64 tensors.")}))},e.prototype.slice=function(e,t,n){this.assertNotComplex(e,"slice");for(var r=zo(n,e.dtype),o=0;o<r.size;++o){var i=r.indexToLoc(o),a=i.map((function(e,n){return e+t[n]}));r.set.apply(r,[e.get.apply(e,a)].concat(i))}return r.toTensor()},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s,u){this.assertNotComplex(e,"stridedSlice");var l=tt(e.shape,t,n,r,o,i,a,s,u),c=l[0],h=l[1],p=l[2],d=h.filter((function(e,t){return-1===p.indexOf(t)}));if(d.some((function(e){return 0===e})))return ft([],d);for(var f=zo(h,e.dtype),m=0;m<f.size;m++){for(var g=f.indexToLoc(m),y=new Array(g.length),v=0;v<y.length;v++)y[v]=g[v]*r[v]+c[v];f.set.apply(f,[e.get.apply(e,y)].concat(g))}return f.toTensor().reshape(d)},e.prototype.reverse=function(e,t){this.assertNotComplex(e,"reverse");for(var n=zo(e.shape,e.dtype),r=e.buffer(),o=function(o){var i=n.indexToLoc(o),a=i.slice();t.forEach((function(t){return a[t]=e.shape[t]-1-a[t]})),n.set.apply(n,[r.get.apply(r,a)].concat(i))},i=0;i<n.size;i++)o(i);return n.toTensor()},e.prototype.concat=function(e,t){this.assertNotComplex(e,"concat");var n=e.map((function(e){var n=w(e.shape.slice(t));return e.as2D(-1,n)})),r=Ze(n.map((function(e){return e.shape})),1),o=zo(r,e[0].dtype).values;if(1===n[0].shape[0]){var i=0;n.forEach((function(e){o.set(e.dataSync(),i),i+=e.size}))}else{var a=0;n.forEach((function(e){for(var t=e.dataSync(),n=0,i=0;i<e.shape[0];++i)for(var s=i*r[1]+a,u=0;u<e.shape[1];++u)o[s+u]=t[n++];a+=e.shape[1]}))}var s=Ze(e.map((function(e){return e.shape})),t);return ft(o,s,e[0].dtype)},e.prototype.neg=function(e){return this.assertNotComplex(e,"neg"),this.multiply(mt(-1),e)},e.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,Mt(e.dtype,t.dtype),(function(e,t){return e+t}))},e.prototype.addN=function(e){this.assertNotComplex(e,"addN");for(var t=e.map((function(e){return e.dataSync()})),n=zo(e[0].shape,e[0].dtype),r=n.values,o=0;o<e.length;o++)for(var i=t[o],a=0;a<r.length;a++)r[a]+=i[a];return n.toTensor()},e.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,Mt(e.dtype,t.dtype),(function(e,t){return e-t}))},e.prototype.pow=function(e,t){return this.assertNotComplex([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},e.prototype.batchMatMul=function(e,t,n,r){this.assertNotComplex([e,t],"matMul");for(var o=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],s=e.shape[0],u=e.dataSync(),l=t.dataSync(),c=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],h=c[0],p=c[1],d=c[2],f=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],m=f[0],g=f[1],y=f[2],v=i*a,b=new Float32Array(s*v),w=this.blockSize,x=0;x<s;x++)for(var _=0;_<i;_+=w)for(var N=0;N<a;N+=w)for(var E=0;E<o;E+=w)for(var C=Math.min(_+w,i),I=Math.min(N+w,a),O=Math.min(E+w,o),S=_;S<C;S++)for(var k=N;k<I;k++){for(var T=0,A=E;A<O;A++)T+=u[x*h+S*p+A*d]*l[A*m+k*g+x*y];b[x*v+(S*a+k)]+=T}return vt(b,[s,i,a])},e.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,Mt(e.dtype,t.dtype),(function(e,t){return e*t}))},e.prototype.realDivide=function(e,t){return this.assertNotComplex([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",(function(e,t){return e/t}))},e.prototype.floorDiv=function(e,t){return this.assertNotComplex([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},e.prototype.sum=function(e,t){this.assertNotComplex(e,"sum"),He("sum",t,e.rank);for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],Mt(e.dtype,"int32")),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=0,h=0;h<i;++h)c+=s[l+h];a[u]=c}return o},e.prototype.prod=function(e,t){this.assertNotComplex(e,"sum");for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],Mt(e.dtype,"int32")),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=1,h=0;h<i;++h)c*=s[l+h];a[u]=c}return o},e.prototype.unsortedSegmentSum=function(e,t,n){this.assertNotComplex(e,"unsortedSegmentSum");for(var r=[],o=e.rank-t.rank,i=0;i<o;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var a=mt(i,"int32"),s=Ha(a,t).asType("float32").mul(e).sum(0);r.push(s)}return li(r)},e.prototype.argMin=function(e,t){this.assertNotComplex(e,"argMin");var n=[t];He("argMin",n,e.rank);for(var r=We(e.shape,n),o=r[1],i=Nt(r[0],"int32"),a=w(o),s=i.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var c=l*a,h=u[c],p=0,d=0;d<a;++d){var f=u[c+d];f<h&&(h=f,p=d)}s[l]=p}return i},e.prototype.argMax=function(e,t){this.assertNotComplex(e,"argMax");var n=[t];He("argMax",n,e.rank);for(var r=We(e.shape,n),o=r[1],i=Nt(r[0],"int32"),a=w(o),s=i.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var c=l*a,h=u[c],p=0,d=0;d<a;++d){var f=u[c+d];f>h&&(h=f,p=d)}s[l]=p}return i},e.prototype.cumsum=function(e,t,n,r){if(this.assertNotComplex(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var o=Mt(e.dtype,"int32"),i=Nt(e.shape,o),a=i.dataSync(),s=e.dataSync(),u=e.shape[e.rank-1],l=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},c=0;c<s.length;c+=u)for(var h=0;h<u;h++){var p=l(c,h);if(0===h)a[p]=n?0:s[p];else{var d=l(c,h-1);a[p]=n?s[d]+a[d]:s[p]+a[d]}}return i},e.prototype.equal=function(e,t){return this.assertNotComplex([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},e.prototype.notEqual=function(e,t){return this.assertNotComplex([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},e.prototype.less=function(e,t){return this.assertNotComplex([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},e.prototype.lessEqual=function(e,t){return this.assertNotComplex([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},e.prototype.greater=function(e,t){return this.assertNotComplex([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},e.prototype.greaterEqual=function(e,t){return this.assertNotComplex([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},e.prototype.logicalNot=function(e){this.assertNotComplex(e,"logicalNot");for(var t=e.dataSync(),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return ie.make(e.shape,{values:n},"bool")},e.prototype.logicalAnd=function(e,t){return this.assertNotComplex([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},e.prototype.logicalOr=function(e,t){return this.assertNotComplex([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},e.prototype.select=function(e,t,n){this.assertNotComplex([e,t,n],"select");for(var r=e.dataSync(),o=t.dataSync(),i=n.dataSync(),a=Nt(t.shape,Mt(t.dtype,n.dtype)),s=a.dataSync(),u=0,l=0===e.rank||e.rank>1||1===t.rank?1:t.shape[1],c=0;c<r.length;c++)for(var h=0;h<l;h++)s[u++]=1===r[c]?o[c]:i[c];return a},e.prototype.where=function(e){this.assertNotComplex([e],"where");var t=e.dataSync();return fi(e.shape,t)},e.prototype.topk=function(e,t,n){return this.assertNotComplex(e,"topk"),Kt(e.dataSync(),e.shape,e.dtype,t)},e.prototype.min=function(e,t){this.assertNotComplex(e,"min"),He("min",t,e.rank);for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],e.dtype),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=s[l],h=0;h<i;++h){var p=s[l+h];p<c&&(c=p)}a[u]=c}return o},e.prototype.minimum=function(e,t){return this.assertNotComplex([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},e.prototype.mod=function(e,t){return this.assertNotComplex([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},e.prototype.max=function(e,t){this.assertNotComplex(e,"max"),He("max",t,e.rank);for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],e.dtype),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=s[l],h=0;h<i;++h){var p=s[l+h];p>c&&(c=p)}a[u]=c}return o},e.prototype.maximum=function(e,t){return this.assertNotComplex([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},e.prototype.all=function(e,t){this.assertNotComplex(e,"all"),He("all",t,e.rank);for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],e.dtype),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=s[l],h=0;h<i;++h)c=c&&s[l+h];a[u]=c}return o},e.prototype.any=function(e,t){this.assertNotComplex(e,"any"),He("any",t,e.rank);for(var n=We(e.shape,t),r=n[1],o=Nt(n[0],e.dtype),i=w(r),a=o.dataSync(),s=e.dataSync(),u=0;u<a.length;++u){for(var l=u*i,c=s[l],h=0;h<i;++h)c=c||s[l+h];a[u]=c}return o},e.prototype.squaredDifference=function(e,t){return this.assertNotComplex([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},e.prototype.ceil=function(e){this.assertNotComplex(e,"ceil");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return ie.make(e.shape,{values:n})},e.prototype.floor=function(e){this.assertNotComplex(e,"floor");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return ie.make(e.shape,{values:n})},e.prototype.sign=function(e){this.assertNotComplex(e,"x");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=t[r]<0?-1:t[r]>0?1:0;return ie.make(e.shape,{values:n})},e.prototype.round=function(e){this.assertNotComplex(e,"round");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=Math.floor(t[r]);n[r]=t[r]-o<.5?Math.floor(t[r]):t[r]-o>.5?Math.ceil(t[r]):o%2==0?o:o+1}return ie.make(e.shape,{values:n})},e.prototype.exp=function(e){this.assertNotComplex(e,"exp");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return ie.make(e.shape,{values:n})},e.prototype.expm1=function(e){this.assertNotComplex(e,"expm1");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return ie.make(e.shape,{values:n})},e.prototype.log=function(e){this.assertNotComplex(e,"log");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.log(t[r]);return ie.make(e.shape,{values:n})},e.prototype.log1p=function(e){this.assertNotComplex(e,"log1p");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.log1p(t[r]);return ie.make(e.shape,{values:n})},e.prototype.sqrt=function(e){this.assertNotComplex(e,"sqrt");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.sqrt(t[r]);return ie.make(e.shape,{values:n})},e.prototype.rsqrt=function(e){this.assertNotComplex(e,"rsqrt");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/Math.sqrt(t[r]);return ie.make(e.shape,{values:n})},e.prototype.square=function(e){this.assertNotComplex(e,"square");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=o*o}return ie.make(e.shape,{values:n})},e.prototype.reciprocal=function(e){this.assertNotComplex(e,"reciprocal");for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return ie.make(e.shape,{values:n})},e.prototype.relu=function(e){this.assertNotComplex(e,"relu");for(var t=Nt(e.shape,e.dtype),n=t.dataSync(),r=e.dataSync(),o=0;o<r.length;++o)n[o]=Math.max(0,r[o]);return t},e.prototype.elu=function(e){this.assertNotComplex(e,"elu");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?o:Math.exp(o)-1}return ie.make(e.shape,{values:t})},e.prototype.eluDer=function(e,t){this.assertNotComplex([e,t],"eluDer");for(var n=new Float32Array(t.size),r=t.dataSync(),o=e.dataSync(),i=0;i<r.length;++i){var a=r[i];n[i]=a>=1?o[i]:o[i]*(a+1)}return ie.make(t.shape,{values:n})},e.prototype.selu=function(e){this.assertNotComplex(e,"selu");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?1.0507009873554805*o:1.7580993408473768*(Math.exp(o)-1)}return ie.make(e.shape,{values:t})},e.prototype.clip=function(e,t,n){this.assertNotComplex(e,"clip");for(var r=new Float32Array(e.size),o=e.dataSync(),i=0;i<o.length;++i){var a=o[i];r[i]=a>n?n:a<t?t:a}return ie.make(e.shape,{values:r})},e.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return ie.make(e.shape,{values:t})},e.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<e.size;++r)t[r]=Math.hypot(n[2*r],n[2*r+1]);return ie.make(e.shape,{values:t})},e.prototype.int=function(e){this.assertNotComplex(e,"int");for(var t=new Int32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=n[r];return ie.make(e.shape,{values:t},"int32")},e.prototype.sigmoid=function(e){this.assertNotComplex(e,"sigmoid");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return ie.make(e.shape,{values:t})},e.prototype.softplus=function(e){this.assertNotComplex(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=e.dataSync(),o=0;o<r.length;++o){var i,a=r[o]>-t,s=r[o]<t,u=Math.exp(r[o]);i=s?u:a?r[o]:Math.log(1+u),n[o]=i}return ie.make(e.shape,{values:n})},e.prototype.sin=function(e){this.assertNotComplex(e,"sin");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return ie.make(e.shape,{values:t})},e.prototype.cos=function(e){this.assertNotComplex(e,"cos");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return ie.make(e.shape,{values:t})},e.prototype.tan=function(e){this.assertNotComplex(e,"tan");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return ie.make(e.shape,{values:t})},e.prototype.asin=function(e){this.assertNotComplex(e,"asin");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return ie.make(e.shape,{values:t})},e.prototype.acos=function(e){this.assertNotComplex(e,"acos");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return ie.make(e.shape,{values:t})},e.prototype.atan=function(e){this.assertNotComplex(e,"atan");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return ie.make(e.shape,{values:t})},e.prototype.atan2=function(e,t){return this.assertNotComplex([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},e.prototype.sinh=function(e){this.assertNotComplex(e,"sinh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return ie.make(e.shape,{values:t})},e.prototype.cosh=function(e){this.assertNotComplex(e,"cosh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return ie.make(e.shape,{values:t})},e.prototype.tanh=function(e){this.assertNotComplex(e,"tanh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=N(n[r]);return ie.make(e.shape,{values:t})},e.prototype.asinh=function(e){this.assertNotComplex(e,"asinh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return ie.make(e.shape,{values:t})},e.prototype.acosh=function(e){this.assertNotComplex(e,"acosh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return ie.make(e.shape,{values:t})},e.prototype.atanh=function(e){this.assertNotComplex(e,"atanh");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return ie.make(e.shape,{values:t})},e.prototype.erf=function(e){this.assertNotComplex(e,"erf");for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r){var o=n[r],i=1/(1+.3275911*o);t[r]=1-((((1.061405429*i-1.453152027)*i+1.421413741)*i-.284496736)*i+.254829592)*i*Math.exp(-o*o)}return ie.make(e.shape,{values:t})},e.prototype.step=function(e,t){void 0===t&&(t=0),this.assertNotComplex(e,"step");for(var n=new Float32Array(e.size),r=e.dataSync(),o=0;o<r.length;++o){var i=r[o];n[o]=isNaN(i)?NaN:i>0?1:t}return ie.make(e.shape,{values:n})},e.prototype.conv2d=function(e,t,n){this.assertNotComplex([e,t],"conv2d");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=zo(n.outShape,e.dtype),c=e.dataSync(),h=t.dataSync(),p=l.values,d=0;d<n.batchSize;++d)for(var f=d*e.strides[0],m=d*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],v=g*n.strideHeight-s,b=0;b<r;b++){var w=v+b*i;if(!(w<0||w>=n.inHeight))for(var x=b*t.strides[0],_=f+w*e.strides[1],N=0;N<n.outWidth;++N)for(var E=y+N*n.outChannels,C=N*n.strideWidth-u,I=0;I<o;I++){var O=C+I*a;if(!(O<0||O>=n.inWidth))for(var S=_+O*n.inChannels,k=x+I*t.strides[1],T=0;T<n.inChannels;++T){for(var A=c[S+T],P=0;P<n.outChannels;++P)p[E+P]+=A*h[k+P];k+=n.outChannels}}}return l.toTensor()},e.prototype.conv2dDerInput=function(e,t,n){this.assertNotComplex([e,t],"conv2dDerInput");for(var r=zo(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],l=e.dataSync(),c=e.strides,h=c[0],p=c[1],d=c[2],f=t.dataSync(),m=t.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,_=n.inChannels,N=n.inHeight,E=n.inWidth,C=n.outChannels,I=n.outHeight,O=n.outWidth,S=n.strideHeight,k=n.strideWidth,T=w-1-n.padInfo.top,A=x-1-n.padInfo.left,P=0;P<b;++P)for(var D=0;D<_;++D)for(var R=0;R<N;++R)for(var M=R-T,j=Math.max(0,Math.ceil(M/S)),L=Math.min(I,(w+M)/S),V=0;V<E;++V){for(var F=V-A,z=Math.max(0,Math.ceil(F/k)),B=Math.min(O,(x+F)/k),U=0,W=j;W<L;++W)for(var $=W*S-M,q=z;q<B;++q)for(var H=h*P+p*W+d*q,G=g*(w-1-$)+y*(x-1-(q*k-F))+v*D,K=0;K<C;++K)U+=l[H+K]*f[G+K];o[a*P+s*R+u*V+D]=U}return r.toTensor()},e.prototype.conv2dDerFilter=function(e,t,n){this.assertNotComplex([e,t],"conv2dDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=zo(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=0;c<i;++c)for(var h=Math.max(0,Math.ceil((l-c)/r)),p=Math.min(n.outHeight,(n.inHeight+l-c)/r),d=0;d<a;++d)for(var f=Math.max(0,Math.ceil((u-d)/o)),m=Math.min(n.outWidth,(n.inWidth+u-d)/o),g=0;g<n.inChannels;++g)for(var y=0;y<n.outChannels;++y){for(var v=0,b=0;b<n.batchSize;++b)for(var w=h;w<p;++w)for(var x=c+w*r-l,_=f;_<m;++_)v+=e.get(b,x,d+_*o-u,g)*t.get(b,w,_,y);s.set(v,c,d,g,y)}return s.toTensor()},e.prototype.depthwiseConv2D=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2D");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=zo(n.outShape,e.dtype),h=e.dataSync(),p=t.dataSync(),d=c.values,f=0;f<n.batchSize;++f)for(var m=f*e.strides[0],g=f*c.strides[0],y=0;y<n.outHeight;++y)for(var v=g+y*c.strides[1],b=y*n.strideHeight-s,w=0;w<r;++w){var x=b+w*i;if(!(x<0||x>=n.inHeight))for(var _=w*t.strides[0],N=m+x*e.strides[1],E=0;E<n.outWidth;++E)for(var C=v+E*c.strides[2],I=E*n.strideWidth-u,O=0;O<o;++O){var S=I+O*a;if(!(S<0||S>=n.inWidth))for(var k=N+S*n.inChannels,T=C,A=_+O*t.strides[1],P=0;P<n.inChannels;++P){for(var D=h[k+P],R=0;R<l;++R)d[T+R]+=D*p[A+R];T+=l,A+=l}}}return c.toTensor()},e.prototype.depthwiseConv2DDerInput=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2DDerInput");for(var r=zo(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],l=e.dataSync(),c=e.strides,h=c[0],p=c[1],d=c[2],f=t.dataSync(),m=t.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,_=n.inChannels,N=n.inHeight,E=n.inWidth,C=n.outHeight,I=n.outWidth,O=n.strideHeight,S=n.strideWidth,k=w-1-n.padInfo.top,T=x-1-n.padInfo.left,A=n.outChannels/_,P=0;P<b;++P)for(var D=0;D<_;++D)for(var R=0;R<N;++R)for(var M=R-k,j=Math.max(0,Math.ceil(M/O)),L=Math.min(C,(w+M)/O),V=0;V<E;++V){for(var F=V-T,z=Math.max(0,Math.ceil(F/S)),B=Math.min(I,(x+F)/S),U=0,W=j;W<L;++W)for(var $=W*O-M,q=z;q<B;++q)for(var H=h*P+p*W+d*q,G=g*(w-1-$)+y*(x-1-(q*S-F))+v*D,K=0;K<A;++K)U+=l[H+(D*A+K)]*f[G+K];o[a*P+s*R+u*V+D]=U}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=zo(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,h=0;h<i;++h)for(var p=Math.max(0,Math.ceil((l-h)/r)),d=Math.min(n.outHeight,(n.inHeight+l-h)/r),f=0;f<a;++f)for(var m=Math.max(0,Math.ceil((u-f)/o)),g=Math.min(n.outWidth,(n.inWidth+u-f)/o),y=0;y<n.outChannels;++y){for(var v=Math.trunc(y/c),b=y%c,w=0,x=0;x<n.batchSize;++x)for(var _=p;_<d;++_)for(var N=h+_*r-l,E=m;E<g;++E)w+=e.get(x,N,f+E*o-u,v)*t.get(x,_,E,y);s.set(w,h,f,v,b)}return s.toTensor()},e.prototype.tile=function(e,t){this.assertNotComplex(e,"tile");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=zo(n,e.dtype),i=e.buffer();for(r=0;r<o.values.length;++r){for(var a=o.indexToLoc(r),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=a[u]%e.shape[u];var l=i.locToIndex(s);o.values[r]=i.values[l]}return o.toTensor()},e.prototype.pad=function(e,t,n){this.assertNotComplex(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),o=t.map((function(e){return e[0]})),i=e.buffer(),a=zo(r,e.dtype);0!==n&&a.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),l=u.map((function(e,t){return e+o[t]}));a.set.apply(a,[e.get.apply(e,u)].concat(l))}return a.toTensor()},e.prototype.transpose=function(e,t){this.assertNotComplex(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var o=e.dataSync(),i=zo(n,e.dtype),a=e.buffer();for(r=0;r<e.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),l=0;l<u.length;l++)u[l]=s[t[l]];var c=i.locToIndex(u);i.values[c]=o[r]}return i.toTensor()},e.prototype.gather=function(e,t,n){this.assertNotComplex([e,t],"gather");var r=e.shape.slice(),o=t.dataSync();r[n]=o.length;for(var i=zo(r,e.dtype),a=e.buffer(),s=0;s<i.size;++s){var u=i.indexToLoc(s),l=u.slice();l[n]=o[u[n]];var c=a.locToIndex(l);i.values[s]=a.values[c]}return i.toTensor()},e.prototype.batchToSpaceND=function(e,t,n){this.assertNotComplex([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),o=Le(e.shape,t,r),i=Ve(o.length,t.length),a=Fe(e.shape,t,r),s=ze(n,t.length),u=Be(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},e.prototype.spaceToBatchND=function(e,t,n){this.assertNotComplex([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=Le(a.shape,t,r,!1),u=Ve(s.length,t.length,!1),l=Fe(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},e.prototype.pool=function(e,t,n){this.assertNotComplex(e,"pool");for(var r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=e.dataSync(),d=zo(t.outShape,e.dtype),f=d.values,m=t.outShape[1]*t.outShape[2]*t.outShape[3],g=t.outShape[2]*t.outShape[3],y=t.outShape[3],v=0;v<t.batchSize;++v)for(var b=v*m,w=v*e.strides[0],x=0;x<t.inChannels;++x)for(var _=0;_<t.outHeight;++_)for(var N=_*r-l,E=Math.max(0,N),C=Math.min(t.inHeight,s+N),I=b+_*g,O=0;O<t.outWidth;++O){for(var S=O*o-c,k=Math.max(0,S),T=Math.min(t.inWidth,u+S),A=h,P=0,D=0,R=E;R<C;R+=i){for(var M=w+R*e.strides[1],j=k;j<T;j+=a){var L=p[M+j*e.strides[2]+x];"max"===n&&L>A?A=L:"avg"===n&&(P+=L,D++)}if(isNaN(A))break}f[I+O*y+x]="avg"===n?P/D:A}return d.toTensor()},e.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},e.prototype.maxPoolPositions=function(e,t){for(var n=zo(t.outShape,"int32"),r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,h=0;h<t.batchSize;++h)for(var p=0;p<t.inChannels;++p)for(var d=0;d<t.outHeight;++d){for(var f=d*r-l,m=f;m<0;)m+=i;for(var g=Math.min(t.inHeight,s+f),y=0;y<t.outWidth;++y){for(var v=y*o-c,b=v;b<0;)b+=a;for(var w=Math.min(t.inWidth,u+v),x=Number.NEGATIVE_INFINITY,_=-1,N=m;N<g;N+=i)for(var E=N-f,C=b;C<w;C+=a){var I=C-v,O=e.get(h,N,C,p);O>x&&(x=O,_=E*u+I)}n.set(_,h,d,y,p)}}return n.toTensor()},e.prototype.maxPoolBackprop=function(e,t,n,r){this.assertNotComplex([t,n],"maxPoolBackprop");for(var o=this.maxPoolPositions(t,r),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=c-1-r.padInfo.left,p=l-1-r.padInfo.top,d=zo(t.shape,"float32"),f=0;f<r.batchSize;++f)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.inHeight;++g)for(var y=0;y<r.inWidth;++y){for(var v=g-p,b=y-h,w=0,x=0;x<l;x+=s){var _=(v+x)/i;if(!(_<0||_>=r.outHeight||Math.floor(_)!==_))for(var N=0;N<c;N+=u){var E=(b+N)/a;if(!(E<0||E>=r.outWidth||Math.floor(E)!==E)){var C=l*c-1-o.get(f,_,E,m)===x*c+N?1:0;0!==C&&(w+=e.get(f,_,E,m)*C)}}}d.set(w,f,g,y,m)}return d.toTensor()},e.prototype.avgPoolBackprop=function(e,t,n){this.assertNotComplex([e,t],"avgPoolBackprop");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,p=l-1-n.padInfo.top,d=zo(t.shape,"float32"),f=1/(i*a),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var v=0;v<n.inWidth;++v){for(var b=y-p,w=v-h,x=0,_=0;_<l;_+=s){var N=(b+_)/r;if(!(N<0||N>=n.outHeight||Math.floor(N)!==N))for(var E=0;E<c;E+=u){var C=(w+E)/o;C<0||C>=n.outWidth||Math.floor(C)!==C||(x+=e.get(m,N,C,g))}}d.set(x*f,m,y,v,g)}return d.toTensor()},e.prototype.cast=function(e,t){return Ft(e,t,this)},e.prototype.reshape=function(e,t){return zt(e,t)},e.prototype.avgPool=function(e,t){return this.assertNotComplex(e,"avgPool"),this.pool(e,t,"avg").toFloat()},e.prototype.resizeBilinear=function(e,t,n,r){this.assertNotComplex(e,"resizeBilinear");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],l=e.dataSync(),c=new Float32Array(w([i,t,n,u])),h=[r&&t>1?a-1:a,r&&n>1?s-1:s],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=0,f=h[0]/p[0],m=h[1]/p[1],g=0;g<i;g++)for(var y=0;y<t;y++)for(var v=f*y,b=Math.floor(v),x=v-b,_=Math.min(a-1,Math.ceil(v)),N=g*e.strides[0]+b*e.strides[1],E=g*e.strides[0]+_*e.strides[1],C=0;C<n;C++)for(var I=m*C,O=Math.floor(I),S=I-O,k=Math.min(s-1,Math.ceil(I)),T=N+O*e.strides[2],A=E+O*e.strides[2],P=N+ +k*e.strides[2],D=E+k*e.strides[2],R=0;R<u;R++){var M=l[T+R],j=l[A+R],L=M+(l[P+R]-M)*S;c[d++]=L+(j+(l[D+R]-j)*S-L)*x}return ft(c,[i,t,n,u])},e.prototype.resizeBilinearBackprop=function(e,t,n){this.assertNotComplex([e,t],"resizeBilinearBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],h=new Float32Array(o*i*a*s),p=[n&&l>1?i-1:i,n&&c>1?a-1:a],d=[n&&l>1?l-1:l,n&&c>1?c-1:c],f=p[0]/d[0],m=p[1]/d[1],g=e.dataSync(),y=0,v=0;v<o;v++)for(var b=v*t.strides[0],w=0;w<l;w++)for(var x=w*f,_=Math.floor(x),N=Math.min(Math.ceil(x),i-1),E=b+_*t.strides[1],C=b+N*t.strides[1],I=x-_,O=1-I,S=0;S<c;S++)for(var k=S*m,T=Math.floor(k),A=Math.min(Math.ceil(k),a-1),P=k-T,D=1-P,R=E+T*t.strides[2],M=E+A*t.strides[2],j=C+T*t.strides[2],L=C+A*t.strides[2],V=O*D,F=O*P,z=I*D,B=I*P,U=0;U<s;U++){var W=g[y++];h[R+U]+=W*V,h[M+U]+=W*F,h[j+U]+=W*z,h[L+U]+=W*B}return bt(h,[o,a,i,s],t.dtype)},e.prototype.resizeNearestNeighbor=function(e,t,n,r){this.assertNotComplex(e,"resizeNearestNeighbor");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],l=e.dataSync(),c=new Float32Array(i*t*n*u),h=[r&&t>1?a-1:a,r&&n>1?s-1:s],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=h[0]/p[0],f=h[1]/p[1],m=0,g=0;g<i;g++)for(var y=g*e.strides[0],v=0;v<t;v++)for(var b=d*v,w=y+Math.min(a-1,r?Math.round(b):Math.floor(b))*e.strides[1],x=0;x<n;x++)for(var _=f*x,N=w+Math.min(s-1,r?Math.round(_):Math.floor(_))*e.strides[2],E=0;E<u;E++)c[m++]=l[N+E];return ft(c,[i,t,n,u],e.dtype)},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){this.assertNotComplex([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],h=new Float32Array(o*i*a*s),p=e.dataSync(),d=[n&&l>1?i-1:i,n&&c>1?a-1:a],f=[n&&l>1?l-1:l,n&&c>1?c-1:c],m=d[0]/f[0],g=d[1]/f[1],y=1/m,v=1/g,b=2*Math.ceil(y)+2,w=2*Math.ceil(v)+2,x=0;x<o;x++)for(var _=x*t.strides[0],N=0;N<i;N++)for(var E=_+N*t.strides[1],C=Math.floor(N*y),I=Math.floor(C-b/2),O=0;O<a;O++)for(var S=E+O*t.strides[2],k=Math.floor(O*v),T=Math.floor(k-w/2),A=0;A<s;A++){for(var P=0,D=0;D<b;D++){var R=D+I;if(!(R<0||R>=l)){var M=_+R*e.strides[1],j=R*m;if(N===Math.min(i-1,n?Math.round(j):Math.floor(j)))for(var L=0;L<w;L++){var V=L+T;if(!(V<0||V>=c)){var F=M+V*e.strides[2],z=V*g;O===Math.min(a-1,n?Math.round(z):Math.floor(z))&&(P+=p[F+A])}}}}h[S+A]=P}return bt(h,t.shape,t.dtype)},e.prototype.batchNormalization=function(e,t,n,r,o,i){this.assertNotComplex([e,t,n,o,i],"batchNormalization");for(var a=e.dataSync(),s=t.dataSync(),u=n.dataSync(),l=o?o.dataSync():new Float32Array([1]),c=i?i.dataSync():new Float32Array([0]),h=new Float32Array(a.length),p=c.length,d=l.length,f=u.length,m=s.length,g=0,y=0,v=0,b=0,w=0;w<a.length;++w)h[w]=c[g++]+(a[w]-s[y++])*l[v++]/Math.sqrt(u[b++]+r),g>=p&&(g=0),y>=m&&(y=0),v>=d&&(v=0),b>=f&&(b=0);return bt(h,e.shape)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){this.assertNotComplex(e,"localResponseNormalization4D");var i=e.shape[3],a=i-1,s=e.dataSync(),u=w(e.shape),l=new Float32Array(u);function c(e){for(var n=e%i,r=e-n+Math.max(0,n-t),o=e-n+Math.min(n+t,a),u=0;r<=o;r++){var l=s[r];u+=l*l}return u}for(var h=0;h<u;h++){var p=c(h),d=s[h]*Math.pow(n+r*p,-o);l[h]=d}return bt(l,e.shape)},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){this.assertNotComplex(e,"LRNGrad");for(var s=e.shape[3],u=e.dataSync(),l=t.dataSync(),c=n.dataSync(),h=new Float32Array(w(e.shape)),p=w(e.shape),d=0;d<p;d++){for(var f=d%s,m=d-f+Math.max(0,f-r),g=d-f+Math.min(s,f+r+1),y=0,v=m;v<g;v++)y+=Math.pow(l[v],2);for(y=i*y+o,v=m;v<g;v++){var b=-2*i*a*l[v]*c[d]/y;d===v&&(b+=Math.pow(y,-a)),h[v]+=b*=u[d]}}return bt(h,e.shape)},e.prototype.multinomial=function(e,t,n,r){this.assertNotComplex(e,"multinomial");for(var o=t?e:lt(e),i=o.shape[0],a=o.shape[1],s=Nt([i,n],"int32"),u=s.dataSync(),l=o.dataSync(),c=0;c<i;++c){var h=c*a,p=new Float32Array(a-1);p[0]=l[h];for(var d=1;d<p.length;++d)p[d]=p[d-1]+l[h+d];for(var f=Lo(r.toString()),m=c*n,g=0;g<n;++g){var y=f();u[m+g]=p.length;for(var v=0;v<p.length;v++)if(y<p[v]){u[m+g]=v;break}}}return s},e.prototype.oneHot=function(e,t,n,r){this.assertNotComplex(e,"oneHot");var o=new Float32Array(e.size*t);o.fill(r);for(var i=0;i<e.size;++i)e.get(i)>=0&&e.get(i)<t&&(o[i*t+e.get(i)]=n);return yt(o,[e.size,t],"int32")},e.prototype.nonMaxSuppression=function(e,t,n,r,o){return this.assertNotComplex(e,"nonMaxSuppression"),qt(e.dataSync(),t.dataSync(),n,r,o)},e.prototype.fft=function(e){return this.fftBatch(e,!1)},e.prototype.ifft=function(e){return this.fftBatch(e,!0)},e.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],o=zo(e.shape,"float32"),i=zo(e.shape,"float32"),a=pt(e).as2D(n,r),s=dt(e).as2D(n,r),u=0;u<n;u++)for(var l=a.slice([u,0],[1,r]),c=s.slice([u,0],[1,r]),h=ht(l,c),p=this.fftImpl(h,t).dataSync(),d=0;d<r;d++){var f=Ut(p,d);o.values[u*r+d]=f.real,i.values[u*r+d]=f.imag}return ht(o.toTensor(),i.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var o=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(o=ht(pt(o).div(mt(r)),dt(o).div(mt(r)))),o}var i=e.dataSync(),a=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return ht(a.real,a.imag).as2D(e.shape[0],e.shape[1])},e.prototype.isExponentOf2=function(e){return 0==(e&e-1)},e.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=e.dataSync(),o=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=0;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),a=ht(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=2;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),u=ht(s.real,s.imag).as1D();a=this.fftRadix2(a,o,n),u=this.fftRadix2(u,o,n);var l=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),o=0;o<Math.ceil(e/2);o++){var i=(t?2:-2)*Math.PI*(o/e);n[o]=Math.cos(i),r[o]=Math.sin(i)}return{real:n,imag:r}}(t,n),c=ht(l.real,l.imag).mul(u),h=a.add(c),p=a.sub(c),d=pt(h).concat(pt(p)),f=dt(h).concat(dt(p));return ht(d,f).as1D()},e.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),o=0;o<t;o++){for(var i=0,a=0,s=0;s<t;s++){var u=$t(o*s,t,n),l=Ut(e,s);i+=l.real*u.real-l.imag*u.imag,a+=l.real*u.imag+l.imag*u.real}n&&(i/=t,a/=t),Wt(r,i,a,o)}return r},e.prototype.depthToSpace=function(e,t,n){g("NHWC"===n,"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n),g(t>1,"blockSize should be > 1 for depthToSpace, but was: "+t);for(var r=e.shape[0],o=e.shape[1],i=e.shape[2],a=e.shape[3],s=o*t,u=i*t,l=a/(t*t),c=e.dataSync(),h=new Float32Array(r*s*u*l),p=0,d=0;d<r;++d)for(var f=0;f<s;++f)for(var m=Math.floor(f/t),y=f%t,v=0;v<u;++v)for(var b=Math.floor(v/t),w=(y*t+v%t)*l,x=0;x<l;++x)h[p++]=c[x+w+a*(b+i*(m+o*d))];return bt(h,[r,s,u,l])},e.prototype.broadcastedBinaryOp=function(e,t,n,r){var o=Yt(e.shape,t.shape),i=zo(o,n),a=e.dataSync(),s=t.dataSync(),u=Qt(e.shape,o),l=Qt(t.shape,o),c=i.values;if(u.length+l.length===0)for(var h=0;h<c.length;++h)c[h]=r(a[h%a.length],s[h%s.length]);else{var p=e.buffer(),d=t.buffer(),f=function(n){var o=i.indexToLoc(n),h=o.slice(-e.rank);u.forEach((function(e){return h[e]=0}));var f=p.locToIndex(h),m=o.slice(-t.rank);l.forEach((function(e){return m[e]=0}));var g=d.locToIndex(m);c[n]=r(a[f],s[g])};for(h=0;h<c.length;++h)f(h)}return i.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=Yt(e.shape,t.shape),o=zo(r,"float32"),i=zo(r,"float32"),a=e.dataSync(),s=t.dataSync(),u=Qt(e.shape,r),l=Qt(t.shape,r),c=o.values,h=i.values;if(u.length+l.length===0)for(var p=0;p<c.length;p++){var d=p%a.length,f=p%s.length,m=n(a[2*d],a[2*d+1],s[2*f],s[2*f+1]);c[p]=m.real,h[p]=m.imag}else{var g=this.data.get(e.dataId).complexTensors.real.buffer(),y=this.data.get(t.dataId).complexTensors.real.buffer(),v=function(r){var i=o.indexToLoc(r),p=i.slice(-e.rank);u.forEach((function(e){return p[e]=0}));var d=g.locToIndex(p),f=i.slice(-t.rank);l.forEach((function(e){return f[e]=0}));var m=y.locToIndex(f),v=n(a[2*d],a[2*d+1],s[2*m],s[2*m+1]);c[r]=v.real,h[r]=v.imag};for(p=0;p<c.length;p++)v(p)}return this.complex(o.toTensor(),i.toTensor())},e.prototype.split=function(e,t,n){return Gt(e,t,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.cropAndResize=function(e,t,n,r,o,i){for(var a=e.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=t.shape[0],p=r[0],d=r[1],f=zo([h,p,d,c],e.dtype),m=t.dataSync(),g=n.dataSync(),y=e.dataSync(),v=e.strides,b=f.strides,w=0;w<h;w++){var x=4*w,_=m[x],N=m[x+1],E=m[x+2],C=m[x+3],I=g[w];if(!(I>=s))for(var O=p>1?(E-_)*(u-1)/(p-1):0,S=d>1?(C-N)*(l-1)/(d-1):0,k=0;k<p;k++){var T=p>1?_*(u-1)+k*O:.5*(_+E)*(u-1);if(T<0||T>u-1)for(var A=0;A<d;A++)for(var P=0;P<c;P++){var D=P+A*b[2]+k*b[1]+w*b[0];f.values[D]=i}else if("bilinear"===o){var R=Math.floor(T),M=Math.ceil(T),j=T-R;for(A=0;A<d;A++)if((q=d>1?N*(l-1)+A*S:.5*(N+C)*(l-1))<0||q>l-1)for(P=0;P<c;P++)f.values[D=P+A*b[2]+k*b[1]+w*b[0]]=i;else{var L=Math.floor(q),V=Math.ceil(q),F=q-L;for(P=0;P<c;P++){var z=y[D=P+L*v[2]+R*v[1]+I*v[0]],B=y[D=P+V*v[2]+R*v[1]+I*v[0]],U=y[D=P+L*v[2]+M*v[1]+I*v[0]],W=z+(B-z)*F,$=U+(y[D=P+V*v[2]+M*v[1]+I*v[0]]-U)*F;f.values[D=P+A*b[2]+k*b[1]+w*b[0]]=W+($-W)*j}}}else for(A=0;A<d;++A){var q;if((q=d>1?N*(l-1)+A*S:.5*(N+C)*(l-1))<0||q>l-1)for(P=0;P<c;P++)f.values[D=P+A*b[2]+k*b[1]+w*b[0]]=i;else{var H=Math.round(q),G=Math.round(T);for(P=0;P<c;P++)f.values[P+A*b[2]+k*b[1]+w*b[0]]=y[P+H*v[2]+G*v[1]+I*v[0]]}}}}return f.toTensor()},e.prototype.sparseToDense=function(e,t,n,r){var o=et(0,e,n);return this.scatter(e,t,n,o.outputSize,o.sliceSize,o.numUpdates,o.sliceRank,o.strides,r,!1)},e.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Qe(e,t),i=o[0],a=o[1],s=o[2],u=o[3];if(0===a)return ft([],i,e.dtype);for(var l=new te([a,s],e.dtype),c=t.dataSync(),h=e.dataSync(),p=0;p<a;p++){for(var d=[],f=0,m=0;m<r;m++){var g=c[p*r+m];f+=g*u[m],d.push(g)}if(f<0||f>=e.size/s)throw new Error("Invalid indices: "+d+" does not index into "+e.shape);for(var y=0;y<s;y++)l.values[p*s+y]=h[f*s+y]}return l.toTensor().reshape(i)},e.prototype.scatterND=function(e,t,n){var r=et(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=mt(0);return this.scatter(e,t,n,u,a,i,o,s,l,!0)},e.prototype.scatter=function(e,t,n,r,o,i,a,s,u,l){var c=[r/o,o],h=e.dataSync(),p=t.dataSync();if(0===r)return ft([],n,t.dtype);var d=new te(c,t.dtype);d.values.fill(u.dataSync()[0]);for(var f=0;f<i;f++){for(var m=[],g=0,y=0;y<a;y++){var v=h[f*a+y];m.push(v),g+=v*s[y]}if(g<0||g>=r/o)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<o;b++)l?d.values[g*o+b]+=p[f*o+b]:d.values[g*o+b]=0===t.rank?p[0]:p[f*o+b]}return d.toTensor().reshape(n)},e}();_e.registerBackend("cpu",(function(){return new Nu}),1,oe);var Eu="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:setImmediate;function Cu(){return new Promise((function(e){return Eu((function(){return e()}))}))}var Iu={float32:4,int32:4,uint16:2,uint8:1,bool:1};function Ou(e,t){for(var n={},r=0,o=function(t){var o=t.name,i=t.dtype,a=t.shape,s=w(a),u=void 0;if("quantization"in t){var l=t.quantization;if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+l.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=Iu[l.dtype],h=e.slice(r,r+s*c),p="uint8"===l.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===i)u=Float32Array.from(p,(function(e){return e*l.scale+l.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=Int32Array.from(p,(function(e){return Math.round(e*l.scale+l.min)}))}r+=s*c}else{var d=Iu[i];if(h=e.slice(r,r+s*d),"float32"===i)u=new Float32Array(h);else if("int32"===i)u=new Int32Array(h);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=new Uint8Array(h)}r+=s*d}var f=void 0;if("float32"===i)f=ft(u,a,"float32");else if("int32"===i)f=ft(u,a,"int32");else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);f=ft(u,a,"bool")}n[o]=f},i=0,a=t;i<a.length;i++)o(a[i]);return n}function Su(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),o=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),r.buffer}var ku="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Tu(e){return ku?Buffer.byteLength(e):new Blob([e]).size}function Au(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Pu(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Du(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Tu(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Tu(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var Ru=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t){return e.getHandlers(t,"load")},e.getHandlers=function(e,t){var n=[];return("load"===t?this.getInstance().loadRouters:this.getInstance().saveRouters).forEach((function(t){var r=t(e);null!==r&&n.push(r)})),n},e}(),Mu="://",ju=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){g(null!=t,"scheme must not be undefined or null."),t.endsWith(Mu)&&(t=t.slice(0,t.indexOf(Mu))),g(t.length>0,"scheme must not be an empty string.");var r=e.getInstance();g(null==r.managers[t],"A model store manager is already registered for scheme '"+t+"'."),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Lu(e){if(-1===e.indexOf(Mu))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+ju.getSchemes().join(","));return{scheme:e.split(Mu)[0],path:e.split(Mu)[1]}}function Vu(e,t,n){return void 0===n&&(n=!1),a(this,void 0,void 0,(function(){var r,o,i,a,u,l,c,h,p;return s(this,(function(s){switch(s.label){case 0:return g(e!==t,"Old path and new path are the same: '"+e+"'"),g((r=Ru.getLoadHandlers(e)).length>0,"Copying failed because no load handler is found for source URL "+e+"."),g(r.length<2,"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."),o=r[0],g((i=Ru.getSaveHandlers(t)).length>0,"Copying failed because no save handler is found for destination URL "+t+"."),g(i.length<2,"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."),a=i[0],u=Lu(e).scheme,l=Lu(e).path,c=u===Lu(e).scheme,[4,o.load()];case 1:return h=s.sent(),n&&c?[4,ju.getManager(u).removeModel(l)]:[3,3];case 2:s.sent(),s.label=3;case 3:return[4,a.save(h)];case 4:return p=s.sent(),!n||c?[3,6]:[4,ju.getManager(u).removeModel(l)];case 5:s.sent(),s.label=6;case 6:return[2,p.modelArtifactsInfo]}}))}))}var Fu="models_store",zu="model_info_store";function Bu(){if(!_e.get("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Uu(e){var t=e.result;t.createObjectStore(Fu,{keyPath:"modelPath"}),t.createObjectStore(zu,{keyPath:"modelPath"})}var Wu=function(){function e(e){if(this.indexedDB=Bu(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Uu(o)},o.onsuccess=function(){var i=o.result;if(null==t){var a=i.transaction(Fu,"readonly"),s=a.objectStore(Fu).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},a.oncomplete=function(){return i.close()}}else{var u,l=Du(t),c=i.transaction(zu,"readwrite"),h=c.objectStore(zu),p=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});p.onsuccess=function(){var o=(u=i.transaction(Fu,"readwrite")).objectStore(Fu).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l});o.onsuccess=function(){return e({modelArtifactsInfo:l})},o.onerror=function(e){var t=(h=c.objectStore(zu)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(o.error)},t.onerror=function(e){return i.close(),r(o.error)}}},p.onerror=function(e){return i.close(),r(p.error)},c.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},o.onerror=function(e){return r(o.error)}}))},e.URL_SCHEME="indexeddb://",e}(),$u=function(e){return _e.get("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Wu.URL_SCHEME)?function(e){return new Wu(e)}(e.slice(Wu.URL_SCHEME.length)):null};Ru.registerSaveRouter($u),Ru.registerLoadRouter($u);var qu=function(){function e(){this.indexedDB=Bu()}return e.prototype.listModels=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Uu(r)},r.onsuccess=function(){var e=r.result,o=e.transaction(zu,"readonly"),i=o.objectStore(zu).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var o=r[n];e[o.modelPath]=o.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},o.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return e=function(e){return e.startsWith(Wu.URL_SCHEME)?e.slice(Wu.URL_SCHEME.length):e}(e),[2,new Promise((function(n,r){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Uu(o)},o.onsuccess=function(){var t,i=o.result,a=i.transaction(zu,"readwrite"),s=a.objectStore(zu),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var o=s.delete(e),a=function(){var o=(t=i.transaction(Fu,"readwrite")).objectStore(Fu).delete(e);o.onsuccess=function(){return n(u.result.modelArtifactsInfo)},o.onerror=function(e){return r(u.error)}};o.onsuccess=a,o.onerror=function(e){return a(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},a.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},o.onerror=function(e){return r(o.error)}}))]}))}))},e}();if(_e.get("IS_BROWSER"))try{ju.registerManager(Wu.URL_SCHEME,new qu)}catch(he){}var Hu="/",Gu="tensorflowjs_models",Ku="info",Xu="model_topology",Zu="weight_specs",Qu="weight_data";function Ju(e){return{info:[Gu,e,Ku].join(Hu),topology:[Gu,e,Xu].join(Hu),weightSpecs:[Gu,e,Zu].join(Hu),weightData:[Gu,e,Qu].join(Hu)}}function Yu(e){var t=e.split(Hu);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Hu)}var el=function(){function e(e){if(!_e.get("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Ju(this.modelPath)}return e.prototype.save=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Du(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){return ku?Buffer.from(e).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}(e.weightData)),[2,{modelArtifactsInfo:r}]}catch(e){for(o in this.keys)this.LS.removeItem(this.keys[o]);throw new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o;return s(this,(function(i){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(ku){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(o),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),tl=function(e){return _e.get("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(el.URL_SCHEME)?function(e){return new el(e)}(e.slice(el.URL_SCHEME.length)):null};Ru.registerSaveRouter(tl),Ru.registerLoadRouter(tl);var nl=function(){function e(){g(_e.get("IS_BROWSER"),"Current environment is not a web browser"),g(void 0!==window.localStorage,"Current browser does not appear to support localStorage"),this.LS=window.localStorage}return e.prototype.listModels=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return s(this,(function(a){for(e={},t=Gu+Hu,n=Hu+Ku,r=0;r<this.LS.length;++r)(o=this.LS.key(r)).startsWith(t)&&o.endsWith(n)&&(i=Yu(o),e[i]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},e.prototype.removeModel=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){if(e=function(e){return e.startsWith(el.URL_SCHEME)?e.slice(el.URL_SCHEME.length):e}(e),t=Ju(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(_e.get("IS_BROWSER"))try{ju.registerManager(el.URL_SCHEME,new nl)}catch(he){}var rl="model",ol=".json",il=".weights.bin",al=function(){function e(t){if(!_e.get("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=rl),this.modelTopologyFileName=t+ol,this.weightDataFileName=t+il}return e.prototype.save=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(i){if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:e.modelTopology,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,r.click(),null!=e.weightData&&((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=t,o.click()),[2,{modelArtifactsInfo:Du(e)}]}))}))},e.URL_SCHEME="downloads://",e}(),sl=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return a(this,void 0,void 0,(function(){var e,t,n=this;return s(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,o){var i=new FileReader;i.onload=function(i){var a=JSON.parse(i.target.result),s=a.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var l;try{l=n.checkManifestAndWeightFiles(u,t)}catch(e){return void o(e)}var c=[],h=[],p=[];u.forEach((function(e){e.paths.forEach((function(e){h.push(e),p.push(null)})),c.push.apply(c,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,o=h.indexOf(e);p[o]=n,-1===p.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:Au(p)})},t.onerror=function(t){return o("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(l[e])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return Pu(e.name)})),o={},i=0,a=e;i<a.length;i++)a[i].paths.forEach((function(e){var i=Pu(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");o[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return o},e}();function ul(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return n=e.map((function(e){return fetch(e,t)})),[4,Promise.all(n)];case 1:return r=o.sent(),[4,Promise.all(r.map((function(e){return e.arrayBuffer()})))];case 2:return[2,o.sent()]}}))}))}function ll(e){var t=this;return function(n,r,o){return void 0===r&&(r=""),a(t,void 0,void 0,(function(){var t,i,a,u,l,c,h,p,d,f;return s(this,(function(s){switch(s.label){case 0:if(t=n.map((function(){return!1})),i={},a=null!=o?o.map((function(){return!1})):[],u=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var s=Iu["quantization"in e?e.quantization.dtype:e.dtype]*w(e.shape),l=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:s})};null!=o?o.forEach((function(t,n){t===e.name&&(l(),a[n]=!0)})):l(),u.push(e.name),r+=s}))})),!a.every((function(e){return e})))throw l=o.filter((function(e,t){return!a[t]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return c=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],c.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),[4,e(h)];case 1:return p=s.sent(),d={},f=0,c.forEach((function(e){for(var t=n[e].paths.length,r=0,o=0;o<t;o++)r+=p[f+o].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,l=0;l<t;l++){var c=new Uint8Array(p[f+l]);s.set(c,u),u+=c.byteLength}i[e].forEach((function(e){var t=Ou(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]})),f+=t})),[2,d]}}))}))}}Ru.registerSaveRouter((function(e){return _e.get("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(al.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new al(e)}(e.slice(al.URL_SCHEME.length)):null}));var cl=function(){function e(e,t,n){if(this.weightPathPrefix=n,this.DEFAULT_METHOD="POST","undefined"==typeof fetch)throw new Error("browserHTTPRequest is not supported outside the web browser without a fetch polyfill.");if(g(null!=e&&e.length>0,"URL path for browserHTTPRequest must not be null, undefined or empty."),Array.isArray(e)&&g(2===e.length,"URL paths for browserHTTPRequest must have a length of 2, (actual length is "+e.length+")."),this.path=e,null!=t&&null!=t.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t||{}}return e.prototype.save=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,t.body.append("model.json",new Blob([JSON.stringify({modelTopology:e.modelTopology,weightsManifest:[{paths:["./model.weights.bin"],weights:e.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,fetch(this.path,t)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:Du(e),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},e.prototype.load=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,Array.isArray(this.path)?this.loadBinaryModel():this.loadJSONModel()]}))}))},e.prototype.loadBinaryTopology=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch(this.path[0],this.requestInit)];case 1:if(!(e=n.sent()).ok)throw new Error("BrowserHTTPRequest.load() failed due to HTTP response: "+e.statusText);return[4,e.arrayBuffer()];case 2:return[2,n.sent()];case 3:throw t=n.sent(),new Error(this.path[0]+" not found. "+t);case 4:return[2]}}))}))},e.prototype.loadBinaryModel=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,u;return s(this,(function(s){switch(s.label){case 0:return e=this.loadBinaryTopology(),[4,fetch(this.path[1],this.requestInit)];case 1:if(!(t=s.sent()).ok)throw new Error("BrowserHTTPRequest.load() failed due to HTTP response: "+t.statusText);return[4,Promise.all([e,t])];case 2:return n=s.sent(),r=n[0],[4,n[1].json()];case 3:return null==(o=s.sent())?[3,5]:[4,this.loadWeights(o)];case 4:u=s.sent(),i=u[0],a=u[1],s.label=5;case 5:return[2,{modelTopology:r,weightSpecs:i,weightData:a}]}}))}))},e.prototype.loadJSONModel=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:return[4,fetch(this.path,this.requestInit)];case 1:if(!(e=s.sent()).ok)throw new Error("BrowserHTTPRequest.load() failed due to HTTP response: "+e.statusText);return[4,e.json()];case 2:if(t=s.sent(),r=t.weightsManifest,null==(n=t.modelTopology)&&null==r)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==r?[3,4]:[4,this.loadWeights(t.weightsManifest)];case 3:a=s.sent(),o=a[0],i=a[1],s.label=4;case 4:return[2,{modelTopology:n,weightSpecs:o,weightData:i}]}}))}))},e.prototype.loadWeights=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,l,c,h,p;return s(this,(function(s){switch(s.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],o=n[1],i=this.weightPathPrefix||r,a=[],u=0,l=e;u<l.length;u++)a.push.apply(a,l[u].weights);return c=[],e.forEach((function(e){e.paths.forEach((function(e){c.push(i+e+o)}))})),h=[a],p=Au,[4,ul(c,this.requestInit)];case 1:return[2,h.concat([p.apply(void 0,[s.sent()])])]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function hl(e){return null!=e.match(cl.URL_SCHEME_REGEX)}var pl=function(e){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return hl(e)})):hl(e))?dl(e):null};function dl(e,t,n){return new cl(e,t,n)}Ru.registerSaveRouter(pl),Ru.registerLoadRouter(pl);var fl=function(){function e(e,t,n){this.modelTopology=e,this.weightSpecs=t,this.weightData=n}return e.prototype.load=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){return e={},null!=this.modelTopology&&(e=i({modelTopology:this.modelTopology},e)),null!=this.weightSpecs&&this.weightSpecs.length>0&&(e=i({weightSpecs:this.weightSpecs},e)),null!=this.weightData&&this.weightData.byteLength>0&&(e=i({weightData:this.weightData},e)),[2,e]}))}))},e}(),ml=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),gl=Object.freeze({browserFiles:function(e){return new sl(e)},browserHTTPRequest:dl,concatenateArrayBuffers:Au,decodeWeights:Ou,encodeWeights:function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(i){switch(i.label){case 0:for(r in t=[],n=[],e){if("float32"!==(o=e[r]).dtype&&"int32"!==o.dtype&&"bool"!==o.dtype)throw new Error("Unsupported dtype in weight '"+r+"': "+o.dtype);t.push({name:r,shape:o.shape,dtype:o.dtype}),n.push(o.data())}return[4,Promise.all(n)];case 1:return[2,{data:Su(i.sent()),specs:t}]}}))}))},fromMemory:function(e,t,n){return new fl(e,t,n)},getLoadHandlers:Ru.getLoadHandlers,getModelArtifactsInfoForJSON:Du,getSaveHandlers:Ru.getSaveHandlers,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),a(this,void 0,void 0,(function(){return s(this,(function(o){return[2,ll((function(e){return ul(e,r)}))(e,t,n)]}))}))},registerLoadRouter:Ru.registerLoadRouter,registerSaveRouter:Ru.registerSaveRouter,weightsLoaderFactory:ll,withSaveHandler:function(e){return new ml(e)},copyModel:function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,Vu(e,t,!1)];case 1:return[2,n.sent()]}}))}))},listModels:function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:e=ju.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?[4,ju.getManager(o=r[n]).listModels()]:[3,4];case 2:for(a in i=s.sent())t[o+Mu+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,Vu(e,t,!0)];case 1:return[2,n.sent()]}}))}))},removeModel:function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Lu(e),[4,ju.getManager(t.scheme).removeModel(t.path)];case 1:return[2,n.sent()]}}))}))}}),yl=ut({confusionMatrix_:function(e,t,n){var r=at(e,"labels","confusionMatrix"),o=at(t,"predictions","confusionMatrix");g(null==n||n>0&&Number.isInteger(n),"If provided, numClasses must be a positive integer, but got "+n),g(1===r.rank,"Expected the rank of labels to be 1, but got "+r.rank),g(1===o.rank,"Expected the rank of predictions to be 1, but got "+o.rank),g(r.shape[0]===o.shape[0],"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."),g(n>0&&Number.isInteger(n),"numClasses is required to be a positive integer, but got "+n);var i=Qo(r.asType("int32"),n),a=Qo(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}}),vl=Object.freeze({confusionMatrix:yl}),bl=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),wl=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function xl(e){g(null!=e.className,"Class being registered does not have the static className property defined."),g("string"==typeof e.className,"className is required to be a string, but got type "+typeof e.className),g(e.className.length>0,"Class being registered has an empty-string as its className, which is disallowed."),wl.register(e)}var _l=Object.freeze({Serializable:bl,SerializationMap:wl,registerClass:xl});function Nl(e,t,n){return null==n&&(n=_e.get("TEST_EPSILON")),El(e,t,(function(e,t){return Cl(e,Number(t),n)}))}function El(e,t,n){if(e instanceof ie||t instanceof ie){if(e instanceof ie&&t instanceof ie){if(e.dtype!==t.dtype)throw new Error("Arrays are of different type actual: "+e.dtype+" vs expected: "+t.dtype+".");if(!x(e.shape,t.shape))throw new Error("Arrays are of different shape actual: "+e.shape+" vs expected: "+t.shape+".")}}else{var r=e.constructor.name,o=t.constructor.name;if(r!==o)throw new Error("Arrays are of different type actual: "+r+" vs expected: "+o)}var i,a;if(i=e instanceof ie?e.dataSync():e,a=t instanceof ie?t.dataSync():t,i.length!==a.length)throw new Error("Arrays have different lengths actual: "+i.length+" vs expected: "+a.length+".\nActual:   "+i+".\nExpected: "+a+".");for(var s=0;s<a.length;++s){var u=i[s],l=a[s];if(!n(u,l))throw new Error("Arrays differ: actual["+s+"] = "+u+", expected["+s+"] = "+l+".\nActual:   "+i+".\nExpected: "+a+".")}}function Cl(e,t,n){return!(!isNaN(e)||!isNaN(t))||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var Il=Object.freeze({WEBGL_ENVS:{HAS_WEBGL:!0},NODE_ENVS:{IS_NODE:!0},CHROME_ENVS:{IS_CHROME:!0},BROWSER_ENVS:{IS_BROWSER:!0},CPU_ENVS:{HAS_WEBGL:!1},ALL_ENVS:{},expectArraysClose:Nl,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){return e instanceof ie&&"string"===e.dtype||t instanceof ie&&"string"===t.dtype||e instanceof Array&&L(e[0])||t instanceof Array&&L(t[0])?El(e,t,(function(e,t){return e==t})):Nl(e,t,0)},expectNumbersClose:function(e,t,n){if(null==n&&(n=_e.get("TEST_EPSILON")),!Cl(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){var r;r=e instanceof ie?e.dataSync():e;for(var o=0;o<r.length;o++)if(r[o]<t||r[o]>n)throw new Error("Value out of range:"+r[o]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Ol="0.14.0",Sl=Object.freeze({gpgpu_util:Ur,webgl_util:xr,MathBackendWebGL:gi,GPGPUContext:Wr}),kl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,i=r.grads;return this.applyGradients(i),Object.keys(i).forEach((function(e){return i[e].dispose()})),t?o:(o.dispose(),null)},t.prototype.computeGradients=function(e,t){return Se(e,t)},t}(bl),Tl=function(e){function t(t,n,r){void 0===r&&(r=null);var o=e.call(this)||this;return o.learningRate=t,o.rho=n,o.epsilon=r,o.accumulatedGrads={},o.accumulatedUpdates={},o.c=Pe(mt(-t)),o.rhoScalar=Pe(mt(n)),o.oneMinusRho=Pe(mt(1-n)),null===r&&(r=_e.get("EPSILON")),o.epsilonScalar=Pe(mt(r)),o}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=_e.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&Ae((function(){t.accumulatedGrads[n]=Dt(o).variable(!1)})),null==r.accumulatedUpdates[n]&&Ae((function(){t.accumulatedUpdates[n]=Dt(o).variable(!1)}));var i=e[n],a=r.accumulatedGrads[n],s=r.accumulatedUpdates[n];Ae((function(){var e=t.rhoScalar.mul(a).add(t.oneMinusRho.mul(i.square())),r=s.add(t.epsilonScalar).sqrt().div(a.add(t.epsilonScalar).sqrt()).mul(i),u=t.rhoScalar.mul(s).add(t.oneMinusRho.mul(r.square()));t.accumulatedGrads[n].assign(e),t.accumulatedUpdates[n].assign(u);var l=t.c.mul(r).add(o);o.assign(l)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.rhoScalar.dispose(),this.oneMinusRho.dispose(),null!=this.accumulatedUpdates&&(Object.keys(this.accumulatedUpdates).forEach((function(t){return e.accumulatedUpdates[t].dispose()})),Object.keys(this.accumulatedGrads).forEach((function(t){return e.accumulatedGrads[t].dispose()})))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="AdadeltaOptimizer",t}(kl);xl(Tl);var Al=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads={},r.c=Pe(mt(-t)),r.epsilon=Pe(mt(_e.get("EPSILON"))),r}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=_e.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&Ae((function(){t.accumulatedGrads[n]=Et(o.shape,t.initialAccumulatorValue).variable(!1)}));var i=e[n],a=r.accumulatedGrads[n];Ae((function(){var e=a.add(i.square());t.accumulatedGrads[n].assign(e);var r=t.c.mul(i.div(e.add(t.epsilon).sqrt())).add(o);o.assign(r)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.epsilon.dispose(),this.c.dispose(),null!=this.accumulatedGrads&&Object.keys(this.accumulatedGrads).forEach((function(t){return e.accumulatedGrads[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="AdagradOptimizer",t}(kl);xl(Al);var Pl=function(e){function t(t,n,r,o){void 0===o&&(o=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=o,i.accumulatedFirstMoment={},i.accumulatedSecondMoment={},i.c=Pe(mt(-t)),i.beta1Scalar=Pe(mt(n)),i.beta2Scalar=Pe(mt(r)),Ae((function(){i.accBeta1=mt(n).variable(),i.accBeta2=mt(r).variable()})),i.oneMinusBeta1=Pe(mt(1-n)),i.oneMinusBeta2=Pe(mt(1-r)),i.one=Pe(mt(1)),null===o&&(o=_e.get("EPSILON")),i.epsScalar=Pe(mt(o)),i}return o(t,e),t.prototype.applyGradients=function(e){var t=this;Ae((function(){var n=t.one.sub(t.accBeta1),r=t.one.sub(t.accBeta2);for(var o in e){var i=_e.engine.registeredVariables[o];if(null==t.accumulatedFirstMoment[o]){var a=!1;t.accumulatedFirstMoment[o]=Dt(i).variable(a)}null==t.accumulatedSecondMoment[o]&&(a=!1,t.accumulatedSecondMoment[o]=Dt(i).variable(a));var s=e[o],u=t.accumulatedSecondMoment[o],l=t.beta1Scalar.mul(t.accumulatedFirstMoment[o]).add(t.oneMinusBeta1.mul(s)),c=t.beta2Scalar.mul(u).add(t.oneMinusBeta2.mul(s.square())),h=l.div(n),p=c.div(r);t.accumulatedFirstMoment[o].assign(l),t.accumulatedSecondMoment[o].assign(c);var d=t.c.mul(h.div(t.epsScalar.add(p.sqrt()))).add(i);i.assign(d)}t.accBeta1.assign(t.accBeta1.mul(t.beta1Scalar)),t.accBeta2.assign(t.accBeta2.mul(t.beta2Scalar))}))},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.accBeta1.dispose(),this.accBeta2.dispose(),this.oneMinusBeta1.dispose(),this.oneMinusBeta2.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach((function(t){return e.accumulatedFirstMoment[t].dispose()})),null!=this.accumulatedSecondMoment&&Object.keys(this.accumulatedSecondMoment).forEach((function(t){return e.accumulatedSecondMoment[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="AdamOptimizer",t}(kl);xl(Pl);var Dl=function(e){function t(t,n,r,o,i){void 0===o&&(o=null),void 0===i&&(i=0);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=o,a.decay=i,a.accumulatedFirstMoment={},a.accumulatedWeightedInfNorm={},a.c=Pe(mt(-t)),a.beta1Scalar=Pe(mt(n)),a.beta2Scalar=Pe(mt(r)),a.decayScalar=Pe(mt(i)),Ae((function(){a.iteration=mt(0).variable(),a.accBeta1=mt(n).variable()})),a.oneMinusBeta1=Pe(mt(1-n)),a.one=Pe(mt(1)),null===o&&(o=_e.get("EPSILON")),a.epsScalar=Pe(mt(o)),a}return o(t,e),t.prototype.applyGradients=function(e){var t=this;Ae((function(){var n=t.one.sub(t.accBeta1),r=t.c.div(t.one.add(t.decayScalar.mul(t.iteration)));for(var o in e){var i=_e.engine.registeredVariables[o];if(null==t.accumulatedFirstMoment[o]){var a=!1;t.accumulatedFirstMoment[o]=Dt(i).variable(a)}null==t.accumulatedWeightedInfNorm[o]&&(a=!1,t.accumulatedWeightedInfNorm[o]=Dt(i).variable(a));var s=e[o],u=t.accumulatedWeightedInfNorm[o],l=t.beta1Scalar.mul(t.accumulatedFirstMoment[o]).add(t.oneMinusBeta1.mul(s)),c=t.beta2Scalar.mul(u),h=s.abs(),p=c.maximum(h);t.accumulatedFirstMoment[o].assign(l),t.accumulatedWeightedInfNorm[o].assign(p);var d=r.div(n).mul(l.div(t.epsScalar.add(p))).add(i);i.assign(d)}t.iteration.assign(t.iteration.add(t.one)),t.accBeta1.assign(t.accBeta1.mul(t.beta1Scalar))}))},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.accBeta1.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.oneMinusBeta1.dispose(),this.decayScalar.dispose(),this.iteration.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach((function(t){return e.accumulatedFirstMoment[t].dispose()})),null!=this.accumulatedWeightedInfNorm&&Object.keys(this.accumulatedWeightedInfNorm).forEach((function(t){return e.accumulatedWeightedInfNorm[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="AdamaxOptimizer",t}(kl);xl(Dl);var Rl=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return o(t,e),t.prototype.applyGradients=function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],o=_e.engine.registeredVariables[n];Ae((function(){var e=t.c.mul(r).add(o);o.assign(e)}))}))},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Pe(mt(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGDOptimizer",t}(kl);xl(Rl);var Ml=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.m=mt(o.momentum),o.accumulations={},o}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=_e.engine.registeredVariables[n];null==r.accumulations[n]&&Ae((function(){t.accumulations[n]=Dt(o).variable(!1)}));var i=r.accumulations[n],a=e[n];Ae((function(){var e,r=t.m.mul(i).add(a);e=t.useNesterov?t.c.mul(a.add(r.mul(t.m))).add(o):t.c.mul(r).add(o),t.accumulations[n].assign(r),o.assign(e)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){if(e.prototype.dispose.call(this),this.m.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="MomentumOptimizer",t}(Rl);xl(Ml);var jl=function(e){function t(t,n,r,o,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1);var a=e.call(this)||this;return a.learningRate=t,a.decay=n,a.momentum=r,a.epsilon=o,a.accumulatedMeanSquares={},a.accumulatedMeanGrads={},a.accumulatedMoments={},a.c=Pe(mt(t)),a.decayScalar=Pe(mt(n)),a.momentumScalar=Pe(mt(r)),a.oneMinusDecay=Pe(mt(1-n)),a.centered=i,null===o&&(o=_e.get("EPSILON")),a.epsilonScalar=Pe(mt(o)),a}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=_e.engine.registeredVariables[n];null==r.accumulatedMeanSquares[n]&&Ae((function(){t.accumulatedMeanSquares[n]=Dt(o).variable(!1)})),null==r.accumulatedMeanGrads[n]&&r.centered&&Ae((function(){t.accumulatedMeanGrads[n]=Dt(o).variable(!1)})),null==r.accumulatedMoments[n]&&Ae((function(){t.accumulatedMoments[n]=Dt(o).variable(!1)}));var i=r.accumulatedMeanSquares[n],a=r.accumulatedMeanGrads[n],s=r.accumulatedMoments[n],u=e[n];Ae((function(){var e=t.decayScalar.mul(i).add(t.oneMinusDecay.mul(u.square()));if(t.centered){var r=t.decayScalar.mul(a).add(t.oneMinusDecay.mul(u)),l=t.momentumScalar.mul(s).add(t.c.mul(u).div(e.sub(r.square().add(t.epsilonScalar)).sqrt()));t.accumulatedMeanSquares[n].assign(e),t.accumulatedMeanGrads[n].assign(r),t.accumulatedMoments[n].assign(l);var c=o.sub(l);o.assign(c)}else{var h=t.decayScalar.mul(i).add(t.oneMinusDecay.mul(u.square()));l=t.momentumScalar.mul(s).add(t.c.mul(u).div(h.add(t.epsilonScalar).sqrt())),t.accumulatedMeanSquares[n].assign(h),t.accumulatedMoments[n].assign(l),c=o.sub(l),o.assign(c)}}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.decayScalar.dispose(),this.momentumScalar.dispose(),this.oneMinusDecay.dispose(),null!=this.accumulatedMeanSquares&&Object.keys(this.accumulatedMeanSquares).forEach((function(t){return e.accumulatedMeanSquares[t].dispose()})),null!=this.accumulatedMeanGrads&&this.centered&&Object.keys(this.accumulatedMeanGrads).forEach((function(t){return e.accumulatedMeanGrads[t].dispose()})),null!=this.accumulatedMoments&&Object.keys(this.accumulatedMoments).forEach((function(t){return e.accumulatedMoments[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSPropOptimizer",t}(kl);xl(jl);var Ll=function(){function e(){}return e.sgd=function(e){return new Rl(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new Ml(e,t,n)},e.rmsprop=function(e,t,n,r,o){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===o&&(o=!1),new jl(e,t,n,r,o)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Pl(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new Tl(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===o&&(o=0),new Dl(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new Al(e,t)},e}(),Vl={sgd:Ll.sgd,momentum:Ll.momentum,adadelta:Ll.adadelta,adagrad:Ll.adagrad,rmsprop:Ll.rmsprop,adamax:Ll.adamax,adam:Ll.adam},Fl=xe.setBackend,zl=xe.getBackend,Bl=xe.disposeVariables,Ul=xe.memory;!function(e){re=e}(_u)},oY9k:function(e,t){e.exports=t=window.fetch,t.default=window.fetch.bind(window),t.Headers=window.Headers,t.Request=window.Request,t.Response=window.Response},tgWb:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FrozenModel})),__webpack_require__.d(__webpack_exports__,"b",(function(){return loadFrozenModel})),__webpack_require__.d(__webpack_exports__,"c",(function(){return loadTfHubModule})),__webpack_require__.d(__webpack_exports__,"d",(function(){return version}));var _tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("Re/O"),__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function __awaiter(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),r=0,o=2,i=!0;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,a){n[r]=function(e){if(i)if(i=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,a(e))}}))}var base64_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),o=new Array(123),i=0;i<64;)o[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;n.encode=function(e,t,n){for(var o,i=null,a=[],s=0,u=0;t<n;){var l=e[t++];switch(u){case 0:a[s++]=r[l>>2],o=(3&l)<<4,u=1;break;case 1:a[s++]=r[o|l>>4],o=(15&l)<<2,u=2;break;case 2:a[s++]=r[o|l>>6],a[s++]=r[63&l],u=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=r[o],a[s++]=61,1===u&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))},n.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var u=e.charCodeAt(s++);if(61===u&&a>1)break;if(void 0===(u=o[u]))throw Error("invalid encoding");switch(a){case 0:r=u,a=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,a=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,a=3;break;case 3:t[n++]=(3&r)<<6|u,a=0}}if(1===a)throw Error("invalid encoding");return n-i},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this};var float_1=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:i,e.writeFloatBE=r?i:o,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),o=2*(r>>31)+1,i=r>>>23&255,a=8388607&r;return 255===i?a?NaN:o*(1/0):0===i?1401298464324817e-60*o*a:o*Math.pow(2,i-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:i,e.writeDoubleBE=r?i:o,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,o,i){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,o,i+t),e(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))e(0,o,i+t),e(2146959360,o,i+n);else if(r>17976931348623157e292)e(0,o,i+t),e((a<<31|2146435072)>>>0,o,i+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,o,i+t),e((a<<31|s/4294967296)>>>0,o,i+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=r*Math.pow(2,-u))>>>0,o,i+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,o,i+n)}}}function n(e,t,n,r,o){var i=e(r,o+t),a=e(r,o+n),s=2*(a>>31)+1,u=a>>>20&2047,l=4294967296*(1048575&a)+i;return 2047===u?l?NaN:s*(1/0):0===u?5e-324*s*l:s*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod$$1=eval("quire".replace(/^/,"re"))(moduleName);if(mod$$1&&(mod$$1.length||Object.keys(mod$$1).length))return mod$$1}catch(e){}return null}var utf8_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],a=0;t<n;)(r=e[t++])<128?i[a++]=r:r>191&&r<224?i[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[a++]=55296+(r>>10),i[a++]=56320+(1023&r)):i[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,i.slice(0,a))),o.join("")):String.fromCharCode.apply(String,i.slice(0,a))},n.write=function(e,t,n){for(var r,o,i=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(a+1)))?(++a,t[n++]=(r=65536+((1023&r)<<10)+(1023&o))>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}})),pool_1=pool;function pool(e,t,n){var r=n||8192,o=r>>>1,i=null,a=r;return function(n){if(n<1||n>o)return e(n);a+n>r&&(i=e(r),a=0);var s=t.call(i,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new LongBits(n,r)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10};var minimal=createCommonjsModule((function(e,t){var n=t;function r(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float_1,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1,n.LongBits=longbits,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=commonjsGlobal.dcodeIO&&commonjsGlobal.dcodeIO.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&null!=this[e[n]])return e[n]}},n.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer.create=minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer},Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var n=Writer.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e};var writer_buffer=BufferWriter$1;(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1;var Buffer=minimal.Buffer;function BufferWriter$1(){writer.call(this)}BufferWriter$1.alloc=function(e){return(BufferWriter$1.alloc=minimal._Buffer_allocUnsafe)(e)};var writeBytesBuffer=Buffer&&Buffer.prototype instanceof Uint8Array&&"set"===Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]};function writeStringBuffer(e,t,n){e.length<40?minimal.utf8.write(e,t,n):t.utf8Write(e,n)}BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},e;function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array,Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(e=4294967295,function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e;var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice),BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))};var service=Service;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,r,o,i){if(!o)throw TypeError("request must be specified");var a=this;if(!i)return minimal.asPromise(e,a,t,n,r,o);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return a.emit("error",e,t),i(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),i(e)}return a.emit("data",n,t),i(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){i(e)}),0)}else setTimeout((function(){i(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule((function(e,t){t.Service=service})),roots={},indexMinimal=createCommonjsModule((function(e,t){var n=t;function r(){n.Reader._configure(n.BufferReader),n.util._configure()}n.build="minimal",n.Writer=writer,n.BufferWriter=writer_buffer,n.Reader=reader,n.BufferReader=reader_buffer,n.util=minimal,n.rpc=rpc_1,n.roots=roots,n.configure=r,n.Writer._configure(n.BufferWriter),r()})),minimal$1=indexMinimal,minimal_1=minimal$1.roots,minimal_2=minimal$1.Reader,minimal_3=minimal$1.util,$Reader=minimal$1.Reader,$util=minimal$1.util,$root=minimal$1.roots.default||(minimal$1.roots.default={});$root.tensorflow=function(){var e,t,n={};return n.Any=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.typeUrl="",e.prototype.value=$util.newBuffer([]),e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.Any;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.typeUrl=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),n.DataType=(e={},(t=Object.create(e))[e[0]="DT_INVALID"]=0,t[e[1]="DT_FLOAT"]=1,t[e[2]="DT_DOUBLE"]=2,t[e[3]="DT_INT32"]=3,t[e[4]="DT_UINT8"]=4,t[e[5]="DT_INT16"]=5,t[e[6]="DT_INT8"]=6,t[e[7]="DT_STRING"]=7,t[e[8]="DT_COMPLEX64"]=8,t[e[9]="DT_INT64"]=9,t[e[10]="DT_BOOL"]=10,t[e[11]="DT_QINT8"]=11,t[e[12]="DT_QUINT8"]=12,t[e[13]="DT_QINT32"]=13,t[e[14]="DT_BFLOAT16"]=14,t[e[101]="DT_FLOAT_REF"]=101,t[e[102]="DT_DOUBLE_REF"]=102,t[e[103]="DT_INT32_REF"]=103,t[e[104]="DT_UINT8_REF"]=104,t[e[105]="DT_INT16_REF"]=105,t[e[106]="DT_INT8_REF"]=106,t[e[107]="DT_STRING_REF"]=107,t[e[108]="DT_COMPLEX64_REF"]=108,t[e[109]="DT_INT64_REF"]=109,t[e[110]="DT_BOOL_REF"]=110,t[e[111]="DT_QINT8_REF"]=111,t[e[112]="DT_QUINT8_REF"]=112,t[e[113]="DT_QINT32_REF"]=113,t[e[114]="DT_BFLOAT16_REF"]=114,t),n.TensorShape=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dim=$util.emptyArray,e.prototype.unknownRank=!1,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.TensorShape;e.pos<n;){var o=e.uint32();switch(o>>>3){case 2:r.dim&&r.dim.length||(r.dim=[]),r.dim.push($root.tensorflow.TensorShape.Dim.decode(e,e.uint32()));break;case 3:r.unknownRank=e.bool();break;default:e.skipType(7&o)}}return r},e.Dim=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.size=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.name="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.TensorShape.Dim;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.size=e.int64();break;case 2:r.name=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),n.Tensor=function(){function e(e){if(this.floatVal=[],this.doubleVal=[],this.intVal=[],this.stringVal=[],this.scomplexVal=[],this.int64Val=[],this.boolVal=[],this.uint32Val=[],this.uint64Val=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dtype=0,e.prototype.tensorShape=null,e.prototype.versionNumber=0,e.prototype.tensorContent=$util.newBuffer([]),e.prototype.floatVal=$util.emptyArray,e.prototype.doubleVal=$util.emptyArray,e.prototype.intVal=$util.emptyArray,e.prototype.stringVal=$util.emptyArray,e.prototype.scomplexVal=$util.emptyArray,e.prototype.int64Val=$util.emptyArray,e.prototype.boolVal=$util.emptyArray,e.prototype.uint32Val=$util.emptyArray,e.prototype.uint64Val=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.Tensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.dtype=e.int32();break;case 2:r.tensorShape=$root.tensorflow.TensorShape.decode(e,e.uint32());break;case 3:r.versionNumber=e.int32();break;case 4:r.tensorContent=e.bytes();break;case 5:if(r.floatVal&&r.floatVal.length||(r.floatVal=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)r.floatVal.push(e.float());else r.floatVal.push(e.float());break;case 6:if(r.doubleVal&&r.doubleVal.length||(r.doubleVal=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.doubleVal.push(e.double());else r.doubleVal.push(e.double());break;case 7:if(r.intVal&&r.intVal.length||(r.intVal=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.intVal.push(e.int32());else r.intVal.push(e.int32());break;case 8:r.stringVal&&r.stringVal.length||(r.stringVal=[]),r.stringVal.push(e.bytes());break;case 9:if(r.scomplexVal&&r.scomplexVal.length||(r.scomplexVal=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.scomplexVal.push(e.float());else r.scomplexVal.push(e.float());break;case 10:if(r.int64Val&&r.int64Val.length||(r.int64Val=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.int64Val.push(e.int64());else r.int64Val.push(e.int64());break;case 11:if(r.boolVal&&r.boolVal.length||(r.boolVal=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.boolVal.push(e.bool());else r.boolVal.push(e.bool());break;case 16:if(r.uint32Val&&r.uint32Val.length||(r.uint32Val=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.uint32Val.push(e.uint32());else r.uint32Val.push(e.uint32());break;case 17:if(r.uint64Val&&r.uint64Val.length||(r.uint64Val=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.uint64Val.push(e.uint64());else r.uint64Val.push(e.uint64());break;default:e.skipType(7&o)}}return r},e}(),n.AttrValue=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.list=null,e.prototype.s=$util.newBuffer([]),e.prototype.i=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.f=0,e.prototype.b=!1,e.prototype.type=0,e.prototype.shape=null,e.prototype.tensor=null,e.prototype.placeholder="",e.prototype.func=null,Object.defineProperty(e.prototype,"value",{get:$util.oneOfGetter(t=["list","s","i","f","b","type","shape","tensor","placeholder","func"]),set:$util.oneOfSetter(t)}),e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.AttrValue;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.list=$root.tensorflow.AttrValue.ListValue.decode(e,e.uint32());break;case 2:r.s=e.bytes();break;case 3:r.i=e.int64();break;case 4:r.f=e.float();break;case 5:r.b=e.bool();break;case 6:r.type=e.int32();break;case 7:r.shape=$root.tensorflow.TensorShape.decode(e,e.uint32());break;case 8:r.tensor=$root.tensorflow.Tensor.decode(e,e.uint32());break;case 9:r.placeholder=e.string();break;case 10:r.func=$root.tensorflow.NameAttrList.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.ListValue=function(){function e(e){if(this.s=[],this.i=[],this.f=[],this.b=[],this.type=[],this.shape=[],this.tensor=[],this.func=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.s=$util.emptyArray,e.prototype.i=$util.emptyArray,e.prototype.f=$util.emptyArray,e.prototype.b=$util.emptyArray,e.prototype.type=$util.emptyArray,e.prototype.shape=$util.emptyArray,e.prototype.tensor=$util.emptyArray,e.prototype.func=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.AttrValue.ListValue;e.pos<n;){var o=e.uint32();switch(o>>>3){case 2:r.s&&r.s.length||(r.s=[]),r.s.push(e.bytes());break;case 3:if(r.i&&r.i.length||(r.i=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)r.i.push(e.int64());else r.i.push(e.int64());break;case 4:if(r.f&&r.f.length||(r.f=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.f.push(e.float());else r.f.push(e.float());break;case 5:if(r.b&&r.b.length||(r.b=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.b.push(e.bool());else r.b.push(e.bool());break;case 6:if(r.type&&r.type.length||(r.type=[]),2==(7&o))for(i=e.uint32()+e.pos;e.pos<i;)r.type.push(e.int32());else r.type.push(e.int32());break;case 7:r.shape&&r.shape.length||(r.shape=[]),r.shape.push($root.tensorflow.TensorShape.decode(e,e.uint32()));break;case 8:r.tensor&&r.tensor.length||(r.tensor=[]),r.tensor.push($root.tensorflow.Tensor.decode(e,e.uint32()));break;case 9:r.func&&r.func.length||(r.func=[]),r.func.push($root.tensorflow.NameAttrList.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),e}(),n.NameAttrList=function(){function e(e){if(this.attr={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.attr=$util.emptyObject,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new $root.tensorflow.NameAttrList;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:o.name=e.string();break;case 2:e.skip().pos++,o.attr===$util.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=$root.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&i)}}return o},e}(),n.NodeDef=function(){function e(e){if(this.input=[],this.attr={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.op="",e.prototype.input=$util.emptyArray,e.prototype.device="",e.prototype.attr=$util.emptyObject,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new $root.tensorflow.NodeDef;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:o.name=e.string();break;case 2:o.op=e.string();break;case 3:o.input&&o.input.length||(o.input=[]),o.input.push(e.string());break;case 4:o.device=e.string();break;case 5:e.skip().pos++,o.attr===$util.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=$root.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&i)}}return o},e}(),n.VersionDef=function(){function e(e){if(this.badConsumers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.producer=0,e.prototype.minConsumer=0,e.prototype.badConsumers=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.VersionDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.producer=e.int32();break;case 2:r.minConsumer=e.int32();break;case 3:if(r.badConsumers&&r.badConsumers.length||(r.badConsumers=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)r.badConsumers.push(e.int32());else r.badConsumers.push(e.int32());break;default:e.skipType(7&o)}}return r},e}(),n.GraphDef=function(){function e(e){if(this.node=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.node=$util.emptyArray,e.prototype.versions=null,e.prototype.library=null,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.GraphDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.node&&r.node.length||(r.node=[]),r.node.push($root.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:r.versions=$root.tensorflow.VersionDef.decode(e,e.uint32());break;case 2:r.library=$root.tensorflow.FunctionDefLibrary.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),n.CollectionDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.nodeList=null,e.prototype.bytesList=null,e.prototype.int64List=null,e.prototype.floatList=null,e.prototype.anyList=null,Object.defineProperty(e.prototype,"kind",{get:$util.oneOfGetter(t=["nodeList","bytesList","int64List","floatList","anyList"]),set:$util.oneOfSetter(t)}),e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.nodeList=$root.tensorflow.CollectionDef.NodeList.decode(e,e.uint32());break;case 2:r.bytesList=$root.tensorflow.CollectionDef.BytesList.decode(e,e.uint32());break;case 3:r.int64List=$root.tensorflow.CollectionDef.Int64List.decode(e,e.uint32());break;case 4:r.floatList=$root.tensorflow.CollectionDef.FloatList.decode(e,e.uint32());break;case 5:r.anyList=$root.tensorflow.CollectionDef.AnyList.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.NodeList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.value=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef.NodeList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.string());break;default:e.skipType(7&o)}}return r},e}(),e.BytesList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.value=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef.BytesList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.bytes());break;default:e.skipType(7&o)}}return r},e}(),e.Int64List=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.value=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef.Int64List;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)r.value.push(e.int64());else r.value.push(e.int64());break;default:e.skipType(7&o)}}return r},e}(),e.FloatList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.value=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef.FloatList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&o))for(var i=e.uint32()+e.pos;e.pos<i;)r.value.push(e.float());else r.value.push(e.float());break;default:e.skipType(7&o)}}return r},e}(),e.AnyList=function(){function e(e){if(this.value=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.value=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.CollectionDef.AnyList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push($root.tensorflow.Any.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),e}(),n.SaverDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t,n;return e.prototype.filenameTensorName="",e.prototype.saveTensorName="",e.prototype.restoreOpName="",e.prototype.maxToKeep=0,e.prototype.sharded=!1,e.prototype.keepCheckpointEveryNHours=0,e.prototype.version=0,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.SaverDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.filenameTensorName=e.string();break;case 2:r.saveTensorName=e.string();break;case 3:r.restoreOpName=e.string();break;case 4:r.maxToKeep=e.int32();break;case 5:r.sharded=e.bool();break;case 6:r.keepCheckpointEveryNHours=e.float();break;case 7:r.version=e.int32();break;default:e.skipType(7&o)}}return r},e.CheckpointFormatVersion=(t={},(n=Object.create(t))[t[0]="LEGACY"]=0,n[t[1]="V1"]=1,n[t[2]="V2"]=2,n),e}(),n.TensorInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.name="",e.prototype.cooSparse=null,e.prototype.dtype=0,e.prototype.tensorShape=null,Object.defineProperty(e.prototype,"encoding",{get:$util.oneOfGetter(t=["name","cooSparse"]),set:$util.oneOfSetter(t)}),e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.TensorInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 4:r.cooSparse=$root.tensorflow.TensorInfo.CooSparse.decode(e,e.uint32());break;case 2:r.dtype=e.int32();break;case 3:r.tensorShape=$root.tensorflow.TensorShape.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.CooSparse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.valuesTensorName="",e.prototype.indicesTensorName="",e.prototype.denseShapeTensorName="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.TensorInfo.CooSparse;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.valuesTensorName=e.string();break;case 2:r.indicesTensorName=e.string();break;case 3:r.denseShapeTensorName=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),n.SignatureDef=function(){function e(e){if(this.inputs={},this.outputs={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.inputs=$util.emptyObject,e.prototype.outputs=$util.emptyObject,e.prototype.methodName="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new $root.tensorflow.SignatureDef;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:e.skip().pos++,o.inputs===$util.emptyObject&&(o.inputs={}),n=e.string(),e.pos++,o.inputs[n]=$root.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:e.skip().pos++,o.outputs===$util.emptyObject&&(o.outputs={}),n=e.string(),e.pos++,o.outputs[n]=$root.tensorflow.TensorInfo.decode(e,e.uint32());break;case 3:o.methodName=e.string();break;default:e.skipType(7&i)}}return o},e}(),n.AssetFileDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.tensorInfo=null,e.prototype.filename="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.AssetFileDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.tensorInfo=$root.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:r.filename=e.string();break;default:e.skipType(7&o)}}return r},e}(),n.OpDef=function(){function e(e){if(this.inputArg=[],this.outputArg=[],this.attr=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.inputArg=$util.emptyArray,e.prototype.outputArg=$util.emptyArray,e.prototype.attr=$util.emptyArray,e.prototype.deprecation=null,e.prototype.summary="",e.prototype.description="",e.prototype.isCommutative=!1,e.prototype.isAggregate=!1,e.prototype.isStateful=!1,e.prototype.allowsUninitializedInput=!1,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.OpDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.inputArg&&r.inputArg.length||(r.inputArg=[]),r.inputArg.push($root.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 3:r.outputArg&&r.outputArg.length||(r.outputArg=[]),r.outputArg.push($root.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 4:r.attr&&r.attr.length||(r.attr=[]),r.attr.push($root.tensorflow.OpDef.AttrDef.decode(e,e.uint32()));break;case 8:r.deprecation=$root.tensorflow.OpDef.OpDeprecation.decode(e,e.uint32());break;case 5:r.summary=e.string();break;case 6:r.description=e.string();break;case 18:r.isCommutative=e.bool();break;case 16:r.isAggregate=e.bool();break;case 17:r.isStateful=e.bool();break;case 19:r.allowsUninitializedInput=e.bool();break;default:e.skipType(7&o)}}return r},e.ArgDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.description="",e.prototype.type=0,e.prototype.typeAttr="",e.prototype.numberAttr="",e.prototype.typeListAttr="",e.prototype.isRef=!1,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.OpDef.ArgDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.description=e.string();break;case 3:r.type=e.int32();break;case 4:r.typeAttr=e.string();break;case 5:r.numberAttr=e.string();break;case 6:r.typeListAttr=e.string();break;case 16:r.isRef=e.bool();break;default:e.skipType(7&o)}}return r},e}(),e.AttrDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.type="",e.prototype.defaultValue=null,e.prototype.description="",e.prototype.hasMinimum=!1,e.prototype.minimum=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.allowedValues=null,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.OpDef.AttrDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.type=e.string();break;case 3:r.defaultValue=$root.tensorflow.AttrValue.decode(e,e.uint32());break;case 4:r.description=e.string();break;case 5:r.hasMinimum=e.bool();break;case 6:r.minimum=e.int64();break;case 7:r.allowedValues=$root.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),e.OpDeprecation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.version=0,e.prototype.explanation="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.OpDef.OpDeprecation;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.version=e.int32();break;case 2:r.explanation=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),n.OpList=function(){function e(e){if(this.op=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.op=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.OpList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.op&&r.op.length||(r.op=[]),r.op.push($root.tensorflow.OpDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),n.MetaGraphDef=function(){function e(e){if(this.collectionDef={},this.signatureDef={},this.assetFileDef=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.metaInfoDef=null,e.prototype.graphDef=null,e.prototype.saverDef=null,e.prototype.collectionDef=$util.emptyObject,e.prototype.signatureDef=$util.emptyObject,e.prototype.assetFileDef=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new $root.tensorflow.MetaGraphDef;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:o.metaInfoDef=$root.tensorflow.MetaGraphDef.MetaInfoDef.decode(e,e.uint32());break;case 2:o.graphDef=$root.tensorflow.GraphDef.decode(e,e.uint32());break;case 3:o.saverDef=$root.tensorflow.SaverDef.decode(e,e.uint32());break;case 4:e.skip().pos++,o.collectionDef===$util.emptyObject&&(o.collectionDef={}),n=e.string(),e.pos++,o.collectionDef[n]=$root.tensorflow.CollectionDef.decode(e,e.uint32());break;case 5:e.skip().pos++,o.signatureDef===$util.emptyObject&&(o.signatureDef={}),n=e.string(),e.pos++,o.signatureDef[n]=$root.tensorflow.SignatureDef.decode(e,e.uint32());break;case 6:o.assetFileDef&&o.assetFileDef.length||(o.assetFileDef=[]),o.assetFileDef.push($root.tensorflow.AssetFileDef.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return o},e.MetaInfoDef=function(){function e(e){if(this.tags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.metaGraphVersion="",e.prototype.strippedOpList=null,e.prototype.anyInfo=null,e.prototype.tags=$util.emptyArray,e.prototype.tensorflowVersion="",e.prototype.tensorflowGitVersion="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.MetaGraphDef.MetaInfoDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.metaGraphVersion=e.string();break;case 2:r.strippedOpList=$root.tensorflow.OpList.decode(e,e.uint32());break;case 3:r.anyInfo=$root.tensorflow.Any.decode(e,e.uint32());break;case 4:r.tags&&r.tags.length||(r.tags=[]),r.tags.push(e.string());break;case 5:r.tensorflowVersion=e.string();break;case 6:r.tensorflowGitVersion=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),n.SavedModel=function(){function e(e){if(this.metaGraphs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.savedModelSchemaVersion=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.metaGraphs=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.SavedModel;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.savedModelSchemaVersion=e.int64();break;case 2:r.metaGraphs&&r.metaGraphs.length||(r.metaGraphs=[]),r.metaGraphs.push($root.tensorflow.MetaGraphDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),n.FunctionDefLibrary=function(){function e(e){if(this.function=[],this.gradient=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.function=$util.emptyArray,e.prototype.gradient=$util.emptyArray,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.FunctionDefLibrary;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.function&&r.function.length||(r.function=[]),r.function.push($root.tensorflow.FunctionDef.decode(e,e.uint32()));break;case 2:r.gradient&&r.gradient.length||(r.gradient=[]),r.gradient.push($root.tensorflow.GradientDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),n.FunctionDef=function(){function e(e){if(this.attr={},this.nodeDef=[],this.ret={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.signature=null,e.prototype.attr=$util.emptyObject,e.prototype.nodeDef=$util.emptyArray,e.prototype.ret=$util.emptyObject,e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new $root.tensorflow.FunctionDef;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:o.signature=$root.tensorflow.OpDef.decode(e,e.uint32());break;case 5:e.skip().pos++,o.attr===$util.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=$root.tensorflow.AttrValue.decode(e,e.uint32());break;case 3:o.nodeDef&&o.nodeDef.length||(o.nodeDef=[]),o.nodeDef.push($root.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:e.skip().pos++,o.ret===$util.emptyObject&&(o.ret={}),n=e.string(),e.pos++,o.ret[n]=e.string();break;default:e.skipType(7&i)}}return o},e}(),n.GradientDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.functionName="",e.prototype.gradientFunc="",e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.tensorflow.GradientDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.functionName=e.string();break;case 2:r.gradientFunc=e.string();break;default:e.skipType(7&o)}}return r},e}(),n}();var compiled_api=$root,compiled_api_1=compiled_api.tensorflow;function getParamValue(e,t,n,r){var o=t.params[e];if(o&&void 0!==o.inputIndex){if("tensor"===o.type)return getTensor(t.inputNames[o.inputIndex],n,r);if("tensors"===o.type)return(0===o.inputIndex?0===o.inputParamLength?t.inputNames:t.inputNames.slice(o.inputIndex,-o.inputParamLength):t.inputNames.splice(o.inputIndex)).map((function(e){return getTensor(e,n,r)}));var i=Array.prototype.slice.call(getTensor(t.inputNames.slice(o.inputIndex)[0],n,r).dataSync());return"number"===o.type?i[0]:i}return o&&o.value}function getTensor(e,t,n){var r=parseNodeName(e),o=r[0],i=r[1],a=n.currentContextIds.find((function(e){return!!t[getNodeNameWithContextId(o,e)]}));return void 0!==a?t[getNodeNameWithContextId(o,a)][i]:void 0}function getTensorsForCurrentContenxt(e,t,n){return t[getNodeNameWithContextId(e,n.currentContextId)]}function getNodeNameAndIndex(e,t){var n=parseNodeName(e),r=n[1];return[getNodeNameWithContextId(n[0],t&&t.currentContextId),r]}function getNodeNameWithContextId(e,t){return t?e+"-"+t:e}function parseNodeName(e){var t=e.lastIndexOf(":");return-1===t?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function split$1(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var json=[{tfOpName:"Add",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",dlOpName:"addN",category:"arithmetic",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",dlOpName:"sub",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",dlOpName:"floorDiv",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",dlOpName:"mul",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",dlOpName:"maximum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Minimum",dlOpName:"minimum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Pow",dlOpName:"pow",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",dlOpName:"squaredDifference",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",dlOpName:"mod",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",dlOpName:"mod",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}],arithmetic=Object.freeze({json}),json$1=[{tfOpName:"Abs",dlOpName:"abs",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",dlOpName:"acos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",dlOpName:"asin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",dlOpName:"atan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",dlOpName:"atan2",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"y",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",dlOpName:"ceil",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"clip_value_min",dlParamName:"clipValueMin",type:"number"},{tfParamName:"clip_value_max",dlParamName:"clipValueMax",type:"number"}]},{tfOpName:"Cos",dlOpName:"cos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",dlOpName:"cosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",dlOpName:"elu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",dlOpName:"exp",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",dlOpName:"floor",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",dlOpName:"log",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",dlOpName:"neg",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",dlOpName:"relu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{dlParamName:"clipValueMin",type:"number",defaultValue:0},{dlParamName:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",dlOpName:"selu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",dlOpName:"sigmoid",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",dlOpName:"sin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",dlOpName:"sinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",dlOpName:"sqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",dlOpName:"rsqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",dlOpName:"square",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",dlOpName:"tan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",dlOpName:"tanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",dlOpName:"sign",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",dlOpName:"round",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",dlOpName:"expm1",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",dlOpName:"log1p",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",dlOpName:"softplus",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",dlOpName:"asinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",dlOpName:"acosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",dlOpName:"atanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",dlOpName:"erf",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",dlOpName:"prod",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axes",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool",notSupported:!0},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",dlOpName:"leakyRelu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"alpha",dlParamName:"alpha",type:"number",defaultValue:.2},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}],basicMath=Object.freeze({json:json$1}),json$2=[{tfOpName:"LoopCond",dlOpName:"loopCond",category:"control",params:[{tfInputIndex:0,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Switch",dlOpName:"switch",category:"control",params:[{tfInputIndex:0,dlParamName:"data",type:"tensor"},{tfInputIndex:1,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Merge",dlOpName:"merge",category:"control",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"}]},{tfOpName:"Enter",dlOpName:"enter",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"frame_name",dlParamName:"frameName",type:"string"},{tfParamName:"is_constant",dlParamName:"isConstant",type:"bool"}]},{tfOpName:"Exit",dlOpName:"exit",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",dlOpName:"nextIteration",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",dlOpName:"tensorArray",category:"control",params:[{tfInputIndex:0,dlParamName:"size",type:"number"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"element_shape",dlParamName:"elementShape",type:"shape"},{tfParamName:"dynamic_size",dlParamName:"dynamicSize",type:"bool"},{tfParamName:"clear_after_read",dlParamName:"clearAfterRead",type:"bool"},{tfParamName:"identical_element_shapes",dlParamName:"identicalElementShapes",type:"bool"},{tfParamName:"tensor_array_name",dlParamName:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",dlOpName:"tensorArrayWrite",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"index",type:"number"},{tfInputIndex:2,dlParamName:"tensor",type:"tensor"},{tfInputIndex:3,dlParamName:"flowIn",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",dlOpName:"tensorArrayRead",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"index",type:"number"},{tfInputIndex:2,dlParamName:"flowIn",type:"number"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",dlOpName:"tensorArrayGather",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"indices",type:"number[]"},{tfInputIndex:2,dlParamName:"flowIn",type:"number"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"element_shape",dlParamName:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",dlOpName:"tensorArrayScatter",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"indices",type:"number[]"},{tfInputIndex:2,dlParamName:"tensor",type:"tensor"},{tfInputIndex:3,dlParamName:"flowIn",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",dlOpName:"tensorArrayConcat",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"flowIn",type:"number"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"element_shape_except0",dlParamName:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",dlOpName:"tensorArraySplit",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"tensor",type:"tensor"},{tfInputIndex:2,dlParamName:"lengths",type:"number[]"},{tfInputIndex:3,dlParamName:"flowIn",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",dlOpName:"tensorArraySize",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"},{tfInputIndex:1,dlParamName:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",dlOpName:"tensorArrayClose",category:"control",params:[{tfInputIndex:0,dlParamName:"tensorArrayId",type:"number"}]}],control=Object.freeze({json:json$2}),json$3=[{tfOpName:"AvgPool",dlOpName:"avgPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",dlOpName:"maxPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",dlOpName:"conv1d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"stride",dlParamName:"stride",type:"number"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NWC"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"dilation",dlParamName:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",dlOpName:"conv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"useCudnnOnGpu",dlParamName:"useCudnnOnGpu",type:"bool"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"Conv2DBackpropInput",dlOpName:"conv2dTranspose",category:"convolution",params:[{tfInputIndex:2,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfInputIndex:0,dlParamName:"outputShape",type:"number[]"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]}],convolution=Object.freeze({json:json$3}),json$4=[{tfOpName:"Fill",dlOpName:"fill",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfInputIndex:1,dlParamName:"value",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",dlOpName:"linspace",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"num",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",dlOpName:"oneHot",category:"creation",params:[{tfInputIndex:0,dlParamName:"indices",type:"tensor"},{tfInputIndex:1,dlParamName:"depth",type:"number"},{tfInputIndex:2,dlParamName:"onValue",type:"number",defaultValue:1},{tfInputIndex:3,dlParamName:"offValue",type:"number",defaultValue:0},{tfParamName:"axis",dlParamName:"axis",type:"number",notSupported:!0},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",dlOpName:"ones",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",dlOpName:"onesLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",dlOpName:"randomUniform",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"minval",dlParamName:"minval",type:"number",defaultValue:0},{tfParamName:"maxval",dlParamName:"maxval",type:"number",defaultValue:1},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"seed",dlParamName:"seed",type:"number",defaultValue:0},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",dlOpName:"range",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"step",type:"number",defaultValue:0},{tfParamName:"Tidx",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"truncatedNormal",dlOpName:"truncatedNormal",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"means",dlParamName:"mean",type:"number",defaultValue:0},{tfParamName:"stddev",dlParamName:"stdDev",type:"number",defaultValue:1},{tfParamName:"seed",dlParamName:"seed",type:"number"},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",dlOpName:"zeros",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",dlOpName:"zerosLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]}],creation=Object.freeze({json:json$4}),json$5=[{tfOpName:"NonMaxSuppressionV2",dlOpName:"nonMaxSuppression",category:"dynamic",params:[{tfInputIndex:0,dlParamName:"boxes",type:"tensor"},{tfInputIndex:1,dlParamName:"scores",type:"tensor"},{tfInputIndex:2,dlParamName:"maxOutputSize",type:"number"},{tfInputIndex:3,dlParamName:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",dlOpName:"nonMaxSuppression",category:"dynamic",params:[{tfInputIndex:0,dlParamName:"boxes",type:"tensor"},{tfInputIndex:1,dlParamName:"scores",type:"tensor"},{tfInputIndex:2,dlParamName:"maxOutputSize",type:"number"},{tfInputIndex:3,dlParamName:"iouThreshold",type:"number"},{tfInputIndex:4,dlParamName:"scoreThreshold",type:"number"}]},{tfOpName:"Where",dlOpName:"whereAsync",category:"dynamic",params:[{tfInputIndex:0,dlParamName:"condition",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",dlOpName:"setdiff1dAsync",category:"dynamic",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"y",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}],dynamic=Object.freeze({json:json$5}),json$6=[{tfOpName:"TopKV2",dlOpName:"topK",category:"evaluation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"k",type:"number"},{tfParamName:"sorted",dlParamName:"sorted",type:"bool"}]}],evaluation=Object.freeze({json:json$6}),json$7=[{tfOpName:"PlaceholderWithDefault",dlOpName:"placeholder",category:"graph",params:[{tfInputIndex:0,dlParamName:"default",type:"tensor"},{tfParamName:"shape",dlParamName:"shape",type:"shape"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",dlOpName:"placeholder",category:"graph",params:[{tfParamName:"shape",dlParamName:"shape",type:"shape"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"Const",dlOpName:"const",category:"graph"},{tfOpName:"Identity",dlOpName:"identity",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Snapshot",dlOpName:"snapshot",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Rank",dlOpName:"rank",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Size",dlOpName:"size",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Shape",dlOpName:"shape",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"ShapeN",dlOpName:"shapeN",category:"graph",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"x",type:"tensors"}]},{tfOpName:"Print",dlOpName:"print",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfInputParamLength:1,dlParamName:"data",type:"tensors"},{tfParamName:"message",dlParamName:"message",type:"string"},{tfParamName:"first_n",dlParamName:"firstN",type:"number",notSupprted:!0},{tfParamName:"summarize",dlParamName:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",dlOpName:"noop",category:"graph",params:[]},{tfOpName:"StopGradient",dlOpName:"stopGradient",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",dlOpName:"fakeQuantWithMinMaxVars",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"min",dlParamName:"min",type:"number"},{tfParamName:"max",dlParamName:"max",type:"number"}]}],graph=Object.freeze({json:json$7}),json$8=[{tfOpName:"ResizeBilinear",dlOpName:"resizeBilinear",category:"image",params:[{tfInputIndex:0,dlParamName:"images",type:"tensor"},{tfInputIndex:1,dlParamName:"size",type:"number[]"},{tfParamName:"align_corners",dlParamName:"alignCorners",type:"bool"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",dlOpName:"resizeNearestNeighbor",category:"image",params:[{tfInputIndex:0,dlParamName:"images",type:"tensor"},{tfInputIndex:1,dlParamName:"size",type:"number[]"},{tfParamName:"align_corners",dlParamName:"alignCorners",type:"bool"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",dlOpName:"cropAndResize",category:"image",params:[{tfInputIndex:0,dlParamName:"image",type:"tensor"},{tfInputIndex:1,dlParamName:"boxes",type:"tensor"},{tfInputIndex:2,dlParamName:"boxInd",type:"tensor"},{tfInputIndex:3,dlParamName:"cropSize",type:"number[]"},{tfParamName:"method",dlParamName:"method",type:"string"},{tfParamName:"extrapolation_value",dlParamName:"extrapolationValue",type:"number"}]}],image$1=Object.freeze({json:json$8}),json$9=[{tfOpName:"Equal",dlOpName:"equal",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",dlOpName:"notEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",dlOpName:"greater",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",dlOpName:"greaterEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",dlOpName:"less",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",dlOpName:"lessEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",dlOpName:"logicalAnd",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",dlOpName:"logicalNot",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",dlOpName:"logicalOr",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",dlOpName:"where",category:"logical",params:[{tfInputIndex:0,dlParamName:"condition",type:"tensor"},{tfInputIndex:1,dlParamName:"a",type:"tensor"},{tfInputIndex:2,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}],logical=Object.freeze({json:json$9}),json$10=[{tfOpName:"MatMul",dlOpName:"matMul",category:"matrices",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"transpose_a",dlParamName:"transposeA",type:"bool",defaultValue:!1},{tfParamName:"transpose_b",dlParamName:"transposeB",type:"bool",defaultValue:!1},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",dlOpName:"matMul",category:"matrices",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"adj_x",dlParamName:"transposeA",type:"bool",defaultValue:!1},{tfParamName:"adj_y",dlParamName:"transposeB",type:"bool",defaultValue:!1},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",dlOpName:"transpose",category:"matrices",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"perm",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}],matrices=Object.freeze({json:json$10}),json$11=[{tfOpName:"FusedBatchNorm",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",dlOpName:"localResponseNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"depth_radius",dlParamName:"radius",type:"number",defaultValue:5},{tfParamName:"bias",dlParamName:"bias",type:"number",defaultValue:1},{tfParamName:"alpha",dlParamName:"alpha",type:"number",defaultValue:1},{tfParamName:"beta",dlParamName:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",dlOpName:"softmax",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",dlOpName:"logSoftmax",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"SparseToDense",dlOpName:"sparseToDense",category:"normalization",params:[{tfInputIndex:0,dlParamName:"sparseIndices",type:"tensor"},{tfInputIndex:1,dlParamName:"outputShape",type:"number[]"},{tfInputIndex:2,dlParamName:"sparseValues",type:"tensor"},{tfInputIndex:3,dlParamName:"defaultValue",type:"tensor"},{tfParamName:"validate_indices",dlParamName:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],normalization=Object.freeze({json:json$11}),json$12=[{tfOpName:"Max",dlOpName:"max",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Mean",dlOpName:"mean",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Min",dlOpName:"min",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Sum",dlOpName:"sum",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"All",dlOpName:"all",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Any",dlOpName:"any",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",dlOpName:"argMax",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"ArgMin",dlOpName:"argMin",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"Prod",dlOpName:"prod",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]}],reduction=Object.freeze({json:json$12}),json$13=[{tfOpName:"ConcatV2",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:-1,dlParamName:"axis",type:"number"}]},{tfOpName:"Concat",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:1,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:0,dlParamName:"axis",type:"number"}]},{tfOpName:"GatherV2",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfInputIndex:2,dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0},{tfParamName:"validate_indices",dlParamName:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"}]},{tfOpName:"Slice",dlOpName:"slice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"size",type:"number[]"}]},{tfOpName:"StridedSlice",dlOpName:"stridedSlice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"end",type:"number[]"},{tfInputIndex:3,dlParamName:"strides",type:"number[]"},{tfParamName:"begin_mask",dlParamName:"beginMask",type:"number",defaultValue:0},{tfParamName:"end_mask",dlParamName:"endMask",type:"number",defaultValue:0},{tfParamName:"new_axis_mask",dlParamName:"newAxisMask",type:"number",defaultValue:0},{tfParamName:"ellipsis_mask",dlParamName:"ellipsisMask",type:"number",defaultValue:0},{tfParamName:"shrink_axis_mask",dlParamName:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",dlOpName:"stack",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",dlOpName:"unstack",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0},{tfParamName:"num",dlParamName:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",dlOpName:"tile",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"reps",type:"number[]"}]},{tfOpName:"Split",dlOpName:"split",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"axis",type:"number",defaultValue:0},{tfInputIndex:1,dlParamName:"x",type:"tensor"},{tfParamName:"num_split",dlParamName:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",dlOpName:"split",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"numOrSizeSplits",type:"number[]"},{tfInputIndex:2,dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",dlOpName:"scatterNd",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"indices",type:"tensor"},{tfInputIndex:1,dlParamName:"values",type:"tensor"},{tfInputIndex:2,dlParamName:"shape",type:"number[]"}]},{tfOpName:"GatherNd",dlOpName:"gatherNd",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",dlOpName:"sparseToDense",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"sparseIndices",type:"tensor"},{tfInputIndex:1,dlParamName:"outputShape",type:"number[]"},{tfInputIndex:2,dlParamName:"sparseValues",type:"tensor"},{tfInputIndex:3,dlParamName:"defaultValue",type:"tensor"},{tfParamName:"validate_indices",dlParamName:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],sliceJoin=Object.freeze({json:json$13}),json$14=[{tfOpName:"FFT",dlOpName:"fft",category:"spectral",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"IFFT",dlOpName:"ifft",category:"spectral",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"RFFT",dlOpName:"rfft",category:"spectral",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"fft_length",type:"number",unsupported:!0}]},{tfOpName:"IRFFT",dlOpName:"irfft",category:"spectral",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"fft_length",type:"number",unsupported:!0}]}],spectral=Object.freeze({json:json$14}),json$15=[{tfOpName:"Cast",dlOpName:"cast",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"SrcT",dlParamName:"sdtype",type:"dtype",notSupported:!0},{tfParamName:"DstT",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",dlOpName:"expandDims",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfParamNameDeprecated:"dim",dlParamName:"axis",type:"number"}]},{tfOpName:"Pad",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfParamName:"constant_value",dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfInputIndex:2,dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",dlOpName:"reshape",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"shape",type:"number[]"}]},{tfOpName:"Squeeze",dlOpName:"squeeze",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"axis",tfParamNameDeprecated:"squeeze_dims",dlParamName:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",dlOpName:"spaceToBatchND",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"blockShape",type:"number[]"},{tfInputIndex:2,dlParamName:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",dlOpName:"batchToSpaceND",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"blockShape",type:"number[]"},{tfInputIndex:2,dlParamName:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",dlOpName:"depthToSpace",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"block_size",dlParamName:"blockSize",type:"number"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string"}]}],transformation=Object.freeze({json:json$15}),CONTROL_FLOW_OPS=["Switch","Merge","Enter","Exit","NextIteration"],DYNAMIC_SHAPE_OPS=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"],OperationMapper=function(){function e(){var e=[].concat.apply([],[arithmetic,basicMath,control,convolution,creation,dynamic,evaluation,logical,image$1,graph,matrices,normalization,reduction,sliceJoin,spectral,transformation].map((function(e){return e.json})));this.opMappers=e.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.isControlFlow=function(e){return CONTROL_FLOW_OPS.some((function(t){return t===e.op}))},e.prototype.isDynamicShape=function(e){return DYNAMIC_SHAPE_OPS.some((function(t){return t===e.op}))},e.prototype.transformGraph=function(e){var t=this,n=!1,r=!1,o=[],i=[],a=e.node.reduce((function(e,a){return e[a.name]=t.mapNode(a),t.isControlFlow(a)&&(n=!0),t.isDynamicShape(a)&&(r=!0),"Placeholder"===a.op&&o.push(e[a.name]),"Const"===a.op&&i.push(e[a.name]),e}),{}),s=[],u=[];return Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e){var n=getNodeNameAndIndex(e)[0];t.inputs.push(a[n]),a[n].children.push(t)})),0===t.inputs.length&&s.push(t)})),Object.keys(a).forEach((function(e){var t=a[e];0===t.children.length&&u.push(t)})),{nodes:a,inputs:s,outputs:u,weights:i,placeholders:o,withControlFlow:n,withDynamicShape:r}},e.prototype.mapNode=function(e){var t=this,n=this.opMappers[e.op];if(void 0===n)throw new Error("Tensorflow Op is not supported: "+e.op);var r={name:e.name,op:n.dlOpName,category:n.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],params:{}};return n.params&&(r.params=n.params.reduce((function(n,r){var o=r.tfInputIndex,i=r.tfInputParamLength,a=r.type,s=void 0;if(void 0===o)switch(r.type){case"string":void 0===(s=t.getStringParam(e.attr,r.tfParamName,r.defaultValue))&&r.tfParamNameDeprecated&&(s=t.getStringParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"number":void 0===(s=t.getNumberParam(e.attr,r.tfParamName,r.defaultValue||0))&&r.tfParamNameDeprecated&&(s=t.getNumberParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"number[]":void 0===(s=t.getNumericArrayParam(e.attr,r.tfParamName,r.defaultValue))&&r.tfParamNameDeprecated&&(s=t.getNumericArrayParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"bool":void 0===(s=t.getBoolParam(e.attr,r.tfParamName,r.defaultValue))&&r.tfParamNameDeprecated&&(s=t.getBoolParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"shape":void 0===(s=t.getTensorShapeParam(e.attr,r.tfParamName,r.defaultValue))&&r.tfParamNameDeprecated&&(s=t.getTensorShapeParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"dtype":void 0===(s=t.getDtypeParam(e.attr,r.tfParamName,r.defaultValue))&&r.tfParamNameDeprecated&&(s=t.getDtypeParam(e.attr,r.tfParamNameDeprecated,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+r.type+" for op: "+e.op)}return n[r.dlParamName]={value:s,inputIndex:o,type:a,inputParamLength:i},n}),{})),r},e.prototype.getStringParam=function(e,t,n,r){void 0===r&&(r=!1);var o=e[t];if(void 0!==o){var i=String.fromCharCode.apply(null,o.s);return r?i:i.toLowerCase()}return n},e.prototype.getBoolParam=function(e,t,n){var r=e[t];return r?r.b:n},e.prototype.getNumberParam=function(e,t,n){var r=e[t],o=r?r[r.value]:n;return"number"==typeof o?o:o.toInt()},e.prototype.getDtypeParam=function(e,t,n){var r=e[t];if(r&&r.type)switch(r.type){case compiled_api_1.DataType.DT_FLOAT:return"float32";case compiled_api_1.DataType.DT_INT32:return"int32";case compiled_api_1.DataType.DT_BOOL:return"bool";default:return n}return n},e.prototype.getTensorShapeParam=function(e,t,n){var r=e[t];return r&&r.shape?r.shape.dim.map((function(e){return"number"==typeof e.size?e.size:e.size.toInt()})):n},e.prototype.getNumericArrayParam=function(e,t,n){var r=e[t];return r?(r.list.f&&r.list.f.length?r.list.f:r.list.i).map((function(e){return"number"==typeof e?e:e.toInt()})):n},e}(),executeOp=function(e,t,n){switch(e.op){case"add":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.u)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"addN":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.v)(getParamValue("tensors",e,t,n))];case"mod":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.tc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"mul":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.xc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"div":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.kb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"floorDiv":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.zb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"sub":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Rd)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"minimum":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.rc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"maximum":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.mc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"pow":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Rc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"squaredDifference":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ld)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$1=function(e,t,n){switch(e.op){case"abs":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.r)(getParamValue("x",e,t,n))];case"acos":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.s)(getParamValue("x",e,t,n))];case"acosh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.t)(getParamValue("x",e,t,n))];case"asin":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.B)(getParamValue("x",e,t,n))];case"asinh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.C)(getParamValue("x",e,t,n))];case"atan":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.D)(getParamValue("x",e,t,n))];case"atan2":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.E)(getParamValue("x",e,t,n),getParamValue("y",e,t,n))];case"atanh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.F)(getParamValue("x",e,t,n))];case"ceil":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.P)(getParamValue("x",e,t,n))];case"cos":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.cb)(getParamValue("x",e,t,n))];case"cosh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.db)(getParamValue("x",e,t,n))];case"elu":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nb)(getParamValue("x",e,t,n))];case"erf":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.rb)(getParamValue("x",e,t,n))];case"exp":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.sb)(getParamValue("x",e,t,n))];case"expm1":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ub)(getParamValue("x",e,t,n))];case"floor":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.yb)(getParamValue("x",e,t,n))];case"log":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Yb)(getParamValue("x",e,t,n))];case"log1p":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Zb)(getParamValue("x",e,t,n))];case"neg":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Bc)(getParamValue("x",e,t,n))];case"reciprocal":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.cd)(getParamValue("x",e,t,n))];case"relu":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.dd)(getParamValue("x",e,t,n))];case"round":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ld)(getParamValue("x",e,t,n))];case"selu":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.pd)(getParamValue("x",e,t,n))];case"sigmoid":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ud)(getParamValue("x",e,t,n))];case"sin":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.wd)(getParamValue("x",e,t,n))];case"sign":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.vd)(getParamValue("x",e,t,n))];case"sinh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.xd)(getParamValue("x",e,t,n))];case"softplus":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ed)(getParamValue("x",e,t,n))];case"sqrt":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Jd)(getParamValue("x",e,t,n))];case"square":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Kd)(getParamValue("x",e,t,n))];case"tanh":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Vd)(getParamValue("x",e,t,n))];case"tan":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ud)(getParamValue("x",e,t,n))];case"clipByValue":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Q)(getParamValue("x",e,t,n),getParamValue("clipValueMin",e,t,n),getParamValue("clipValueMax",e,t,n))];case"rsqrt":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.kb)(Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(1,"float32"),Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Jd)(getTensor(e.inputNames[0],t,n)))];case"prod":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Vc)(getParamValue("x",e,t,n),getParamValue("axes",e,t,n))];case"leakyRelu":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Qb)(getParamValue("x",e,t,n),getParamValue("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},TensorArray=function(){function e(t,n,r,o,i,a,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=o,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach((function(e){return e.tensor.dispose()})),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.tensors.length)throw new Error("Tried to read from index "+e+", but array size is: "+this.tensors.length);var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},e.prototype.readMany=function(e){var t=this;return e.map((function(e){return t.read(e)}))},e.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+",\n          because the value dtype is "+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(0===this.size()&&0===this.elementShape.length&&(this.elementShape=t.shape),this.assertShapesMatch(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");n.tensor=t,n.written=!0,this.tensors[e]=n},e.prototype.writeMany=function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+e.length+" is not the same as tensors size: "+t.length+".");e.forEach((function(e,r){return n.write(e,t[r])}))},e.prototype.gather=function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(!e){e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Wd)([],[0].concat(this.elementShape));var r=this.readMany(e);return this.assertShapesMatch(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Od)(r,0)},e.prototype.concat=function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(0===this.size())return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Wd)([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return this.assertShapesMatch(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.T)(r,0)},e.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var n=Math.max.apply(Math,e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(e,Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ne)(t,0))},e.prototype.split=function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var r=0,o=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,a=[];Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ee)((function(){t=t.reshape([1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:o[s-1],0],l=[1,e[s],i];a[s]=Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.yd)(t,u,l).reshape(n.elementShape)}return a}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,a)},e.prototype.assertShapesMatch=function(e,t,n){void 0===n&&(n=""),_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oe.assert(this.arraysEqual(e,t),n+" Shapes "+e+" and "+t+" must match")},e.prototype.arraysEqual=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0},e.nextId=0,e}();function executeOp$2(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_,N,E,C,I,O,S,k,T,A,P,D,R,M,j,L;return __generator(this,(function(V){switch(V.label){case 0:switch(e.op){case"loopCond":return[3,1];case"switch":return[3,2];case"merge":return[3,4];case"enter":return[3,5];case"exit":return[3,6];case"nextIteration":return[3,7];case"tensorArray":return[3,8];case"tensorArrayWrite":return[3,9];case"tensorArrayRead":return[3,10];case"tensorArrayGather":return[3,11];case"tensorArrayScatter":return[3,12];case"tensorArrayConcat":return[3,13];case"tensorArraySplit":return[3,14];case"tensorArraySize":return[3,15];case"tensorArrayClose":return[3,16]}return[3,17];case 1:return[2,[getParamValue("pred",e,t,n).clone()]];case 2:return r=getParamValue("pred",e,t,n),o=getParamValue("data",e,t,n),[4,r.data()];case 3:return[2,V.sent()[0]?[void 0,o.clone()]:[o.clone(),void 0]];case 4:return[2,(i=e.inputNames.find((function(e){return void 0!==getTensor(e,t,n)})))?[getTensor(i,t,n).clone()]:void 0];case 5:return a=getParamValue("frameName",e,t,n),s=getParamValue("tensor",e,t,n),n.enterFrame(a),[2,[s.clone()]];case 6:return u=getParamValue("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=getParamValue("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=getParamValue("size",e,t,n),h=getParamValue("dtype",e,t,n),p=getParamValue("elementShape",e,t,n),d=getParamValue("dynamicSize",e,t,n),f=getParamValue("clearAfterRead",e,t,n),m=getParamValue("identicalElementShapes",e,t,n),g=getParamValue("name",e,t,n),y=new TensorArray(g,h,c,p,m,d,f),n.addTensorArray(y),[2,[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(y.id),Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(1)]];case 9:return v=getParamValue("tensorArrayId",e,t,n),b=getParamValue("index",e,t,n),w=getParamValue("tensor",e,t,n),n.getTensorArray(v).write(b,w),[2,[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(1)]];case 10:return x=getParamValue("tensorArrayId",e,t,n),_=getParamValue("index",e,t,n),[2,[n.getTensorArray(x).read(_)]];case 11:return N=getParamValue("tensorArrayId",e,t,n),E=getParamValue("indices",e,t,n),C=getParamValue("dtype",e,t,n),[2,[n.getTensorArray(N).gather(E,C)]];case 12:return I=getParamValue("tensorArrayId",e,t,n),O=getParamValue("indices",e,t,n),S=getParamValue("tensor",e,t,n),n.getTensorArray(I).scatter(O,S),[2,[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(1)]];case 13:return k=getParamValue("tensorArrayId",e,t,n),T=n.getTensorArray(k),A=getParamValue("dtype",e,t,n),[2,[T.concat(A)]];case 14:return P=getParamValue("tensorArrayId",e,t,n),D=getParamValue("tensor",e,t,n),R=getParamValue("lengths",e,t,n),n.getTensorArray(P).split(R,D),[2,[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(1)]];case 15:return M=getParamValue("tensorArrayId",e,t,n),j=n.getTensorArray(M),[2,[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(j.size(),"int32")]];case 16:return L=getParamValue("tensorArrayId",e,t,n),n.getTensorArray(L).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}var executeOp$3=function(e,t,n){switch(e.op){case"conv1d":var r=getParamValue("stride",e,t,n),o=getParamValue("pad",e,t,n),i=getParamValue("dataFormat",e,t,n).toUpperCase(),a=getParamValue("dilation",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Y)(getParamValue("x",e,t,n),getParamValue("filter",e,t,n),r,o,i,a)];case"conv2d":r=getParamValue("strides",e,t,n),o=getParamValue("pad",e,t,n),i=getParamValue("dataFormat",e,t,n).toUpperCase();var s=getParamValue("dilations",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Z)(getParamValue("x",e,t,n),getParamValue("filter",e,t,n),[r[1],r[2]],o,i,[s[0],s[1]])];case"conv2dTranspose":var u=getParamValue("outputShape",e,t,n);return r=getParamValue("strides",e,t,n),o=getParamValue("pad",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.bb)(getParamValue("x",e,t,n),getParamValue("filter",e,t,n),u,[r[1],r[2]],o)];case"depthwiseConv2d":return r=getParamValue("strides",e,t,n),o=getParamValue("pad",e,t,n),s=getParamValue("dilations",e,t,n),i=getParamValue("dataFormat",e,t,n).toUpperCase(),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.hb)(getParamValue("input",e,t,n),getParamValue("filter",e,t,n),[r[1],r[2]],o,i,[s[0],s[1]])];case"avgPool":r=getParamValue("strides",e,t,n),o=getParamValue("pad",e,t,n);var l=getParamValue("kernelSize",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.G)(getParamValue("x",e,t,n),[l[1],l[2]],[r[1],r[2]],o)];case"maxPool":return r=getParamValue("strides",e,t,n),o=getParamValue("pad",e,t,n),l=getParamValue("kernelSize",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.lc)(getParamValue("x",e,t,n),[l[1],l[2]],[r[1],r[2]],o)];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$4=function(e,t,n){switch(e.op){case"fill":var r=getParamValue("shape",e,t,n),o=getParamValue("dtype",e,t,n),i=getParamValue("value",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.xb)(r,i,o)];case"linspace":var a=getParamValue("start",e,t,n),s=getParamValue("stop",e,t,n),u=getParamValue("num",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Wb)(a,s,u)];case"oneHot":var l=getParamValue("indices",e,t,n),c=getParamValue("depth",e,t,n),h=getParamValue("onValue",e,t,n),p=getParamValue("offValue",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Gc)(l,c,h,p)];case"ones":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Hc)(getParamValue("shape",e,t,n),getParamValue("dtype",e,t,n))];case"onesLike":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ic)(getParamValue("x",e,t,n))];case"randomUniform":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Zc)(getParamValue("shape",e,t,n),getParamValue("minval",e,t,n),getParamValue("maxval",e,t,n),getParamValue("dtype",e,t,n))];case"range":a=getParamValue("start",e,t,n);var d=getParamValue("stop",e,t,n),f=getParamValue("step",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ad)(a,d,f,getParamValue("dtype",e,t,n))];case"truncatedNormal":r=getParamValue("shape",e,t,n);var m=getParamValue("mean",e,t,n),g=getParamValue("stdDev",e,t,n),y=getParamValue("seed",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.le)(r,m,g,getParamValue("dtype",e,t,n),y)];case"zeros":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.xe)(getParamValue("shape",e,t,n),getParamValue("dtype",e,t,n))];case"zerosLike":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ye)(getParamValue("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}};function executeOp$5(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,o,i,a,s;return __generator(this,(function(u){switch(u.label){case 0:switch(e.op){case"nonMaxSuppression":return[3,1];case"whereAsync":return[3,3];case"setdiff1dAsync":return[3,5]}return[3,7];case 1:return r=getParamValue("boxes",e,t,n),o=getParamValue("scores",e,t,n),i=getParamValue("maxOutputSize",e,t,n),a=getParamValue("iouThreshold",e,t,n),s=getParamValue("scoreThreshold",e,t,n),[4,_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Mb.nonMaxSuppressionAsync(r,o,i,a,s)];case 2:return[2,[u.sent()]];case 3:return[4,Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.we)(getParamValue("condition",e,t,n))];case 4:return[2,[u.sent()]];case 5:return[4,Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.td)(getParamValue("x",e,t,n),getParamValue("y",e,t,n))];case 6:return[2,u.sent()];case 7:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}var executeOp$6=function(e,t,n){switch(e.op){case"topK":var r=getParamValue("x",e,t,n),o=getParamValue("k",e,t,n),i=getParamValue("sorted",e,t,n),a=Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ie)(r,o,i);return[a.values,a.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$7=function(e,t,n){switch(e.op){case"const":return t[e.name];case"placeholder":var r=getParamValue("default",e,t,n);return[getTensor(e.name,t,n)||r];case"identity":case"stopGradient":case"fakeQuantWithMinMaxVars":case"snapshot":return[getParamValue("x",e,t,n).clone()];case"shape":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Xd)(getParamValue("x",e,t,n).shape,"int32")];case"shapeN":return getParamValue("x",e,t,n).map((function(e){return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Xd)(e.shape)}));case"size":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(getParamValue("x",e,t,n).size,"int32")];case"rank":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.nd)(getParamValue("x",e,t,n).rank,"int32")];case"noop":return[];case"print":var o=getParamValue("x",e,t,n),i=getParamValue("data",e,t,n),a=getParamValue("message",e,t,n),s=getParamValue("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(a);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[0].dataSync()).slice(0,s));return[o];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$8=function(e,t,n){switch(e.op){case"resizeBilinear":var r=getParamValue("images",e,t,n),o=getParamValue("size",e,t,n),i=getParamValue("alignCorners",e,t,n);return[_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Mb.resizeBilinear(r,[o[0],o[1]],i)];case"resizeNearestNeighbor":return r=getParamValue("images",e,t,n),o=getParamValue("size",e,t,n),i=getParamValue("alignCorners",e,t,n),[_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Mb.resizeNearestNeighbor(r,[o[0],o[1]],i)];case"cropAndResize":var a=getParamValue("image",e,t,n),s=getParamValue("boxes",e,t,n),u=getParamValue("boxInd",e,t,n),l=getParamValue("cropSize",e,t,n),c=getParamValue("method",e,t,n),h=getParamValue("extrapolationValue",e,t,n);return[_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Mb.cropAndResize(a,s,u,l,c,h)];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$9=function(e,t,n){switch(e.op){case"equal":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.pb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"notEqual":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ec)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"greater":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Gb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"greaterEqual":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Hb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"less":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Rb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"lessEqual":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Sb)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"logicalAnd":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.dc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"logicalNot":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ec)(getParamValue("a",e,t,n))];case"logicalOr":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.fc)(getParamValue("a",e,t,n),getParamValue("b",e,t,n))];case"where":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ve)(getParamValue("condition",e,t,n),getParamValue("a",e,t,n),getParamValue("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$10=function(e,t,n){switch(e.op){case"matMul":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ic)(getParamValue("a",e,t,n),getParamValue("b",e,t,n),getParamValue("transposeA",e,t,n),getParamValue("transposeB",e,t,n))];case"transpose":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ke)(getParamValue("x",e,t,n),getParamValue("perm",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$11=function(e,t,n){switch(e.op){case"batchNormalization":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.I)(getParamValue("x",e,t,n),getParamValue("mean",e,t,n),getParamValue("variance",e,t,n),getParamValue("epsilon",e,t,n),getParamValue("scale",e,t,n),getParamValue("offset",e,t,n))];case"localResponseNormalization":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Xb)(getParamValue("x",e,t,n),getParamValue("radius",e,t,n),getParamValue("bias",e,t,n),getParamValue("alpha",e,t,n),getParamValue("beta",e,t,n))];case"softmax":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Dd)(getParamValue("x",e,t,n))];case"logSoftmax":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.bc)(getParamValue("x",e,t,n))];case"sparseToDense":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Gd)(getParamValue("sparseIndices",e,t,n),getParamValue("outputShape",e,t,n),getParamValue("sparseValues",e,t,n),getParamValue("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$12=function(e,t,n){switch(e.op){case"max":var r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.kc)(getParamValue("x",e,t,n),r,o)];case"mean":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oc)(getParamValue("x",e,t,n),r,o)];case"min":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.qc)(getParamValue("x",e,t,n),r,o)];case"sum":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Td)(getParamValue("x",e,t,n),r,o)];case"all":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.x)(getParamValue("x",e,t,n),r,o)];case"any":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.y)(getParamValue("x",e,t,n),r,o)];case"argMax":return r=getParamValue("axis",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.z)(getParamValue("x",e,t,n),r)];case"argMin":return r=getParamValue("axis",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.A)(getParamValue("x",e,t,n),r)];case"prod":return r=getParamValue("axis",e,t,n),o=getParamValue("keepDims",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Vc)(getParamValue("x",e,t,n),r,o)];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$13=function(e,t,n){switch(e.op){case"concat":var r=getParamValue("axis",e,t,n),o=getParamValue("tensors",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.T)(o,r)];case"gather":r=getParamValue("axis",e,t,n);var i=getParamValue("x",e,t,n),a=getParamValue("indices",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Bb)(i,a,r)];case"reverse":return r=getParamValue("axis",e,t,n),i=getParamValue("x",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.fd)(i,r)];case"slice":var s=getParamValue("begin",e,t,n),u=getParamValue("size",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.yd)(getParamValue("x",e,t,n),s,u)];case"stridedSlice":s=getParamValue("begin",e,t,n);var l=getParamValue("end",e,t,n),c=getParamValue("strides",e,t,n),h=getParamValue("beginMask",e,t,n),p=getParamValue("endMask",e,t,n),d=getParamValue("ellipsisMask",e,t,n),f=getParamValue("newAxisMask",e,t,n),m=getParamValue("shrinkAxisMask",e,t,n),g=getParamValue("x",e,t,n);if(1===s.length&&g.shape.length>1)for(var y=1;y<g.shape.length;y++)s.push(0),l.push(g.shape[y]),c.push(c[0]);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Qd)(g,s,l,c,h,p,d,f,m)];case"stack":return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ee)((function(){var r=getParamValue("axis",e,t,n),o=getParamValue("tensors",e,t,n),i=o[0].shape,a=o[0].squeeze().shape,s=o.map((function(e){var t=_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oe.arraysEqual(e.shape,i);if(!t&&!_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oe.arraysEqual(e.squeeze().shape,a))throw new Error("the input tensors shape does not match");return t?e:e.reshape(i)}));return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Od)(s,r)]}));case"unstack":return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ee)((function(){var r=getParamValue("axis",e,t,n),o=getParamValue("tensor",e,t,n);return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ne)(o,r)}));case"tile":var v=getParamValue("reps",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.fe)(getParamValue("x",e,t,n),v)];case"split":r=getParamValue("axis",e,t,n);var b=getParamValue("numOrSizeSplits",e,t,n);return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Id)(getParamValue("x",e,t,n),b,r);case"scatterNd":a=getParamValue("indices",e,t,n);var w=getParamValue("values",e,t,n),x=getParamValue("shape",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.od)(a,w,x)];case"gatherNd":var _=getParamValue("x",e,t,n);return a=getParamValue("indices",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Cb)(_,a)];case"sparseToDense":a=getParamValue("sparseIndices",e,t,n),x=getParamValue("outputShape",e,t,n);var N=getParamValue("sparseValues",e,t,n),E=getParamValue("defaultValue",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Gd)(a,N,x,E)];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$14=function(e,t,n){switch(e.op){case"fft":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.wb)(getParamValue("x",e,t,n))];case"ifft":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Kb)(getParamValue("x",e,t,n))];case"rfft":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.kd)(getParamValue("x",e,t,n))];case"irfft":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Ob)(getParamValue("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},executeOp$15=function(e,t,n){switch(e.op){case"cast":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.O)(getParamValue("x",e,t,n),getParamValue("dtype",e,t,n))];case"expandDims":var r=getParamValue("axis",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.tb)(getParamValue("x",e,t,n),r)];case"squeeze":return r=getParamValue("axis",e,t,n),[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Nd)(getParamValue("x",e,t,n),r)];case"reshape":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ed)(getParamValue("x",e,t,n),getParamValue("shape",e,t,n))];case"pad":return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Lc)(getParamValue("x",e,t,n),split$1(getParamValue("padding",e,t,n),2),getParamValue("constantValue",e,t,n))];case"spaceToBatchND":var o=getParamValue("blockShape",e,t,n),i=split$1(getParamValue("paddings",e,t,n),2);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Fd)(getParamValue("x",e,t,n),o,i)];case"batchToSpaceND":o=getParamValue("blockShape",e,t,n);var a=split$1(getParamValue("crops",e,t,n),2);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.M)(getParamValue("x",e,t,n),o,a)];case"depthToSpace":var s=getParamValue("blockSize",e,t,n),u=getParamValue("dataFormat",e,t,n);return[Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.gb)(getParamValue("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function executeOp$16(e,t,n){switch(e.category){case"arithmetic":return executeOp(e,t,n);case"basic_math":return executeOp$1(e,t,n);case"control":return executeOp$2(e,t,n);case"convolution":return executeOp$3(e,t,n);case"creation":return executeOp$4(e,t,n);case"dynamic":return executeOp$5(e,t,n);case"evaluation":return executeOp$6(e,t,n);case"image":return executeOp$8(e,t,n);case"graph":return executeOp$7(e,t,n);case"logical":return executeOp$9(e,t,n);case"matrices":return executeOp$10(e,t,n);case"normalization":return executeOp$11(e,t,n);case"reduction":return executeOp$12(e,t,n);case"slice_join":return executeOp$13(e,t,n);case"spectral":return executeOp$14(e,t,n);case"transformation":return executeOp$15(e,t,n);default:throw TypeError("Node type "+e.op+" is not implemented")}}var ExecutionContext=function(){function e(e,t){this.weightMap=e,this.tensorArrayMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e},e.prototype.contextIdforContexts=function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":e.frameName+"-"+e.iterationId})).join("/"):""},e.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(e){return this.weightMap[e]},e.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},e.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},e}(),GraphExecutor=function(){function e(e){this.graph=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=e.placeholders,this._outputs=e.outputs,this.compile()}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.placeholders.map((function(e){return{name:e.name,shape:e.params.shape?e.params.shape.value:void 0,dtype:e.params.dtype?e.params.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.params.shape?e.params.shape.value:void 0,dtype:e.params.dtype?e.params.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.placeholders.map((function(e){return e.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.outputs.map((function(e){return e.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isControlFlowModel",{get:function(){return this.graph.withControlFlow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDynamicShapeModel",{get:function(){return this.graph.withDynamicShape},enumerable:!0,configurable:!0}),e.prototype.compile=function(e){if(!this.graph.withControlFlow&&!this.graph.withDynamicShape){var t=[],n=e||this.graph.placeholders,r=n.map((function(e){return e.name})).sort().join(this.SEPERATOR);if(!this.compiledMap.get(r)){for(var o=n.concat(this.graph.weights),i={};o.length>0;){var a=o.pop();i[a.name]=!0,t.push(a),a.children.forEach((function(e){!i[e.name]&&e.inputNames.every((function(e){var t=getNodeNameAndIndex(e)[0];return i[t]}))&&o.push(e)}))}this.compiledMap.set(r,t)}}},e.prototype.execute=function(e,t,n){var r=this;void 0===t&&(t=!0);var o=Object.keys(e).sort();this.checkInput(e,t),this.checkInputShapeAndType(e,t),this.compile(o.map((function(e){return r.graph.nodes[e]})));var i=this.calculateOutputs(n);this.checkOutput(this.compiledMap.get(o.join(this.SEPERATOR)),i);var a={};return Object(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.ee)((function(){for(var t=new ExecutionContext(r._weightMap,a),n=__assign({},r.weightMap,e),s=r.getFrozenTensorIds(n),u={},l=r.compiledMap.get(o.join(r.SEPERATOR)),c=0;c<l.length;c++){var h=l[c];if(n[h.name]||(n[h.name]=executeOp$16(h,n,t),r.checkTensorForDisposal(h.name,h,n,t,s,i,u)),i.every((function(e){return!!n[e]})))break}return r.findOutputs(n,t,i)}))},e.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)},e.prototype.checkTensorForDisposal=function(e,t,n,r,o,i,a){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(a[e.id]=(a[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=getTensorsForCurrentContenxt(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!o.has(e.id)){var t=a[e.id];1===t?(e.dispose(),delete a[e.id]):null!=t&&a[e.id]--}}))}})))},e.prototype.executeAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l=this;return __generator(this,(function(c){switch(c.label){case 0:return this.checkInput(e,!1),this.checkInputShapeAndType(e,!1),n=new ExecutionContext(this._weightMap,{}),r=this.calculateOutputs(t),[4,this.executeWithControlFlow(e,n,r)];case 1:return o=c.sent(),i=this.findOutputs(o,n,t),a=Object.keys(i).map((function(e){return i[e].id})),s=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))})),u=[].concat.apply([],s),Object.keys(o).forEach((function(e){o[e].forEach((function(e){e&&-1===a.indexOf(e.id)&&-1===u.indexOf(e.id)&&-1===l.weightIds.indexOf(e.id)&&e.dispose()}))})),[2,i]}}))}))},e.prototype.executeWithControlFlow=function(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,h=this;return __generator(this,(function(p){switch(p.label){case 0:r=Object.keys(e),o=r.map((function(e){return h.graph.nodes[e]})),i=o.concat(this.graph.weights).map((function(e){return{node:e,contexts:t.currentContext}})),a=__assign({},this.weightMap,e),s={},u=this.getFrozenTensorIds(a),l={},p.label=1;case 1:return i.length>0?(c=this.processStack(o,i,t,a,l,u,n,s),[4,Promise.all(c)]):[3,3];case 2:return p.sent(),[3,1];case 3:return[2,a]}}))}))},e.prototype.processStack=function(e,t,n,r,o,i,a,s){for(var u=this,l=[],c=function(){var c=t.pop();n.currentContext=c.contexts;var p="";if("enter"===c.node.op&&getParamValue("isConstant",c.node,r,n)&&(p=getNodeNameAndIndex(c.node.name,n)[0]),-1===e.indexOf(c.node)){var d=executeOp$16(c.node,r,n);p||(p=getNodeNameAndIndex(c.node.name,n)[0]);var f=n.currentContext;d instanceof Promise?l.push(d.then((function(e){return r[p]=e,n.currentContext=f,u.checkTensorForDisposal(p,c.node,r,n,i,a,s),u.processChildNodes(c.node,t,n,r,o),e}))):(r[p]=d,h.checkTensorForDisposal(p,c.node,r,n,i,a,s),h.processChildNodes(c.node,t,n,r,o))}else h.processChildNodes(c.node,t,n,r,o)},h=this;t.length>0;)c();return l},e.prototype.processChildNodes=function(e,t,n,r,o){e.children.forEach((function(e){var i=getNodeNameAndIndex(e.name,n)[0];o[i]||("merge"===e.op?e.inputNames.some((function(e){return!!getTensor(e,r,n)}))&&(o[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!getTensor(e,r,n)}))&&(o[i]=!0,t.push({contexts:n.currentContext,node:e})))}))},e.prototype.calculateOutputs=function(e){return!e||e instanceof Array||(e=[e]),e||this.graph.outputs.map((function(e){return e.name}))},e.prototype.findOutputs=function(e,t,n){return this.calculateOutputs(n).reduce((function(n,r){return n[r]=getTensor(r,e,t),n}),{})},e.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))},e.prototype.checkInputShapeAndType=function(e,t){void 0===t&&(t=!0),this.placeholders.forEach((function(n){var r=e[n.name];if(t||r){var o=r[0];if(n.params.shape&&n.params.shape.value){var i=n.params.shape.value,a=i.length===o.shape.length&&o.shape.every((function(e,t){return-1===i[t]||i[t]===e}));_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oe.assert(a,"The shape of dict['"+n.name+"'] provided in model.execute(dict) must be ["+i+"], but was ["+o.shape+"]")}n.params.dtype&&n.params.dtype.value&&_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.oe.assert(o.dtype===n.params.dtype.value,"The dtype of dict['"+n.name+"'] provided in model.execute(dict) must be "+n.params.dtype.value+", but was "+o.dtype)}}))},e.prototype.checkInput=function(e,t){var n=this;void 0===t&&(t=!0);var r=Object.keys(e),o=[],i=[];this.inputNodes.forEach((function(e){-1===r.indexOf(e)&&o.push(e)})),r.forEach((function(e){-1===n.inputNodes.indexOf(e)&&i.push(e)}));var a=i.filter((function(e){return!n.graph.nodes[e]}));if(o.length>0&&t)throw new Error("The dict provided in model.execute(dict) has the keys ["+r+"], but is missing the required keys: ["+o+"].");if(i.length>0&&t)throw new Error("The dict provided in model.execute(dict) has unused keys: ["+i+"]. Please provide only the following keys: ["+this.inputNodes+"].");if(a.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+a+"] not part of model graph.")},e.prototype.checkOutput=function(e,t){var n=e.map((function(e){return e.name})),r=[];if(t.forEach((function(e){-1===n.indexOf(e)&&r.push(e)})),r.length>0)throw new Error("The following outputs are not generated by the execution: ["+r+"].")},e}(),TFHUB_SEARCH_PARAM="?tfjs-format=file",DEFAULT_MODEL_NAME="tensorflowjs_model.pb",DEFAULT_MANIFEST_NAME="weights_manifest.json",FrozenModel=function(){function e(e,t,n,r){this.modelUrl=e,this.weightManifestUrl=t,this.requestOption=n,this.weightPrefix=r,this.version="n/a"}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var e=[this.modelUrl,this.weightManifestUrl];if(this.requestOption)this.handler=_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Nb.browserHTTPRequest(e,this.requestOption,this.weightPrefix);else{var t=_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Nb.getLoadHandlers(e);if(0===t.length)t.push(_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Nb.browserHTTPRequest(e,this.requestOption));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for URL '"+[e]+"'");this.handler=t[0]}},e.prototype.load=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,n;return __generator(this,(function(r){switch(r.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return e=r.sent(),t=compiled_api_1.GraphDef.decode(new Uint8Array(e.modelTopology)),this.version=t.versions.producer+"."+t.versions.minConsumer,n=_tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.Nb.decodeWeights(e.weightData,e.weightSpecs),this.executor=new GraphExecutor(OperationMapper.Instance.transformGraph(t)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}}))}))},e.prototype.predict=function(e,t){return this.execute_(e,!0,this.outputNodes)},e.prototype.constructTensorMap=function(e){var t=e instanceof _tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.o?[e]:e;if(t.length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the frozen model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},e.prototype.execute=function(e,t){return this.execute_(e,!1,t)},e.prototype.execute_=function(e,t,n){if(void 0===t&&(t=!0),n=n||this.outputNodes,(e instanceof _tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.o||Array.isArray(e))&&(e=this.constructTensorMap(e)),this.executor.isControlFlowModel||this.executor.isDynamicShapeModel)throw new Error("The model contains control flow or dynamic shape ops, please use executeAsync method");var r=this.executor.execute(this.convertTensorMapToTensorsMap(e),t,n),o=Object.keys(r);return Array.isArray(n)&&n.length>1?n.map((function(e){return r[e]})):r[o[0]]},e.prototype.executeAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r;return __generator(this,(function(o){switch(o.label){case 0:if(!this.executor.isControlFlowModel&&!this.executor.isDynamicShapeModel)throw new Error("The model does not contain control flow or dynamic shape ops, please use execute method for better performance.");return t=t||this.outputNodes,(e instanceof _tensorflow_tfjs_core__WEBPACK_IMPORTED_MODULE_0__.o||Array.isArray(e))&&(e=this.constructTensorMap(e)),[4,this.executor.executeAsync(this.convertTensorMapToTensorsMap(e),t)];case 1:return n=o.sent(),r=Object.keys(n),[2,Array.isArray(t)&&t.length>1?t.map((function(e){return n[e]})):n[r[0]]]}}))}))},e.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})},e.prototype.dispose=function(){this.executor.dispose()},e}();function loadFrozenModel(e,t,n){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:return[4,(r=new FrozenModel(e,t,n)).load()];case 1:return o.sent(),[2,r]}}))}))}function loadTfHubModule(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return e.endsWith("/")||(e+="/"),[2,loadFrozenModel(""+e+DEFAULT_MODEL_NAME+TFHUB_SEARCH_PARAM,""+e+DEFAULT_MANIFEST_NAME+TFHUB_SEARCH_PARAM,t)]}))}))}var version="0.7.0"},zUnb:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"array",(function(){return kg})),n.d(r,"Dataset",(function(){return Og})),n.d(r,"datasetFromIteratorFn",(function(){return Sg})),n.d(r,"zip",(function(){return Tg})),n.d(r,"CSVDataset",(function(){return zg})),n.d(r,"TextLineDataset",(function(){return Rg})),n.d(r,"csv",(function(){return Yg})),n.d(r,"FileDataSource",(function(){return ey})),n.d(r,"URLDataSource",(function(){return Jg})),n.d(r,"version_data",(function(){return ty}));var o={};function i(e){return"function"==typeof e}n.r(o),n.d(o,"data",(function(){return r})),n.d(o,"version",(function(){return ny})),n.d(o,"setBackend",(function(){return Kl.sd})),n.d(o,"getBackend",(function(){return Kl.Db})),n.d(o,"disposeVariables",(function(){return Kl.jb})),n.d(o,"memory",(function(){return Kl.pc})),n.d(o,"version_core",(function(){return Kl.te})),n.d(o,"nextFrame",(function(){return Kl.Cc})),n.d(o,"environment",(function(){return Kl.ob})),n.d(o,"io",(function(){return Kl.Nb})),n.d(o,"math",(function(){return Kl.jc})),n.d(o,"serialization",(function(){return Kl.rd})),n.d(o,"test_util",(function(){return Kl.de})),n.d(o,"util",(function(){return Kl.oe})),n.d(o,"webgl",(function(){return Kl.ue})),n.d(o,"AdadeltaOptimizer",(function(){return Kl.a})),n.d(o,"AdagradOptimizer",(function(){return Kl.b})),n.d(o,"AdamOptimizer",(function(){return Kl.c})),n.d(o,"AdamaxOptimizer",(function(){return Kl.d})),n.d(o,"MomentumOptimizer",(function(){return Kl.i})),n.d(o,"Optimizer",(function(){return Kl.j})),n.d(o,"RMSPropOptimizer",(function(){return Kl.k})),n.d(o,"SGDOptimizer",(function(){return Kl.n})),n.d(o,"Tensor",(function(){return Kl.o})),n.d(o,"TensorBuffer",(function(){return Kl.p})),n.d(o,"variable",(function(){return Kl.re})),n.d(o,"Variable",(function(){return Kl.q})),n.d(o,"Rank",(function(){return Kl.l})),n.d(o,"Reduction",(function(){return Kl.m})),n.d(o,"ENV",(function(){return Kl.f})),n.d(o,"Environment",(function(){return Kl.g})),n.d(o,"KernelBackend",(function(){return Kl.h})),n.d(o,"DataStorage",(function(){return Kl.e})),n.d(o,"image",(function(){return Kl.Mb})),n.d(o,"linalg",(function(){return Kl.Vb})),n.d(o,"losses",(function(){return Kl.hc})),n.d(o,"spectral",(function(){return Kl.Hd})),n.d(o,"op",(function(){return Kl.Jc})),n.d(o,"batchNormalization2d",(function(){return Kl.J})),n.d(o,"batchNormalization3d",(function(){return Kl.K})),n.d(o,"batchNormalization4d",(function(){return Kl.L})),n.d(o,"batchNormalization",(function(){return Kl.I})),n.d(o,"complex",(function(){return Kl.S})),n.d(o,"real",(function(){return Kl.bd})),n.d(o,"imag",(function(){return Kl.Lb})),n.d(o,"concat",(function(){return Kl.T})),n.d(o,"concat1d",(function(){return Kl.U})),n.d(o,"concat2d",(function(){return Kl.V})),n.d(o,"concat3d",(function(){return Kl.W})),n.d(o,"concat4d",(function(){return Kl.X})),n.d(o,"split",(function(){return Kl.Id})),n.d(o,"conv1d",(function(){return Kl.Y})),n.d(o,"conv2d",(function(){return Kl.Z})),n.d(o,"conv2dDerFilter",(function(){return Kl.ab})),n.d(o,"depthwiseConv2d",(function(){return Kl.hb})),n.d(o,"separableConv2d",(function(){return Kl.qd})),n.d(o,"conv2dTranspose",(function(){return Kl.bb})),n.d(o,"matMul",(function(){return Kl.ic})),n.d(o,"dot",(function(){return Kl.mb})),n.d(o,"outerProduct",(function(){return Kl.Kc})),n.d(o,"reverse",(function(){return Kl.fd})),n.d(o,"reverse1d",(function(){return Kl.gd})),n.d(o,"reverse2d",(function(){return Kl.hd})),n.d(o,"reverse3d",(function(){return Kl.id})),n.d(o,"reverse4d",(function(){return Kl.jd})),n.d(o,"maxPool",(function(){return Kl.lc})),n.d(o,"avgPool",(function(){return Kl.G})),n.d(o,"pool",(function(){return Kl.Qc})),n.d(o,"slice",(function(){return Kl.yd})),n.d(o,"slice1d",(function(){return Kl.zd})),n.d(o,"slice2d",(function(){return Kl.Ad})),n.d(o,"slice3d",(function(){return Kl.Bd})),n.d(o,"slice4d",(function(){return Kl.Cd})),n.d(o,"abs",(function(){return Kl.r})),n.d(o,"acos",(function(){return Kl.s})),n.d(o,"acosh",(function(){return Kl.t})),n.d(o,"asin",(function(){return Kl.B})),n.d(o,"asinh",(function(){return Kl.C})),n.d(o,"atan",(function(){return Kl.D})),n.d(o,"atanh",(function(){return Kl.F})),n.d(o,"ceil",(function(){return Kl.P})),n.d(o,"clipByValue",(function(){return Kl.Q})),n.d(o,"cos",(function(){return Kl.cb})),n.d(o,"cosh",(function(){return Kl.db})),n.d(o,"erf",(function(){return Kl.rb})),n.d(o,"exp",(function(){return Kl.sb})),n.d(o,"expm1",(function(){return Kl.ub})),n.d(o,"floor",(function(){return Kl.yb})),n.d(o,"log",(function(){return Kl.Yb})),n.d(o,"log1p",(function(){return Kl.Zb})),n.d(o,"logSigmoid",(function(){return Kl.ac})),n.d(o,"neg",(function(){return Kl.Bc})),n.d(o,"reciprocal",(function(){return Kl.cd})),n.d(o,"round",(function(){return Kl.ld})),n.d(o,"rsqrt",(function(){return Kl.md})),n.d(o,"sigmoid",(function(){return Kl.ud})),n.d(o,"sign",(function(){return Kl.vd})),n.d(o,"sin",(function(){return Kl.wd})),n.d(o,"sinh",(function(){return Kl.xd})),n.d(o,"softplus",(function(){return Kl.Ed})),n.d(o,"sqrt",(function(){return Kl.Jd})),n.d(o,"square",(function(){return Kl.Kd})),n.d(o,"step",(function(){return Kl.Pd})),n.d(o,"tan",(function(){return Kl.Ud})),n.d(o,"tanh",(function(){return Kl.Vd})),n.d(o,"all",(function(){return Kl.x})),n.d(o,"any",(function(){return Kl.y})),n.d(o,"argMax",(function(){return Kl.z})),n.d(o,"argMin",(function(){return Kl.A})),n.d(o,"logSumExp",(function(){return Kl.cc})),n.d(o,"max",(function(){return Kl.kc})),n.d(o,"mean",(function(){return Kl.oc})),n.d(o,"min",(function(){return Kl.qc})),n.d(o,"moments",(function(){return Kl.vc})),n.d(o,"sum",(function(){return Kl.Td})),n.d(o,"prod",(function(){return Kl.Vc})),n.d(o,"equal",(function(){return Kl.pb})),n.d(o,"equalStrict",(function(){return Kl.qb})),n.d(o,"greater",(function(){return Kl.Gb})),n.d(o,"greaterEqual",(function(){return Kl.Hb})),n.d(o,"greaterEqualStrict",(function(){return Kl.Ib})),n.d(o,"greaterStrict",(function(){return Kl.Jb})),n.d(o,"less",(function(){return Kl.Rb})),n.d(o,"lessEqual",(function(){return Kl.Sb})),n.d(o,"lessEqualStrict",(function(){return Kl.Tb})),n.d(o,"lessStrict",(function(){return Kl.Ub})),n.d(o,"notEqual",(function(){return Kl.Ec})),n.d(o,"notEqualStrict",(function(){return Kl.Fc})),n.d(o,"add",(function(){return Kl.u})),n.d(o,"addN",(function(){return Kl.v})),n.d(o,"addStrict",(function(){return Kl.w})),n.d(o,"atan2",(function(){return Kl.E})),n.d(o,"div",(function(){return Kl.kb})),n.d(o,"divStrict",(function(){return Kl.lb})),n.d(o,"floorDiv",(function(){return Kl.zb})),n.d(o,"maximum",(function(){return Kl.mc})),n.d(o,"maximumStrict",(function(){return Kl.nc})),n.d(o,"minimum",(function(){return Kl.rc})),n.d(o,"minimumStrict",(function(){return Kl.sc})),n.d(o,"mod",(function(){return Kl.tc})),n.d(o,"modStrict",(function(){return Kl.uc})),n.d(o,"mul",(function(){return Kl.xc})),n.d(o,"mulStrict",(function(){return Kl.yc})),n.d(o,"pow",(function(){return Kl.Rc})),n.d(o,"powStrict",(function(){return Kl.Sc})),n.d(o,"squaredDifference",(function(){return Kl.Ld})),n.d(o,"squaredDifferenceStrict",(function(){return Kl.Md})),n.d(o,"sub",(function(){return Kl.Rd})),n.d(o,"subStrict",(function(){return Kl.Sd})),n.d(o,"elu",(function(){return Kl.nb})),n.d(o,"leakyRelu",(function(){return Kl.Qb})),n.d(o,"prelu",(function(){return Kl.Tc})),n.d(o,"relu",(function(){return Kl.dd})),n.d(o,"selu",(function(){return Kl.pd})),n.d(o,"logicalAnd",(function(){return Kl.dc})),n.d(o,"logicalNot",(function(){return Kl.ec})),n.d(o,"logicalOr",(function(){return Kl.fc})),n.d(o,"logicalXor",(function(){return Kl.gc})),n.d(o,"where",(function(){return Kl.ve})),n.d(o,"whereAsync",(function(){return Kl.we})),n.d(o,"buffer",(function(){return Kl.N})),n.d(o,"toPixels",(function(){return Kl.he})),n.d(o,"print",(function(){return Kl.Uc})),n.d(o,"batchToSpaceND",(function(){return Kl.M})),n.d(o,"cast",(function(){return Kl.O})),n.d(o,"clone",(function(){return Kl.R})),n.d(o,"cumsum",(function(){return Kl.eb})),n.d(o,"depthToSpace",(function(){return Kl.gb})),n.d(o,"expandDims",(function(){return Kl.tb})),n.d(o,"eye",(function(){return Kl.vb})),n.d(o,"fromPixels",(function(){return Kl.Ab})),n.d(o,"multinomial",(function(){return Kl.Ac})),n.d(o,"oneHot",(function(){return Kl.Gc})),n.d(o,"pad",(function(){return Kl.Lc})),n.d(o,"pad1d",(function(){return Kl.Mc})),n.d(o,"pad2d",(function(){return Kl.Nc})),n.d(o,"pad3d",(function(){return Kl.Oc})),n.d(o,"pad4d",(function(){return Kl.Pc})),n.d(o,"rand",(function(){return Kl.Xc})),n.d(o,"randomNormal",(function(){return Kl.Yc})),n.d(o,"randomUniform",(function(){return Kl.Zc})),n.d(o,"reshape",(function(){return Kl.ed})),n.d(o,"spaceToBatchND",(function(){return Kl.Fd})),n.d(o,"squeeze",(function(){return Kl.Nd})),n.d(o,"stack",(function(){return Kl.Od})),n.d(o,"tile",(function(){return Kl.fe})),n.d(o,"truncatedNormal",(function(){return Kl.le})),n.d(o,"unstack",(function(){return Kl.ne})),n.d(o,"setdiff1dAsync",(function(){return Kl.td})),n.d(o,"fill",(function(){return Kl.xb})),n.d(o,"linspace",(function(){return Kl.Wb})),n.d(o,"ones",(function(){return Kl.Hc})),n.d(o,"range",(function(){return Kl.ad})),n.d(o,"scalar",(function(){return Kl.nd})),n.d(o,"tensor",(function(){return Kl.Wd})),n.d(o,"tensor1d",(function(){return Kl.Xd})),n.d(o,"tensor2d",(function(){return Kl.Yd})),n.d(o,"tensor3d",(function(){return Kl.Zd})),n.d(o,"tensor4d",(function(){return Kl.ae})),n.d(o,"tensor5d",(function(){return Kl.be})),n.d(o,"tensor6d",(function(){return Kl.ce})),n.d(o,"zeros",(function(){return Kl.xe})),n.d(o,"onesLike",(function(){return Kl.Ic})),n.d(o,"zerosLike",(function(){return Kl.ye})),n.d(o,"transpose",(function(){return Kl.ke})),n.d(o,"softmax",(function(){return Kl.Dd})),n.d(o,"logSoftmax",(function(){return Kl.bc})),n.d(o,"localResponseNormalization",(function(){return Kl.Xb})),n.d(o,"norm",(function(){return Kl.Dc})),n.d(o,"gather",(function(){return Kl.Bb})),n.d(o,"unsortedSegmentSum",(function(){return Kl.me})),n.d(o,"basicLSTMCell",(function(){return Kl.H})),n.d(o,"multiRNNCell",(function(){return Kl.zc})),n.d(o,"movingAverage",(function(){return Kl.wc})),n.d(o,"stridedSlice",(function(){return Kl.Qd})),n.d(o,"topk",(function(){return Kl.ie})),n.d(o,"scatterND",(function(){return Kl.od})),n.d(o,"fft",(function(){return Kl.wb})),n.d(o,"ifft",(function(){return Kl.Kb})),n.d(o,"rfft",(function(){return Kl.kd})),n.d(o,"irfft",(function(){return Kl.Ob})),n.d(o,"sparseToDense",(function(){return Kl.Gd})),n.d(o,"gatherND",(function(){return Kl.Cb})),n.d(o,"train",(function(){return Kl.je})),n.d(o,"tidy",(function(){return Kl.ee})),n.d(o,"keep",(function(){return Kl.Pb})),n.d(o,"dispose",(function(){return Kl.ib})),n.d(o,"time",(function(){return Kl.ge})),n.d(o,"profile",(function(){return Kl.Wc})),n.d(o,"customGrad",(function(){return Kl.fb})),n.d(o,"grad",(function(){return Kl.Eb})),n.d(o,"grads",(function(){return Kl.Fb})),n.d(o,"valueAndGrad",(function(){return Kl.pe})),n.d(o,"valueAndGrads",(function(){return Kl.qe})),n.d(o,"variableGrads",(function(){return Kl.se})),n.d(o,"constraints",(function(){return Fc})),n.d(o,"initializers",(function(){return zh})),n.d(o,"layers",(function(){return Nm})),n.d(o,"models",(function(){return Em})),n.d(o,"metrics",(function(){return Cm})),n.d(o,"regularizers",(function(){return Im})),n.d(o,"CallbackList",(function(){return lp})),n.d(o,"CustomCallback",(function(){return dp})),n.d(o,"History",(function(){return pp})),n.d(o,"Callback",(function(){return Om})),n.d(o,"InputSpec",(function(){return Jh})),n.d(o,"SymbolicTensor",(function(){return Yh})),n.d(o,"Model",(function(){return Sd})),n.d(o,"input",(function(){return Rd})),n.d(o,"loadModel",(function(){return Dd})),n.d(o,"model",(function(){return Ad})),n.d(o,"registerCallbackConstructor",(function(){return Md})),n.d(o,"sequential",(function(){return Pd})),n.d(o,"RNN",(function(){return rm})),n.d(o,"Sequential",(function(){return Td})),n.d(o,"LayerVariable",(function(){return Gh})),n.d(o,"version_layers",(function(){return ed})),n.d(o,"FrozenModel",(function(){return Sm.a})),n.d(o,"loadFrozenModel",(function(){return Sm.b})),n.d(o,"loadTfHubModule",(function(){return Sm.c})),n.d(o,"version_converter",(function(){return Sm.d}));let a=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else a&&console.log("RxJS: Back to a better error behavior. Thank you. <3");a=e},get useDeprecatedSynchronousErrorHandling(){return a}};function u(e){setTimeout(()=>{throw e})}const l={closed:!0,next(e){},error(e){if(s.useDeprecatedSynchronousErrorHandling)throw e;u(e)},complete(){}},c=Array.isArray||(e=>e&&"number"==typeof e.length);function h(e){return null!==e&&"object"==typeof e}function p(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}p.prototype=Object.create(Error.prototype);const d=p;let f=(()=>{class e{constructor(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}unsubscribe(){let e,t=!1;if(this.closed)return;let{_parent:n,_parents:r,_unsubscribe:o,_subscriptions:a}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let s=-1,u=r?r.length:0;for(;n;)n.remove(this),n=++s<u&&r[s]||null;if(i(o))try{o.call(this)}catch(Qh){t=!0,e=Qh instanceof d?m(Qh.errors):[Qh]}if(c(a))for(s=-1,u=a.length;++s<u;){const n=a[s];if(h(n))try{n.unsubscribe()}catch(Qh){t=!0,e=e||[],Qh instanceof d?e=e.concat(m(Qh.errors)):e.push(Qh)}}if(t)throw new d(e)}add(t){let n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){const t=n;(n=new e)._subscriptions=[t]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(n._addParent(this)){const e=this._subscriptions;e?e.push(n):this._subscriptions=[n]}return n}remove(e){const t=this._subscriptions;if(t){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}_addParent(e){let{_parent:t,_parents:n}=this;return t!==e&&(t?n?-1===n.indexOf(e)&&(n.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))}}return e.EMPTY=function(e){return e.closed=!0,e}(new e),e})();function m(e){return e.reduce((e,t)=>e.concat(t instanceof d?t.errors:t),[])}const g="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends f{constructor(e,t,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=l;break;case 1:if(!e){this.destination=l;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new v(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new v(this,e,t,n)}}[g](){return this}static create(e,t,n){const r=new y(e,t,n);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:e,_parents:t}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this}}class v extends y{constructor(e,t,n,r){let o;super(),this._parentSubscriber=e;let a=this;i(t)?o=t:t&&(o=t.next,n=t.error,r=t.complete,t!==l&&(i((a=Object.create(t)).unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:n}=s;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):u(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;u(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw n;u(n)}}__tryOrSetError(e,t,n){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return s.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(u(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const b="function"==typeof Symbol&&Symbol.observable||"@@observable";function w(){}let x=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const{operator:r}=this,o=function(e,t,n){if(e){if(e instanceof y)return e;if(e[g])return e[g]()}return e||t||n?new y(e,t,n):new y(l)}(e,t,n);if(o.add(r?r.call(o,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),s.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(e){try{return this._subscribe(e)}catch(t){s.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:n,isStopped:r}=e;if(t||r)return!1;e=n&&n instanceof y?n:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=_(t))((t,n)=>{let r;r=this.subscribe(t=>{try{e(t)}catch(o){n(o),r&&r.unsubscribe()}},n,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[b](){return this}pipe(...e){return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)}:w)(this);var t}toPromise(e){return new(e=_(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function _(e){if(e||(e=s.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function N(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}N.prototype=Object.create(Error.prototype);const E=N;class C extends f{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}class I extends y{constructor(e){super(e),this.destination=e}}let O=(()=>{class e extends x{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[g](){return new I(this)}lift(e){const t=new S(this,this);return t.operator=e,t}next(e){if(this.closed)throw new E;if(!this.isStopped){const{observers:t}=this,n=t.length,r=t.slice();for(let o=0;o<n;o++)r[o].next(e)}}error(e){if(this.closed)throw new E;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,n=t.length,r=t.slice();for(let o=0;o<n;o++)r[o].error(e);this.observers.length=0}complete(){if(this.closed)throw new E;this.isStopped=!0;const{observers:e}=this,t=e.length,n=e.slice();for(let r=0;r<t;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new E;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new E;return this.hasError?(e.error(this.thrownError),f.EMPTY):this.isStopped?(e.complete(),f.EMPTY):(this.observers.push(e),new C(this,e))}asObservable(){const e=new x;return e.source=this,e}}return e.create=(e,t)=>new S(e,t),e})();class S extends O{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):f.EMPTY}}function k(e){return e&&"function"==typeof e.schedule}class T extends y{constructor(e,t,n){super(),this.parent=e,this.outerValue=t,this.outerIndex=n,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const A=e=>t=>{for(let n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.closed||t.complete()},P=e=>t=>(e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,u),t);function D(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const R=D(),M=e=>t=>{const n=e[R]();for(;;){const e=n.next();if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t},j=e=>t=>{const n=e[b]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)},L=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function V(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const F=e=>{if(e instanceof x)return t=>e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t);if(e&&"function"==typeof e[b])return j(e);if(L(e))return A(e);if(V(e))return P(e);if(e&&"function"==typeof e[R])return M(e);{const t=h(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function z(e,t,n,r,o=new T(e,n,r)){if(!o.closed)return F(t)(o)}class B extends y{notifyNext(e,t,n,r,o){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}function U(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new W(e,t))}}class W{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new $(e,this.project,this.thisArg))}}class $ extends y{constructor(e,t,n){super(e),this.project=t,this.count=0,this.thisArg=n||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}function q(e,t){return new x(t?n=>{const r=new f;let o=0;return r.add(t.schedule((function(){o!==e.length?(n.next(e[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}:A(e))}function H(e,t){if(!t)return e instanceof x?e:new x(F(e));if(null!=e){if(function(e){return e&&"function"==typeof e[b]}(e))return function(e,t){return new x(t?n=>{const r=new f;return r.add(t.schedule(()=>{const o=e[b]();r.add(o.subscribe({next(e){r.add(t.schedule(()=>n.next(e)))},error(e){r.add(t.schedule(()=>n.error(e)))},complete(){r.add(t.schedule(()=>n.complete()))}}))})),r}:j(e))}(e,t);if(V(e))return function(e,t){return new x(t?n=>{const r=new f;return r.add(t.schedule(()=>e.then(e=>{r.add(t.schedule(()=>{n.next(e),r.add(t.schedule(()=>n.complete()))}))},e=>{r.add(t.schedule(()=>n.error(e)))}))),r}:P(e))}(e,t);if(L(e))return q(e,t);if(function(e){return e&&"function"==typeof e[R]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new x(t?n=>{const r=new f;let o;return r.add(()=>{o&&"function"==typeof o.return&&o.return()}),r.add(t.schedule(()=>{o=e[R](),r.add(t.schedule((function(){if(n.closed)return;let e,t;try{const n=o.next();e=n.value,t=n.done}catch(r){return void n.error(r)}t?n.complete():(n.next(e),this.schedule())})))})),r}:M(e))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function G(e,t,n=Number.POSITIVE_INFINITY){return"function"==typeof t?r=>r.pipe(G((n,r)=>H(e(n,r)).pipe(U((e,o)=>t(n,e,r,o))),n)):("number"==typeof t&&(n=t),t=>t.lift(new K(e,n)))}class K{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new X(e,this.project,this.concurrent))}}class X extends B{constructor(e,t,n=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}_innerSub(e,t,n){const r=new T(this,void 0,void 0);this.destination.add(r),z(this,e,t,n,r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e,t,n,r,o){this.destination.next(t)}notifyComplete(e){const t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Z(e){return e}function Q(){return function(e){return e.lift(new J(e))}}class J{constructor(e){this.connectable=e}call(e,t){const{connectable:n}=this;n._refCount++;const r=new Y(e,n),o=t.subscribe(r);return r.closed||(r.connection=n.connect()),o}}class Y extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:n}=this,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}const ee=class extends x{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new f).add(this.source.subscribe(new ne(this.getSubject(),this))),e.closed?(this._connection=null,e=f.EMPTY):this._connection=e),e}refCount(){return Q()(this)}}.prototype,te={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:ee._subscribe},_isComplete:{value:ee._isComplete,writable:!0},getSubject:{value:ee.getSubject},connect:{value:ee.connect},refCount:{value:ee.refCount}};class ne extends I{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function re(){return new O}const oe="__parameters__";function ie(e,t,n){const r=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function o(...e){if(this instanceof o)return r.apply(this,e),this;const t=new o(...e);return n.annotation=t,n;function n(e,n,r){const o=e.hasOwnProperty(oe)?e[oe]:Object.defineProperty(e,oe,{value:[]})[oe];for(;o.length<=r;)o.push(null);return(o[r]=o[r]||[]).push(t),e}}return n&&(o.prototype=Object.create(n.prototype)),o.prototype.ngMetadataName=e,o.annotationCls=o,o}const ae=ie("Inject",e=>({token:e})),se=ie("Optional"),ue=ie("Self"),le=ie("SkipSelf");var ce=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function he(e){for(let t in e)if(e[t]===he)return t;throw Error("Could not find renamed property on target object.")}function pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function de(e){const t=e[fe];return t&&t.token===e?t:null}const fe=he({ngInjectableDef:he});function me(e){if("string"==typeof e)return e;if(e instanceof Array)return"["+e.map(me).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}const ge=he({__forward_ref__:he});function ye(e){return e.__forward_ref__=ye,e.toString=function(){return me(this())},e}function ve(e){const t=e;return"function"==typeof t&&t.hasOwnProperty(ge)&&t.__forward_ref__===ye?t():e}const be="undefined"!=typeof globalThis&&globalThis,we="undefined"!=typeof window&&window,xe="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,_e="undefined"!=typeof global&&global,Ne=be||_e||we||xe;class Ee{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.ngInjectableDef=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Ce=new Ee("INJECTOR",-1),Ie=new Object,Oe="ngTempTokenPath",Se="ngTokenPath",ke=/\n/gm,Te="\u0275",Ae="__source",Pe=he({provide:String,useValue:he});let De,Re=void 0;function Me(e){const t=Re;return Re=e,t}function je(e,t=ce.Default){if(void 0===Re)throw new Error("inject() must be called from an injection context");return null===Re?function(e,t,n){const r=de(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ce.Optional)return null;throw new Error(`Injector: NOT_FOUND [${me(e)}]`)}(e,0,t):Re.get(e,t&ce.Optional?null:void 0,t)}function Le(e,t=ce.Default){return(De||je)(e,t)}class Ve{get(e,t=Ie){if(t===Ie){const t=new Error(`NullInjectorError: No provider for ${me(e)}!`);throw t.name="NullInjectorError",t}return t}}function Fe(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&e.charAt(1)==Te?e.substr(2):e;let o=me(t);if(t instanceof Array)o=t.map(me).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push(n+":"+("string"==typeof r?JSON.stringify(r):me(r)))}o=`{${e.join(", ")}}`}return`${n}${r?"("+r+")":""}[${o}]: ${e.replace(ke,"\n  ")}`}class ze{}class Be{}function Ue(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function We(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}const $e=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),qe=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ne))(),He="ngDebugContext",Ge="ngOriginalError",Ke="ngErrorLogger";function Xe(e){return e[He]}function Ze(e){return e[Ge]}function Qe(e,...t){e.error(...t)}class Je{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e[Ke]||Qe}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?Xe(e)?Xe(e):this._findContext(Ze(e)):null}_findOriginalError(e){let t=Ze(e);for(;t&&Ze(t);)t=Ze(t);return t}}let Ye=!0,et=!1;function tt(){return et=!0,Ye}class nt{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e),this.inertBodyElement=this.inertDocument.createElement("body"),e.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(r){return null}const t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);const n=t.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(e){e="<body><remove></remove>"+e+"</body>";try{const t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(t){return null}}getInertBodyElement_InertDocument(e){const t=this.inertDocument.createElement("template");return"content"in t?(t.innerHTML=e,t):(this.inertBodyElement.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const n=t.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||e.removeAttribute(n)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const rt=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,ot=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function it(e){return(e=String(e)).match(rt)||e.match(ot)?e:(tt()&&console.warn(`WARNING: sanitizing unsafe URL value ${e} (see http://g.co/ng/security#xss)`),"unsafe:"+e)}function at(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function st(...e){const t={};for(const n of e)for(const e in n)n.hasOwnProperty(e)&&(t[e]=!0);return t}const ut=at("area,br,col,hr,img,wbr"),lt=at("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ct=at("rp,rt"),ht=st(ct,lt),pt=st(ut,st(lt,at("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),st(ct,at("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ht),dt=at("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ft=at("srcset"),mt=st(dt,ft,at("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),at("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),gt=at("script,style,template");class yt{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!pt.hasOwnProperty(t))return this.sanitizedSomething=!0,!gt.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let o=0;o<n.length;o++){const e=n.item(o),t=e.name,i=t.toLowerCase();if(!mt.hasOwnProperty(i)){this.sanitizedSomething=!0;continue}let a=e.value;dt[i]&&(a=it(a)),ft[i]&&(r=a,a=(r=String(r)).split(",").map(e=>it(e.trim())).join(", ")),this.buf.push(" ",t,'="',wt(a),'"')}var r;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();pt.hasOwnProperty(t)&&!ut.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(wt(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const vt=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,bt=/([^\#-~ |!])/g;function wt(e){return e.replace(/&/g,"&amp;").replace(vt,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(bt,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let xt;function _t(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}const Nt=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}();class Et{}const Ct=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),It=/^url\(([^)]+)\)$/,Ot=/([A-Z])/g;function St(e){try{return null!=e?e.toString().slice(0,30):e}catch(Qh){return"[ERROR] Exception while trying to serialize the value"}}let kt=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Tt(),e})();const Tt=(...e)=>{},At=new Ee("The presence of this token marks an injector as being the root injector."),Pt=function(e,t,n){return new Ft(e,t,n)};let Dt=(()=>{class e{static create(e,t){return Array.isArray(e)?Pt(e,t,""):Pt(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=Ie,e.NULL=new Ve,e.ngInjectableDef=pe({token:e,providedIn:"any",factory:()=>Le(Ce)}),e.__NG_ELEMENT_ID__=-1,e})();const Rt=function(e){return e},Mt=[],jt=Rt,Lt=function(){return Array.prototype.slice.call(arguments)},Vt="\u0275";class Ft{constructor(e,t=Dt.NULL,n=null){this.parent=t,this.source=n;const r=this._records=new Map;r.set(Dt,{token:Dt,fn:Rt,deps:Mt,value:this,useNew:!1}),r.set(Ce,{token:Ce,fn:Rt,deps:Mt,value:this,useNew:!1}),function e(t,n){if(n)if((n=ve(n))instanceof Array)for(let r=0;r<n.length;r++)e(t,n[r]);else{if("function"==typeof n)throw Bt("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Bt("Unexpected provider",n);{let e=ve(n.provide);const r=function(e){const t=function(e){let t=Mt;const n=e.deps;if(n&&n.length){t=[];for(let e=0;e<n.length;e++){let r=6,o=ve(n[e]);if(o instanceof Array)for(let e=0,t=o;e<t.length;e++){const n=t[e];n instanceof se||n==se?r|=1:n instanceof le||n==le?r&=-3:n instanceof ue||n==ue?r&=-5:o=n instanceof ae?n.token:ve(n)}t.push({token:o,options:r})}}else if(e.useExisting)t=[{token:ve(e.useExisting),options:6}];else if(!(n||Pe in e))throw Bt("'deps' required",e);return t}(e);let n=Rt,r=Mt,o=!1,i=ve(e.provide);if(Pe in e)r=e.useValue;else if(e.useFactory)n=e.useFactory;else if(e.useExisting);else if(e.useClass)o=!0,n=ve(e.useClass);else{if("function"!=typeof i)throw Bt("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",e);o=!0,n=i}return{deps:t,fn:n,useNew:o,value:r}}(n);if(!0===n.multi){let r=t.get(e);if(r){if(r.fn!==Lt)throw zt(e)}else t.set(e,r={token:n.provide,deps:[],useNew:!1,fn:Lt,value:Mt});r.deps.push({token:e=n,options:6})}const o=t.get(e);if(o&&o.fn==Lt)throw zt(e);t.set(e,r)}}}(r,e)}get(e,t,n=ce.Default){const r=this._records.get(e);try{return function e(t,n,r,o,i,a){try{return function(t,n,r,o,i,a){let s;if(!n||a&ce.SkipSelf)a&ce.Self||(s=o.get(t,i,ce.Default));else{if((s=n.value)==jt)throw Error(Vt+"Circular dependency");if(s===Mt){n.value=jt;let t=void 0,i=n.useNew,a=n.fn,u=n.deps,l=Mt;if(u.length){l=[];for(let t=0;t<u.length;t++){const n=u[t],i=n.options,a=2&i?r.get(n.token):void 0;l.push(e(n.token,a,r,a||4&i?o:Dt.NULL,1&i?null:Dt.THROW_IF_NOT_FOUND,ce.Default))}}n.value=s=i?new a(...l):a.apply(t,l)}}return s}(t,n,r,o,i,a)}catch(Qh){throw Qh instanceof Error||(Qh=new Error(Qh)),(Qh[Oe]=Qh[Oe]||[]).unshift(t),n&&n.value==jt&&(n.value=Mt),Qh}}(e,r,this._records,this.parent,t,n)}catch(Qh){return function(e,t,n,r){const o=e[Oe];throw t[Ae]&&o.unshift(t[Ae]),e.message=Fe("\n"+e.message,o,"StaticInjectorError",r),e[Se]=o,e[Oe]=null,e}(Qh,e,0,this.source)}}toString(){const e=[];return this._records.forEach((t,n)=>e.push(me(n))),`StaticInjector[${e.join(", ")}]`}}function zt(e){return Bt("Cannot mix multi providers and regular providers",e)}function Bt(e,t){return new Error(Fe(e,t,"StaticInjectorError"))}let Ut=null;function Wt(){if(!Ut){const e=Ne.Symbol;if(e&&e.iterator)Ut=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ut=n)}}}return Ut}function $t(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function qt(e,t){const n=Gt(e),r=Gt(t);if(n&&r)return function(e,t,n){const r=e[Wt()](),o=t[Wt()]();for(;;){const e=r.next(),t=o.next();if(e.done&&t.done)return!0;if(e.done||t.done)return!1;if(!n(e.value,t.value))return!1}}(e,t,qt);{const o=e&&("object"==typeof e||"function"==typeof e),i=t&&("object"==typeof t||"function"==typeof t);return!(n||!o||r||!i)||$t(e,t)}}class Ht{constructor(e){this.wrapped=e}static wrap(e){return new Ht(e)}static unwrap(e){return Ht.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Ht}}function Gt(e){return!!Kt(e)&&(Array.isArray(e)||!(e instanceof Map)&&Wt()in e)}function Kt(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Xt(e){return!!e&&"function"==typeof e.then}function Zt(e){return!!e&&"function"==typeof e.subscribe}class Qt{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}class Jt{}class Yt{}function en(e){const t=Error(`No component factory found for ${me(e)}. Did you add it to @NgModule.entryComponents?`);return t[tn]=e,t}const tn="ngComponent";class nn{resolveComponentFactory(e){throw en(e)}}let rn=(()=>{class e{}return e.NULL=new nn,e})();class on{constructor(e,t,n){this._parent=t,this._ngModule=n,this._factories=new Map;for(let r=0;r<e.length;r++){const t=e[r];this._factories.set(t.componentType,t)}}resolveComponentFactory(e){let t=this._factories.get(e);if(!t&&this._parent&&(t=this._parent.resolveComponentFactory(e)),!t)throw en(e);return new an(t,this._ngModule)}}class an extends Yt{constructor(e,t){super(),this.factory=e,this.ngModule=t,this.selector=e.selector,this.componentType=e.componentType,this.ngContentSelectors=e.ngContentSelectors,this.inputs=e.inputs,this.outputs=e.outputs}create(e,t,n,r){return this.factory.create(e,t,n,r||this.ngModule)}}function sn(...e){}let un=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=()=>ln(e),e})();const ln=sn;class cn{}class hn{}const pn=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}();let dn=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>fn(),e})();const fn=sn;class mn{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const gn=new mn("8.2.14");class yn{constructor(){}supports(e){return Gt(e)}create(e){return new bn(e)}}const vn=(e,t)=>t;class bn{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||vn}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,o=null;for(;t||n;){const i=!n||t&&t.currentIndex<Nn(n,r,o)?t:n,a=Nn(i,r,o),s=i.currentIndex;if(i===n)r--,n=n._nextRemoved;else if(t=t._next,null==i.previousIndex)r++;else{o||(o=[]);const e=a-r,t=s-r;if(e!=t){for(let n=0;n<e;n++){const r=n<o.length?o[n]:o[n]=0,i=r+n;t<=i&&i<e&&(o[n]=r+1)}o[i.previousIndex]=t-e}}a!==s&&e(i,a,s)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Gt(e))throw new Error(`Error trying to diff '${me(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,r,o=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)r=this._trackByFn(t,n=e[t]),null!==o&&$t(o.trackById,r)?(i&&(o=this._verifyReinsertion(o,n,r,t)),$t(o.item,n)||this._addIdentityChange(o,n)):(o=this._mismatch(o,n,r,t),i=!0),o=o._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Wt()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(e,e=>{r=this._trackByFn(t,e),null!==o&&$t(o.trackById,r)?(i&&(o=this._verifyReinsertion(o,e,r,t)),$t(o.item,e)||this._addIdentityChange(o,e)):(o=this._mismatch(o,e,r,t),i=!0),o=o._next,t++}),this.length=t;return this._truncate(o),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?($t(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?($t(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):e=this._addAfter(new wn(t,n),o,r),e}_verifyReinsertion(e,t,n,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,o=e._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new _n),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _n),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class wn{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xn{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&$t(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class _n{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new xn,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Nn(e,t,n){const r=e.previousIndex;if(null===r)return r;let o=0;return n&&r<n.length&&(o=n[r]),r+t+o}class En{constructor(){}supports(e){return e instanceof Map||Kt(e)}create(){return new Cn}}class Cn{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Kt(e)))throw new Error(`Error trying to diff '${me(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const r=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,r)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const r=n._prev,o=n._next;return r&&(r._next=o),o&&(o._prev=r),n._next=null,n._prev=null,n}const n=new In(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){$t(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class In{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let On=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new le,new se]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${n=e,n.name||typeof n}'`);var n}}return e.ngInjectableDef=pe({token:e,providedIn:"root",factory:()=>new e([new yn])}),e})(),Sn=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new le,new se]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.ngInjectableDef=pe({token:e,providedIn:"root",factory:()=>new e([new En])}),e})();const kn=[new En],Tn=new On([new yn]),An=new Sn(kn);let Pn=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Dn(e,un),e})();const Dn=sn;let Rn=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Mn(e,un),e})();const Mn=sn;function jn(e,t,n,r){let o=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${t}'. Current value: '${n}'.`;return r&&(o+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(e,t){const n=new Error(e);return Ln(n,t),n}(o,e)}function Ln(e,t){e[He]=t,e[Ke]=t.logError.bind(t)}function Vn(e){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${e}`)}function Fn(e,t,n){const r=e.state,o=1792&r;return o===t?(e.state=-1793&r|n,e.initIndex=-1,!0):o===n}function zn(e,t,n){return(1792&e.state)===t&&e.initIndex<=n&&(e.initIndex=n+1,!0)}function Bn(e,t){return e.nodes[t]}function Un(e,t){return e.nodes[t]}function Wn(e,t){return e.nodes[t]}function $n(e,t){return e.nodes[t]}function qn(e,t){return e.nodes[t]}const Hn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Gn=()=>{},Kn=new Map;function Xn(e){let t=Kn.get(e);return t||(t=me(e)+"_"+Kn.size,Kn.set(e,t)),t}const Zn="$$undefined",Qn="$$empty";function Jn(e){return{id:Zn,styles:e.styles,encapsulation:e.encapsulation,data:e.data}}let Yn=0;function er(e,t,n,r){return!(!(2&e.state)&&$t(e.oldValues[t.bindingIndex+n],r))}function tr(e,t,n,r){return!!er(e,t,n,r)&&(e.oldValues[t.bindingIndex+n]=r,!0)}function nr(e,t,n,r){const o=e.oldValues[t.bindingIndex+n];if(1&e.state||!qt(o,r)){const i=t.bindings[n].name;throw jn(Hn.createDebugContext(e,t.nodeIndex),`${i}: ${o}`,`${i}: ${r}`,0!=(1&e.state))}}function rr(e){let t=e;for(;t;)2&t.def.flags&&(t.state|=8),t=t.viewContainerParent||t.parent}function or(e,t){let n=e;for(;n&&n!==t;)n.state|=64,n=n.viewContainerParent||n.parent}function ir(e,t,n,r){try{return rr(33554432&e.def.nodes[t].flags?Un(e,t).componentView:e),Hn.handleEvent(e,t,n,r)}catch(Qh){e.root.errorHandler.handleError(Qh)}}function ar(e){return e.parent?Un(e.parent,e.parentNodeDef.nodeIndex):null}function sr(e){return e.parent?e.parentNodeDef.parent:null}function ur(e,t){switch(201347067&t.flags){case 1:return Un(e,t.nodeIndex).renderElement;case 2:return Bn(e,t.nodeIndex).renderText}}function lr(e){return!!e.parent&&!!(32768&e.parentNodeDef.flags)}function cr(e){return!(!e.parent||32768&e.parentNodeDef.flags)}function hr(e){return 1<<e%32}function pr(e){const t={};let n=0;const r={};return e&&e.forEach(([e,o])=>{"number"==typeof e?(t[e]=o,n|=hr(e)):r[e]=o}),{matchedQueries:t,references:r,matchedQueryIds:n}}function dr(e,t){return e.map(e=>{let n,r;return Array.isArray(e)?[r,n]=e:(r=0,n=e),n&&("function"==typeof n||"object"==typeof n)&&t&&Object.defineProperty(n,Ae,{value:t,configurable:!0}),{flags:r,token:n,tokenKey:Xn(n)}})}function fr(e,t,n){let r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===$e.Native?Un(e,n.renderParent.nodeIndex).renderElement:void 0:t}const mr=new WeakMap;function gr(e){let t=mr.get(e);return t||((t=e(()=>Gn)).factory=e,mr.set(e,t)),t}function yr(e,t,n,r,o){3===t&&(n=e.renderer.parentNode(ur(e,e.def.lastRenderRootNode))),vr(e,t,0,e.def.nodes.length-1,n,r,o)}function vr(e,t,n,r,o,i,a){for(let s=n;s<=r;s++){const n=e.def.nodes[s];11&n.flags&&wr(e,n,t,o,i,a),s+=n.childCount}}function br(e,t,n,r,o,i){let a=e;for(;a&&!lr(a);)a=a.parent;const s=a.parent,u=sr(a),l=u.nodeIndex+u.childCount;for(let c=u.nodeIndex+1;c<=l;c++){const e=s.def.nodes[c];e.ngContentIndex===t&&wr(s,e,n,r,o,i),c+=e.childCount}if(!s.parent){const a=e.root.projectableNodes[t];if(a)for(let t=0;t<a.length;t++)xr(e,a[t],n,r,o,i)}}function wr(e,t,n,r,o,i){if(8&t.flags)br(e,t.ngContent.index,n,r,o,i);else{const a=ur(e,t);if(3===n&&33554432&t.flags&&48&t.bindingFlags?(16&t.bindingFlags&&xr(e,a,n,r,o,i),32&t.bindingFlags&&xr(Un(e,t.nodeIndex).componentView,a,n,r,o,i)):xr(e,a,n,r,o,i),16777216&t.flags){const a=Un(e,t.nodeIndex).viewContainer._embeddedViews;for(let e=0;e<a.length;e++)yr(a[e],n,r,o,i)}1&t.flags&&!t.element.name&&vr(e,n,t.nodeIndex+1,t.nodeIndex+t.childCount,r,o,i)}}function xr(e,t,n,r,o,i){const a=e.renderer;switch(n){case 1:a.appendChild(r,t);break;case 2:a.insertBefore(r,t,o);break;case 3:a.removeChild(r,t);break;case 0:i.push(t)}}const _r=/^:([^:]+):(.+)$/;function Nr(e){if(":"===e[0]){const t=e.match(_r);return[t[1],t[2]]}return["",e]}function Er(e){let t=0;for(let n=0;n<e.length;n++)t|=e[n].flags;return t}const Cr=new Object,Ir=Xn(Dt),Or=Xn(Ce),Sr=Xn(ze);function kr(e,t,n,r){return n=ve(n),{index:-1,deps:dr(r,me(t)),flags:e,token:t,value:n}}function Tr(e,t,n=Dt.THROW_IF_NOT_FOUND){const r=Me(e);try{if(8&t.flags)return t.token;if(2&t.flags&&(n=null),1&t.flags)return e._parent.get(t.token,n);const a=t.tokenKey;switch(a){case Ir:case Or:case Sr:return e}const s=e._def.providersByKey[a];let u;if(s){let t=e._providers[s.index];return void 0===t&&(t=e._providers[s.index]=Ar(e,s)),t===Cr?void 0:t}if((u=de(t.token))&&(o=e,null!=(i=u).providedIn&&(function(e,t){return e._def.modules.indexOf(t)>-1}(o,i.providedIn)||"root"===i.providedIn&&o._def.isRoot))){const n=e._providers.length;return e._def.providers[n]=e._def.providersByKey[t.tokenKey]={flags:5120,value:u.factory,deps:[],index:n,token:t.token},e._providers[n]=Cr,e._providers[n]=Ar(e,e._def.providersByKey[t.tokenKey])}return 4&t.flags?n:e._parent.get(t.token,n)}finally{Me(r)}var o,i}function Ar(e,t){let n;switch(201347067&t.flags){case 512:n=function(e,t,n){const r=n.length;switch(r){case 0:return new t;case 1:return new t(Tr(e,n[0]));case 2:return new t(Tr(e,n[0]),Tr(e,n[1]));case 3:return new t(Tr(e,n[0]),Tr(e,n[1]),Tr(e,n[2]));default:const o=new Array(r);for(let t=0;t<r;t++)o[t]=Tr(e,n[t]);return new t(...o)}}(e,t.value,t.deps);break;case 1024:n=function(e,t,n){const r=n.length;switch(r){case 0:return t();case 1:return t(Tr(e,n[0]));case 2:return t(Tr(e,n[0]),Tr(e,n[1]));case 3:return t(Tr(e,n[0]),Tr(e,n[1]),Tr(e,n[2]));default:const o=Array(r);for(let t=0;t<r;t++)o[t]=Tr(e,n[t]);return t(...o)}}(e,t.value,t.deps);break;case 2048:n=Tr(e,t.deps[0]);break;case 256:n=t.value}return n===Cr||null===n||"object"!=typeof n||131072&t.flags||"function"!=typeof n.ngOnDestroy||(t.flags|=131072),void 0===n?Cr:n}function Pr(e,t){const n=e.viewContainer._embeddedViews;if((null==t||t>=n.length)&&(t=n.length-1),t<0)return null;const r=n[t];return r.viewContainerParent=null,We(n,t),Hn.dirtyParentQueries(r),Rr(r),r}function Dr(e,t,n){const r=t?ur(t,t.def.lastRenderRootNode):e.renderElement,o=n.renderer.parentNode(r),i=n.renderer.nextSibling(r);yr(n,2,o,i,void 0)}function Rr(e){yr(e,3,null,null,void 0)}const Mr=new Object;function jr(e,t,n,r,o,i){return new Lr(e,t,n,r,o,i)}class Lr extends Yt{constructor(e,t,n,r,o,i){super(),this.selector=e,this.componentType=t,this._inputs=r,this._outputs=o,this.ngContentSelectors=i,this.viewDefFactory=n}get inputs(){const e=[],t=this._inputs;for(let n in t)e.push({propName:n,templateName:t[n]});return e}get outputs(){const e=[];for(let t in this._outputs)e.push({propName:t,templateName:this._outputs[t]});return e}create(e,t,n,r){if(!r)throw new Error("ngModule should be provided");const o=gr(this.viewDefFactory),i=o.nodes[0].element.componentProvider.nodeIndex,a=Hn.createRootView(e,t||[],n,o,r,Mr),s=Wn(a,i).instance;return n&&a.renderer.setAttribute(Un(a,0).renderElement,"ng-version",gn.full),new Vr(a,new Ur(a),s)}}class Vr extends Jt{constructor(e,t,n){super(),this._view=e,this._viewRef=t,this._component=n,this._elDef=this._view.def.nodes[0],this.hostView=t,this.changeDetectorRef=t,this.instance=n}get location(){return new un(Un(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Hr(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(e){this._viewRef.onDestroy(e)}}function Fr(e,t,n){return new zr(e,t,n)}class zr{constructor(e,t,n){this._view=e,this._elDef=t,this._data=n,this._embeddedViews=[]}get element(){return new un(this._data.renderElement)}get injector(){return new Hr(this._view,this._elDef)}get parentInjector(){let e=this._view,t=this._elDef.parent;for(;!t&&e;)t=sr(e),e=e.parent;return e?new Hr(e,t):new Hr(this._view,null)}clear(){for(let e=this._embeddedViews.length-1;e>=0;e--){const t=Pr(this._data,e);Hn.destroyView(t)}}get(e){const t=this._embeddedViews[e];if(t){const e=new Ur(t);return e.attachToViewContainerRef(this),e}return null}get length(){return this._embeddedViews.length}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,o){const i=n||this.parentInjector;o||e instanceof an||(o=i.get(ze));const a=e.create(i,r,void 0,o);return this.insert(a.hostView,t),a}insert(e,t){if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const n=e;return function(e,t,n,r){let o=t.viewContainer._embeddedViews;null==n&&(n=o.length),r.viewContainerParent=e,Ue(o,n,r),function(e,t){const n=ar(t);if(!n||n===e||16&t.state)return;t.state|=16;let r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(t),function(e,t){if(4&t.flags)return;e.nodeFlags|=4,t.flags|=4;let n=t.parent;for(;n;)n.childFlags|=4,n=n.parent}(t.parent.def,t.parentNodeDef)}(t,r),Hn.dirtyParentQueries(r),Dr(t,n>0?o[n-1]:null,r)}(this._view,this._data,t,n._view),n.attachToViewContainerRef(this),e}move(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const n=this._embeddedViews.indexOf(e._view);return function(e,t,n){const r=e.viewContainer._embeddedViews,o=r[t];We(r,t),null==n&&(n=r.length),Ue(r,n,o),Hn.dirtyParentQueries(o),Rr(o),Dr(e,n>0?r[n-1]:null,o)}(this._data,n,t),e}indexOf(e){return this._embeddedViews.indexOf(e._view)}remove(e){const t=Pr(this._data,e);t&&Hn.destroyView(t)}detach(e){const t=Pr(this._data,e);return t?new Ur(t):null}}function Br(e){return new Ur(e)}class Ur{constructor(e){this._view=e,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(e){const t=[];return yr(e,0,void 0,void 0,t),t}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){rr(this._view)}detach(){this._view.state&=-5}detectChanges(){const e=this._view.root.rendererFactory;e.begin&&e.begin();try{Hn.checkAndUpdateView(this._view)}finally{e.end&&e.end()}}checkNoChanges(){Hn.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(e){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(e)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Hn.destroyView(this._view)}detachFromAppRef(){this._appRef=null,Rr(this._view),Hn.dirtyParentQueries(this._view)}attachToAppRef(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}attachToViewContainerRef(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}}function Wr(e,t){return new $r(e,t)}class $r extends Pn{constructor(e,t){super(),this._parentView=e,this._def=t}createEmbeddedView(e){return new Ur(Hn.createEmbeddedView(this._parentView,this._def,this._def.element.template,e))}get elementRef(){return new un(Un(this._parentView,this._def.nodeIndex).renderElement)}}function qr(e,t){return new Hr(e,t)}class Hr{constructor(e,t){this.view=e,this.elDef=t}get(e,t=Dt.THROW_IF_NOT_FOUND){return Hn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:e,tokenKey:Xn(e)},t)}}function Gr(e,t){const n=e.def.nodes[t];if(1&n.flags){const t=Un(e,n.nodeIndex);return n.element.template?t.template:t.renderElement}if(2&n.flags)return Bn(e,n.nodeIndex).renderText;if(20240&n.flags)return Wn(e,n.nodeIndex).instance;throw new Error(`Illegal state: read nodeValue for node index ${t}`)}function Kr(e){return new Xr(e.renderer)}class Xr{constructor(e){this.delegate=e}selectRootElement(e){return this.delegate.selectRootElement(e)}createElement(e,t){const[n,r]=Nr(t),o=this.delegate.createElement(r,n);return e&&this.delegate.appendChild(e,o),o}createViewRoot(e){return e}createTemplateAnchor(e){const t=this.delegate.createComment("");return e&&this.delegate.appendChild(e,t),t}createText(e,t){const n=this.delegate.createText(t);return e&&this.delegate.appendChild(e,n),n}projectNodes(e,t){for(let n=0;n<t.length;n++)this.delegate.appendChild(e,t[n])}attachViewAfter(e,t){const n=this.delegate.parentNode(e),r=this.delegate.nextSibling(e);for(let o=0;o<t.length;o++)this.delegate.insertBefore(n,t[o],r)}detachView(e){for(let t=0;t<e.length;t++){const n=e[t],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}destroyView(e,t){for(let n=0;n<t.length;n++)this.delegate.destroyNode(t[n])}listen(e,t,n){return this.delegate.listen(e,t,n)}listenGlobal(e,t,n){return this.delegate.listen(e,t,n)}setElementProperty(e,t,n){this.delegate.setProperty(e,t,n)}setElementAttribute(e,t,n){const[r,o]=Nr(t);null!=n?this.delegate.setAttribute(e,o,n,r):this.delegate.removeAttribute(e,o,r)}setBindingDebugInfo(e,t,n){}setElementClass(e,t,n){n?this.delegate.addClass(e,t):this.delegate.removeClass(e,t)}setElementStyle(e,t,n){null!=n?this.delegate.setStyle(e,t,n):this.delegate.removeStyle(e,t)}invokeElementMethod(e,t,n){e[t].apply(e,n)}setText(e,t){this.delegate.setValue(e,t)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function Zr(e,t,n,r){return new Qr(e,t,n,r)}class Qr{constructor(e,t,n,r){this._moduleType=e,this._parent=t,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(e){const t=e._def,n=e._providers=new Array(t.providers.length);for(let r=0;r<t.providers.length;r++){const o=t.providers[r];4096&o.flags||void 0===n[r]&&(n[r]=Ar(e,o))}}(this)}get(e,t=Dt.THROW_IF_NOT_FOUND,n=ce.Default){let r=0;return n&ce.SkipSelf?r|=1:n&ce.Self&&(r|=4),Tr(this,{token:e,tokenKey:Xn(e),flags:r},t)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(rn)}destroy(){if(this._destroyed)throw new Error(`The ng module ${me(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(e,t){const n=e._def,r=new Set;for(let o=0;o<n.providers.length;o++)if(131072&n.providers[o].flags){const t=e._providers[o];if(t&&t!==Cr){const e=t.ngOnDestroy;"function"!=typeof e||r.has(t)||(e.apply(t),r.add(t))}}}(this),this._destroyListeners.forEach(e=>e())}onDestroy(e){this._destroyListeners.push(e)}}const Jr=Xn(cn),Yr=Xn(dn),eo=Xn(un),to=Xn(Rn),no=Xn(Pn),ro=Xn(kt),oo=Xn(Dt),io=Xn(Ce);function ao(e,t,n,r,o,i,a,s){const u=[];if(a)for(let c in a){const[e,t]=a[c];u[e]={flags:8,name:c,nonMinifiedName:t,ns:null,securityContext:null,suffix:null}}const l=[];if(s)for(let c in s)l.push({type:1,propName:c,target:null,eventName:s[c]});return uo(e,t|=16384,n,r,o,o,i,u,l)}function so(e,t,n,r,o){return uo(-1,e,t,0,n,r,o)}function uo(e,t,n,r,o,i,a,s,u){const{matchedQueries:l,references:c,matchedQueryIds:h}=pr(n);u||(u=[]),s||(s=[]),i=ve(i);const p=dr(a,me(o));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:l,matchedQueryIds:h,references:c,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Er(s),outputs:u,element:null,provider:{token:o,value:i,deps:p},text:null,query:null,ngContent:null}}function lo(e,t){return fo(e,t)}function co(e,t){let n=e;for(;n.parent&&!lr(n);)n=n.parent;return mo(n.parent,sr(n),!0,t.provider.value,t.provider.deps)}function ho(e,t){const n=mo(e,t.parent,(32768&t.flags)>0,t.provider.value,t.provider.deps);if(t.outputs.length)for(let r=0;r<t.outputs.length;r++){const o=t.outputs[r],i=n[o.propName];if(!Zt(i))throw new Error(`@Output ${o.propName} not initialized in '${n.constructor.name}'.`);{const n=i.subscribe(po(e,t.parent.nodeIndex,o.eventName));e.disposables[t.outputIndex+r]=n.unsubscribe.bind(n)}}return n}function po(e,t,n){return r=>ir(e,t,n,r)}function fo(e,t){const n=(8192&t.flags)>0,r=t.provider;switch(201347067&t.flags){case 512:return mo(e,t.parent,n,r.value,r.deps);case 1024:return function(e,t,n,r,o){const i=o.length;switch(i){case 0:return r();case 1:return r(yo(e,t,n,o[0]));case 2:return r(yo(e,t,n,o[0]),yo(e,t,n,o[1]));case 3:return r(yo(e,t,n,o[0]),yo(e,t,n,o[1]),yo(e,t,n,o[2]));default:const a=Array(i);for(let r=0;r<i;r++)a[r]=yo(e,t,n,o[r]);return r(...a)}}(e,t.parent,n,r.value,r.deps);case 2048:return yo(e,t.parent,n,r.deps[0]);case 256:return r.value}}function mo(e,t,n,r,o){const i=o.length;switch(i){case 0:return new r;case 1:return new r(yo(e,t,n,o[0]));case 2:return new r(yo(e,t,n,o[0]),yo(e,t,n,o[1]));case 3:return new r(yo(e,t,n,o[0]),yo(e,t,n,o[1]),yo(e,t,n,o[2]));default:const a=new Array(i);for(let r=0;r<i;r++)a[r]=yo(e,t,n,o[r]);return new r(...a)}}const go={};function yo(e,t,n,r,o=Dt.THROW_IF_NOT_FOUND){if(8&r.flags)return r.token;const i=e;2&r.flags&&(o=null);const a=r.tokenKey;a===ro&&(n=!(!t||!t.element.componentView)),t&&1&r.flags&&(n=!1,t=t.parent);let s=e;for(;s;){if(t)switch(a){case Jr:return Kr(vo(s,t,n));case Yr:return vo(s,t,n).renderer;case eo:return new un(Un(s,t.nodeIndex).renderElement);case to:return Un(s,t.nodeIndex).viewContainer;case no:if(t.element.template)return Un(s,t.nodeIndex).template;break;case ro:return Br(vo(s,t,n));case oo:case io:return qr(s,t);default:const e=(n?t.element.allProviders:t.element.publicProviders)[a];if(e){let t=Wn(s,e.nodeIndex);return t||(t={instance:fo(s,e)},s.nodes[e.nodeIndex]=t),t.instance}}n=lr(s),t=sr(s),s=s.parent,4&r.flags&&(s=null)}const u=i.root.injector.get(r.token,go);return u!==go||o===go?u:i.root.ngModule.injector.get(r.token,o)}function vo(e,t,n){let r;if(n)r=Un(e,t.nodeIndex).componentView;else for(r=e;r.parent&&!lr(r);)r=r.parent;return r}function bo(e,t,n,r,o,i){if(32768&n.flags){const t=Un(e,n.parent.nodeIndex).componentView;2&t.def.flags&&(t.state|=8)}if(t.instance[n.bindings[r].name]=o,524288&n.flags){i=i||{};const t=Ht.unwrap(e.oldValues[n.bindingIndex+r]);i[n.bindings[r].nonMinifiedName]=new Qt(t,o,0!=(2&e.state))}return e.oldValues[n.bindingIndex+r]=o,i}function wo(e,t){if(!(e.def.nodeFlags&t))return;const n=e.def.nodes;let r=0;for(let o=0;o<n.length;o++){const i=n[o];let a=i.parent;for(!a&&i.flags&t&&_o(e,o,i.flags&t,r++),0==(i.childFlags&t)&&(o+=i.childCount);a&&1&a.flags&&o===a.nodeIndex+a.childCount;)a.directChildFlags&t&&(r=xo(e,a,t,r)),a=a.parent}}function xo(e,t,n,r){for(let o=t.nodeIndex+1;o<=t.nodeIndex+t.childCount;o++){const t=e.def.nodes[o];t.flags&n&&_o(e,o,t.flags&n,r++),o+=t.childCount}return r}function _o(e,t,n,r){const o=Wn(e,t);if(!o)return;const i=o.instance;i&&(Hn.setCurrentNode(e,t),1048576&n&&zn(e,512,r)&&i.ngAfterContentInit(),2097152&n&&i.ngAfterContentChecked(),4194304&n&&zn(e,768,r)&&i.ngAfterViewInit(),8388608&n&&i.ngAfterViewChecked(),131072&n&&i.ngOnDestroy())}const No=new Ee("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>qe}),Eo={},Co=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();var Io=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(e){let t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];const Oo="en-US";let So=Oo;function ko(e){var t;t="Expected localeId to be defined",null==e&&function(e){throw new Error(`ASSERTION ERROR: ${e}`)}(t),"string"==typeof e&&(So=e.toLowerCase().replace(/_/g,"-"))}class To extends O{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r,o=e=>null,i=()=>null;e&&"object"==typeof e?(r=this.__isAsync?t=>{setTimeout(()=>e.next(t))}:t=>{e.next(t)},e.error&&(o=this.__isAsync?t=>{setTimeout(()=>e.error(t))}:t=>{e.error(t)}),e.complete&&(i=this.__isAsync?()=>{setTimeout(()=>e.complete())}:()=>{e.complete()})):(r=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)},t&&(o=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)}),n&&(i=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const a=super.subscribe(r,o,i);return e instanceof f&&e.add(a),a}}function Ao(){return this._results[Wt()]()}class Po{constructor(){this.dirty=!0,this._results=[],this.changes=new To,this.length=0;const e=Wt(),t=Po.prototype;t[e]||(t[e]=Ao)}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e){this._results=function e(t,n){void 0===n&&(n=t);for(let r=0;r<t.length;r++){let o=t[r];Array.isArray(o)?(n===t&&(n=t.slice(0,r)),e(o,n)):n!==t&&n.push(o)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const Do=new Ee("Application Initializer");class Ro{constructor(e){this.appInits=e,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();Xt(t)&&e.push(t)}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}const Mo=new Ee("AppId");function jo(){return`${Lo()}${Lo()}${Lo()}`}function Lo(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Vo=new Ee("Platform Initializer"),Fo=new Ee("Platform ID"),zo=new Ee("appBootstrapListener");class Bo{log(e){console.log(e)}warn(e){console.warn(e)}}const Uo=new Ee("LocaleId"),Wo=!1;function $o(){throw new Error("Runtime compiler is not loaded")}const qo=$o,Ho=$o,Go=$o,Ko=$o;class Xo{constructor(){this.compileModuleSync=qo,this.compileModuleAsync=Ho,this.compileModuleAndAllComponentsSync=Go,this.compileModuleAndAllComponentsAsync=Ko}clearCache(){}clearCacheFor(e){}getModuleId(e){}}class Zo{}let Qo,Jo;function Yo(){const e=Ne.wtf;return!(!e||!(Qo=e.trace)||(Jo=Qo.events,0))}const ei=Yo();function ti(e,t){return null}const ni=ei?function(e,t=null){return Jo.createScope(e,t)}:(e,t)=>ti,ri=ei?function(e,t){return Qo.leaveScope(e,t),t}:(e,t)=>t,oi=(()=>Promise.resolve(0))();function ii(e){"undefined"==typeof Zone?oi.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class ai{constructor({enableLongStackTrace:e=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new To(!1),this.onMicrotaskEmpty=new To(!1),this.onStable=new To(!1),this.onError=new To(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var t;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(t=this)._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,r,o,i,a)=>{try{return ci(t),e.invokeTask(r,o,i,a)}finally{hi(t)}},onInvoke:(e,n,r,o,i,a,s)=>{try{return ci(t),e.invoke(r,o,i,a,s)}finally{hi(t)}},onHasTask:(e,n,r,o)=>{e.hasTask(r,o),n===r&&("microTask"==o.change?(t.hasPendingMicrotasks=o.microTask,li(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,n,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ai.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ai.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const o=this._inner,i=o.scheduleEventTask("NgZoneEvent: "+r,e,ui,si,si);try{return o.runTask(i,t,n)}finally{o.cancelTask(i)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}function si(){}const ui={};function li(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function ci(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function hi(e){e._nesting--,li(e)}class pi{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new To,this.onMicrotaskEmpty=new To,this.onStable=new To,this.onError=new To}run(e){return e()}runGuarded(e){return e()}runOutsideAngular(e){return e()}runTask(e){return e()}}class di{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ai.assertNotInAngularZone(),ii(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ii(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let r=-1;t&&t>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==r),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}class fi{constructor(){this._applications=new Map,yi.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return yi.findTestabilityInTree(this,e,t)}}class mi{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let gi,yi=new mi,vi=function(e,t,n){return e.get(Zo).createCompiler([t]).compileModuleAsync(n)},bi=function(e){return e instanceof an};const wi=new Ee("AllowMultipleToken");class xi{constructor(e,t){this.name=e,this.token=t}}function _i(e,t,n=[]){const r=`Platform: ${t}`,o=new Ee(r);return(t=[])=>{let i=Ni();if(!i||i.injector.get(wi,!1))if(e)e(n.concat(t).concat({provide:o,useValue:!0}));else{const e=n.concat(t).concat({provide:o,useValue:!0});!function(e){if(gi&&!gi.destroyed&&!gi.injector.get(wi,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");gi=e.get(Ei);const t=e.get(Vo,null);t&&t.forEach(e=>e())}(Dt.create({providers:e,name:r}))}return function(e){const t=Ni();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(o)}}function Ni(){return gi&&!gi.destroyed?gi:null}class Ei{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n="noop"===(o=t?t.ngZone:void 0)?new pi:("zone.js"===o?void 0:o)||new ai({enableLongStackTrace:tt()}),r=[{provide:ai,useValue:n}];var o;return n.run(()=>{const t=Dt.create({providers:r,parent:this.injector,name:e.moduleType.name}),o=e.create(t),i=o.injector.get(Je,null);if(!i)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return Wo&&ko(o.injector.get(Uo,Oo)||Oo),o.onDestroy(()=>Oi(this._modules,o)),n.runOutsideAngular(()=>n.onError.subscribe({next:e=>{i.handleError(e)}})),function(e,t,n){try{const r=n();return Xt(r)?r.catch(n=>{throw t.runOutsideAngular(()=>e.handleError(n)),n}):r}catch(Qh){throw t.runOutsideAngular(()=>e.handleError(Qh)),Qh}}(i,n,()=>{const e=o.injector.get(Ro);return e.runInitializers(),e.donePromise.then(()=>(this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,t=[]){const n=Ci({},t);return vi(this.injector,n,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Ii);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${me(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}function Ci(e,t){return Array.isArray(t)?t.reduce(Ci,e):Object.assign({},e,t)}let Ii=(()=>{class e{constructor(e,t,n,r,o,i){this._zone=e,this._console=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=o,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=tt(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new x(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),s=new x(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{ai.assertNotInAngularZone(),ii(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{ai.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=function(...e){let t=Number.POSITIVE_INFINITY,n=null,r=e[e.length-1];return k(r)?(n=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof r&&(t=e.pop()),null===n&&1===e.length&&e[0]instanceof x?e[0]:function(e=Number.POSITIVE_INFINITY){return G(Z,e)}(t)(q(e,n))}(a,s.pipe(e=>Q()(function(e,t){return function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,te);return r.source=t,r.subjectFactory=n,r}}(re)(e))))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof Yt?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const r=bi(n)?null:this._injector.get(ze),o=n.create(Dt.NULL,[],t||n.selector,r);o.onDestroy(()=>{this._unloadComponent(o)});const i=o.injector.get(di,null);return i&&o.injector.get(fi).registerApplication(o.location.nativeElement,i),this._loadComponent(o),tt()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const t=e._tickScope();try{this._runningTick=!0;for(let e of this._views)e.detectChanges();if(this._enforceNoNewChanges)for(let e of this._views)e.checkNoChanges()}catch(Qh){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(Qh))}finally{this._runningTick=!1,ri(t)}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Oi(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(zo,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}_unloadComponent(e){this.detachView(e.hostView),Oi(this.components,e)}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy())}get viewCount(){return this._views.length}}return e._tickScope=ni("ApplicationRef#tick()"),e})();function Oi(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Si{constructor(e,t){this.name=e,this.callback=t}}class ki{constructor(e,t,n){this.listeners=[],this.parent=null,this._debugContext=n,this.nativeNode=e,t&&t instanceof Ti&&t.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class Ti extends ki{constructor(e,t,n){super(e,t,n),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=e}addChild(e){e&&(this.childNodes.push(e),e.parent=this)}removeChild(e){const t=this.childNodes.indexOf(e);-1!==t&&(e.parent=null,this.childNodes.splice(t,1))}insertChildrenAfter(e,t){const n=this.childNodes.indexOf(e);-1!==n&&(this.childNodes.splice(n+1,0,...t),t.forEach(t=>{t.parent&&t.parent.removeChild(t),e.parent=this}))}insertBefore(e,t){const n=this.childNodes.indexOf(e);-1===n?this.addChild(t):(t.parent&&t.parent.removeChild(t),t.parent=this,this.childNodes.splice(n,0,t))}query(e){return this.queryAll(e)[0]||null}queryAll(e){const t=[];return function e(t,n,r){t.childNodes.forEach(t=>{t instanceof Ti&&(n(t)&&r.push(t),e(t,n,r))})}(this,e,t),t}queryAllNodes(e){const t=[];return function e(t,n,r){t instanceof Ti&&t.childNodes.forEach(t=>{n(t)&&r.push(t),t instanceof Ti&&e(t,n,r)})}(this,e,t),t}get children(){return this.childNodes.filter(e=>e instanceof Ti)}triggerEventHandler(e,t){this.listeners.forEach(n=>{n.name==e&&n.callback(t)})}}const Ai=new Map,Pi=function(e){return Ai.get(e)||null};function Di(e){Ai.set(e.nativeNode,e)}const Ri=_i(null,"core",[{provide:Fo,useValue:"unknown"},{provide:Ei,deps:[Dt]},{provide:fi,deps:[]},{provide:Bo,deps:[]}]);function Mi(){return Tn}function ji(){return An}function Li(e){return e?(Wo&&ko(e),e):Oo}function Vi(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}class Fi{constructor(e){}}function zi(e,t,n,r,o,i){e|=1;const{matchedQueries:a,references:s,matchedQueryIds:u}=pr(t);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:e,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:a,matchedQueryIds:u,references:s,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:i?gr(i):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:o||Gn},provider:null,text:null,query:null,ngContent:null}}function Bi(e,t,n,r,o,i,a=[],s,u,l,c,h){l||(l=Gn);const{matchedQueries:p,references:d,matchedQueryIds:f}=pr(n);let m=null,g=null;i&&([m,g]=Nr(i)),s=s||[];const y=new Array(s.length);for(let w=0;w<s.length;w++){const[e,t,n]=s[w],[r,o]=Nr(t);let i=void 0,a=void 0;switch(15&e){case 4:a=n;break;case 1:case 8:i=n}y[w]={flags:e,ns:r,name:o,nonMinifiedName:o,securityContext:i,suffix:a}}u=u||[];const v=new Array(u.length);for(let w=0;w<u.length;w++){const[e,t]=u[w];v[w]={type:0,target:e,eventName:t,propName:null}}const b=(a=a||[]).map(([e,t])=>{const[n,r]=Nr(e);return[n,r,t]});return h=function(e){if(e&&e.id===Zn){const t=null!=e.encapsulation&&e.encapsulation!==$e.None||e.styles.length||Object.keys(e.data).length;e.id=t?`c${Yn++}`:Qn}return e&&e.id===Qn&&(e=null),e||null}(h),c&&(t|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:f,references:d,ngContentIndex:r,childCount:o,bindings:y,bindingFlags:Er(y),outputs:v,element:{ns:m,name:g,attrs:b,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:l||Gn},provider:null,text:null,query:null,ngContent:null}}function Ui(e,t,n){const r=n.element,o=e.root.selectorOrNode,i=e.renderer;let a;if(e.parent||!o){a=r.name?i.createElement(r.name,r.ns):i.createComment("");const o=fr(e,t,n);o&&i.appendChild(o,a)}else a=i.selectRootElement(o,!!r.componentRendererType&&r.componentRendererType.encapsulation===$e.ShadowDom);if(r.attrs)for(let s=0;s<r.attrs.length;s++){const[e,t,n]=r.attrs[s];i.setAttribute(a,t,n,e)}return a}function Wi(e,t,n,r){for(let a=0;a<n.outputs.length;a++){const s=n.outputs[a],u=$i(e,n.nodeIndex,(i=s.eventName,(o=s.target)?`${o}:${i}`:i));let l=s.target,c=e;"component"===s.target&&(l=null,c=t);const h=c.renderer.listen(l||r,s.eventName,u);e.disposables[n.outputIndex+a]=h}var o,i}function $i(e,t,n){return r=>ir(e,t,n,r)}function qi(e,t,n,r){if(!tr(e,t,n,r))return!1;const o=t.bindings[n],i=Un(e,t.nodeIndex),a=i.renderElement,s=o.name;switch(15&o.flags){case 1:!function(e,t,n,r,o,i){const a=t.securityContext;let s=a?e.root.sanitizer.sanitize(a,i):i;s=null!=s?s.toString():null;const u=e.renderer;null!=i?u.setAttribute(n,o,s,r):u.removeAttribute(n,o,r)}(e,o,a,o.ns,s,r);break;case 2:!function(e,t,n,r){const o=e.renderer;r?o.addClass(t,n):o.removeClass(t,n)}(e,a,s,r);break;case 4:!function(e,t,n,r,o){let i=e.root.sanitizer.sanitize(Nt.STYLE,o);if(null!=i){i=i.toString();const e=t.suffix;null!=e&&(i+=e)}else i=null;const a=e.renderer;null!=i?a.setStyle(n,r,i):a.removeStyle(n,r)}(e,o,a,s,r);break;case 8:!function(e,t,n,r,o){const i=t.securityContext;let a=i?e.root.sanitizer.sanitize(i,o):o;e.renderer.setProperty(n,r,a)}(33554432&t.flags&&32&o.flags?i.componentView:e,o,a,s,r)}return!0}function Hi(e,t,n){let r=[];for(let o in n)r.push({propName:o,bindingType:n[o]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:t,filterId:hr(t),bindings:r},ngContent:null}}function Gi(e){const t=e.def.nodeMatchedQueries;for(;e.parent&&cr(e);){let n=e.parentNodeDef;e=e.parent;const r=n.nodeIndex+n.childCount;for(let o=0;o<=r;o++){const r=e.def.nodes[o];67108864&r.flags&&536870912&r.flags&&(r.query.filterId&t)===r.query.filterId&&qn(e,o).setDirty(),!(1&r.flags&&o+r.childCount<n.nodeIndex)&&67108864&r.childFlags&&536870912&r.childFlags||(o+=r.childCount)}}if(134217728&e.def.nodeFlags)for(let n=0;n<e.def.nodes.length;n++){const t=e.def.nodes[n];134217728&t.flags&&536870912&t.flags&&qn(e,n).setDirty(),n+=t.childCount}}function Ki(e,t){const n=qn(e,t.nodeIndex);if(!n.dirty)return;let r,o=void 0;if(67108864&t.flags){const n=t.parent.parent;o=Xi(e,n.nodeIndex,n.nodeIndex+n.childCount,t.query,[]),r=Wn(e,t.parent.nodeIndex).instance}else 134217728&t.flags&&(o=Xi(e,0,e.def.nodes.length-1,t.query,[]),r=e.component);n.reset(o);const i=t.query.bindings;let a=!1;for(let s=0;s<i.length;s++){const e=i[s];let t;switch(e.bindingType){case 0:t=n.first;break;case 1:t=n,a=!0}r[e.propName]=t}a&&n.notifyOnChanges()}function Xi(e,t,n,r,o){for(let i=t;i<=n;i++){const t=e.def.nodes[i],n=t.matchedQueries[r.id];if(null!=n&&o.push(Zi(e,t,n)),1&t.flags&&t.element.template&&(t.element.template.nodeMatchedQueries&r.filterId)===r.filterId){const n=Un(e,i);if((t.childMatchedQueries&r.filterId)===r.filterId&&(Xi(e,i+1,i+t.childCount,r,o),i+=t.childCount),16777216&t.flags){const e=n.viewContainer._embeddedViews;for(let t=0;t<e.length;t++){const i=e[t],a=ar(i);a&&a===n&&Xi(i,0,i.def.nodes.length-1,r,o)}}const a=n.template._projectedViews;if(a)for(let e=0;e<a.length;e++){const t=a[e];Xi(t,0,t.def.nodes.length-1,r,o)}}(t.childMatchedQueries&r.filterId)!==r.filterId&&(i+=t.childCount)}return o}function Zi(e,t,n){if(null!=n)switch(n){case 1:return Un(e,t.nodeIndex).renderElement;case 0:return new un(Un(e,t.nodeIndex).renderElement);case 2:return Un(e,t.nodeIndex).template;case 3:return Un(e,t.nodeIndex).viewContainer;case 4:return Wn(e,t.nodeIndex).instance}}function Qi(e,t,n){const r=fr(e,t,n);r&&br(e,n.ngContent.index,1,r,null,void 0)}function Ji(e,t,n){const r=new Array(n.length-1);for(let o=1;o<n.length;o++)r[o-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[o]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function Yi(e,t,n){let r;const o=e.renderer;r=o.createText(n.text.prefix);const i=fr(e,t,n);return i&&o.appendChild(i,r),{renderText:r}}function ea(e,t){return(null!=e?e.toString():"")+t.suffix}function ta(e,t,n,r){let o=0,i=0,a=0,s=0,u=0,l=null,c=null,h=!1,p=!1,d=null;for(let f=0;f<t.length;f++){const e=t[f];if(e.nodeIndex=f,e.parent=l,e.bindingIndex=o,e.outputIndex=i,e.renderParent=c,a|=e.flags,u|=e.matchedQueryIds,e.element){const t=e.element;t.publicProviders=l?l.element.publicProviders:Object.create(null),t.allProviders=t.publicProviders,h=!1,p=!1,e.element.template&&(u|=e.element.template.nodeMatchedQueries)}if(ra(l,e,t.length),o+=e.bindings.length,i+=e.outputs.length,!c&&3&e.flags&&(d=e),20224&e.flags){h||(h=!0,l.element.publicProviders=Object.create(l.element.publicProviders),l.element.allProviders=l.element.publicProviders);const t=0!=(32768&e.flags);0==(8192&e.flags)||t?l.element.publicProviders[Xn(e.provider.token)]=e:(p||(p=!0,l.element.allProviders=Object.create(l.element.publicProviders)),l.element.allProviders[Xn(e.provider.token)]=e),t&&(l.element.componentProvider=e)}if(l?(l.childFlags|=e.flags,l.directChildFlags|=e.flags,l.childMatchedQueries|=e.matchedQueryIds,e.element&&e.element.template&&(l.childMatchedQueries|=e.element.template.nodeMatchedQueries)):s|=e.flags,e.childCount>0)l=e,na(e)||(c=e);else for(;l&&f===l.nodeIndex+l.childCount;){const e=l.parent;e&&(e.childFlags|=l.childFlags,e.childMatchedQueries|=l.childMatchedQueries),c=(l=e)&&na(l)?l.renderParent:l}}return{factory:null,nodeFlags:a,rootNodeFlags:s,nodeMatchedQueries:u,flags:e,nodes:t,updateDirectives:n||Gn,updateRenderer:r||Gn,handleEvent:(e,n,r,o)=>t[n].element.handleEvent(e,r,o),bindingCount:o,outputCount:i,lastRenderRootNode:d}}function na(e){return 0!=(1&e.flags)&&null===e.element.name}function ra(e,t,n){const r=t.element&&t.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${t.nodeIndex}!`)}if(20224&t.flags&&0==(1&(e?e.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${t.nodeIndex}!`);if(t.query){if(67108864&t.flags&&(!e||0==(16384&e.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${t.nodeIndex}!`);if(134217728&t.flags&&e)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${t.nodeIndex}!`)}if(t.childCount){const r=e?e.nodeIndex+e.childCount:n-1;if(t.nodeIndex<=r&&t.nodeIndex+t.childCount>r)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${t.nodeIndex}!`)}}function oa(e,t,n,r){const o=sa(e.root,e.renderer,e,t,n);return ua(o,e.component,r),la(o),o}function ia(e,t,n){const r=sa(e,e.renderer,null,null,t);return ua(r,n,n),la(r),r}function aa(e,t,n,r){const o=t.element.componentRendererType;let i;return i=o?e.root.rendererFactory.createRenderer(r,o):e.root.renderer,sa(e.root,i,e,t.element.componentProvider,n)}function sa(e,t,n,r,o){const i=new Array(o.nodes.length),a=o.outputCount?new Array(o.outputCount):null;return{def:o,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:i,state:13,root:e,renderer:t,oldValues:new Array(o.bindingCount),disposables:a,initIndex:-1}}function ua(e,t,n){e.component=t,e.context=n}function la(e){let t;lr(e)&&(t=Un(e.parent,e.parentNodeDef.parent.nodeIndex).renderElement);const n=e.def,r=e.nodes;for(let o=0;o<n.nodes.length;o++){const i=n.nodes[o];let a;switch(Hn.setCurrentNode(e,o),201347067&i.flags){case 1:const n=Ui(e,t,i);let s=void 0;if(33554432&i.flags){const t=gr(i.element.componentView);s=Hn.createComponentView(e,i,t,n)}Wi(e,s,i,n),a={renderElement:n,componentView:s,viewContainer:null,template:i.element.template?Wr(e,i):void 0},16777216&i.flags&&(a.viewContainer=Fr(e,i,a));break;case 2:a=Yi(e,t,i);break;case 512:case 1024:case 2048:case 256:(a=r[o])||4096&i.flags||(a={instance:lo(e,i)});break;case 16:a={instance:co(e,i)};break;case 16384:(a=r[o])||(a={instance:ho(e,i)}),32768&i.flags&&ua(Un(e,i.parent.nodeIndex).componentView,a.instance,a.instance);break;case 32:case 64:case 128:a={value:void 0};break;case 67108864:case 134217728:a=new Po;break;case 8:Qi(e,t,i),a=void 0}r[o]=a}va(e,ya.CreateViewNodes),_a(e,201326592,268435456,0)}function ca(e){da(e),Hn.updateDirectives(e,1),ba(e,ya.CheckNoChanges),Hn.updateRenderer(e,1),va(e,ya.CheckNoChanges),e.state&=-97}function ha(e){1&e.state?(e.state&=-2,e.state|=2):e.state&=-3,Fn(e,0,256),da(e),Hn.updateDirectives(e,0),ba(e,ya.CheckAndUpdate),_a(e,67108864,536870912,0);let t=Fn(e,256,512);wo(e,2097152|(t?1048576:0)),Hn.updateRenderer(e,0),va(e,ya.CheckAndUpdate),_a(e,134217728,536870912,0),wo(e,8388608|((t=Fn(e,512,768))?4194304:0)),2&e.def.flags&&(e.state&=-9),e.state&=-97,Fn(e,768,1024)}function pa(e,t,n,r,o,i,a,s,u,l,c,h,p){return 0===n?function(e,t,n,r,o,i,a,s,u,l,c,h){switch(201347067&t.flags){case 1:return function(e,t,n,r,o,i,a,s,u,l,c,h){const p=t.bindings.length;let d=!1;return p>0&&qi(e,t,0,n)&&(d=!0),p>1&&qi(e,t,1,r)&&(d=!0),p>2&&qi(e,t,2,o)&&(d=!0),p>3&&qi(e,t,3,i)&&(d=!0),p>4&&qi(e,t,4,a)&&(d=!0),p>5&&qi(e,t,5,s)&&(d=!0),p>6&&qi(e,t,6,u)&&(d=!0),p>7&&qi(e,t,7,l)&&(d=!0),p>8&&qi(e,t,8,c)&&(d=!0),p>9&&qi(e,t,9,h)&&(d=!0),d}(e,t,n,r,o,i,a,s,u,l,c,h);case 2:return function(e,t,n,r,o,i,a,s,u,l,c,h){let p=!1;const d=t.bindings,f=d.length;if(f>0&&tr(e,t,0,n)&&(p=!0),f>1&&tr(e,t,1,r)&&(p=!0),f>2&&tr(e,t,2,o)&&(p=!0),f>3&&tr(e,t,3,i)&&(p=!0),f>4&&tr(e,t,4,a)&&(p=!0),f>5&&tr(e,t,5,s)&&(p=!0),f>6&&tr(e,t,6,u)&&(p=!0),f>7&&tr(e,t,7,l)&&(p=!0),f>8&&tr(e,t,8,c)&&(p=!0),f>9&&tr(e,t,9,h)&&(p=!0),p){let p=t.text.prefix;f>0&&(p+=ea(n,d[0])),f>1&&(p+=ea(r,d[1])),f>2&&(p+=ea(o,d[2])),f>3&&(p+=ea(i,d[3])),f>4&&(p+=ea(a,d[4])),f>5&&(p+=ea(s,d[5])),f>6&&(p+=ea(u,d[6])),f>7&&(p+=ea(l,d[7])),f>8&&(p+=ea(c,d[8])),f>9&&(p+=ea(h,d[9]));const m=Bn(e,t.nodeIndex).renderText;e.renderer.setValue(m,p)}return p}(e,t,n,r,o,i,a,s,u,l,c,h);case 16384:return function(e,t,n,r,o,i,a,s,u,l,c,h){const p=Wn(e,t.nodeIndex),d=p.instance;let f=!1,m=void 0;const g=t.bindings.length;return g>0&&er(e,t,0,n)&&(f=!0,m=bo(e,p,t,0,n,m)),g>1&&er(e,t,1,r)&&(f=!0,m=bo(e,p,t,1,r,m)),g>2&&er(e,t,2,o)&&(f=!0,m=bo(e,p,t,2,o,m)),g>3&&er(e,t,3,i)&&(f=!0,m=bo(e,p,t,3,i,m)),g>4&&er(e,t,4,a)&&(f=!0,m=bo(e,p,t,4,a,m)),g>5&&er(e,t,5,s)&&(f=!0,m=bo(e,p,t,5,s,m)),g>6&&er(e,t,6,u)&&(f=!0,m=bo(e,p,t,6,u,m)),g>7&&er(e,t,7,l)&&(f=!0,m=bo(e,p,t,7,l,m)),g>8&&er(e,t,8,c)&&(f=!0,m=bo(e,p,t,8,c,m)),g>9&&er(e,t,9,h)&&(f=!0,m=bo(e,p,t,9,h,m)),m&&d.ngOnChanges(m),65536&t.flags&&zn(e,256,t.nodeIndex)&&d.ngOnInit(),262144&t.flags&&d.ngDoCheck(),f}(e,t,n,r,o,i,a,s,u,l,c,h);case 32:case 64:case 128:return function(e,t,n,r,o,i,a,s,u,l,c,h){const p=t.bindings;let d=!1;const f=p.length;if(f>0&&tr(e,t,0,n)&&(d=!0),f>1&&tr(e,t,1,r)&&(d=!0),f>2&&tr(e,t,2,o)&&(d=!0),f>3&&tr(e,t,3,i)&&(d=!0),f>4&&tr(e,t,4,a)&&(d=!0),f>5&&tr(e,t,5,s)&&(d=!0),f>6&&tr(e,t,6,u)&&(d=!0),f>7&&tr(e,t,7,l)&&(d=!0),f>8&&tr(e,t,8,c)&&(d=!0),f>9&&tr(e,t,9,h)&&(d=!0),d){const d=$n(e,t.nodeIndex);let m;switch(201347067&t.flags){case 32:m=new Array(p.length),f>0&&(m[0]=n),f>1&&(m[1]=r),f>2&&(m[2]=o),f>3&&(m[3]=i),f>4&&(m[4]=a),f>5&&(m[5]=s),f>6&&(m[6]=u),f>7&&(m[7]=l),f>8&&(m[8]=c),f>9&&(m[9]=h);break;case 64:m={},f>0&&(m[p[0].name]=n),f>1&&(m[p[1].name]=r),f>2&&(m[p[2].name]=o),f>3&&(m[p[3].name]=i),f>4&&(m[p[4].name]=a),f>5&&(m[p[5].name]=s),f>6&&(m[p[6].name]=u),f>7&&(m[p[7].name]=l),f>8&&(m[p[8].name]=c),f>9&&(m[p[9].name]=h);break;case 128:const e=n;switch(f){case 1:m=e.transform(n);break;case 2:m=e.transform(r);break;case 3:m=e.transform(r,o);break;case 4:m=e.transform(r,o,i);break;case 5:m=e.transform(r,o,i,a);break;case 6:m=e.transform(r,o,i,a,s);break;case 7:m=e.transform(r,o,i,a,s,u);break;case 8:m=e.transform(r,o,i,a,s,u,l);break;case 9:m=e.transform(r,o,i,a,s,u,l,c);break;case 10:m=e.transform(r,o,i,a,s,u,l,c,h)}}d.value=m}return d}(e,t,n,r,o,i,a,s,u,l,c,h);default:throw"unreachable"}}(e,t,r,o,i,a,s,u,l,c,h,p):function(e,t,n){switch(201347067&t.flags){case 1:return function(e,t,n){let r=!1;for(let o=0;o<n.length;o++)qi(e,t,o,n[o])&&(r=!0);return r}(e,t,n);case 2:return function(e,t,n){const r=t.bindings;let o=!1;for(let i=0;i<n.length;i++)tr(e,t,i,n[i])&&(o=!0);if(o){let o="";for(let e=0;e<n.length;e++)o+=ea(n[e],r[e]);o=t.text.prefix+o;const i=Bn(e,t.nodeIndex).renderText;e.renderer.setValue(i,o)}return o}(e,t,n);case 16384:return function(e,t,n){const r=Wn(e,t.nodeIndex),o=r.instance;let i=!1,a=void 0;for(let s=0;s<n.length;s++)er(e,t,s,n[s])&&(i=!0,a=bo(e,r,t,s,n[s],a));return a&&o.ngOnChanges(a),65536&t.flags&&zn(e,256,t.nodeIndex)&&o.ngOnInit(),262144&t.flags&&o.ngDoCheck(),i}(e,t,n);case 32:case 64:case 128:return function(e,t,n){const r=t.bindings;let o=!1;for(let i=0;i<n.length;i++)tr(e,t,i,n[i])&&(o=!0);if(o){const o=$n(e,t.nodeIndex);let i;switch(201347067&t.flags){case 32:i=n;break;case 64:i={};for(let o=0;o<n.length;o++)i[r[o].name]=n[o];break;case 128:const e=n[0],t=n.slice(1);i=e.transform(...t)}o.value=i}return o}(e,t,n);default:throw"unreachable"}}(e,t,r)}function da(e){const t=e.def;if(4&t.nodeFlags)for(let n=0;n<t.nodes.length;n++){const r=t.nodes[n];if(4&r.flags){const t=Un(e,n).template._projectedViews;if(t)for(let n=0;n<t.length;n++){const r=t[n];r.state|=32,or(r,e)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function fa(e,t,n,r,o,i,a,s,u,l,c,h,p){return 0===n?function(e,t,n,r,o,i,a,s,u,l,c,h){const p=t.bindings.length;p>0&&nr(e,t,0,n),p>1&&nr(e,t,1,r),p>2&&nr(e,t,2,o),p>3&&nr(e,t,3,i),p>4&&nr(e,t,4,a),p>5&&nr(e,t,5,s),p>6&&nr(e,t,6,u),p>7&&nr(e,t,7,l),p>8&&nr(e,t,8,c),p>9&&nr(e,t,9,h)}(e,t,r,o,i,a,s,u,l,c,h,p):function(e,t,n){for(let r=0;r<n.length;r++)nr(e,t,r,n[r])}(e,t,r),!1}function ma(e,t){if(qn(e,t.nodeIndex).dirty)throw jn(Hn.createDebugContext(e,t.nodeIndex),`Query ${t.query.id} not dirty`,`Query ${t.query.id} dirty`,0!=(1&e.state))}function ga(e){if(!(128&e.state)){if(ba(e,ya.Destroy),va(e,ya.Destroy),wo(e,131072),e.disposables)for(let t=0;t<e.disposables.length;t++)e.disposables[t]();!function(e){if(!(16&e.state))return;const t=ar(e);if(t){const n=t.template._projectedViews;n&&(We(n,n.indexOf(e)),Hn.dirtyParentQueries(e))}}(e),e.renderer.destroyNode&&function(e){const t=e.def.nodes.length;for(let n=0;n<t;n++){const t=e.def.nodes[n];1&t.flags?e.renderer.destroyNode(Un(e,n).renderElement):2&t.flags?e.renderer.destroyNode(Bn(e,n).renderText):(67108864&t.flags||134217728&t.flags)&&qn(e,n).destroy()}}(e),lr(e)&&e.renderer.destroy(),e.state|=128}}const ya=function(){var e={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return e[e.CreateViewNodes]="CreateViewNodes",e[e.CheckNoChanges]="CheckNoChanges",e[e.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",e[e.CheckAndUpdate]="CheckAndUpdate",e[e.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",e[e.Destroy]="Destroy",e}();function va(e,t){const n=e.def;if(33554432&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const o=n.nodes[r];33554432&o.flags?wa(Un(e,r).componentView,t):0==(33554432&o.childFlags)&&(r+=o.childCount)}}function ba(e,t){const n=e.def;if(16777216&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const o=n.nodes[r];if(16777216&o.flags){const n=Un(e,r).viewContainer._embeddedViews;for(let e=0;e<n.length;e++)wa(n[e],t)}else 0==(16777216&o.childFlags)&&(r+=o.childCount)}}function wa(e,t){const n=e.state;switch(t){case ya.CheckNoChanges:0==(128&n)&&(12==(12&n)?ca(e):64&n&&xa(e,ya.CheckNoChangesProjectedViews));break;case ya.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ca(e):64&n&&xa(e,t));break;case ya.CheckAndUpdate:0==(128&n)&&(12==(12&n)?ha(e):64&n&&xa(e,ya.CheckAndUpdateProjectedViews));break;case ya.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?ha(e):64&n&&xa(e,t));break;case ya.Destroy:ga(e);break;case ya.CreateViewNodes:la(e)}}function xa(e,t){ba(e,t),va(e,t)}function _a(e,t,n,r){if(!(e.def.nodeFlags&t&&e.def.nodeFlags&n))return;const o=e.def.nodes.length;for(let i=0;i<o;i++){const o=e.def.nodes[i];if(o.flags&t&&o.flags&n)switch(Hn.setCurrentNode(e,o.nodeIndex),r){case 0:Ki(e,o);break;case 1:ma(e,o)}o.childFlags&t&&o.childFlags&n||(i+=o.childCount)}}let Na=!1;function Ea(e,t,n,r,o,i){const a=o.injector.get(hn);return ia(Ia(e,o,a,t,n),r,i)}function Ca(e,t,n,r,o,i){const a=o.injector.get(hn),s=Ia(e,o,new os(a),t,n),u=ja(r);return ns(Ua.create,ia,null,[s,u,i])}function Ia(e,t,n,r,o){const i=t.injector.get(Et),a=t.injector.get(Je),s=n.createRenderer(null,null);return{ngModule:t,injector:e,projectableNodes:r,selectorOrNode:o,sanitizer:i,rendererFactory:n,renderer:s,errorHandler:a}}function Oa(e,t,n,r){const o=ja(n);return ns(Ua.create,oa,null,[e,t,o,r])}function Sa(e,t,n,r){return n=Pa.get(t.element.componentProvider.provider.token)||ja(n),ns(Ua.create,aa,null,[e,t,n,r])}function ka(e,t,n,r){return Zr(e,t,n,function(e){const{hasOverrides:t,hasDeprecatedOverrides:n}=function(e){let t=!1,n=!1;return 0===Ta.size?{hasOverrides:t,hasDeprecatedOverrides:n}:(e.providers.forEach(e=>{const r=Ta.get(e.token);3840&e.flags&&r&&(t=!0,n=n||r.deprecatedBehavior)}),e.modules.forEach(e=>{Aa.forEach((r,o)=>{de(o).providedIn===e&&(t=!0,n=n||r.deprecatedBehavior)})}),{hasOverrides:t,hasDeprecatedOverrides:n})}(e);return t?(function(e){for(let t=0;t<e.providers.length;t++){const r=e.providers[t];n&&(r.flags|=4096);const o=Ta.get(r.token);o&&(r.flags=-3841&r.flags|o.flags,r.deps=dr(o.deps),r.value=o.value)}if(Aa.size>0){let t=new Set(e.modules);Aa.forEach((r,o)=>{if(t.has(de(o).providedIn)){let t={token:o,flags:r.flags|(n?4096:0),deps:dr(r.deps),value:r.value,index:e.providers.length};e.providers.push(t),e.providersByKey[Xn(o)]=t}})}}(e=e.factory(()=>Gn)),e):e}(r))}const Ta=new Map,Aa=new Map,Pa=new Map;function Da(e){let t;Ta.set(e.token,e),"function"==typeof e.token&&(t=de(e.token))&&"function"==typeof t.providedIn&&Aa.set(e.token,e)}function Ra(e,t){const n=gr(t.viewDefFactory),r=gr(n.nodes[0].element.componentView);Pa.set(e,r)}function Ma(){Ta.clear(),Aa.clear(),Pa.clear()}function ja(e){if(0===Ta.size)return e;const t=function(e){const t=[];let n=null;for(let r=0;r<e.nodes.length;r++){const o=e.nodes[r];1&o.flags&&(n=o),n&&3840&o.flags&&Ta.has(o.provider.token)&&(t.push(n.nodeIndex),n=null)}return t}(e);if(0===t.length)return e;e=e.factory(()=>Gn);for(let r=0;r<t.length;r++)n(e,t[r]);return e;function n(e,t){for(let n=t+1;n<e.nodes.length;n++){const t=e.nodes[n];if(1&t.flags)return;if(3840&t.flags){const e=t.provider,n=Ta.get(e.token);n&&(t.flags=-3841&t.flags|n.flags,e.deps=dr(n.deps),e.value=n.value)}}}}function La(e,t,n,r,o,i,a,s,u,l,c,h,p){const d=e.def.nodes[t];return pa(e,d,n,r,o,i,a,s,u,l,c,h,p),224&d.flags?$n(e,t).value:void 0}function Va(e,t,n,r,o,i,a,s,u,l,c,h,p){const d=e.def.nodes[t];return fa(e,d,n,r,o,i,a,s,u,l,c,h,p),224&d.flags?$n(e,t).value:void 0}function Fa(e){return ns(Ua.detectChanges,ha,null,[e])}function za(e){return ns(Ua.checkNoChanges,ca,null,[e])}function Ba(e){return ns(Ua.destroy,ga,null,[e])}const Ua=function(){var e={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return e[e.create]="create",e[e.detectChanges]="detectChanges",e[e.checkNoChanges]="checkNoChanges",e[e.destroy]="destroy",e[e.handleEvent]="handleEvent",e}();let Wa,$a,qa;function Ha(e,t){$a=e,qa=t}function Ga(e,t,n,r){return Ha(e,t),ns(Ua.handleEvent,e.def.handleEvent,null,[e,t,n,r])}function Ka(e,t){if(128&e.state)throw Vn(Ua[Wa]);return Ha(e,Ja(e,0)),e.def.updateDirectives((function(e,n,r,...o){const i=e.def.nodes[n];return 0===t?Za(e,i,r,o):Qa(e,i,r,o),16384&i.flags&&Ha(e,Ja(e,n)),224&i.flags?$n(e,i.nodeIndex).value:void 0}),e)}function Xa(e,t){if(128&e.state)throw Vn(Ua[Wa]);return Ha(e,Ya(e,0)),e.def.updateRenderer((function(e,n,r,...o){const i=e.def.nodes[n];return 0===t?Za(e,i,r,o):Qa(e,i,r,o),3&i.flags&&Ha(e,Ya(e,n)),224&i.flags?$n(e,i.nodeIndex).value:void 0}),e)}function Za(e,t,n,r){if(pa(e,t,n,...r)){const a=1===n?r[0]:r;if(16384&t.flags){const n={};for(let e=0;e<t.bindings.length;e++){const r=t.bindings[e],s=a[e];8&r.flags&&(n[(o=r.nonMinifiedName,i=void 0,i=o.replace(/[$@]/g,"_"),`ng-reflect-${o=i.replace(Ot,(...e)=>"-"+e[1].toLowerCase())}`)]=St(s))}const r=t.parent,s=Un(e,r.nodeIndex).renderElement;if(r.element.name)for(let t in n){const r=n[t];null!=r?e.renderer.setAttribute(s,t,r):e.renderer.removeAttribute(s,t)}else e.renderer.setValue(s,`bindings=${JSON.stringify(n,null,2)}`)}}var o,i}function Qa(e,t,n,r){fa(e,t,n,...r)}function Ja(e,t){for(let n=t;n<e.def.nodes.length;n++){const t=e.def.nodes[n];if(16384&t.flags&&t.bindings&&t.bindings.length)return n}return null}function Ya(e,t){for(let n=t;n<e.def.nodes.length;n++){const t=e.def.nodes[n];if(3&t.flags&&t.bindings&&t.bindings.length)return n}return null}class es{constructor(e,t){this.view=e,this.nodeIndex=t,null==t&&(this.nodeIndex=t=0),this.nodeDef=e.def.nodes[t];let n=this.nodeDef,r=e;for(;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=sr(r),r=r.parent;this.elDef=n,this.elView=r}get elOrCompView(){return Un(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return qr(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const e=[];if(this.elDef)for(let t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){const n=this.elView.def.nodes[t];20224&n.flags&&e.push(n.provider.token),t+=n.childCount}return e}get references(){const e={};if(this.elDef){ts(this.elView,this.elDef,e);for(let t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){const n=this.elView.def.nodes[t];20224&n.flags&&ts(this.elView,n,e),t+=n.childCount}}return e}get componentRenderElement(){const e=function(e){for(;e&&!lr(e);)e=e.parent;return e.parent?Un(e.parent,sr(e).nodeIndex):null}(this.elOrCompView);return e?e.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?ur(this.view,this.nodeDef):ur(this.elView,this.elDef)}logError(e,...t){let n,r;2&this.nodeDef.flags?(n=this.view.def,r=this.nodeDef.nodeIndex):(n=this.elView.def,r=this.elDef.nodeIndex);const o=function(e,t){let n=-1;for(let r=0;r<=t;r++)3&e.nodes[r].flags&&n++;return n}(n,r);let i=-1;n.factory(()=>++i===o?e.error.bind(e,...t):Gn),i<o&&(e.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),e.error(...t))}}function ts(e,t,n){for(let r in t.references)n[r]=Zi(e,t,t.references[r])}function ns(e,t,n,r){const o=Wa,i=$a,a=qa;try{Wa=e;const s=t.apply(n,r);return $a=i,qa=a,Wa=o,s}catch(Qh){if(Xe(Qh)||!$a)throw Qh;throw s=Qh,u=rs(),s instanceof Error||(s=new Error(s.toString())),Ln(s,u),s}var s,u}function rs(){return $a?new es($a,qa):null}class os{constructor(e){this.delegate=e}createRenderer(e,t){return new is(this.delegate.createRenderer(e,t))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class is{constructor(e){this.delegate=e,this.debugContextFactory=rs,this.data=this.delegate.data}createDebugContext(e){return this.debugContextFactory(e)}destroyNode(e){const t=Pi(e);!function(e){Ai.delete(e.nativeNode)}(t),t instanceof ki&&(t.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(e)}destroy(){this.delegate.destroy()}createElement(e,t){const n=this.delegate.createElement(e,t),r=this.createDebugContext(n);if(r){const t=new Ti(n,null,r);t.name=e,Di(t)}return n}createComment(e){const t=this.delegate.createComment(e),n=this.createDebugContext(t);return n&&Di(new ki(t,null,n)),t}createText(e){const t=this.delegate.createText(e),n=this.createDebugContext(t);return n&&Di(new ki(t,null,n)),t}appendChild(e,t){const n=Pi(e),r=Pi(t);n&&r&&n instanceof Ti&&n.addChild(r),this.delegate.appendChild(e,t)}insertBefore(e,t,n){const r=Pi(e),o=Pi(t),i=Pi(n);r&&o&&r instanceof Ti&&r.insertBefore(i,o),this.delegate.insertBefore(e,t,n)}removeChild(e,t){const n=Pi(e),r=Pi(t);n&&r&&n instanceof Ti&&n.removeChild(r),this.delegate.removeChild(e,t)}selectRootElement(e,t){const n=this.delegate.selectRootElement(e,t),r=rs();return r&&Di(new Ti(n,null,r)),n}setAttribute(e,t,n,r){const o=Pi(e);o&&o instanceof Ti&&(o.attributes[r?r+":"+t:t]=n),this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){const r=Pi(e);r&&r instanceof Ti&&(r.attributes[n?n+":"+t:t]=null),this.delegate.removeAttribute(e,t,n)}addClass(e,t){const n=Pi(e);n&&n instanceof Ti&&(n.classes[t]=!0),this.delegate.addClass(e,t)}removeClass(e,t){const n=Pi(e);n&&n instanceof Ti&&(n.classes[t]=!1),this.delegate.removeClass(e,t)}setStyle(e,t,n,r){const o=Pi(e);o&&o instanceof Ti&&(o.styles[t]=n),this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){const r=Pi(e);r&&r instanceof Ti&&(r.styles[t]=null),this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){const r=Pi(e);r&&r instanceof Ti&&(r.properties[t]=n),this.delegate.setProperty(e,t,n)}listen(e,t,n){if("string"!=typeof e){const r=Pi(e);r&&r.listeners.push(new Si(t,n))}return this.delegate.listen(e,t,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setValue(e,t){return this.delegate.setValue(e,t)}}function as(e,t,n){return new ss(e,t,n)}class ss extends Be{constructor(e,t,n){super(),this.moduleType=e,this._bootstrapComponents=t,this._ngModuleDefFactory=n}create(e){!function(){if(Na)return;Na=!0;const e=tt()?{setCurrentNode:Ha,createRootView:Ca,createEmbeddedView:Oa,createComponentView:Sa,createNgModuleRef:ka,overrideProvider:Da,overrideComponentView:Ra,clearOverrides:Ma,checkAndUpdateView:Fa,checkNoChangesView:za,destroyView:Ba,createDebugContext:(e,t)=>new es(e,t),handleEvent:Ga,updateDirectives:Ka,updateRenderer:Xa}:{setCurrentNode:()=>{},createRootView:Ea,createEmbeddedView:oa,createComponentView:aa,createNgModuleRef:Zr,overrideProvider:Gn,overrideComponentView:Gn,clearOverrides:Gn,checkAndUpdateView:ha,checkNoChangesView:ca,destroyView:ga,createDebugContext:(e,t)=>new es(e,t),handleEvent:(e,t,n,r)=>e.def.handleEvent(e,t,n,r),updateDirectives:(e,t)=>e.def.updateDirectives(0===t?La:Va,e),updateRenderer:(e,t)=>e.def.updateRenderer(0===t?La:Va,e)};Hn.setCurrentNode=e.setCurrentNode,Hn.createRootView=e.createRootView,Hn.createEmbeddedView=e.createEmbeddedView,Hn.createComponentView=e.createComponentView,Hn.createNgModuleRef=e.createNgModuleRef,Hn.overrideProvider=e.overrideProvider,Hn.overrideComponentView=e.overrideComponentView,Hn.clearOverrides=e.clearOverrides,Hn.checkAndUpdateView=e.checkAndUpdateView,Hn.checkNoChangesView=e.checkNoChangesView,Hn.destroyView=e.destroyView,Hn.resolveDep=yo,Hn.createDebugContext=e.createDebugContext,Hn.handleEvent=e.handleEvent,Hn.updateDirectives=e.updateDirectives,Hn.updateRenderer=e.updateRenderer,Hn.dirtyParentQueries=Gi}();const t=function(e){const t=Array.from(e.providers),n=Array.from(e.modules),r={};for(const o in e.providersByKey)r[o]=e.providersByKey[o];return{factory:e.factory,isRoot:e.isRoot,providers:t,modules:n,providersByKey:r}}(gr(this._ngModuleDefFactory));return Hn.createNgModuleRef(this.moduleType,e||Dt.NULL,this._bootstrapComponents,t)}}class us{}class ls{constructor(e){this.translateService=e,this.langArray=[],this.selectedLang="de",this.canCallAPI=!0,this.limitMessage=!1,this.isTranslationAvailable=!0,this.mar=[],this.hin=[],this.nl=[],this.de=[],this.fr=[],this.it=[],this.tr=[],this.pl=[],this.es=[],this.data={objectToDetect:"person",threshold:.7},this.results=[]}ngOnInit(){this.langArray=[{name:"Dutch",code:"nl",lang:"nl-NL"},{name:"French",code:"fr",lang:"fr-FR"},{name:"German",code:"de",lang:"de-DE"},{name:"Hindi",code:"hin",lang:"hi-IN"},{name:"Italian",code:"it",lang:"it-IT"},{name:"Marathi",code:"mar",lang:"hi-IN"},{name:"Polish",code:"pl",lang:"pl-PL"},{name:"Spanish",code:"es",lang:"es-ES"},{name:"Turkis",code:"tr",lang:"tr-TR"}],window.speechSynthesis?(void 0!==speechSynthesis.onvoiceschanged&&(this.isTranslationAvailable=!0,speechSynthesis.onvoiceschanged=this.getAllVoices),this.getAllVoices()):this.isTranslationAvailable=!1}getAllVoices(){let e=speechSynthesis.getVoices(),t=[],n=[];e.forEach((function(e,r){let o=e.voiceURI;t.includes(o)||(t.push(o),n.push(e))})),n.forEach((function(e,t){e.id=t})),this.allVoices=n,console.log(this.allVoices," voices")}speakTranslation(e){if(this.allVoices&&this.allVoices.length){let t,n=new SpeechSynthesisUtterance,r=this.langArray.find(e=>e.code==this.selectedLang);r&&(t=this.allVoices.findIndex(e=>e.lang==r.lang)),n.voice=this.allVoices[t],n.lang=n.voice.lang,n.text=e,n.rate=.8,speechSynthesis.speak(n),console.log(n," uuuuuuuuu")}else this.getAllVoices()}handlePredictionChange(e){let t=e.reduce((e,t)=>(e.some(e=>e.translation===t.object)||e.push(t),e),[]);this.results=t}setLang(e){this.selectedLang=e}getTranslation(e,t){this.canCallAPI=!1,this.translateService.getTranslation(e,this.selectedLang).subscribe(n=>(this.limitMessage=!1,this.tranlationData=n.responseData,t.push({object:e,translation:this.tranlationData.translatedText}),this.canCallAPI=!0,this.tranlationData.translatedText))}addObject(e,t){let n,r;return!!this.canCallAPI&&(e.length?(n=e.findIndex(e=>e.object==t))<0&&(r=this.getTranslation(t,e)):r=this.getTranslation(t,e),r)}showTranslation(e){let t;switch(this.selectedLang){case"mar":this.addObject(this.mar,e),this.mar&&"undefined"!==this.mar&&this.mar.length&&(t=this.mar.find(t=>t.object==e).translation);break;case"hin":this.addObject(this.hin,e),this.hin&&"undefined"!==this.hin&&this.hin.length&&(t=this.hin.find(t=>t.object==e).translation);break;case"nl":this.addObject(this.nl,e),this.nl&&"undefined"!==this.nl&&this.nl.length&&(t=this.nl.find(t=>t.object==e).translation);break;case"de":this.addObject(this.de,e),this.de&&"undefined"!==this.de&&this.de.length&&(t=this.de.find(t=>t.object==e).translation);break;case"tr":this.addObject(this.tr,e),this.tr&&"undefined"!==this.tr&&this.tr.length&&(t=this.tr.find(t=>t.object==e).translation);break;case"it":this.addObject(this.it,e),this.it&&"undefined"!==this.it&&this.tr.length&&(t=this.it.find(t=>t.object==e).translation);break;case"pl":this.addObject(this.pl,e),this.pl&&"undefined"!==this.pl&&this.pl.length&&(t=this.pl.find(t=>t.object==e).translation);break;case"es":this.addObject(this.es,e),this.es&&"undefined"!==this.es&&this.es.length&&(t=this.es.find(t=>t.object==e).translation)}return t}}class cs{}const hs=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),ps=function(e){return function(e){const t=e.toLowerCase().replace(/_/g,"-");let n=Eo[t];if(n)return n;const r=t.split("-")[0];if(n=Eo[r])return n;if("en"===r)return Io;throw new Error(`Missing locale data for the locale "${e}".`)}(e)[Co.PluralCase]},ds=new Ee("UseV4Plurals");class fs{}class ms extends fs{constructor(e,t){super(),this.locale=e,this.deprecatedPluralFn=t}getPluralCategory(e,t){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(t||this.locale,e):ps(t||this.locale)(e)){case hs.Zero:return"zero";case hs.One:return"one";case hs.Two:return"two";case hs.Few:return"few";case hs.Many:return"many";default:return"other"}}}function gs(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[r,o]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}class ys{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}class vs{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){tt()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(e)}. `+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${n}' of type '${e=n,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,r)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new ys(null,this._ngForOf,-1,-1),null===r?void 0:r),o=new bs(e,n);t.push(o)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const o=this._viewContainer.get(n);this._viewContainer.move(o,r);const i=new bs(e,o);t.push(i)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=r,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}class bs{constructor(e,t){this.record=e,this.view=t}}class ws{constructor(e,t){this._viewContainer=e,this._context=new xs,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){_s("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){_s("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}class xs{constructor(){this.$implicit=null,this.ngIf=null}}function _s(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${me(t)}'.`)}class Ns{}const Es=new Ee("DocumentToken"),Cs="server";let Is=null;function Os(){return Is}class Ss{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(e){this._attrToPropMap=e}}class ks extends Ss{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const e=this.createElement("div",document);if(null!=this.getStyle(e,"animationName"))this._animationPrefix="";else{const t=["Webkit","Moz","O","ms"];for(let n=0;n<t.length;n++)if(null!=this.getStyle(e,t[n]+"AnimationName")){this._animationPrefix="-"+t[n].toLowerCase()+"-";break}}const t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(t).forEach(n=>{null!=this.getStyle(e,n)&&(this._transitionEnd=t[n])})}catch(e){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(e){return e.getDistributedNodes()}resolveAndSetHref(e,t,n){e.href=null==n?t:t+"/../"+n}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}const Ts={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},As=3,Ps={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ds={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Rs=(()=>{if(Ne.Node)return Ne.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))}})();class Ms extends ks{parse(e){throw new Error("parse not implemented")}static makeCurrent(){var e;e=new Ms,Is||(Is=e)}hasProperty(e,t){return t in e}setProperty(e,t,n){e[t]=n}getProperty(e,t){return e[t]}invoke(e,t,n){e[t](...n)}logError(e){window.console&&(console.error?console.error(e):console.log(e))}log(e){window.console&&window.console.log&&window.console.log(e)}logGroup(e){window.console&&window.console.group&&window.console.group(e)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return Ts}contains(e,t){return Rs.call(e,t)}querySelector(e,t){return e.querySelector(t)}querySelectorAll(e,t){return e.querySelectorAll(t)}on(e,t,n){e.addEventListener(t,n,!1)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}createMouseEvent(e){const t=this.getDefaultDocument().createEvent("MouseEvent");return t.initEvent(e,!0,!0),t}createEvent(e){const t=this.getDefaultDocument().createEvent("Event");return t.initEvent(e,!0,!0),t}preventDefault(e){e.preventDefault(),e.returnValue=!1}isPrevented(e){return e.defaultPrevented||null!=e.returnValue&&!e.returnValue}getInnerHTML(e){return e.innerHTML}getTemplateContent(e){return"content"in e&&this.isTemplateElement(e)?e.content:null}getOuterHTML(e){return e.outerHTML}nodeName(e){return e.nodeName}nodeValue(e){return e.nodeValue}type(e){return e.type}content(e){return this.hasProperty(e,"content")?e.content:e}firstChild(e){return e.firstChild}nextSibling(e){return e.nextSibling}parentElement(e){return e.parentNode}childNodes(e){return e.childNodes}childNodesAsList(e){const t=e.childNodes,n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r];return n}clearNodes(e){for(;e.firstChild;)e.removeChild(e.firstChild)}appendChild(e,t){e.appendChild(t)}removeChild(e,t){e.removeChild(t)}replaceChild(e,t,n){e.replaceChild(t,n)}remove(e){return e.parentNode&&e.parentNode.removeChild(e),e}insertBefore(e,t,n){e.insertBefore(n,t)}insertAllBefore(e,t,n){n.forEach(n=>e.insertBefore(n,t))}insertAfter(e,t,n){e.insertBefore(n,t.nextSibling)}setInnerHTML(e,t){e.innerHTML=t}getText(e){return e.textContent}setText(e,t){e.textContent=t}getValue(e){return e.value}setValue(e,t){e.value=t}getChecked(e){return e.checked}setChecked(e,t){e.checked=t}createComment(e){return this.getDefaultDocument().createComment(e)}createTemplate(e){const t=this.getDefaultDocument().createElement("template");return t.innerHTML=e,t}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createElementNS(e,t,n){return(n=n||this.getDefaultDocument()).createElementNS(e,t)}createTextNode(e,t){return(t=t||this.getDefaultDocument()).createTextNode(e)}createScriptTag(e,t,n){const r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(e,t),r}createStyleElement(e,t){const n=(t=t||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(e,t)),n}createShadowRoot(e){return e.createShadowRoot()}getShadowRoot(e){return e.shadowRoot}getHost(e){return e.host}clone(e){return e.cloneNode(!0)}getElementsByClassName(e,t){return e.getElementsByClassName(t)}getElementsByTagName(e,t){return e.getElementsByTagName(t)}classList(e){return Array.prototype.slice.call(e.classList,0)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}hasClass(e,t){return e.classList.contains(t)}setStyle(e,t,n){e.style[t]=n}removeStyle(e,t){e.style[t]=""}getStyle(e,t){return e.style[t]}hasStyle(e,t,n){const r=this.getStyle(e,t)||"";return n?r==n:r.length>0}tagName(e){return e.tagName}attributeMap(e){const t=new Map,n=e.attributes;for(let r=0;r<n.length;r++){const e=n.item(r);t.set(e.name,e.value)}return t}hasAttribute(e,t){return e.hasAttribute(t)}hasAttributeNS(e,t,n){return e.hasAttributeNS(t,n)}getAttribute(e,t){return e.getAttribute(t)}getAttributeNS(e,t,n){return e.getAttributeNS(t,n)}setAttribute(e,t,n){e.setAttribute(t,n)}setAttributeNS(e,t,n,r){e.setAttributeNS(t,n,r)}removeAttribute(e,t){e.removeAttribute(t)}removeAttributeNS(e,t,n){e.removeAttributeNS(t,n)}templateAwareRoot(e){return this.isTemplateElement(e)?this.content(e):e}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(e){try{return e.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(e){return e.title}setTitle(e,t){e.title=t||""}elementMatches(e,t){return!!this.isElementNode(e)&&(e.matches&&e.matches(t)||e.msMatchesSelector&&e.msMatchesSelector(t)||e.webkitMatchesSelector&&e.webkitMatchesSelector(t))}isTemplateElement(e){return this.isElementNode(e)&&"TEMPLATE"===e.nodeName}isTextNode(e){return e.nodeType===Node.TEXT_NODE}isCommentNode(e){return e.nodeType===Node.COMMENT_NODE}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}hasShadowRoot(e){return null!=e.shadowRoot&&e instanceof HTMLElement}isShadowRoot(e){return e instanceof DocumentFragment}importIntoDoc(e){return document.importNode(this.templateAwareRoot(e),!0)}adoptNode(e){return document.adoptNode(e)}getHref(e){return e.getAttribute("href")}getEventKey(e){let t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),e.location===As&&Ds.hasOwnProperty(t)&&(t=Ds[t]))}return Ps[t]||t}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(e){const t=Ls||(Ls=document.querySelector("base"))?Ls.getAttribute("href"):null;return null==t?null:(n=t,js||(js=document.createElement("a")),js.setAttribute("href",n),"/"===js.pathname.charAt(0)?js.pathname:"/"+js.pathname);var n}resetBaseElement(){Ls=null}getUserAgent(){return window.navigator.userAgent}setData(e,t,n){this.setAttribute(e,"data-"+t,n)}getData(e,t){return this.getAttribute(e,"data-"+t)}getComputedStyle(e){return getComputedStyle(e)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(e){return gs(document.cookie,e)}setCookie(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)}}let js,Ls=null;function Vs(){return!!window.history.pushState}const Fs=new Ee("TRANSITION_ID"),zs=[{provide:Do,useFactory:function(e,t,n){return()=>{n.get(Ro).donePromise.then(()=>{const n=Os();Array.prototype.slice.apply(n.querySelectorAll(t,"style[ng-transition]")).filter(t=>n.getAttribute(t,"ng-transition")===e).forEach(e=>n.remove(e))})}},deps:[Fs,Es,Dt],multi:!0}];class Bs{static init(){var e;e=new Bs,yi=e}addToWindow(e){Ne.getAngularTestability=(t,n=!0)=>{const r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Ne.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ne.getAllAngularRootElements=()=>e.getAllRootElements(),Ne.frameworkStabilizers||(Ne.frameworkStabilizers=[]),Ne.frameworkStabilizers.push(e=>{const t=Ne.getAllAngularTestabilities();let n=t.length,r=!1;const o=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(o)}))})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?Os().isShadowRoot(t)?this.findTestabilityInTree(e,Os().getHost(t),!0):this.findTestabilityInTree(e,Os().parentElement(t),!0):null}}function Us(e,t){"undefined"!=typeof COMPILED&&COMPILED||((Ne.ng=Ne.ng||{})[e]=t)}const Ws=(()=>({ApplicationRef:Ii,NgZone:ai}))();function $s(e){return Pi(e)}const qs=new Ee("EventManagerPlugins");class Hs{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let r=0;r<n.length;r++){const t=n[r];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}class Gs{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Os().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}class Ks{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}class Xs extends Ks{constructor(e){super(),this._doc=e,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(e.head)}_addStylesToHost(e,t){e.forEach(e=>{const n=this._doc.createElement("style");n.textContent=e,this._styleNodes.add(t.appendChild(n))})}addHost(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}removeHost(e){this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach(t=>this._addStylesToHost(e,t))}ngOnDestroy(){this._styleNodes.forEach(e=>Os().remove(e))}}const Zs={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Qs=/%COMP%/g,Js="_nghost-%COMP%",Ys="_ngcontent-%COMP%";function eu(e,t,n){for(let r=0;r<t.length;r++){let o=t[r];Array.isArray(o)?eu(e,o,n):(o=o.replace(Qs,e),n.push(o))}return n}function tu(e){return t=>{!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}class nu{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new ru(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case $e.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new au(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case $e.Native:case $e.ShadowDom:return new su(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=eu(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class ru{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Zs[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const o=Zs[r];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Zs[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&pn.DashCase?e.style.setProperty(t,n,r&pn.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&pn.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){iu(t,"property"),e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return iu(t,"listener"),"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,tu(n)):this.eventManager.addEventListener(e,t,tu(n))}}const ou=(()=>"@".charCodeAt(0))();function iu(e,t){if(e.charCodeAt(0)===ou)throw new Error(`Found the synthetic ${t} ${e}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class au extends ru{constructor(e,t,n,r){super(e),this.component=n;const o=eu(r+"-"+n.id,n.styles,[]);t.addStyles(o),this.contentAttr=Ys.replace(Qs,r+"-"+n.id),this.hostAttr=Js.replace(Qs,r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class su extends ru{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===$e.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const o=eu(r.id,r.styles,[]);for(let i=0;i<o.length;i++){const e=document.createElement("style");e.textContent=o[i],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}const uu=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(e){return"__zone_symbol__"+e})(),lu=uu("addEventListener"),cu=uu("removeEventListener"),hu={},pu="FALSE",du="ANGULAR",fu="addEventListener",mu="removeEventListener",gu="__zone_symbol__propagationStopped",yu="__zone_symbol__stopImmediatePropagation",vu=(()=>{const e="undefined"!=typeof Zone&&Zone[uu("BLACK_LISTED_EVENTS")];if(e){const t={};return e.forEach(e=>{t[e]=e}),t}})(),bu=function(e){return!!vu&&vu.hasOwnProperty(e)},wu=function(e){const t=hu[e.type];if(!t)return;const n=this[t];if(!n)return;const r=[e];if(1===n.length){const e=n[0];return e.zone!==Zone.current?e.zone.run(e.handler,this,r):e.handler.apply(this,r)}{const t=n.slice();for(let n=0;n<t.length&&!0!==e[gu];n++){const e=t[n];e.zone!==Zone.current?e.zone.run(e.handler,this,r):e.handler.apply(this,r)}}};class xu extends Gs{constructor(e,t,n){super(e),this.ngZone=t,n&&function(e){return e===Cs}(n)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype[yu])return;const e=Event.prototype[yu]=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[gu]=!0),e&&e.apply(this,arguments)}}supports(e){return!0}addEventListener(e,t,n){let r=n;if(!e[lu]||ai.isInAngularZone()&&!bu(t))e[fu](t,r,!1);else{let n=hu[t];n||(n=hu[t]=uu(du+t+pu));let o=e[n];const i=o&&o.length>0;o||(o=e[n]=[]);const a=bu(t)?Zone.root:Zone.current;if(0===o.length)o.push({zone:a,handler:r});else{let e=!1;for(let t=0;t<o.length;t++)if(o[t].handler===r){e=!0;break}e||o.push({zone:a,handler:r})}i||e[lu](t,wu,!1)}return()=>this.removeEventListener(e,t,r)}removeEventListener(e,t,n){let r=e[cu];if(!r)return e[mu].apply(e,[t,n,!1]);let o=hu[t],i=o&&e[o];if(!i)return e[mu].apply(e,[t,n,!1]);let a=!1;for(let s=0;s<i.length;s++)if(i[s].handler===n){a=!0,i.splice(s,1);break}a?0===i.length&&r.apply(e,[t,wu,!1]):e[mu].apply(e,[t,n,!1])}}const _u={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Nu=new Ee("HammerGestureConfig"),Eu=new Ee("HammerLoader");class Cu{constructor(){this.events=[],this.overrides={}}buildHammer(e){const t=new Hammer(e,this.options);t.get("pinch").set({enable:!0}),t.get("rotate").set({enable:!0});for(const n in this.overrides)t.get(n).set(this.overrides[n]);return t}}class Iu extends Gs{constructor(e,t,n,r){super(e),this._config=t,this.console=n,this.loader=r}supports(e){return!(!_u.hasOwnProperty(e.toLowerCase())&&!this.isCustomEvent(e)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${e}" event cannot be bound because Hammer.JS is not `+"loaded and no custom loader has been specified."),1))}addEventListener(e,t,n){const r=this.manager.getZone();if(t=t.toLowerCase(),!window.Hammer&&this.loader){let r=!1,o=()=>{r=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(o=()=>{});r||(o=this.addEventListener(e,t,n))}).catch(()=>{this.console.warn(`The "${t}" event cannot be bound because the custom `+"Hammer.JS loader failed."),o=()=>{}}),()=>{o()}}return r.runOutsideAngular(()=>{const o=this._config.buildHammer(e),i=function(e){r.runGuarded((function(){n(e)}))};return o.on(t,i),()=>{o.off(t,i),"function"==typeof o.destroy&&o.destroy()}})}isCustomEvent(e){return this._config.events.indexOf(e)>-1}}const Ou=["alt","control","meta","shift"],Su={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};class ku extends Gs{constructor(e){super(e)}supports(e){return null!=ku.parseEventName(e)}addEventListener(e,t,n){const r=ku.parseEventName(t),o=ku.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Os().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const t=e.toLowerCase().split("."),n=t.shift();if(0===t.length||"keydown"!==n&&"keyup"!==n)return null;const r=ku._normalizeKey(t.pop());let o="";if(Ou.forEach(e=>{const n=t.indexOf(e);n>-1&&(t.splice(n,1),o+=e+".")}),o+=r,0!=t.length||0===r.length)return null;const i={};return i.domEventName=n,i.fullKey=o,i}static getEventFullKey(e){let t="",n=Os().getEventKey(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Ou.forEach(r=>{r!=n&&(0,Su[r])(e)&&(t+=r+".")}),t+=n}static eventCallback(e,t,n){return r=>{ku.getEventFullKey(r)===e&&n.runGuarded(()=>t(r))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}class Tu{}class Au extends Tu{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case Nt.NONE:return t;case Nt.HTML:return t instanceof Du?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"HTML"),function(e,t){let n=null;try{xt=xt||new nt(e);let r=t?String(t):"";n=xt.getInertBodyElement(r);let o=5,i=r;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,r=i,i=n.innerHTML,n=xt.getInertBodyElement(r)}while(r!==i);const a=new yt,s=a.sanitizeChildren(_t(n)||n);return tt()&&a.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n){const e=_t(n)||n;for(;e.firstChild;)e.removeChild(e.firstChild)}}}(this._doc,String(t)));case Nt.STYLE:return t instanceof Ru?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"Style"),function(e){if(!(e=String(e).trim()))return"";const t=e.match(It);return t&&it(t[1])===t[1]||e.match(Ct)&&function(e){let t=!0,n=!0;for(let r=0;r<e.length;r++){const o=e.charAt(r);"'"===o&&n?t=!t:'"'===o&&t&&(n=!n)}return t&&n}(e)?e:(tt()&&console.warn(`WARNING: sanitizing unsafe style value ${e} (see http://g.co/ng/security#xss).`),"unsafe")}(t));case Nt.SCRIPT:if(t instanceof Mu)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"Script"),new Error("unsafe value used in a script context");case Nt.URL:return t instanceof Lu||t instanceof ju?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"URL"),it(String(t)));case Nt.RESOURCE_URL:if(t instanceof Lu)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(e,t){if(e instanceof Pu)throw new Error(`Required a safe ${t}, got a ${e.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(e){return new Du(e)}bypassSecurityTrustStyle(e){return new Ru(e)}bypassSecurityTrustScript(e){return new Mu(e)}bypassSecurityTrustUrl(e){return new ju(e)}bypassSecurityTrustResourceUrl(e){return new Lu(e)}}class Pu{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class Du extends Pu{getTypeName(){return"HTML"}}class Ru extends Pu{getTypeName(){return"Style"}}class Mu extends Pu{getTypeName(){return"Script"}}class ju extends Pu{getTypeName(){return"URL"}}class Lu extends Pu{getTypeName(){return"ResourceURL"}}const Vu=_i(Ri,"browser",[{provide:Fo,useValue:"browser"},{provide:Vo,useValue:function(){Ms.makeCurrent(),Bs.init()},multi:!0},{provide:cs,useClass:class extends cs{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=Os().getLocation(),this._history=Os().getHistory()}getBaseHrefFromDOM(){return Os().getBaseHref(this._doc)}onPopState(e){Os().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}onHashChange(e){Os().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,n){Vs()?this._history.pushState(e,t,n):this.location.hash=n}replaceState(e,t,n){Vs()?this._history.replaceState(e,t,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}},deps:[Es]},{provide:Es,useFactory:function(){return document},deps:[]}]);function Fu(){return new Je}class zu{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:zu,providers:[{provide:Mo,useValue:e.appId},{provide:Fs,useExisting:Mo},zs]}}}"undefined"!=typeof window&&window;const Bu=new x(e=>e.complete());class Uu extends B{constructor(e,t){super(e),this.sources=t,this.completed=0,this.haveValues=0;const n=t.length;this.values=new Array(n);for(let r=0;r<n;r++){const e=z(this,t[r],null,r);e&&this.add(e)}}notifyNext(e,t,n,r,o){this.values[n]=t,o._hasValue||(o._hasValue=!0,this.haveValues++)}notifyComplete(e){const{destination:t,haveValues:n,values:r}=this,o=r.length;e._hasValue?(this.completed++,this.completed===o&&(n===o&&t.next(r),t.complete())):t.complete()}}const Wu=new Ee("NgValueAccessor");class $u{constructor(e,t,n){this._renderer=e,this._elementRef=t,this._compositionMode=n,this.onChange=e=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=Os()?Os().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}class qu{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Hu extends qu{get formDirective(){return null}get path(){return null}}function Gu(){throw new Error("unimplemented")}class Ku extends qu{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Gu()}get asyncValidator(){return Gu()}}class Xu{constructor(e){this._cd=e}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}class Zu extends Xu{constructor(e){super(e)}}function Qu(e){return null==e||0===e.length}const Ju=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Yu{static min(e){return t=>{if(Qu(t.value)||Qu(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}static max(e){return t=>{if(Qu(t.value)||Qu(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}static required(e){return Qu(e.value)?{required:!0}:null}static requiredTrue(e){return!0===e.value?null:{required:!0}}static email(e){return Qu(e.value)?null:Ju.test(e.value)?null:{email:!0}}static minLength(e){return t=>{if(Qu(t.value))return null;const n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}static maxLength(e){return t=>{const n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}static pattern(e){if(!e)return Yu.nullValidator;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),e=>{if(Qu(e.value))return null;const r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(e){return null}static compose(e){if(!e)return null;const t=e.filter(el);return 0==t.length?null:function(e){return nl(function(e,t){return t.map(t=>t(e))}(e,t))}}static composeAsync(e){if(!e)return null;const t=e.filter(el);return 0==t.length?null:function(e){return function e(...t){let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&c(t[0])&&(t=t[0]),0===t.length?Bu:n?e(t).pipe(U(e=>n(...e))):new x(e=>new Uu(e,t))}(function(e,t){return t.map(t=>t(e))}(e,t).map(tl)).pipe(U(nl))}}}function el(e){return null!=e}function tl(e){const t=Xt(e)?H(e):e;if(!Zt(t))throw new Error("Expected validator to return Promise or Observable.");return t}function nl(e){const t=e.reduce((e,t)=>null!=t?Object.assign({},e,t):e,{});return 0===Object.keys(t).length?null:t}function rl(e){return e.validate?t=>e.validate(t):e}function ol(e){return e.validate?t=>e.validate(t):e}class il{constructor(){this._accessors=[]}add(e,t){this._accessors.push([e,t])}remove(e){for(let t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}select(e){this._accessors.forEach(t=>{this._isSameGroup(t,e)&&t[1]!==e&&t[1].fireUncheck(e.value)})}_isSameGroup(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}const al={formControlName:'\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',formGroupName:'\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',formArrayName:'\n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });',ngModelGroup:'\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',ngModelWithFormGroup:'\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  '};function sl(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}class ul{constructor(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=$t}set compareWith(e){if("function"!=typeof e)throw new Error(`compareWith must be a function, but received ${JSON.stringify(e)}`);this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=sl(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}class ll{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(sl(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}function cl(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}class hl{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(cl(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(cl(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}function pl(e,t){return[...t.path,e]}function dl(e,t){e||ml(t,"Cannot find control with"),t.valueAccessor||ml(t,"No value accessor for form control with"),e.validator=Yu.compose([e.validator,t.validator]),e.asyncValidator=Yu.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&fl(e,t)})}(e,t),function(e,t){e.registerOnChange((e,n)=>{t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&fl(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange(e=>{t.valueAccessor.setDisabledState(e)}),t._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(()=>e.updateValueAndValidity())}),t._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(()=>e.updateValueAndValidity())})}function fl(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function ml(e,t){let n;throw n=e.path.length>1?`path: '${e.path.join(" -> ")}'`:e.path[0]?`name: '${e.path}'`:"unspecified name attribute",new Error(`${t} ${n}`)}function gl(e){return null!=e?Yu.compose(e.map(rl)):null}function yl(e){return null!=e?Yu.composeAsync(e.map(ol)):null}const vl=[class{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},class{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},class{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},ul,class{constructor(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=$t}set compareWith(e){if("function"!=typeof e)throw new Error(`compareWith must be a function, but received ${JSON.stringify(e)}`);this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const n=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(n.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const n=[];if(t.hasOwnProperty("selectedOptions")){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const r=e.item(t),o=this._getOptionValue(r.value);n.push(o)}}else{const e=t.options;for(let t=0;t<e.length;t++){const r=e.item(t);if(r.selected){const e=this._getOptionValue(r.value);n.push(e)}}}this.value=n,e(n)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}},class{constructor(e,t,n,r){this._renderer=e,this._elementRef=t,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Ku),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}],bl="VALID",wl="INVALID",xl="PENDING",_l="DISABLED";function Nl(e){const t=Cl(e)?e.validators:e;return Array.isArray(t)?gl(t):t||null}function El(e,t){const n=Cl(t)?t.asyncValidators:e;return Array.isArray(n)?yl(n):n||null}function Cl(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class Il{constructor(e,t){this.validator=e,this.asyncValidator=t,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return this.status===bl}get invalid(){return this.status===wl}get pending(){return this.status==xl}get disabled(){return this.status===_l}get enabled(){return this.status!==_l}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this.validator=Nl(e)}setAsyncValidators(e){this.asyncValidator=El(e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=xl,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=_l,this.errors=null,this._forEachChild(t=>{t.disable(Object.assign({},e,{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=bl,this._forEachChild(t=>{t.enable(Object.assign({},e,{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==bl&&this.status!==xl||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?_l:bl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=xl;const t=tl(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>this.setErrors(t,{emitEvent:e}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,n){return null==t?null:(t instanceof Array||(t=t.split(".")),t instanceof Array&&0===t.length?null:t.reduce((e,t)=>e instanceof Sl?e.controls.hasOwnProperty(t)?e.controls[t]:null:e instanceof kl&&e.at(t)||null,e))}(this,e)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new To,this.statusChanges=new To}_calculateStatus(){return this._allControlsDisabled()?_l:this.errors?wl:this._anyControlsHaveStatus(xl)?xl:this._anyControlsHaveStatus(wl)?wl:bl}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Cl(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class Ol extends Il{constructor(e=null,t,n){super(Nl(t),El(n,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class Sl extends Il{constructor(e,t,n){super(Nl(t),El(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t instanceof Ol?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>e(this.controls[t],t))}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){let t=!1;return this._forEachChild((n,r)=>{t=t||this.contains(r)&&e(n)}),t}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((e,r)=>{n=t(n,e,r)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class kl extends Il{constructor(e,t,n){super(Nl(t),El(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(e){return this.controls[e]}push(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}insert(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}removeAt(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e.forEach((e,n)=>{this.at(n)&&this.at(n).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}reset(e=[],t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof Ol?e.value:e.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const Tl=(()=>Promise.resolve(null))();class Al extends Hu{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new To,this.form=new Sl({},gl(e),yl(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Tl.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),dl(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Tl.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),function(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}(this._directives,e)})}addFormGroup(e){Tl.then(()=>{const t=this._findContainer(e.path),n=new Sl({});(function(e,t){null==e&&ml(t,"Cannot find control with"),e.validator=Yu.compose([e.validator,t.validator]),e.asyncValidator=Yu.composeAsync([e.asyncValidator,t.asyncValidator])})(n,e),t.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Tl.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){Tl.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}),this.ngSubmit.emit(e),!1;var t}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}class Pl{static modelParentException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup's partner directive "formControlName" instead.  Example:\n\n      ${al.formControlName}\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      ${al.ngModelWithFormGroup}`)}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${al.formGroupName}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${al.ngModelGroup}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${al.formGroupName}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${al.ngModelGroup}`)}static ngFormWarning(){console.warn("\n    It looks like you're using 'ngForm'.\n\n    Support for using the 'ngForm' element selector has been deprecated in Angular v6 and will be removed\n    in Angular v9.\n\n    Use 'ng-form' instead.\n\n    Before:\n    <ngForm #myForm=\"ngForm\">\n\n    After:\n    <ng-form #myForm=\"ngForm\">\n    ")}}const Dl=new Ee("NgFormSelectorWarning");class Rl extends Hu{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return pl(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return gl(this._validators)}get asyncValidator(){return yl(this._asyncValidators)}_checkParentType(){}}class Ml extends Rl{constructor(e,t,n){super(),this._parent=e,this._validators=t,this._asyncValidators=n}_checkParentType(){this._parent instanceof Ml||this._parent instanceof Al||Pl.modelGroupParentException()}}const jl=(()=>Promise.resolve(null))();class Ll extends Ku{constructor(e,t,n,r){super(),this.control=new Ol,this._registered=!1,this.update=new To,this._parent=e,this._rawValidators=t||[],this._rawAsyncValidators=n||[],this.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||ml(e,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,o=void 0;return t.forEach(t=>{t.constructor===$u?n=t:function(e){return vl.some(t=>e.constructor===t)}(t)?(r&&ml(e,"More than one built-in value accessor matches form control with"),r=t):(o&&ml(e,"More than one custom value accessor matches form control with"),o=t)}),o||r||n||(ml(e,"No valid value accessor for form control with"),null)}(this,r)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!$t(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?pl(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return gl(this._rawValidators)}get asyncValidator(){return yl(this._rawAsyncValidators)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){dl(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof Ml)&&this._parent instanceof Rl?Pl.formGroupNameException():this._parent instanceof Ml||this._parent instanceof Al||Pl.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Pl.missingNameException()}_updateValue(e){jl.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,n=""===t||t&&"false"!==t;jl.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}class Vl{}class Fl{static withConfig(e){return{ngModule:Fl,providers:[{provide:Dl,useValue:e.warnOnDeprecatedNgFormSelector}]}}}var zl;class Bl{constructor(e,t,n){this._mimeType=null,this._imageAsBase64=null,this._imageAsDataUrl=null,this._imageData=null,this._mimeType=t,this._imageAsDataUrl=e,this._imageData=n}static getDataFromDataUrl(e,t){return e.replace(`data:${t};base64,`,"")}get imageAsBase64(){return this._imageAsBase64?this._imageAsBase64:this._imageAsBase64=Bl.getDataFromDataUrl(this._imageAsDataUrl,this._mimeType)}get imageAsDataUrl(){return this._imageAsDataUrl}get imageData(){return this._imageData}}class Ul{static getAvailableVideoInputs(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?new Promise((e,t)=>{navigator.mediaDevices.enumerateDevices().then(t=>{e(t.filter(e=>"videoinput"===e.kind))}).catch(e=>{t(e.message||e)})}):Promise.reject("enumerateDevices() not supported.")}}let Wl=(()=>{let e=zl=class{constructor(){this.width=640,this.height=480,this.videoOptions=zl.DEFAULT_VIDEO_OPTIONS,this.allowCameraSwitch=!0,this.captureImageData=!1,this.imageType=zl.DEFAULT_IMAGE_TYPE,this.imageQuality=zl.DEFAULT_IMAGE_QUALITY,this.imageCapture=new To,this.initError=new To,this.imageClick=new To,this.cameraSwitched=new To,this.availableVideoInputs=[],this.videoInitialized=!1,this.activeVideoInputIndex=-1,this.mediaStream=null,this.activeVideoSettings=null}set trigger(e){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.triggerSubscription=e.subscribe(()=>{this.takeSnapshot()})}set switchCamera(e){this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe(),this.switchCameraSubscription=e.subscribe(e=>{"string"==typeof e?this.switchToVideoInput(e):this.rotateVideoInput(!1!==e)})}static getMediaConstraintsForDevice(e,t){const n=t||this.DEFAULT_VIDEO_OPTIONS;return e&&(n.deviceId={exact:e}),n}static getDeviceIdFromMediaStreamTrack(e){if(e.getSettings&&e.getSettings()&&e.getSettings().deviceId)return e.getSettings().deviceId;if(e.getConstraints&&e.getConstraints()&&e.getConstraints().deviceId){const t=e.getConstraints().deviceId;return zl.getValueFromConstrainDOMString(t)}}static getFacingModeFromMediaStreamTrack(e){if(e){if(e.getSettings&&e.getSettings()&&e.getSettings().facingMode)return e.getSettings().facingMode;if(e.getConstraints&&e.getConstraints()&&e.getConstraints().facingMode){const t=e.getConstraints().facingMode;return zl.getValueFromConstrainDOMString(t)}}}static isUserFacing(e){const t=zl.getFacingModeFromMediaStreamTrack(e);return!!t&&"user"===t.toLowerCase()}static getValueFromConstrainDOMString(e){if(e){if(e instanceof String)return String(e);if(Array.isArray(e)&&Array(e).length>0)return String(e[0]);if("object"==typeof e){if(e.exact)return String(e.exact);if(e.ideal)return String(e.ideal)}}return null}ngAfterViewInit(){this.detectAvailableDevices().then(()=>{this.switchToVideoInput(null)}).catch(e=>{this.initError.next({message:e}),this.switchToVideoInput(null)})}ngOnDestroy(){this.stopMediaTracks(),this.unsubscribeFromSubscriptions()}takeSnapshot(){const e=this.nativeVideoElement,t={width:this.width,height:this.height};e.videoWidth&&(t.width=e.videoWidth,t.height=e.videoHeight);const n=this.canvas.nativeElement;n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.drawImage(e,0,0);const o=this.imageType?this.imageType:zl.DEFAULT_IMAGE_TYPE,i=n.toDataURL(o,this.imageQuality?this.imageQuality:zl.DEFAULT_IMAGE_QUALITY);let a=null;this.captureImageData&&(a=r.getImageData(0,0,n.width,n.height)),this.imageCapture.next(new Bl(i,o,a))}rotateVideoInput(e){this.availableVideoInputs&&this.availableVideoInputs.length>1&&this.switchToVideoInput(this.availableVideoInputs[(this.activeVideoInputIndex+(e?1:this.availableVideoInputs.length-1))%this.availableVideoInputs.length].deviceId)}switchToVideoInput(e){this.videoInitialized=!1,this.stopMediaTracks(),this.initWebcam(e,this.videoOptions)}videoResize(){}get videoWidth(){const e=this.getVideoAspectRatio();return Math.min(this.width,this.height*e)}get videoHeight(){const e=this.getVideoAspectRatio();return Math.min(this.height,this.width/e)}get videoStyleClasses(){let e="";return this.isMirrorImage()&&(e+="mirrored "),e.trim()}get nativeVideoElement(){return this.video.nativeElement}getVideoAspectRatio(){const e=this.nativeVideoElement;return e.videoWidth&&e.videoWidth>0&&e.videoHeight&&e.videoHeight>0?e.videoWidth/e.videoHeight:this.width/this.height}initWebcam(e,t){const n=this.nativeVideoElement;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const r=zl.getMediaConstraintsForDevice(e,t);navigator.mediaDevices.getUserMedia({video:r}).then(e=>{this.mediaStream=e,n.srcObject=e,n.play(),this.activeVideoSettings=e.getVideoTracks()[0].getSettings();const t=zl.getDeviceIdFromMediaStreamTrack(e.getVideoTracks()[0]);this.cameraSwitched.next(t),this.detectAvailableDevices().then(()=>{this.activeVideoInputIndex=t?this.availableVideoInputs.findIndex(e=>e.deviceId===t):-1,this.videoInitialized=!0}).catch(()=>{this.activeVideoInputIndex=-1,this.videoInitialized=!0})}).catch(e=>{this.initError.next({message:e.message,mediaStreamError:e})})}else this.initError.next({message:"Cannot read UserMedia from MediaDevices."})}getActiveVideoTrack(){return this.mediaStream?this.mediaStream.getVideoTracks()[0]:null}isMirrorImage(){if(!this.getActiveVideoTrack())return!1;{let e="auto";switch(this.mirrorImage&&("string"==typeof this.mirrorImage?e=String(this.mirrorImage).toLowerCase():this.mirrorImage.x&&(e=this.mirrorImage.x.toLowerCase())),e){case"always":return!0;case"never":return!1}}return zl.isUserFacing(this.getActiveVideoTrack())}stopMediaTracks(){this.mediaStream&&this.mediaStream.getTracks&&this.mediaStream.getTracks().forEach(e=>e.stop())}unsubscribeFromSubscriptions(){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe()}detectAvailableDevices(){return new Promise((e,t)=>{Ul.getAvailableVideoInputs().then(t=>{this.availableVideoInputs=t,e(t)}).catch(e=>{this.availableVideoInputs=[],t(e)})})}};return e.DEFAULT_VIDEO_OPTIONS={facingMode:"environment"},e.DEFAULT_IMAGE_TYPE="image/jpeg",e.DEFAULT_IMAGE_QUALITY=.92,e})(),$l=class{};var ql=Jn({encapsulation:0,styles:[".webcam-wrapper[_ngcontent-%COMP%]{display:inline-block;position:relative;line-height:0}.webcam-wrapper[_ngcontent-%COMP%]   video.mirrored[_ngcontent-%COMP%]{transform:scale(-1,1)}.webcam-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:none}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAE9UlEQVR42u2aT2hdRRTGf+cRQqghSqihdBFDkRISK2KDfzDWxHaRQHEhaINKqa1gKQhd6EZLN+IidCH+Q0oWIkVRC21BQxXRitVaSbKoJSGtYGoK2tQ/tU1jY5v0c5F54Xl7b/KSO/PyEt+3e5f75p7zzZwzZ74zUEIJJfyfYaEGllQGVAGZlENdBy6Z2cSiYFTSKkkfS/pH/nBF0kFJdUW9AiRVASeAukD8DgNrzOySrwEzng18KaDzALXuG8W3AiStAvqBisBRNg40mtlPxbYCOgvgPO4bncWW+JpVeDQXRQhIygDfA00F5r0XuNfMrgclQFI98DDQCNQA5ZFXqoCWBVp8XwHRHeEqcN7loy/NbHBesyqpQ1KfFj/6nC+ZvFaApFrgPaCZpYVvgCfNbDiRAElNwGFg+RIt/X8H2s2s9wYCJDUAR4HqJX7++RN40MwGpgmQVAH0AQ2BPz4AHHPl8nBOAqtyFWQjsA6oL4Ada81sPDv7uwImod8kvSJp9RyS8O2SXnb/DYVd2Y9VSroQ4ANXJO2WVJmixqh0kzMWwL4LkiqRtDnA4D1zmfE8j9g9AezcnAHaPcfXdbfdnPZ2Yps6+DwAvO/Z1naTdApY7Xng48BDZnY1MpMVQBuw3iXc5Tnb0wBwBPjUzP6eoezuArZ6svM0geJLkvZEYnl3nkntoqROSbckSW2Suj3ZOIangc7GPJuUtNGdFIfmMeavktoSSKiW9LMPw30Q8JqkekmjCbOZRhuclLQjgYSNxUBAj6RyZ9ATgUJpUtJTCSR8vpAEXHAyWK5BXYFIGHOlepSAloUk4NEYgyoknQhEwhFJ0e8h6VSaQeerCb5uZgdi9utxYBNwOUD93hIVXswM4INCi6K9wAszFC2DwLOBDjHbYp59karIUnRdzYy/3ClqVklaUhfwTICj7K25OqA7a4wWagVsm4Me/xzwg2cCqqONFzO7DPxSCAJi436GUBgHHguQD2oTlJ55oSzP9ybccsttSJw1szdjFOSnI/8dTCGZHwcORp4Nx7y3B1iZ8/sm4MW8/Euxg5wIsS/HaAp3zeP4/G7obRDXI4jiTIA22H7Xdc7X+S3A5lC7QBQ357aq3VAjCeSkwUfAJrfvz+R8A9ADLAtZB+TinpjC5JMA+//jwPZZnF8G7J+L8z4IWB/zbG+gIujVWfLBW/NStVMmqaG4POJRsIjix7h8IGnLQuoBbQki5sVAJHyYm7YkNaRRtXwQ8G1cHpX0iKRrgUjYno17Sf0LrQhJUkdCeHWkVITGJI0k1QeS3ikGSUzOyJUJJNznYneuOCnpTldcxa2kP3xJYqOeSDjqZG8ShJLnE8TTuMS6Iyu1BW7djZqkfo9N0QOuYJmYQddfB7RG+gLTNzqAY9FrL+5/nwEbvDdJJe3zzOrhNP3AWRqmk55t3ZcBuj3b2gb0Sbrbo/NNzk7fFzu7s/E5EiC+rrmeQU0Kx2skvRFoOx2ZzlmSdgbsw49JetvtBpk8nM64d/cGbNtJ0s7cGyJlwHeEv+t3nqnLSgPAUOSGyG3AHUxdzqoJbEcvcL+ZTeTeEapzJKxgaeOcc/7Mf06D7kFrguS0VDAMtGadv+E47DT9tcChJej8ISfpD+abgTe45uOkFi8mnQ+JBVQ+d4VXuOptjavcyot8pq86mfwk8LWZnaOEEkoooYQSSojDv8AhQNeGfe0jAAAAAElFTkSuQmCC);background-repeat:no-repeat;border-radius:5px;position:absolute;right:13px;top:10px;height:48px;width:48px;background-size:80%;cursor:pointer;background-position:center;transition:background-color .2s}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.18)}"],data:{}});function Hl(e){return ta(0,[(e()(),Bi(0,0,null,null,0,"div",[["class","camera-switch"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.rotateVideoInput(!0)&&r),r}),null,null))],null,null)}function Gl(e){return ta(0,[Hi(402653184,1,{video:0}),Hi(402653184,2,{canvas:0}),(e()(),Bi(2,0,null,null,4,"div",[["class","webcam-wrapper"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.imageClick.next()&&r),r}),null,null)),(e()(),Bi(3,0,[[1,0],["video",1]],null,0,"video",[["autoplay",""],["muted",""],["playsinline",""]],[[8,"width",0],[8,"height",0],[8,"className",0]],[[null,"resize"]],(function(e,t,n){var r=!0;return"resize"===t&&(r=!1!==e.component.videoResize()&&r),r}),null,null)),(e()(),zi(16777216,null,null,1,null,Hl)),ao(5,16384,null,0,ws,[Rn,Pn],{ngIf:[0,"ngIf"]},null),(e()(),Bi(6,0,[[2,0],["canvas",1]],null,0,"canvas",[],[[8,"width",0],[8,"height",0]],null,null,null,null))],(function(e,t){var n=t.component;e(t,5,0,n.allowCameraSwitch&&n.availableVideoInputs.length>1&&n.videoInitialized)}),(function(e,t){var n=t.component;e(t,3,0,n.videoWidth,n.videoHeight,n.videoStyleClasses),e(t,6,0,n.width,n.height)}))}var Kl=n("Re/O"),Xl=function(e,t){return(Xl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Zl(e,t){function n(){this.constructor=e}Xl(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Ql=function(){return(Ql=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Jl(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function Yl(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var ec=Kl.f.get("EPSILON");function tc(){return ec}var nc=0;function rc(){return nc++}var oc={};function ic(e){return void 0===e&&(e=""),e in oc||(oc[e]=0),oc[e]+=1,e+oc[e].toString()}var ac={float32:{},int32:{}},sc="float32";function uc(e,t){return void 0===t&&(t=sc),null==ac[t][e]&&(ac[t][e]=Object(Kl.nd)(e,t),Object(Kl.Pb)(ac[t][e])),ac[t][e]}var lc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Zl(t,e),t}(Error),cc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Zl(t,e),t}(Error),hc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Zl(t,e),t}(Error),pc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Zl(t,e),t}(Error),dc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Zl(t,e),t}(Error);function fc(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function mc(e,t){if(!e)throw new dc(t)}function gc(e,t){for(var n=0,r=0,o=e;r<o.length;r++)o[r]===t&&n++;return n}function yc(e){return 1===e.length?e[0]:e}function vc(e){return Array.isArray(e)?e:[e]}function bc(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function wc(e){return e.length<=1?e:-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}!function(e){Zl((function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}),e)}(Error);var xc={};function _c(e){return null==e?null:{className:e.getClassName(),config:e.getConfig()}}function Nc(e,t,n,r){if(void 0===t&&(t={}),void 0===n&&(n={}),void 0===r&&(r="object"),"string"==typeof e){var o=void 0;if(e in n)o=n[e];else if(e in xc)o=xc[e];else if(null==(o=t[e]))throw new hc("Unknown "+r+": "+e+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return o}var i=e;if(null==i.className||null==i.config)throw new hc(r+": Improper config format: "+JSON.stringify(i)+".\n'className' and 'config' must set.");var a,s,u,l=i.className,c=void 0,h=void 0;if(l in n?(c=(a=n.get(l))[0],h=a[1]):l in xc?(c=(s=xc.className)[0],h=s[1]):l in t&&(c=(u=t[l])[0],h=u[1]),null==c)throw new hc("Unknown "+r+": "+l+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=h){for(var p={},d=0,f=Object.keys(xc);d<f.length;d++)p[w=f[d]]=xc[w];for(var m=0,g=Object.keys(n);m<g.length;m++)p[w=g[m]]=n[w];i.config.customObjects=p;for(var y=Ql({},xc),v=0,b=Object.keys(n);v<b.length;v++){var w=b[v];xc[w]=n[w]}var x=h(c,i.config);return xc=Ql({},y),x}y=Ql({},xc);for(var _=0,N=Object.keys(n);_<N.length;_++)xc[w=N[_]]=n[w];return x=new c(i.config),xc=Ql({},y),x}function Ec(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Cc(e){if(null==e)return e;for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];-1===t.indexOf(o)&&t.push(o)}return t}function Ic(e){if(null==e)throw new hc("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Oc(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new hc(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function Sc(e,t,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),mc(n>=0),mc(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function kc(e,t){return Object(Kl.ee)((function(){return Object(Kl.Jd)(Object(Kl.Td)(Object(Kl.yc)(e,e),t,!0))}))}var Tc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.getConfig=function(){return{}},t}(Kl.rd.Serializable),Ac=function(e){function t(t){var n=e.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return Zl(t,e),t.prototype.apply=function(e){var t=this;return Object(Kl.ee)((function(){var n=kc(e,t.axis),r=Object(Kl.Q)(n,0,t.maxValue);return Object(Kl.xc)(e,Object(Kl.kb)(r,Object(Kl.u)(uc(tc()),n)))}))},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(Tc);Kl.rd.registerClass(Ac);var Pc=function(e){function t(t){var n=e.call(this)||this;return n.defaultAxis=0,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return Zl(t,e),t.prototype.apply=function(e){var t=this;return Object(Kl.ee)((function(){return Object(Kl.kb)(e,Object(Kl.u)(uc(tc()),kc(e,t.axis)))}))},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(Tc);Kl.rd.registerClass(Pc);var Dc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.dd)(e)},t.className="NonNeg",t}(Tc);Kl.rd.registerClass(Dc);var Rc=function(e){function t(t){var n=e.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=t.minValue?t.minValue:n.defaultMinValue,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.rate=null!=t.rate?t.rate:n.defaultRate,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return Zl(t,e),t.prototype.apply=function(e){var t=this;return Object(Kl.ee)((function(){var n=kc(e,t.axis),r=Object(Kl.u)(Object(Kl.xc)(uc(t.rate),Object(Kl.Q)(n,t.minValue,t.maxValue)),Object(Kl.xc)(uc(1-t.rate),n));return Object(Kl.xc)(e,Object(Kl.kb)(r,Object(Kl.u)(uc(tc()),n)))}))},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(Tc);Kl.rd.registerClass(Rc);var Mc={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function jc(e){return _c(e)}function Lc(e,t){return void 0===t&&(t={}),Nc(e,Kl.rd.SerializationMap.getMap().classNameMap,t,"constraint")}function Vc(e){return null==e?null:"string"==typeof e?Lc({className:e in Mc?Mc[e]:e,config:{}}):e instanceof Tc?e:Lc(e)}var Fc=Object.freeze({maxNorm:function(e){return new Ac(e)},unitNorm:function(e){return new Pc(e)},nonNeg:function(){return new Dc},minMaxNorm:function(e){return new Rc(e)}}),zc=new Map,Bc=["channelsFirst","channelsLast"];function Uc(e){Oc(Bc,"DataFormat",e)}var Wc=["valid","same","causal"];function $c(e){Oc(Wc,"PaddingMode",e)}var qc=["max","avg"],Hc=[],Gc="/";function Kc(e,t){Hc.push(e);try{var n=t();return Hc.pop(),n}catch(e){throw Hc.pop(),e}}function Xc(e){if(!Jc(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Hc.length?"":Hc.join(Gc)+Gc)+e}function Zc(e){if(!Jc(e))throw new Error("Not a valid tensor name: '"+e+"'");zc.has(e)||zc.set(e,0);var t=zc.get(e);if(zc.set(e,zc.get(e)+1),t>0){var n=e+"_"+t;return zc.set(n,1),n}return e}var Qc=new RegExp(/^[A-Za-z][-A-Za-z0-9\._\/]*$/);function Jc(e){return!!e.match(Qc)}function Yc(e){return e===parseInt(e.toString(),10)}function eh(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,o=t;o<n;++o)r*=e[o];return r}function th(e){return e=Array.isArray(e)?new Float32Array(e):e,Object(Kl.Xd)(e)}function nh(e){return Object(Kl.qc)(th(e)).dataSync()[0]}function rh(e){return Object(Kl.kc)(th(e)).dataSync()[0]}function oh(e,t){if(t<e)throw new hc("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function ih(e,t){return e.asType(t)}function ah(e,t){void 0===t&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function sh(e,t,n){return Object(Kl.ee)((function(){switch(e.rank){case 1:return Object(Kl.zd)(e,t,n);case 2:return Object(Kl.Ad)(e,[t,0],[n,e.shape[1]]);case 3:return Object(Kl.Bd)(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Object(Kl.Cd)(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);default:throw new hc("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}))}function uh(e,t,n){return Object(Kl.ee)((function(){switch(e.rank){case 1:return Object(Kl.zd)(e,t,n);case 2:return Object(Kl.Ad)(e,[0,t],[e.shape[0],n]);case 3:return Object(Kl.Bd)(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Object(Kl.Cd)(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new hc("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))}function lh(e,t,n,r){return Object(Kl.ee)((function(){switch(e.rank){case 1:return Object(Kl.zd)(e,t,n);case 2:switch(r){case 1:return sh(e,t,n);case 2:return uh(e,t,n);default:throw new hc("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return sh(e,t,n);case 2:return Object(Kl.Bd)(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return uh(e,t,n);default:throw new hc("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return sh(e,t,n);case 2:return Object(Kl.Cd)(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Object(Kl.Cd)(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return uh(e,t,n);default:throw new hc("The axis is not within the rank of the tensor "+r)}default:throw new hc("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))}function ch(e,t){var n;return void 0===t&&(t=-1),t<0&&(t=0!==(n=e[0].rank)?n:0),t===e[0].rank&&(t=-1),Object(Kl.T)(e,t)}function hh(e,t){switch(e.rank){case 1:return Object(Kl.U)([e,t]);case 2:return Object(Kl.V)([e,t],0);case 3:return Object(Kl.W)([e,t],0);case 4:return Object(Kl.X)([e,t],0);default:throw new hc("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function ph(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new hc("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return Object(Kl.fe)(e,t)}function dh(e,t,n,r,o){return void 0===t&&(t=0),void 0===n&&(n=1),Object(Kl.Yc)(e,t,n,r,o)}function fh(e,t){if(e.rank<2||t.rank<2)throw new pc("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&(r=e.shape.slice(-1)[0])!==(a=t.shape.slice(-2)[0]))throw new pc("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(2===e.rank&&2===t.rank)return Object(Kl.ic)(e,t);var n=e.shape.slice(),r=n.pop();e=e.reshape([-1,r]);var o=t.shape.slice(),i=o.pop(),a=o.pop(),s=o.concat([i]),u=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(u).reshape([a,-1]);var l=n.concat(s);return Object(Kl.ic)(e,t).reshape(l)}function mh(e,t,n){return Object(Kl.ee)((function(){return t=Array.isArray(t)?Object(Kl.Xd)(t,"int32"):t.toInt(),Object(Kl.Bb)(e,t,n)}))}function gh(e){return Object(Kl.yc)(e,e)}function yh(e,t,n){return Object(Kl.ee)((function(){if(null==n&&(n="channelsLast"),Uc(n),1!==t.rank&&t.rank!==e.rank)throw new hc("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e.rank);var r,o=t.shape;if(5===e.rank)"channelsFirst"===n?r=e.add(t.reshape(1===o.length?[1,o[0],1,1,1]:[1,o[3],o[0],o[1],o[2]])):"channelsLast"===n&&(r=e.add(t.reshape(1===o.length?[1,1,1,1,o[0]]:[1].concat(o))));else if(4===e.rank)"channelsFirst"===n?r=e.add(t.reshape(1===o.length?[1,o[0],1,1]:[1,o[2],o[0],o[1]])):"channelsLast"===n&&(r=e.add(t.reshape(1===o.length?[1,1,1,o[0]]:[1].concat(o))));else if(3===e.rank)"channelsFirst"===n?r=e.add(t.reshape(1===o.length?[1,o[0],1]:[1,o[1],o[0]])):"channelsLast"===n&&(r=e.add(t.reshape(1===o.length?[1,1,o[0]]:[1].concat(o))));else{if(!(e.rank<3))throw new hc("Unsupported input rank by biasAdd: "+e.rank);r=e.add(t)}return r}))}function vh(e,t,n,r){return Object(Kl.ee)((function(){if(null!=n&&!Kl.oe.arraysEqual(e.shape,n))throw new pc("Non-default noise shape is not implemented yet: "+JSON.stringify(n));if(null!=r)throw new pc("seed is not implemented for dropout yet.");var o=Object(Kl.Pd)(Object(Kl.u)(Object(Kl.Bc)(t),Object(Kl.Zc)(e.shape,0,1,"float32")));return o=Object(Kl.xc)(Object(Kl.kb)(uc(1),Object(Kl.Rd)(uc(1),t)),o),Object(Kl.xc)(e,o)}))}function bh(e,t,n){return void 0===n&&(n=!1),n?e():t()}var wh=["fanIn","fanOut","fanAvg"],xh=["normal","uniform"],_h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(Kl.rd.Serializable),Nh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e,t){return Object(Kl.xe)(e,t)},t.className="Zeros",t}(_h);Kl.rd.registerClass(Nh);var Eh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e,t){return Object(Kl.Hc)(e,t)},t.className="Ones",t}(_h);Kl.rd.registerClass(Eh);var Ch=function(e){function t(t){var n=e.call(this)||this;if("object"!=typeof t)throw new hc("Expected argument of type ConstantConfig but got "+t);if(void 0===t.value)throw new hc("config must have value set but got "+t);return n.value=t.value,n}return Zl(t,e),t.prototype.apply=function(e,t){var n=this;return Object(Kl.ee)((function(){return Object(Kl.xc)(Object(Kl.nd)(n.value),Object(Kl.Hc)(e,t))}))},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(_h);Kl.rd.registerClass(Ch);var Ih=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=t.minval||n.DEFAULT_MINVAL,n.maxval=t.maxval||n.DEFAULT_MAXVAL,n.seed=t.seed,n}return Zl(t,e),t.prototype.apply=function(e,t){return Object(Kl.Zc)(e,this.minval,this.maxval,t)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(_h);Kl.rd.registerClass(Ih);var Oh=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return Zl(t,e),t.prototype.apply=function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new pc("randomNormal does not support dType "+t+".");return dh(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(_h);Kl.rd.registerClass(Oh);var Sh=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return Zl(t,e),t.prototype.apply=function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new pc("truncatedNormal does not support dType "+t+".");return Object(Kl.le)(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(_h);Kl.rd.registerClass(Sh);var kh=function(e){function t(t){var n=e.call(this)||this;return n.gain=null!=t.gain?Object(Kl.nd)(t.gain):uc(1),n}return Zl(t,e),t.prototype.apply=function(e,t){var n=this;return Object(Kl.ee)((function(){if(2!==e.length||e[0]!==e[1])throw new hc("Identity matrix initializer can only be used for 2D square matrices.");return Object(Kl.xc)(n.gain,Object(Kl.vb)(e[0]))}))},t.prototype.getConfig=function(){return{gain:this.gain.get()}},t.className="Identity",t}(_h);Kl.rd.registerClass(kh);var Th=function(e){function t(t){var n=e.call(this)||this;if(t.scale<0)throw new hc("scale must be a positive float. Got: "+t.scale);return n.scale=null==t.scale?1:t.scale,n.mode=t.mode,function(e){Oc(wh,"FanMode",e)}(n.mode),n.distribution=t.distribution,function(e){Oc(xh,"Distribution",e)}(n.distribution),n.seed=t.seed,n}return Zl(t,e),t.prototype.apply=function(e,t){var n=function(e,t){var n,r;if(void 0===t&&(t="channelsLast"),Uc(t),2===e.length)n=e[0],r=e[1];else if(-1!==[3,4,5].indexOf(e.length))if("channelsFirst"===t){var o=eh(e,2);n=e[1]*o,r=e[0]*o}else"channelsLast"===t&&(o=eh(e,0,e.length-2),n=e[e.length-2]*o,r=e[e.length-1]*o);else{var i=eh(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}(e),r=n[0],o=n[1],i=this.scale;if(i/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(r+o)/2),"normal"===this.distribution){var a=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new pc(this.getClassName()+" does not support dType "+t+".");return Object(Kl.le)(e,0,a,t,this.seed)}var s=Math.sqrt(3*i);return Object(Kl.Zc)(e,-s,s,t)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(_h);Kl.rd.registerClass(Th);var Ah=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})||this}return Zl(t,e),t.prototype.getClassName=function(){return Th.className},t.className="GlorotUniform",t}(Th);Kl.rd.registerClass(Ah);var Ph=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})||this}return Zl(t,e),t.prototype.getClassName=function(){return Th.className},t.className="GlorotNormal",t}(Th);Kl.rd.registerClass(Ph);var Dh=function(e){function t(t){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return Zl(t,e),t.prototype.getClassName=function(){return Th.className},t.className="HeNormal",t}(Th);Kl.rd.registerClass(Dh);var Rh=function(e){function t(t){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return Zl(t,e),t.prototype.getClassName=function(){return Th.className},t.className="LeCunNormal",t}(Th);Kl.rd.registerClass(Rh);var Mh=function(e){function t(t){var n=e.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==t.gain?n.DEFAULT_GAIN:t.gain,n.seed=t.seed,null!=n.seed)throw new pc("Random seed is not implemented for Orthogonal Initializer yet.");return n}return Zl(t,e),t.prototype.apply=function(e,t){var n=this;return Object(Kl.ee)((function(){if(2!==e.length)throw new pc("The Orthogonal Initializer does not support non-2D shapes yet.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+e[0]*e[1]+") elements: Slowness may result.");var t=dh(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=Kl.Vb.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Object(Kl.xc)(uc(n.gain),r)}))},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(_h);Kl.rd.registerClass(Mh);var jh={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",identity:"Identity",leCunNormal:"LeCunNormal",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Lh(e,t){return void 0===t&&(t={}),Nc(e,Kl.rd.SerializationMap.getMap().classNameMap,t,"initializer")}function Vh(e){return _c(e)}function Fh(e){if("string"==typeof e){var t=e in jh?jh[e]:e;return"GlorotUniform"===t?new Ah:"GlorotNormal"===t?new Ph:"HeNormal"===t?new Dh:"LeCunNormal"===t?new Rh:Lh({className:t,config:{}})}return e instanceof _h?e:Lh(e)}var zh=Object.freeze({zeros:function(){return new Nh},ones:function(){return new Eh},constant:function(e){return new Ch(e)},randomUniform:function(e){return new Ih(e)},randomNormal:function(e){return new Oh(e)},truncatedNormal:function(e){return new Sh(e)},identity:function(e){return new kh(e)},varianceScaling:function(e){return new Th(e)},glorotUniform:function(e){return new Ah(e)},glorotNormal:function(e){return new Ph(e)},heNormal:function(e){return new Dh(e)},leCunNormal:function(e){return new Rh(e)},orthogonal:function(e){return new Mh(e)}});function Bh(e){return Array.isArray(e)&&Array.isArray(e[0])}function Uh(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Wh(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new hc("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function $h(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new hc("Expected exactly 1 Shape; got "+e.length)}return e}function qh(e){for(var t=0,n=0,r=e;n<r.length;n++){var o=r[n];t+=0===o.shape.length?1:o.shape.reduce((function(e,t){return e*t}))}return t}var Hh="Variable",Gh=function(){function e(e,t,n,r,o){void 0===t&&(t="float32"),void 0===n&&(n=Hh),void 0===r&&(r=!0),void 0===o&&(o=null),this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=rc(),this.originalName=Xc(n=null==n?Hh:n),this.name=Zc(this.originalName),this.trainable=r,this.constraint=o,this.val=Object(Kl.re)(e,this.trainable,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},e}();function Kh(e){return e.map((function(e){return e.read()}))}function Xh(e){e.map((function(e){e[0].write(e[1])}))}var Zh,Qh,Jh=function(e){this.dtype=e.dtype,this.shape=e.shape,this.ndim=null!=e.shape?e.shape.length:e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}},Yh=function(e,t,n,r,o,i,a){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=rc(),null!=i&&(this.originalName=Xc(i),this.name=Zc(this.originalName)),this.rank=t.length},ep=0,tp=function(){function e(e,t){this.callArgs=t,this.id=ep++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var n=0,r=e.inboundLayers;n<r.length;n++){var o=r[n];null!=o&&o.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var e=[],t=0,n=this.inboundLayers;t<n.length;t++){var r=n[t];e.push(null!=r?r.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),np=0,rp=function(e){function t(t){var n=e.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=np++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=t.name;if(!r){var o=n.getClassName();r=bc(o)+"_"+ic(o)}if(n.name=r,n.trainable=null==t.trainable||t.trainable,n.updatable=null==t.updatable||t.updatable,null!=t.inputShape||null!=t.batchInputShape){var i=void 0;if(null!=t.batchInputShape)i=t.batchInputShape;else if(null!=t.inputShape){var a=null;null!=t.batchSize&&(a=t.batchSize),i=[a].concat(t.inputShape)}n.batchInputShape=i;var s=t.dtype;null==s&&(s=t.inputDType),null==s&&(s="float32"),n.dtype=s}return n.initialWeights=null!=t.weights?t.weights:null,n._refCount=null,n}return Zl(t,e),t.nodeKey=function(e,t){return e.name+"_ib-"+t.toString()},t.prototype.getNodeAtIndex=function(e,t){if(0===this.inboundNodes.length)throw new cc("The layer has never been called and thus has no defined "+t+".");if(this.inboundNodes.length<=e)throw new hc("Asked to get "+t+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},t.prototype.getInputAt=function(e){return yc(this.getNodeAtIndex(e,"input").inputTensors)},t.prototype.getOutputAt=function(e){return yc(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new lc("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new lc("Layer "+this.name+" is not connected, no input to return.");return yc(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new lc("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new lc("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return yc(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map((function(e){return e()}))},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this._trainableWeights:[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._nonTrainableWeights:this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(e){if(e=vc(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=vc(this.inputSpec);if(e.length!==t.length)throw new hc("Layer "+this.name+" expects "+t.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var n=0;n<e.length;n++){var r=e[n],o=t[n];if(null!=o){var i=r.rank;if(null!=o.ndim&&i!==o.ndim)throw new hc("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+i);if(null!=o.maxNDim&&i>o.maxNDim)throw new hc("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+i);if(null!=o.minNDim&&i<o.minNDim)throw new hc("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+i+".");if(null!=o.dtype&&r.dtype!==o.dtype)throw new hc("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+r.dtype+".");if(o.axes){var a=r.shape;for(var s in o.axes){var u=Number(s),l=o.axes[s];if(null!=l&&-1===[l,null].indexOf(u>=0?a[u]:a[a.length+u]))throw new hc("Input "+n+" is incompatible with layer "+this.name+": expected axis "+u+" of input shape to have value "+l+" but got shape "+a+".")}}if(null!=o.shape)for(var c=0;c<o.shape.length;++c){var h=o.shape[c],p=r.shape[c];if(null!=h&&null!=p&&h!==p)throw new hc("Input "+n+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape=${xShape}.")}}}}},t.prototype.call=function(e,t){return e},t.prototype.invokeCallHook=function(e,t){null!=this._callHook&&this._callHook(e,t)},t.prototype.setCallHook=function(e){this._callHook=e},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(e,t){var n=this;t=t||{},this.assertNotDisposed();for(var r=vc(e),o=!0,i=0,a=r;i<a.length;i++)if(!(a[i]instanceof Yh)){o=!1;break}for(var s=!0,u=0,l=r;u<l.length;u++)if(l[u]instanceof Yh){s=!1;break}if(o===s)throw new hc("Arguments to apply() must be all SymbolicTensors or all Tensors");return Kc(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);for(var o=[],i=0,a=vc(e);i<a.length;i++)o.push(a[i].shape);n.build(yc(o)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&s&&(n._refCount=1)}if(n.assertInputCompatibility(e),s){for(var u=[],l=0,c=vc(f=n.call(e,t));l<c.length;l++){var h=c[l];-1!==r.indexOf(h)&&(h=h.clone()),u.push(h)}if(f=yc(u),null!=n.activityRegularizer)throw new pc("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}var p=function(e){for(var t=[],n=0,r=e=vc(e);n<r.length;n++)t.push(r[n].shape);return yc(t)}(e),d=n.computeOutputShape(p),f=void 0,m="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?p[0]:p),f=null!=d&&d.length>0&&Array.isArray(d[0])?d.map((function(r,o){return new Yh(m,r,n,vc(e),t,n.name,o)})):new Yh(m,d,n,vc(e),t,n.name),n.addInboundNode(e,f,null,null,p,d,t),n._refCount++,null!=n.activityRegularizer)throw new pc("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}))},t.prototype.warnOnIncompatibleInputShape=function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(e)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor ("+JSON.stringify(e)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new lc("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var e=[],t=0,n=this.inboundNodes;t<n.length;t++){var r=JSON.stringify(n[t].outputShapes);-1===e.indexOf(r)&&e.push(r)}if(1===e.length){var o=this.inboundNodes[0].outputShapes;return Array.isArray(o)&&Array.isArray(o[0])&&1===o.length?o[0]:o}throw new lc("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new cc("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return qh(this.weights)},t.prototype.build=function(e){this.built=!0},t.prototype.getWeights=function(e){return void 0===e&&(e=!1),Kh(e?this.trainableWeights:this.weights)},t.prototype.setWeights=function(e){var t=this;Object(Kl.ee)((function(){var n=t.weights;if(n.length!==e.length)throw new hc('You called setWeights(weights) on layer "'+t.name+'" with a weight list of length '+e.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+e+"...");if(0!==n.length){for(var r=[],o=Kh(n),i=0;i<o.length;++i){var a=o[i],s=n[i],u=e[i];if(!Kl.oe.arraysEqual(a.shape,u.shape))throw new hc("Layer weight shape "+a.shape+" not compatible with provided weight shape "+u.shape);r.push([s,u])}Xh(r)}}))},t.prototype.addWeight=function(e,t,n,r,o,i,a){if(-1!==this._addedWeightNames.indexOf(e))throw new hc("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),null==n&&(n="float32");var s=new Gh(r.apply(t,n),n,e,i,a);return null!=o&&this.addLoss((function(){return o.apply(s.read())})),null==i&&(i=!0),i?this._trainableWeights.push(s):this._nonTrainableWeights.push(s),s},t.prototype.addLoss=function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=vc(e),null!=this._losses&&(t=this.losses).push.apply(t,e))},t.prototype.computeOutputShape=function(e){return e},t.prototype.computeMask=function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer "+n.name+" does not support masking,but was passed an inputMask.")}))}return null}return t},t.prototype.addInboundNode=function(e,t,n,r,o,i,a){void 0===a&&(a=null);var s=vc(e);t=vc(t),n=vc(n),r=vc(r),o=Uh(o),i=Uh(i);for(var u=[],l=[],c=[],h=0,p=s;h<p.length;h++){var d=p[h];u.push(d.sourceLayer),l.push(d.nodeIndex),c.push(d.tensorIndex)}new tp({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:o,outputShapes:i},a);for(var f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f},t.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e},t.prototype.disposeWeights=function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length},t.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}},t}(Kl.rd.Serializable),op=function(e){function t(t){var n=e.call(this,{dtype:t.dtype,name:null!=t.name?t.name:ic("input").toString()})||this;if(null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new hc("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=t.batchInputShape;if(null==r){if(null==t.inputShape)throw new hc("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new hc("Cannot specify batchSize if batchInputShape isspecified when creating an InputLayer.");var o=t.dtype||"float32";n.batchInputShape=r,n.dtype=o,n.inputSpec=[{shape:r}];var i=new Yh(n.dtype,n.batchInputShape,n,[],{},n.name);return i.nodeIndex=0,i.tensorIndex=0,new tp({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return Zl(t,e),t.prototype.apply=function(e,t){throw new hc("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(rp);function ip(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new hc("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new op({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function ap(e){return Jl(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u;return Yl(this,(function(l){switch(l.label){case 0:if(null==e)return[2];for(o in t=[],n=[],r=[],e)"number"!=typeof(i=e[o])&&(t.push((a=i).data()),n.push(o),r.push(a));return[4,Promise.all(t)];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];return Object(Kl.ib)(r),[2]}}))}))}function sp(e){if(null!=e)for(var t in e){var n=e[t];"number"!=typeof n&&n.dispose()}}Kl.rd.registerClass(op),(Qh=Zh||(Zh={}))[Qh.SILENT=0]="SILENT",Qh[Qh.VERBOSE=1]="VERBOSE";var up=function(){function e(){this.validationData=null}return e.prototype.setParams=function(e){this.params=e},e.prototype.onEpochBegin=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.onEpochEnd=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.onBatchBegin=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.onBatchEnd=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.onTrainBegin=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.onTrainEnd=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return[2]}))}))},e.prototype.setModel=function(e){},e}(),lp=function(){function e(e,t){void 0===t&&(t=10),null==e&&(e=[]),this.callbacks=e,this.queueLength=t}return e.prototype.append=function(e){this.callbacks.push(e)},e.prototype.setParams=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setParams(e)},e.prototype.setModel=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setModel(e)},e.prototype.onEpochBegin=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onEpochEnd=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchBegin=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchEnd=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:return null==t&&(t={}),[4,ap(t)];case 1:o.sent(),n=0,r=this.callbacks,o.label=2;case 2:return n<r.length?[4,r[n].onBatchEnd(e,t)]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2]}}))}))},e.prototype.onTrainBegin=function(e){return Jl(this,void 0,void 0,(function(){var t,n;return Yl(this,(function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainBegin(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onTrainEnd=function(e){return Jl(this,void 0,void 0,(function(){var t,n;return Yl(this,(function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainEnd(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e}(),cp=function(){function e(e){this.yieldEvery=e,this.batchCount=0,this.batchDurationsMillis=[],this.autoYieldEveryBatches=null,this.batchStartMillis=Kl.oe.now()}return e.prototype.resolveOneTensorInLogs=function(e){return Jl(this,void 0,void 0,(function(){var t,n,r,o;return Yl(this,(function(i){switch(i.label){case 0:for(n in t=[],e)t.push(n);r=0,i.label=1;case 1:return r<t.length?"number"==typeof(o=e[t[r]])?[3,3]:[4,o.data()]:[3,4];case 2:return i.sent(),[3,4];case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.maybeYieldOnBatch=function(t){return Jl(this,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:return"auto"!==this.yieldEvery?[3,7]:(this.batchCount++,null!=this.autoYieldEveryBatches?[3,3]:[4,this.resolveOneTensorInLogs(t)]);case 1:return o.sent(),n=Kl.oe.now(),[4,Object(Kl.Cc)()];case 2:return o.sent(),this.batchCount>e.SKIP_FIRST_BATCHES&&(this.batchDurationsMillis.push(n-this.batchStartMillis),this.batchDurationsMillis.length>=e.DECISION_BATCH_COUNT&&(r=this.batchDurationsMillis.reduce((function(e,t){return e+t}))/this.batchDurationsMillis.length,this.autoYieldEveryBatches=Math.round(e.THRESHOLD_MILLIS/r),this.autoYieldEveryBatches<1&&(this.autoYieldEveryBatches=1))),this.batchStartMillis=Kl.oe.now(),this.lastYieldBatchCount=this.batchCount,[3,6];case 3:return this.batchCount-this.lastYieldBatchCount>=this.autoYieldEveryBatches?[4,Object(Kl.Cc)()]:[3,6];case 4:return o.sent(),[4,this.resolveOneTensorInLogs(t)];case 5:o.sent(),this.lastYieldBatchCount=this.batchCount,o.label=6;case 6:return[3,9];case 7:return"batch"!==this.yieldEvery?[3,9]:[4,Object(Kl.Cc)()];case 8:o.sent(),o.label=9;case 9:return[2]}}))}))},e.prototype.maybeYieldOnEpoch=function(){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){switch(e.label){case 0:return"epoch"!==this.yieldEvery?[3,2]:[4,Object(Kl.Cc)()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.SKIP_FIRST_BATCHES=1,e.DECISION_BATCH_COUNT=2,e.THRESHOLD_MILLIS=16,e}(),hp=function(e){function t(t){var n=e.call(this)||this;return n.yieldEvery=t||"auto",n}return Zl(t,e),t.prototype.onTrainBegin=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return this.autoYielder=new cp(this.yieldEvery),[2]}))}))},t.prototype.onEpochBegin=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return this.seen=0,this.totals={},[2]}))}))},t.prototype.onBatchEnd=function(e,t){return Jl(this,void 0,void 0,(function(){var e,n,r,o,i=this;return Yl(this,(function(a){switch(a.label){case 0:return[4,this.autoYielder.maybeYieldOnBatch(t)];case 1:for(o in a.sent(),null==t&&(t={}),this.seen+=e=null==t.size?0:t.size,n=function(n){var o=t[n];if("number"==typeof o)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+o*e;else{var a=void 0;n in r.totals?a=r.totals[n]:r.totals[n]=uc(0),r.totals[n]=Object(Kl.ee)((function(){return Object(Kl.u)(i.totals[n],Object(Kl.xc)(o,uc(e)))})),null!=a&&a.dispose()}},r=this,t)n(o);return[2]}}))}))},t.prototype.onEpochEnd=function(e,t){return Jl(this,void 0,void 0,(function(){var e,n,r,o,i=this;return Yl(this,(function(a){switch(a.label){case 0:return[4,this.autoYielder.maybeYieldOnEpoch()];case 1:if(a.sent(),null!=t)for(e=function(e){if(null==n.totals[e])return"continue";"number"==typeof n.totals[e]?t[e]=n.totals[e]/n.seen:Object(Kl.ee)((function(){t[e]=Object(Kl.xc)(Object(Kl.kb)(uc(1),uc(i.seen)),i.totals[e]),i.totals[e].dispose(),Object(Kl.Pb)(t[e])}))},n=this,r=0,o=this.params.metrics;r<o.length;r++)e(o[r]);return[2]}}))}))},t}(up),pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.onTrainBegin=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(e){return this.epoch=[],this.history={},[2]}))}))},t.prototype.onEpochEnd=function(e,t){return Jl(this,void 0,void 0,(function(){var n;return Yl(this,(function(r){for(n in null==t&&(t={}),this.epoch.push(e),t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n]);return[2]}))}))},t.prototype.syncData=function(){return Jl(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return Yl(this,(function(u){switch(u.label){case 0:for(r in e=[],t=[],n=[],this.history)for(o=this.history[r],i=0;i<o.length;++i)"number"!=typeof o[i]&&(e.push(o[i].data()),t.push(r),n.push(i));return[4,Promise.all(e)];case 1:for(a=u.sent(),s=0;s<a.length;++s)this.history[t[s]][n[s]].dispose(),this.history[t[s]][n[s]]=a[s][0];return[2]}}))}))},t}(up),dp=function(e){function t(t){var n=e.call(this)||this;return n.trainBegin=t.onTrainBegin,n.trainEnd=t.onTrainEnd,n.epochBegin=t.onEpochBegin,n.epochEnd=t.onEpochEnd,n.batchBegin=t.onBatchBegin,n.batchEnd=t.onBatchEnd,n}return Zl(t,e),t.prototype.onEpochBegin=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){switch(n.label){case 0:return null==this.epochBegin?[3,3]:[4,ap(t)];case 1:return n.sent(),[4,this.epochBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onEpochEnd=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){switch(n.label){case 0:return null==this.epochEnd?[3,3]:[4,ap(t)];case 1:return n.sent(),[4,this.epochEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onBatchBegin=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,ap(t)];case 1:return n.sent(),[4,this.batchBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onBatchEnd=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){switch(n.label){case 0:return null==this.batchEnd?[3,3]:[4,ap(t)];case 1:return n.sent(),[4,this.batchEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onTrainBegin=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(t){switch(t.label){case 0:return null==this.trainBegin?[3,3]:[4,ap(e)];case 1:return t.sent(),[4,this.trainBegin(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.onTrainEnd=function(e){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(t){switch(t.label){case 0:return null==this.trainEnd?[3,3]:[4,ap(e)];case 1:return t.sent(),[4,this.trainEnd(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t}(up);function fp(e){return null==e?null:e instanceof up?[e]:Array.isArray(e)&&e[0]instanceof up?e:vc(e).map((function(e){return new dp(e)}))}var mp=function(){function e(){}return e.registerCallbackConstructor=function(t,n){Kl.oe.assert(t>=0&&Number.isInteger(t),"Verbosity level is expected to be an integer >= 0, but got "+t),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach((function(e){if(e===t)throw new hc("Duplicate callback constructor.")}))},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var o=+r;t>=o&&n.push.apply(n,e.constructors[o])}return n.map((function(e){return new e}))},e.constructors={},e}();function gp(e,t,n,r,o,i,a,s,u,l){var c=new pp,h=[new hp(t)].concat(mp.createCallbacks(n));null!=e&&h.push.apply(h,e),h.push(c);var p=new lp(h);return p.setParams({epochs:r,initialEpoch:o,samples:i,steps:a,batchSize:s,verbose:n,doValidation:u,metrics:l}),{callbackList:p,history:c}}function yp(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.Td)(gh(e),t,!0),r=Object(Kl.xc)(Object(Kl.nd)(tc()),Object(Kl.Ic)(e)),o=Object(Kl.Jd)(Object(Kl.mc)(n,r));return Object(Kl.kb)(e,o)}))}function vp(e,t){return Object(Kl.ee)((function(){return Object(Kl.oc)(gh(Object(Kl.Rd)(t,e)),-1)}))}function bp(e,t){return Object(Kl.ee)((function(){return Object(Kl.oc)(Object(Kl.r)(Object(Kl.Rd)(t,e)),-1)}))}function wp(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.Rd)(e,t),r=Object(Kl.Q)(Object(Kl.r)(e),tc(),Number.MAX_VALUE),o=Object(Kl.r)(Object(Kl.kb)(n,r));return Object(Kl.xc)(uc(100),Object(Kl.oc)(o,-1))}))}function xp(e,t){return Object(Kl.ee)((function(){var n=uc(1),r=Object(Kl.Q)(t,tc(),Number.MAX_VALUE),o=Object(Kl.Yb)(Object(Kl.u)(n,r)),i=Object(Kl.Q)(e,tc(),Number.MAX_VALUE),a=Object(Kl.Yb)(Object(Kl.u)(n,i));return Object(Kl.oc)(gh(Object(Kl.Rd)(o,a)),-1)}))}function _p(e,t){return Object(Kl.ee)((function(){var n=uc(0),r=uc(1),o=Object(Kl.mc)(n,Object(Kl.Rd)(r,Object(Kl.xc)(e,t)));return Object(Kl.oc)(gh(o),-1)}))}function Np(e,t){return Object(Kl.ee)((function(){var n=uc(0),r=uc(1),o=Object(Kl.mc)(n,Object(Kl.Rd)(r,Object(Kl.xc)(e,t)));return Object(Kl.oc)(o,-1)}))}function Ep(e,t){return Object(Kl.ee)((function(){var n=uc(0),r=uc(1),o=Object(Kl.Td)(Object(Kl.xc)(e,t),-1),i=Object(Kl.kc)(Object(Kl.xc)(Object(Kl.Rd)(r,e),t),-1);return Object(Kl.mc)(n,Object(Kl.u)(r,Object(Kl.Rd)(i,o)))}))}function Cp(e,t){return Object(Kl.ee)((function(){var n=uc(Math.log(2)),r=Object(Kl.Rd)(t,e),o=Object(Kl.Rd)(Object(Kl.u)(r,Object(Kl.Ed)(Object(Kl.xc)(uc(-2),r))),n);return Object(Kl.oc)(o,-1)}))}function Ip(e,t,n){return void 0===n&&(n=!1),Object(Kl.ee)((function(){if(n)t=Object(Kl.Dd)(t);else{var r=Object(Kl.Td)(t,t.shape.length-1,!0);t=Object(Kl.kb)(t,r)}return t=Object(Kl.Q)(t,tc(),1-tc()),Object(Kl.Bc)(Object(Kl.Td)(Object(Kl.xc)(e.toFloat(),Object(Kl.Yb)(t)),t.shape.length-1))}))}function Op(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.yb)(function(e){var t=[eh(e.shape)];return e.reshape(t)}(e)).toInt(),r=(t=Object(Kl.Q)(t,tc(),1-tc())).shape;return Ip(Object(Kl.Gc)(n,r[r.length-1]).reshape(r),t,!1)}))}function Sp(e,t){return Object(Kl.ee)((function(){var n;return n=Object(Kl.Q)(t,tc(),1-tc()),n=Object(Kl.Yb)(Object(Kl.kb)(n,Object(Kl.Rd)(uc(1),n))),Object(Kl.oc)(function(e,t){if(!Kl.oe.arraysEqual(e.shape,t.shape))throw new hc("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return Object(Kl.ee)((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function kp(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.Q)(e,tc(),1),r=Object(Kl.Q)(t,tc(),1);return Object(Kl.Td)(Object(Kl.xc)(e,Object(Kl.Yb)(Object(Kl.kb)(n,r))),-1)}))}function Tp(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.Yb)(Object(Kl.u)(uc(tc()),t));return Object(Kl.oc)(Object(Kl.Rd)(t,Object(Kl.xc)(e,n)),-1)}))}function Ap(e,t){return Object(Kl.ee)((function(){var n=yp(e,-1),r=yp(t,-1),o=Object(Kl.xc)(n,r);return Object(Kl.Bc)(Object(Kl.Td)(o,-1))}))}function Pp(e){var t={meanSquaredError:vp,meanAbsoluteError:bp,meanAbsolutePercentageError:wp,meanSquaredLogarithmicError:xp,squaredHinge:_p,hinge:Np,categoricalHinge:Ep,logcosh:Cp,categoricalCrossentropy:Ip,sparseCategoricalCrossentropy:Op,binaryCrossentropy:Sp,kullbackLeiblerDivergence:kp,poisson:Tp,cosineProximity:Ap};if("string"==typeof e){if(e in t)return t[e];var n="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(n="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new hc(n)}return e}function Dp(e,t){return Object(Kl.ee)((function(){var n=Object(Kl.xc)(uc(.5),Object(Kl.Ic)(t)),r=ih(Object(Kl.Gb)(t,n),e.dtype);return Object(Kl.oc)(Object(Kl.pb)(e,r),-1)}))}function Rp(e,t){return Object(Kl.ee)((function(){return ih(Object(Kl.pb)(Object(Kl.z)(e,-1),Object(Kl.z)(t,-1)),"float32")}))}function Mp(e,t){return Object(Kl.ee)((function(){var n=uc(1);return Object(Kl.dc)(e.equal(n),t.equal(n)).sum().cast("float32")}))}function jp(e,t){return Object(Kl.ee)((function(){var n=uc(0),r=Mp(e,t),o=function(e,t){return Object(Kl.ee)((function(){var n=uc(1),r=uc(0);return Object(Kl.dc)(e.equal(r),t.equal(n)).sum().cast("float32")}))}(e,t),i=r.add(o);return Object(Kl.ve)(Object(Kl.Gb)(i,n),r.div(i),n).cast("float32")}))}function Lp(e,t){return Sp(e,t)}function Vp(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),Object(Kl.pb)(e,t).asType("float32")}var Fp=vp,zp=vp,Bp=bp,Up=bp,Wp=wp,$p=wp,qp=Ip,Hp=Ap,Gp=Op;function Kp(e,t,n){void 0===n&&(n=console.log);for(var r="",o=0;o<e.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[o]).slice(0,t[o]),r+=" ".repeat(t[o]-r.length);n(r)}function Xp(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(e){r="multiple"}Kp([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function Zp(e,t,n,r){var o;try{o=JSON.stringify(e.outputShape)}catch(e){o="multiple"}for(var i=[],a=0,s=e.inboundNodes;a<s.length;a++){var u=s[a];if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var l=0;l<u.inboundLayers.length;++l)i.push(u.inboundLayers[l].name+"["+u.nodeIndices[l]+"]["+u.tensorIndices[l]+"]")}var c=e.name,h=e.getClassName(),p=0===i.length?"":i[0];for(Kp([c+" ("+h+")",o,e.countParams().toString(),p],t,r),l=1;l<i.length;++l)Kp(["","","",i[l]],t,r)}function Qp(e,t){return void 0===t&&(t={}),Nc(e,Kl.rd.SerializationMap.getMap().classNameMap,t,"layer")}function Jp(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function Yp(e,t){if(null===e)return null;if("string"==typeof e)return wc(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,o=0;o<r;++o){var i=e[o];Jp(t,o,i)?n.push(i):n.push(Yp(i,t))}return n}for(var a={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if("name"===l&&"string"==typeof c)a[l]=c;else{var h=wc(l);a[h]=Yp(c,h)}}return a}var ed="0.9.0";function td(e,t,n,r){if(!n.startsWith("2."))throw new hc("Unsupported Keras version in weights being loaded: "+n);return t}function nd(e,t,n){var r=function(e){switch(e){case"float32":return"float32";default:throw new hc("Invalid dtype: "+e)}}(e);return Kl.o.make(t,{values:0===t.length?n:Kl.oe.flatten(n)},r)}var rd=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var o=r.getClassName().toLowerCase();r.name=ic(o)}if(r.supportsMasking=!1,r.trainable=!0,r.updatable=!0,r.inputs=Array.isArray(n.inputs)?n.inputs.slice():[n.inputs],r.outputs=Array.isArray(n.outputs)?n.outputs.slice():[n.outputs],Cc(r.inputs).length!==r.inputs.length)throw new hc("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(e){return e.name})));Cc(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(e){return e.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[];for(var i=0,a=r.outputs;i<a.length;i++){var s=(I=a[i]).sourceLayer,u=I.nodeIndex,l=I.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,h=r.inputs;c<h.length;c++)s=(I=h[c]).sourceLayer,l=I.tensorIndex,mc(0===(u=I.nodeIndex),"input layer has >1 nodes"),mc(0===l,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var p=0;p<r.inputLayers.length;p++){if(!((s=r.inputLayers[p])instanceof op))throw new TypeError("Input layers to a Model must be InputLayer objects. Received inputs: "+n.inputs+". Input "+p+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var d=0,f=r.outputLayers;d<f.length;d++)r.outputNames.push((s=f[d]).name);r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));for(var m={},g={},y={},v={},b={},w=[],x=function(e,n,o,i,a,s){null!=i&&null!=a&&null!=s||(i=e.sourceLayer,a=e.nodeIndex,s=e.tensorIndex);var u=i.inboundNodes[a];if(-1!==o.indexOf(u))throw new cc("The tensor "+e.name+' at layer "'+i.name+'" is part of a cycle.');if(-1===n.indexOf(u)){r.containerNodes.add(t.nodeKey(i,a)),i.id in b||(b[i.id]=Object.keys(b).length),-1===o.indexOf(u)&&o.push(u);for(var l=u.inboundLayers.length,c=0;c<l;c++)x(u.inputTensors[c],n,o,u.inboundLayers[c],u.nodeIndices[c],u.tensorIndices[c]);for(n.push(u);o.indexOf(u)>=0;)o.splice(o.indexOf(u),1);w.push(u)}},_=[],N=[],E=0,C=r.outputs;E<C.length;E++){var I=C[E];x(I,_,N)}for(var O=0,S=w.slice().reverse();O<S.length;O++){g[(G=S[O]).id]=G,G.id in m||(m[G.id]=0);var k=m[G.id];for(k=Math.max(k,null==y[G.outboundLayer.id]?0:y[G.outboundLayer.id]),y[G.outboundLayer.id]=k,v[G.outboundLayer.id]=G.outboundLayer,m[G.id]=k,p=0;p<G.inboundLayers.length;p++){var T=G.inboundLayers[p].inboundNodes[u=G.nodeIndices[p]];m[T.id]=Math.max(k+1,null==m[T.id]?0:m[T.id]),g[T.id]=T}}var A={};for(var P in m)(k=m[P])in A||(A[k]=[]),A[k].push(g[P]);var D={};for(var R in y)(k=y[R])in D||(D[k]=[]),D[k].push(v[R]);var M=Object.keys(D).map((function(e){return parseInt(e,10)})).sort(Ec);r.layers=[];for(var j=0,L=M;j<L.length;j++){var V=D[k=L[j]];V.sort((function(e,t){var n=b[e.id],r=b[t.id];return n<r?-1:n>r?1:0}));for(var F=0,z=V;F<z.length;F++)r.layers.push(s=z[F])}r.layersByDepth=D,M=Object.keys(A).map((function(e){return parseInt(e,10)})).sort(Ec);for(var B=r.inputs.slice(),U=[],W=0,$=M;W<$.length;W++)for(var q=0,H=A[k=$[W]];q<H.length;q++){var G;if(null!=(s=(G=H[q]).outboundLayer)){for(var K=0,X=G.inputTensors;K<X.length;K++)if(-1===B.indexOf(I=X[K]))throw new cc("Graph disconnected: cannot obtain value for tensor "+I+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+U);for(var Z=0,Q=G.outputTensors;Z<Q.length;Z++)B.push(I=Q[Z]);U.push(s.name)}}r.nodesByDepth=A;for(var J=r.layers.map((function(e){return e.name})),Y=function(e){var t=J.filter((function(t){return t===e})).length;if(1!==t)throw new cc('The name "'+e+'" is used '+t+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(J))},ee=0,te=J;ee<te.length;ee++)Y(te[ee]);return r.outboundNodes=[],r.inboundNodes=[],new tp({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return Zl(t,e),t.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount)for(var t=0,n=this.layers;t<n.length;t++)e.numDisposedVariables+=n[t].dispose().numDisposedVariables;return e.refCountAfterDispose=this._refCount,e},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new hc("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var e=[],t=0,n=this.layers;t<n.length;t++)e=e.concat(n[t].trainableWeights);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e.push.apply(e,r.nonTrainableWeights)}if(!this.trainable){for(var o=[],i=0,a=this.layers;i<a.length;i++)o.push.apply(o,(r=a[i]).trainableWeights);return o.concat(e)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!0),n?function(e,t,n){void 0===n&&(n=!0);for(var r={},o=0,i=0,a=t;i<a.length;i++)for(var s=0,u=a[i].weights;s<u.length;s++){var l=u[s];if(null!=r[l.originalName])throw new hc("Duplicate weight name: "+l.originalName);r[l.originalName]=l,o++}var c=[];for(var h in e){if(null!=r[h])c.push([r[h],e[h]]);else if(n)throw new hc("Provided weight data has no target variable: "+h);delete r[h]}if(n){var p=[];for(var d in r)p.push(d);if(p.length>0)throw new hc(p.length+" of "+o+" weights are not set: "+p)}Xh(c)}(e,this.layers,r):function(e,t,n){void 0===n&&(n=!1);for(var r=e.keras_version,o=t.map((function(e){return e.name})),i={},a=0,s=t;a<s.length;a++)null!=(v=s[a]).name&&(null==i[v.name]&&(i[v.name]=[]),i[v.name].push(v));for(var u=e.weights,l=[],c=0;c<o.length;++c){var h=o[c],p=u[h];null==p&&(p=[]);for(var d=[],f=0;f<p.length;++f){var m=p[f];d.push(new Gh(nd(m.dtype,m.shape,m.value)))}for(var g=0,y=i[h];g<y.length;g++){var v,b=(v=y[g]).weights;if((d=td(0,d,r)).length!==b.length){if(!n)throw new hc("Layer #"+c+' (named "'+v.name+'") expects '+b.length+" weight(s), but the saved weights have "+d.length+" element(s).");console.warn("Skipping loading of weights of layer "+v.name+" due to mismatch in number of weights: ("+d.length+" vs "+b.length+").")}for(var w=0;w<d.length;++w)!n||Kl.oe.arraysEqual(b[w].shape,d[w].shape)?l.push([b[w],d[w].read()]):console.warn("Skipping loading of weights for layer "+v.name+" due to mismatch in shape ("+b[w].shape+" vs "+d[w].shape+")")}}Xh(l)}(e,this.layers,t)},t.prototype.updatedConfig=function(){var e=this.getConfig();return{className:this.getClassName(),config:e,kerasVersion:"tfjs-layers "+ed,backend:"TensorFlow.js"}},t.prototype.toJSON=function(e,t){void 0===t&&(t=!0);var n=function e(t,n){if(null==t)return null;if("string"==typeof t)return bc(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],o=t.length,i=0;i<o;++i){var a=t[i];Jp(n,i,a)?r.push(a):r.push(e(a,n))}return r}for(var s={},u=0,l=Object.keys(t);u<l.length;u++){var c=l[u],h=t[c];s[bc(c)]="name"!==c&&"className"!==c||"string"!=typeof h?e(h,c):h}return s}(this.updatedConfig());return t?JSON.stringify(n):n},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var r;return e=vc(e),r="mask"in t?vc(t.mask):fc(null,e.length),n.runInternalGraph(e,r)[0]}))},t.prototype.computeMask=function(e,t){var n=this;return Object(Kl.ee)((function(){var r;return e=vc(e),r=null==t?fc(null,e.length):vc(t),n.runInternalGraph(e,r)[1]}))},t.prototype.computeOutputShape=function(e){var t=Uh(e);if(t.length!==this.inputLayers.length)throw new hc("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},r=0;r<t.length;r++){var o=this.inputLayers[r];n[b=o.name+"_0_0"]=t[r]}var i=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Ec);if(i.length>1)for(var a=0,s=i;a<s.length;a++)for(var u=0,l=this.nodesByDepth[s[a]];u<l.length;u++){var c=l[u];if(o=c.outboundLayer,-1===this.inputLayers.map((function(e){return e.id})).indexOf(o.id)){for(var h=[],p=0;p<c.inboundLayers.length;p++){var d=c.tensorIndices[p],f=n[b=c.inboundLayers[p].name+"_"+c.nodeIndices[p]+"_"+d];h.push(f)}var m=Uh(o.computeOutputShape(yc(h))),g=o.inboundNodes.indexOf(c);for(p=0;p<m.length;p++)n[b=o.name+"_"+g+"_"+p]=m[p]}}var y=[],v=[];for(r=0;r<this.outputLayers.length;r++){var b=(o=this.outputLayers[r]).name+"_"+(g=this.outputLayersNodeIndices[r])+"_"+(d=this.outputLayersTensorIndices[r]);v.push(b)}for(r=0;r<v.length;r++){var w=v[r];mc(w in n),y.push(n[w])}return yc(y)},t.prototype.runInternalGraph=function(e,t){null==t&&(t=fc(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var o=this.inputs[r],i=e[r],a=t[r];n[o.id]=[i,a]}for(var s=0,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Ec);s<u.length;s++)for(var l=0,c=this.nodesByDepth[u[s]];l<c.length;l++){for(var h=c[l],p=h.outboundLayer,d=h.inputTensors,f=h.outputTensors,m=new Array,g=0,y=d;g<y.length;g++)(o=y[g]).id in n&&m.push(n[o.id]);if(m.length===d.length){var v={},b=void 0,w=void 0,x=void 0,_=void 0;if(null!=h.callArgs&&(v=h.callArgs),1===m.length){var N=m[0],E=N[0],C=N[1];null==v.mask&&(v.mask=C),x=vc(p.call(E,v)),_=vc(p.computeMask(E,C)),b=[E],w=[C]}else b=m.map((function(e){return e[0]})),w=m.map((function(e){return e[1]})),null==v.mask&&(v.mask=w),x=vc(p.call(b,v)),_=vc(p.computeMask(b,w));if(p.activityRegularizer)throw new pc("Model invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<f.length;++r)n[(o=f[r]).id]=[i=x[r],a=_[r]]}}for(var I=[],O=[],S=[],k=0,T=this.outputs;k<T.length;k++){mc((o=T[k]).id in n,"Could not compute output "+o.name+" : "+o.id);var A=n[o.id],P=A[0];a=A[1],S.push(P.shape),I.push(P),O.push(a)}return[I,O,S]},t.prototype.buildNodeConversionMap=function(e){for(var n,r={},o=0,i=this.layers;o<i.length;o++){var a=i[o];n=a instanceof t?1:0;for(var s=0;s<a.inboundNodes.length;s++){var u=t.nodeKey(a,s);this.containerNodes.has(u)&&(r[u]=n,n+=1)}}return r},t.prototype.getLayer=function(e,t){if(null!=t){if(this.layers.length<=t)throw new hc("Was asked to retrieve layer at index "+t+", but model only has "+this.layers.length+" layer(s).");return this.layers[t]}if(null==e)throw new hc("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var o=r[n];if(o.name===e)return o}throw new hc("No such layer: "+e)},t.prototype.calculateLosses=function(){var e=this;return Object(Kl.ee)((function(){for(var n=[],r=0,o=e.layers;r<o.length;r++)for(var i=o[r],a=0;a<i.inboundNodes.length;++a){var s=t.nodeKey(i,a);e.containerNodes.has(s)&&n.push.apply(n,i.calculateLosses())}return n}))},t.prototype.getConfig=function(){for(var e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],o=0,i=this.layers;o<i.length;o++){for(var a=(b=i[o]).getClassName(),s=b.getConfig(),u=[],l=0;l<b.inboundNodes.length;l++){var c=b.inboundNodes[l],h=t.nodeKey(b,l),p={};if(this.containerNodes.has(h)){if(c.callArgs)try{JSON.stringify(c.callArgs),p=c.callArgs}catch(e){console.warn("Layer "+b.name+" was passed non-serializable keyword arguments: "+c.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),p={}}if(c.inboundLayers.length>0){for(var d=[],f=0;f<c.inboundLayers.length;f++){var m=c.inboundLayers[f],g=c.nodeIndices[f],y=c.tensorIndices[f];null==(x=n[t.nodeKey(m,g)])&&(x=0),d.push([m.name,x,y,p])}u.push(d)}}}r.push({name:b.name,className:a,config:s,inboundNodes:u})}e.layers=r;var v=[];for(f=0;f<this.inputLayers.length;f++){var b=this.inputLayers[f];h=t.nodeKey(b,g=this.inputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(x=n[h])&&void 0!==x||(x=0),v.push([b.name,x,y=this.inputLayersTensorIndices[f]]))}e.inputLayers=v;var w=[];for(f=0;f<this.outputLayers.length;f++){var x;h=t.nodeKey(b=this.outputLayers[f],g=this.outputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(x=n[h])&&void 0!==x||(x=0),w.push([b.name,x,y=this.outputLayersTensorIndices[f]]))}return e.outputLayers=w,e},t.fromConfig=function(e,t){var n={},r={};function o(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}function i(e,t){for(var r,i=[],a=0,s=t;a<s.length;a++){var u=s[a],l=u[0],c=u[1],h=u[2];if(3===u.length)r={};else{if(4!==u.length)throw new hc("Improperly formatted model config for layer "+JSON.stringify(e)+": "+JSON.stringify(u));r=u[3]}if(!(l in n))return void o(e,t);var p=n[l];if(p.inboundNodes.length<=c)return void o(e,t);i.push(p.inboundNodes[c].outputTensors[h])}i.length>0&&e.apply(yc(i),r)}function a(e){var r=e.name,i=Qp(e,null!=t.customObjects?t.customObjects:{});n[r]=i;for(var a=0,s=e.inboundNodes;a<s.length;a++){var u=s[a];if(!(u instanceof Array))throw new hc("Corrupted configuration, expected array for nodeData: "+u);o(i,u)}}for(var s=t.name,u=t.layers,l=0,c=u;l<c.length;l++)a(d=c[l]);for(;!Ic(r);)for(var h=0,p=u;h<p.length;h++){var d=p[h];if((O=n[d.name]).name in r){var f=r[O.name];delete r[O.name];for(var m=0,g=f;m<g.length;m++)i(O,g[m])}}for(var y=[],v=[],b=0,w=t.inputLayers;b<w.length;b++){var x=(d=w[b])[0],_=d[1],N=d[2];mc(x in n);var E=(O=n[x]).inboundNodes[_].outputTensors;y.push(E[N])}for(var C=0,I=t.outputLayers;C<I.length;C++){var O;x=(d=I[C])[0],_=d[1],N=d[2],mc(x in n),E=(O=n[x]).inboundNodes[_].outputTensors,v.push(E[N])}return new e({inputs:y,outputs:v,name:s})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new hc("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,t=this.layers;e<t.length;e++)if(t[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var e=this;Object(Kl.ee)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))},t}(rp),od=function(){function e(t){if(this.id2Value={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n];else{if(null==t)return;for(var r=0,o=t;r<o.length;r++){var i=o[r];this.add(i.key,i.value)}}}return e.prototype.add=function(e,t){if(null!=this.id2Value[e.id])throw new hc("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=function(e,t){if(null!=e.shape){if(e.shape.length!==t.shape.length)throw new hc("The rank of feed ("+t.shape.length+") does not match the rank of the key ("+e.shape.length+").");for(var n=0;n<e.shape.length;++n)if(null!=e.shape[n]&&e.shape[n]!==t.shape[n])throw new hc("The "+n+"-th dimension of the feed ("+t.shape[n]+") is incompatible with that of the key ("+e.shape[n]+").")}if(null==e.dtype||e.dtype===t.dtype)return t;try{return Object(Kl.O)(t,e.dtype)}catch(n){throw new hc("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}(e,t),this.name2Id[e.name]=e.id,this},e.prototype.addFeed=function(e){this.add(e.key,e.value)},e.prototype.hasKey=function(e){return null!=this.id2Value[e.id]},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(e){if(e instanceof Yh){if(null==this.id2Value[e.id])throw new hc("Nonexistent key: "+e.name);return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new hc("Feed dict has no SymbolicTensor name: "+e);return this.id2Value[t]},e}(),id={},ad={};function sd(e,t,n,r){for(var o=null!=n&&n.training,i=Array.isArray(e),a=i?e:[e],s=a.map((function(e){return e.name})),u=[],l=t.names(),c=0,h=s;c<h.length;c++){var p=h[c];-1!==l.indexOf(p)?u.push(t.getValue(p)):u.push(null)}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var d,f,m=s.join(",")+"|"+t.names().join(",");if(null==id[m]){var g=function(e,t){Kl.oe.assert(null!=e&&e.length>0,"Exepcted at least one fetch, got none");var n=[],r={};if(1===e.length){var o=ld(e[0],t);n=o.sorted,r=o.recipientMap}else for(var i=new Set,a=0,s=e;a<s.length;a++){for(var u=ld(s[a],t),l=u.recipientMap,c=0,h=u.sorted;c<h.length;c++){var p=h[c];i.has(p.name)||(n.push(p),i.add(p.name))}var d=function(e){null==r[e]&&(r[e]=new Set),l[e].forEach((function(t){return r[e].add(t)}))};for(var f in l)d(f)}return{sorted:n,recipientCounts:ud(r)}}(a,t);f=g.recipientCounts,id[m]=d=g.sorted,ad[m]=f}d=id[m],f={},o||Object.assign(f,ad[m]);for(var y=new od(t),v=0;v<d.length;++v){if(null!=r){var b=Object(Kl.pc)().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var w=d[v];if(!(w.sourceLayer instanceof op)){for(var x=[],_=[],N=0,E=w.inputs;N<E.length;N++){var C=E[N],I=y.getValue(C);x.push(I),o||(f[C.name]--,0!==f[C.name]||t.hasKey(C)||-1!==s.indexOf(C.name)||I.isDisposed||_.push(I))}for(var O=vc(w.sourceLayer.apply(x,n)),S=cd(w),k=Array.isArray(S)?S:[S],T=0;T<k.length;++T){y.hasKey(k[T])||y.add(k[T],O[T]);var A=s.indexOf(k[T].name);-1!==A&&(u[A]=O[T])}o||Object(Kl.ib)(_)}}return i?u:u[0]}function ud(e){var t={};for(var n in e)t[n]=e[n].size;return t}function ld(e,t){for(var n=new Set,r=[],o={},i=0,a=t.names();i<a.length;i++)n.add(a[i]);var s=[],u=[];for(s.push(e),n.add(e.name);s.length>0;){var l=s[s.length-1],c=u[u.length-1]===s.length-1;if(0===l.inputs.length||c)s.pop(),r.push(l),c&&u.pop();else{u.push(s.length-1);for(var h=0,p=l.inputs;h<p.length;h++){var d=p[h];null==o[d.name]&&(o[d.name]=new Set),o[d.name].add(l.name),n.has(d.name)||(s.push(d),n.add(d.name))}}}return{sorted:r,recipientMap:o}}function cd(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var o=0,i=e.sourceLayer.inboundNodes[r].outputTensors;o<i.length;o++)if(i[o].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var hd=32;function pd(e,t){if(e.outputs.length>1)throw new pc("Support for training a model with multiple output tensors with a dataset object is not implemented yet.");Kl.oe.assert(Array.isArray(t)&&2===t.length,"Dataset iterator for fitDataset() is expected to generate an Array of length 2: `[xs, ys]`, but instead generates "+t);var n=(t=t)[1],r=t[0];if(r instanceof Kl.o)return Kl.oe.assert(1===e.inputs.length,"Model has multiple "+e.inputs.length+" inputs, hence it expects the input dataset to generate a dictionary of tensors  (with keys "+JSON.stringify(e.inputNames)+", but received a single tensor."),Kl.oe.assert(r.shape[0]===n.shape[0],"Mismatch in batch size between x and y tensors ("+r.shape[0]+" vs. "+n.shape[0]+")"),[r,n];var o=void 0;r=r;for(var i=[],a=0,s=e.inputNames;a<s.length;a++){var u=s[a];if(null==r[u])throw new hc("The feature data generated by the dataset lacks the required input key '"+u+"'.");i.push(r[u]),null==o?o=r[u].shape[0]:Kl.oe.assert(r[u].shape[0]===o,"Mismatch in batch size between x and y tensors ("+r[u].shape[0]+" vs. "+n.shape[0]+")")}return i.concat(n)}function dd(e,t,n){return Jl(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_,N,E,C,I,O;return Yl(this,(function(S){switch(S.label){case 0:if(r=null!=n.batchesPerEpoch,Kl.oe.assert(null!=e.optimizer,"You must compile a model before training/testing. Use Model.compile(modelCompileConfig)."),Kl.oe.assert(null!=n,"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),Kl.oe.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs),Kl.oe.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch),Kl.oe.assert(null==n.validationSplit,"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,S.label=1;case 1:return S.trys.push([1,,21,22]),i=void 0,a=void 0,(o=null!=n.validationData)&&(fd(n.validationData)?Kl.oe.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches):(s=function(e){if(3===e.length)throw new pc("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData),i=s.xs,a=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=o?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),h=fp(n.callbacks),p=gp(h,n.yieldEvery,n.verbose,n.epochs,null,null,n.batchesPerEpoch,null,o,c),f=p.history,(d=p.callbackList).setModel(e),e.history=f,[4,d.onTrainBegin()];case 2:return S.sent(),e.stopTraining_=!1,m=null==n.initialEpoch?0:n.initialEpoch,g={},[4,t.iterator()];case 3:y=S.sent(),S.label=4;case 4:return m<n.epochs?[4,d.onEpochBegin(m)]:[3,18];case 5:return S.sent(),v=0,b=0,r?[3,7]:[4,t.iterator()];case 6:y=S.sent(),S.label=7;case 7:return!r||v<n.batchesPerEpoch?[4,y.next()]:[3,16];case 8:if(w=S.sent(),r&&w.done)return console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+v+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,16];if(null==w.value)return[3,10];for(x=pd(e,w.value),(_={}).batch=b,_.size=x[0].shape[0],d.onBatchBegin(b,_),N=u(x),Object(Kl.ib)(x),O=0;O<l.length;++O)_[l[O]]=E=N[O],Object(Kl.Pb)(E);return[4,d.onBatchEnd(b,_)];case 9:S.sent(),sp(_),b++,v++,S.label=10;case 10:return(r?v>=n.batchesPerEpoch:w.done)?o?(C=void 0,fd(n.validationData)?(I=vc,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,12]):[3,14]:[3,15];case 11:return C=I.apply(void 0,[S.sent()]),[3,13];case 12:C=vc(e.evaluate(i,a,{batchSize:null==n.validationBatchSize?hd:n.validationBatchSize,verbose:0})),S.label=13;case 13:for(O=0;O<e.metricsNames.length;++O)g["val_"+e.metricsNames[O]]=C[O];S.label=14;case 14:return[3,16];case 15:return e.stopTraining_?[3,16]:[3,7];case 16:return[4,d.onEpochEnd(m,g)];case 17:return S.sent(),m++,e.stopTraining_?[3,18]:[3,4];case 18:return[4,d.onTrainEnd()];case 19:return S.sent(),[4,e.history.syncData()];case 20:return S.sent(),[2,e.history];case 21:return e.isTraining=!1,[7];case 22:return[2]}}))}))}function fd(e){return"function"==typeof e.iterator}function md(e,t,n){return Jl(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,h,p;return Yl(this,(function(d){switch(d.label){case 0:if(r=null!=n.batches,o=e.testFunction,i=[],n.verbose>0)throw new pc("Verbose mode is not implemented yet.");return Kl.oe.assert(!r||n.batches>0&&Number.isInteger(n.batches),"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)),function(e){return"function"==typeof e.next}(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=d.sent(),d.label=3;case 3:a=s,u=0,l=0,c=function(){var t,s,c,h,p,d;return Yl(this,(function(f){switch(f.label){case 0:return[4,a.next()];case 1:if((t=f.sent()).value){if(s=pd(e,t.value),c=Object(Kl.ee)((function(){return o(s)})),Object(Kl.ib)(s),0===l)for(d=0;d<c.length;++d)i.push(uc(0));for(h=s[0].shape[0],p=function(e){var t=c[e],n=i[e];i[e]=Object(Kl.ee)((function(){return Object(Kl.u)(i[e],Object(Kl.xc)(uc(h),t))})),l>0&&Object(Kl.ib)(n)},d=0;d<c.length;++d)p(d);Object(Kl.ib)(c),u+=h,++l}return t.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}}))},d.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return"break"===d.sent()?[3,6]:[3,4];case 6:for(h=function(e){var t=i[e];i[e]=Object(Kl.ee)((function(){return Object(Kl.kb)(i[e],uc(u))})),Object(Kl.ib)(t)},p=0;p<i.length;++p)h(p);return[2,yc(i)]}}))}))}function gd(e){Kl.oe.assert(e>0&&Number.isInteger(e),"batchSize is required to be a positive integer, but got "+e)}function yd(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return sh(e,t,n-t)})):sh(e,t,n-t)}function vd(e,t){return Object(Kl.ee)((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return vd(e,t)})):mh(e,"int32"===t.dtype?t:t.toInt())}))}function bd(e,t){for(var n=[],r=0,o=null;r<e;)(o=r+t)>=e&&(o=e),n.push([r,o]),r=o;return n}function wd(e,t,n,r,o,i,a,s,u,l,c,h,p,d,f,m){return Jl(this,void 0,void 0,(function(){var g,y,v,b,w,x,_,N;return Yl(this,(function(E){switch(E.label){case 0:if(null==o&&(o=32),null==i&&(i=1),null==c&&(c=!0),null==p&&(p=0),g=!1,null!=u&&null!=l&&(g=!0),null!=f&&(g=!0,null==d))throw new hc("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(y=e.checkNumSamples(n,o,d,"steps_per_epoch"))&&(v=oh(0,y)),null==a&&(a=1),b=gp(s,m,a,i,p,y,d,o,g,h),x=b.history,(w=b.callbackList).setModel(e),e.history=x,[4,w.onTrainBegin()];case 1:E.sent(),e.stopTraining_=!1,_=function(i){var a,s,h,p,f;return Yl(this,(function(m){switch(m.label){case 0:return[4,w.onEpochBegin(i)];case 1:if(m.sent(),a={},null==d)return[3,2];throw new pc("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===c)throw new pc("batch shuffling is not implemneted yet");c&&Kl.oe.shuffle(v),s=Object(Kl.Xd)(v),h=bd(y,o),p=function(i){var c;return Yl(this,(function(p){switch(p.label){case 0:return[4,w.onBatchBegin(i,c={})];case 1:return p.sent(),Object(Kl.ee)((function(){var p=h[i][0],d=h[i][1],f=sh(s,p,d-p);c.batch=i,c.size=d-p;for(var m=vd(n,f),y=t(m),v=0;v<r.length;++v){var b=r[v],w=y[v];c[b]=w,Object(Kl.Pb)(w)}if(i===h.length-1&&g){var x=e.testLoop(u,l,o);for(v=0;v<r.length;++v)b=r[v],w=x[v],Object(Kl.Pb)(w),a["val_"+b]=w}})),[4,w.onBatchEnd(i,c)];case 2:return p.sent(),sp(c),e.stopTraining_?[2,"break"]:[2]}}))},f=0,m.label=3;case 3:return f<h.length?[5,p(f)]:[3,6];case 4:if("break"===m.sent())return[3,6];m.label=5;case 5:return++f,[3,3];case 6:s.dispose(),m.label=7;case 7:return[4,w.onEpochEnd(i,a)];case 8:return m.sent(),e.stopTraining_?[2,"break"]:[2]}}))},N=p,E.label=2;case 2:return N<i?[5,_(N)]:[3,5];case 3:if("break"===E.sent())return[3,5];E.label=4;case 4:return++N,[3,2];case 5:return[4,w.onTrainEnd()];case 6:return E.sent(),[4,e.history.syncData()];case 7:return E.sent(),[2,e.history]}}))}))}function xd(e,t,n,r){return void 0===r&&(r={}),Jl(this,void 0,void 0,(function(){var o,i,a,s,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_;return Yl(this,(function(N){switch(N.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,N.label=1;case 1:if(N.trys.push([1,,3,4]),gd(c=null==r.batchSize?32:r.batchSize),h=e.standardizeUserData(t,n,!1,c),o=h[0],i=h[1],p=!1,d=void 0,null!=r.validationData&&r.validationData.length>0){if(p=!0,2!==r.validationData.length)throw 3===r.validationData.length?new pc("validationData including sample weights is not supported yet."):new hc("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");f=e.standardizeUserData(a=r.validationData[0],s=r.validationData[1],!0,c),d=(u=f[0]).concat(l=f[1])}else null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(p=!0,m=Math.floor(o[0].shape[0]*(1-r.validationSplit)),u=yd(o,m,g=o[0].shape[0]),o=yd(o,0,m),l=yd(i,m,g),i=yd(i,0,m),d=u.concat(l)):null!=r.validationSteps&&(p=!0);return y=o.concat(i),e.checkTrainableWeightsConsistency(),v=e.makeTrainFunction(),b=e.getDedupedMetricsNames(),w=void 0,x=void 0,p?(e.makeTestFunction(),w=e.testFunction,x=b.slice().concat(b.map((function(e){return"val_"+e})))):(w=null,d=[],x=b.slice()),_=fp(r.callbacks),[4,wd(e,v,y,b,c,r.epochs,r.verbose,_,w,d,r.shuffle,x,r.initialEpoch,null,null,r.yieldEvery)];case 2:return[2,N.sent()];case 3:return e.isTraining=!1,Nd(o,t),Nd(i,n),Nd(u,a),Nd(l,s),[7];case 4:return[2]}}))}))}function _d(e){var t=[];e instanceof Kl.o&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(ah(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Nd(e,t){if(null!=e){var n=[];if(t instanceof Kl.o)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t)n.push(t[r].id);var o=[];if(e instanceof Kl.o)-1===n.indexOf(e.id)&&o.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&o.push(e)}));else if(null!=e)for(var i in e){var a=e[i];-1===n.indexOf(a.id)&&o.push(a)}o.forEach((function(e){e.isDisposed||e.dispose()}))}}function Ed(e){return Array.isArray(e)}function Cd(e){return!function(e){return e instanceof Kl.o}(e)&&!Ed(e)}function Id(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=""),null==t||0===t.length){if(null!=e){var i=!1;if(Ed(e)&&e.length>0)i=!0;else if(Cd(e)){for(var a in e)if(e.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new hc("Error when checking model "+o+" expected no data, but got "+e)}return[]}if(null==e)return t.map((function(e){return null}));var s;if(Cd(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(null==e[c])throw new hc('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(Ed(e)){if((e=e).length!==t.length)throw new hc("Error when checking model "+o+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new hc("The model "+o+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=_d(s),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var p=s[h];if(p.shape.length!==n[h].length)throw new hc("Error when checking "+o+": expected "+t[h]+" to have "+n[h].length+" dimension(s). but got array with shape "+p.shape);for(var d=0;d<n[h].length;++d)if(0!==d||r){var f=n[h][d];if(null!=f&&f>=0&&p.shape[d]!==f)throw new hc("Error when checking "+o+": expected "+t[h]+" to have shape ["+n[h]+"], but got array with shape ["+p.shape+"].")}}return s}function Od(e,t,n,r,o){var i;if(void 0===r&&(r=!0),void 0===o&&(o=""),Array.isArray(e)){if(e.length!==t.length)throw new hc("Error when checking model "+o+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");i=e}else{if(t.length>1)throw new hc("The model expects "+t.length+" "+o+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");i=[e]}if(null!=n)for(var a=0;a<t.length;++a)if(null!=n[a]){var s=i[a];if(s.shape.length!==n[a].length)throw new hc("Error when checking "+o+": expected "+t[a]+" to have "+n[a].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[a].length;++u)if(0!==u||r){var l=n[a][u];if(null!=l&&l!==s.shape[u])throw new hc("Error when checking "+o+": expected "+t[a]+" to have shape "+JSON.stringify(n[a])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}var Sd=function(e){function t(t){var n=e.call(this,t)||this;return n.isTraining=!1,n}return Zl(t,e),t.prototype.summary=function(e,t,n){if(void 0===n&&(n=console.log),!this.built)throw new hc("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(e,t,n,r){void 0===r&&(r=console.log);var o,i=function(e){var t=!0,n=[],r=[];for(var o in e.nodesByDepth)n.push(e.nodesByDepth[o]);for(var i=0,a=n;i<a.length;i++){var s=a[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,h=0,p=l[u].inboundNodes;h<p.length;h++)if(-1!==r.indexOf(p[h])){if(c){t=!1;break}c=!0}if(!t)break}return t}(e),a=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in a.push("Receives inputs"),o=[],e.nodesByDepth)o.push.apply(o,e.nodesByDepth[s]);r("_".repeat(t)),Kp(a,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)i?Xp(u[l],n,r):Zp(u[l],n,o,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=function(e){return qh(null!=e.collectedTrainableWeights?e.collectedTrainableWeights:e.trainableWeights)}(e),h=qh(e.nonTrainableWeights);r("Total params: "+(c+h)),r("Trainable params: "+c),r("Non-trainable params: "+h),r("_".repeat(t))}(this,e,t,n)},t.prototype.compile=function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer=function(e){var t={Adagrad:function(){return Kl.je.adagrad(.01)},Adadelta:function(){return Kl.je.adadelta(1,.95,tc())},Adam:function(){return Kl.je.adam(.001,.9,.999,tc())},Adamax:function(){return Kl.je.adamax(.002,.9,.999,tc(),0)},RMSProp:function(){return Kl.je.rmsprop(.001,.9,0,tc())},SGD:function(){return Kl.je.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new hc("Unknown Optimizer "+e)}(e.optimizer);else{if(!(e.optimizer instanceof Kl.j))throw new hc("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer=e.optimizer}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new hc("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");n=e.loss.map((function(e){return Pp(e)}))}else{var r=Pp(e.loss);this.outputs.map((function(e){n.push(r)}))}else{for(var o in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(o))throw new hc('Unknown entry in loss dictionary: "'+o+'". Only expect the following keys: '+this.outputNames);for(var i in this.outputNames)null==e.loss[i]&&console.warn('Output "'+i+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+i+" during training"),n.push(Pp(e.loss[i]))}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var a=0;a<this.outputs.length;++a){var s=this.internalOutputShapes[a];this.feedOutputNames.push(this.outputNames[a]),this.feedOutputShapes.push(s),this.feedLossFns.push(this.lossFunctions[a])}var u=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Kc("loss",(function(){for(var e=0;e<t.outputs.length;++e)-1===u.indexOf(e)&&t.outputs.length>1&&(t.metricsTensors.push([t.lossFunctions[e],e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}));var l=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));if(Array.isArray(e))return t.map((function(t){return e}));if(null!=e){for(var n=[],r=0,o=t;r<o.length;r++){var i=o[r],a=e.hasOwnProperty(i)?e[i]:[];Array.isArray(a)||(a=[a]),n.push(a)}return n}throw new TypeError("Type of metrics argument not understood. Expected an Array or Object, found: "+e)}(e.metrics,this.outputNames);Kc("metric",(function(){for(var e=function(e){if(-1!==u.indexOf(e))return"continue";!function(n){for(var r,o,i,a=function(n){if(-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)){var a=t.internalOutputShapes[e];1===a[a.length-1]||t.lossFunctions[e]===Sp?-1!==["accuracy","acc"].indexOf(n)?o=Dp:-1!==["crossentropy","ce"].indexOf(n)&&(o=Lp):t.lossFunctions[e]===Op?-1!==["accuracy","acc"].indexOf(n)?o=Vp:-1!==["crossentropy","ce"].indexOf(n)&&(o=Gp):-1!==["accuracy","acc"].indexOf(n)?o=Rp:-1!==["crossentropy","ce"].indexOf(n)&&(o=qp);var s=void 0;-1!==["accuracy","acc"].indexOf(n)?s="acc":-1!==["crossentropy","ce"].indexOf(n)&&(s="ce"),i=o,r=""+s}else{var u=function(e){var t={binaryAccuracy:Dp,categoricalAccuracy:Rp,precision:jp,categoricalCrossentropy:qp,sparseCategoricalCrossentropy:Gp,mse:Fp,MSE:zp,mae:Bp,MAE:Up,mape:Wp,MAPE:$p,cosine:Hp};if("string"==typeof e&&e in t)return t[e];if("string"!=typeof e&&null!=e)return e;throw new hc("Unknown metric "+e)}(n);i=u,r=""+n}var l;Kc(r,(function(){l=i})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,r,l)},s=0,u=n;s<u.length;s++)a(u[s])}(l[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(e,t,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;gd(r);var o=this.standardizeUserData(e,t,!0,r);try{var i=o[0].concat(o[1]);return this.makeTestFunction(),yc(this.testLoop(this.testFunction,i,r,n.verbose,n.steps))}finally{Nd(o[0],e),Nd(o[1],t)}},t.prototype.evaluateDataset=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){return this.makeTestFunction(),[2,md(this,e,t)]}))}))},t.prototype.checkNumSamples=function(e,t,n,r){var o;if(void 0===r&&(r="steps"),null!=n){if(o=null,null!=t)throw new hc("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+t)}else{if(null==e)throw new hc("Either the input data should have a defined shape, or "+r+" shoud be specified.");o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o},t.prototype.execute=function(e,t){if(Array.isArray(t)&&0===t.length)throw new hc("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=this.retrieveSymbolicTensors(n?t:[t]),o=new od;if(e instanceof Kl.o&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new hc("The number of inputs provided ("+e.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var i=0;i<this.inputs.length;++i)o.add(this.inputs[i],e[i])}else for(var a=0,s=this.inputs;a<s.length;a++){var u=s[a],l=e[u.name];if(null==l)throw new hc("No value is provided for the model's input "+u.name);o.add(u,l)}var c=sd(r,o);return n?c:c[0]},t.prototype.retrieveSymbolicTensors=function(e){for(var t=fc(null,e.length),n=e.length,r=0,o=this.layers;r<o.length;r++){for(var i=o[r],a=Array.isArray(i.output)?i.output:[i.output],s=a.map((function(e){return e.name})),u=0;u<e.length;++u){var l=s.indexOf(e[u]);if(-1!==l&&(t[u]=a[l],n--),0===n)break}if(0===n)break}if(n>0){var c=[];throw t.forEach((function(t,n){null==t&&c.push(e[n])})),new hc("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(c))}return t},t.prototype.predictLoop=function(e,t,n){var r=this;return void 0===t&&(t=32),void 0===n&&(n=!1),Object(Kl.ee)((function(){var o=r.checkNumSamples(e);if(n)throw new pc("Verbose predictLoop() is not implemented yet.");for(var i=bd(o,t),a=[],s=function(t){var n=Object(Kl.ee)((function(){var n=yd(e,i[t][0],i[t][1]),o=[];if(Array.isArray(n))for(var a=0;a<n.length;++a)o.push({key:r.inputs[a],value:n[a]});else o.push({key:r.inputs[0],value:n});var s=new od(o);return sd(r.outputs,s)}));if(0===t)for(var o=0,s=n;o<s.length;o++)a.push(s[o]);else for(var u=0;u<n.length;++u)a[u]=hh(a[u],n[u])},u=0;u<i.length;++u)s(u);return yc(a)}))},t.prototype.predict=function(e,t){void 0===t&&(t={});var n=_d(e);Od(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return gd(r),this.predictLoop(n,r)}finally{Nd(n,e)}},t.prototype.predictOnBatch=function(e){return Od(e,this.inputNames,this.feedInputShapes,!0),this.predictLoop(e,e.shape[0])},t.prototype.standardizeUserData=function(e,t,n,r){if(void 0===n&&(n=!0),null==this.optimizer)throw new cc("You must compile a model before training/testing. Use Model.compile(modelCompileConfig).");for(var o=[],i=0;i<this.feedOutputShapes.length;++i){var a=this.feedOutputShapes[i];o.push(this.feedLossFns[i]===Op?a.slice(0,a.length-1).concat([1]):a)}if(function(e,t,n){var r=Cc(e.map((function(e){return e.shape[0]})));r.sort();var o=Cc(t.map((function(e){return e.shape[0]})));if(o.sort(),r.length>1)throw new hc("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(e){return e.shape}))));if(o.length>1)throw new hc("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(e){return e.shape}))));if(r.length>0&&o.length>0&&!Kl.oe.arraysEqual(r,o))throw new hc("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+o[0]+" target sample(s).")}(e=Id(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Id(t,this.feedOutputNames,o,!1,"target")),function(e,t,n){for(var r=[vp,Sp,Ip],o=0;o<e.length;++o){var i=e[o],a=t[o],s=n[o];if(null!=a){if(a===Ip&&1===i.shape[i.shape.length-1])throw new hc("You are passing a target array of shape "+i.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(a))for(var u=i.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var h=l[c];if(null!=h&&u[c]!==h)throw new hc("A target Tensor with shape "+i.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new hc("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+e[0].shape[0]+" sample(s).");return[e,t,null]},t.prototype.testLoop=function(e,t,n,r,o){var i=this;return void 0===r&&(r=0),Object(Kl.ee)((function(){var a=i.checkNumSamples(t,n,o,"steps"),s=[];if(r>0)throw new pc("Verbose mode is not implemented yet.");if(null!=o)throw new pc("steps mode in testLoop() is not implemented yet");for(var u=bd(a,n),l=Object(Kl.Xd)(oh(0,a)),c=0;c<u.length;++c){var h=u[c][0],p=u[c][1],d=sh(l,h,p-h),f=vd(t,d),m=e(f);if(0===c)for(var g=0;g<m.length;++g)s.push(uc(0));for(g=0;g<m.length;++g){var y=m[g];s[g]=Object(Kl.u)(s[g],Object(Kl.xc)(uc(p-h),y))}}for(g=0;g<s.length;++g)s[g]=Object(Kl.kb)(s[g],uc(a));return s}))},t.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],o=r;gc(e,r)>1&&(o+="_"+gc(e.slice(0,n),r)),t.push(o)}return t},t.prototype.makeTrainFunction=function(){var e=this;return function(t){var n=t.slice(0,e.inputs.length),r=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],i=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer.minimize((function(){for(var t=[],i=0;i<e.inputs.length;++i)t.push({key:e.inputs[i],value:n[i]});var a,s=new od(t),u=sd(e.outputs,s,{training:!0});for(i=0;i<e.lossFunctions.length;++i){var l=(0,e.lossFunctions[i])(r[i],u[i]);Object(Kl.oc)(l),a=0===i?l:Object(Kl.u)(a,l)}for(i=0;i<e.metricsTensors.length;++i){var c=e.metricsTensors[i][0],h=e.metricsTensors[i][1],p=Object(Kl.oc)(c(r[h],u[h]));Object(Kl.Pb)(p),o.push(p)}return a=Object(Kl.oc)(a),e.calculateLosses().forEach((function(e){a=Object(Kl.u)(a,e)})),a}),!0,i)].concat(o)}},t.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(t){return Object(Kl.ee)((function(){for(var n,r=[],o=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),a=[],s=0;s<e.inputs.length;++s)a.push({key:e.inputs[s],value:o[s]});var u=new od(a),l=sd(e.outputs,u);for(s=0;s<e.lossFunctions.length;++s){var c=e.lossFunctions[s],h=Object(Kl.oc)(c(i[s],l[s]));n=0===s?h:Object(Kl.u)(n,h),r.push(n)}for(s=0;s<e.metricsTensors.length;++s){var p=e.metricsTensors[s][0],d=e.metricsTensors[s][1],f=Object(Kl.oc)(p(i[d],l[d]));r.push(f)}return r}))}},t.prototype.fit=function(e,t,n){return void 0===n&&(n={}),Jl(this,void 0,void 0,(function(){return Yl(this,(function(r){return[2,xd(this,e,t,n)]}))}))},t.prototype.fitDataset=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){return[2,dd(this,e,t)]}))}))},t.prototype.trainOnBatch=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,h;return Yl(this,(function(p){switch(p.label){case 0:n=this.standardizeUserData(e,t),r=n[0],o=n[1],i=this.makeTrainFunction(),a=i(r.concat(o)),s=[],u=0,l=a,p.label=1;case 1:return u<l.length?(h=(c=s).push,[4,l[u].data()]):[3,4];case 2:h.apply(c,[p.sent()[0]]),p.label=3;case 3:return u++,[3,1];case 4:return Object(Kl.ib)(a),[2,yc(s)]}}))}))},t.prototype.getNamedWeights=function(e){for(var t={},n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,o=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||(t[r[i].originalName]=o[i]);return t},Object.defineProperty(t.prototype,"stopTraining",{set:function(e){this.stopTraining_=e},enumerable:!0,configurable:!0}),t.prototype.save=function(e,t){return Jl(this,void 0,void 0,(function(){var n,r,o;return Yl(this,(function(i){switch(i.label){case 0:if("string"==typeof e){if(0===(n=Kl.Nb.getSaveHandlers(e)).length)throw new hc("Cannot find any save handlers for URL '"+e+"'");if(n.length>1)throw new hc("Found more than one ("+n.length+") save handlers for URL '"+e+"'");e=n[0]}if(null==e.save)throw new hc("Model.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Kl.Nb.encodeWeights(this.getNamedWeights(t))];case 1:return r=i.sent(),o=this.toJSON(null,!1),[2,e.save({modelTopology:o,weightData:r.data,weightSpecs:r.specs})]}}))}))},t.className="Model",t}(rd);function kd(e,t,n){return void 0===n&&(n=!0),Jl(this,void 0,void 0,(function(){var r,o,i;return Yl(this,(function(a){switch(a.label){case 0:if(null==e.load)throw new hc("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=a.sent(),null!=(o=r.modelTopology).model_config&&(o=o.model_config),i=Qp(Yp(o),t),null!=r.weightData){if(null==r.weightSpecs)throw new hc("Model artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");i.loadWeights(Kl.Nb.decodeWeights(r.weightData,r.weightSpecs),!1,!0,n)}return[2,i]}}))}))}Kl.rd.registerClass(Sd);var Td=function(e){function t(t){var n=e.call(this,{inputs:[],outputs:[]})||this;if(t=t||{},n.trainable=!0,n._updatable=!0,n.built=!1,n.name=null!=t.name?t.name:ic("sequential_"),null!=t.layers)for(var r=0,o=t.layers;r<o.length;r++)n.add(o[r]);return n}return Zl(t,e),t.prototype.checkShape=function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new hc("Negative dimension size caused by adding layer "+e.name+" with input shape ["+e.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(e){var n,r=e instanceof t||e instanceof Sd;if(r){if(1!==(n=e).outputs.length)throw new hc("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new hc("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new hc("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var o=ip({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new hc("A layer added to a Sequential model must not already be connected somewhere else. Model received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new hc("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];var o=n.inboundNodes[r];if(0===o.inboundLayers.length)return o.inputTensors;for(var i=[],a=0;a<o.inboundLayers.length;a++)for(var s=0,u=e(o.inputTensors[a],o.inboundLayers[a],o.nodeIndices[a]);s<u.length;s++){var l=u[s];-1===i.indexOf(l)&&i.push(l)}return i}(this.outputs[0])}this.inboundNodes=[],new tp({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},t.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(e,t){return null==this.model&&this.build(),this.model.call(e,t)},t.prototype.build=function(e){if($h(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Sd({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.model.updatable=this.updatable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(t,n,r){void 0===r&&(r=console.log),this.built||this.build(),e.prototype.summary.call(this,t,n,r)},t.prototype.setWeights=function(e){null==this.model&&this.build(),this.model.setWeights(e)},Object.defineProperty(t.prototype,"updatable",{get:function(){return this._updatable},set:function(e){this.built&&(this.model.updatable=e),this._updatable=e},enumerable:!0,configurable:!0}),t.prototype.evaluate=function(e,t,n){if(void 0===n&&(n={}),!this.built)throw new cc("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)},t.prototype.evaluateDataset=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){if(!this.built)throw new cc("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(e,t)]}))}))},t.prototype.predict=function(e,t){return void 0===t&&(t={}),null==this.model&&this.build(),this.model.predict(e,t)},t.prototype.predictOnBatch=function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)},t.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer=this.model.optimizer,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},t.prototype.fit=function(e,t,n){return void 0===n&&(n={}),Jl(this,void 0,void 0,(function(){return Yl(this,(function(r){if(!this.built)throw new cc("The model needs to be compiled before being used.");return[2,this.model.fit(e,t,n)]}))}))},t.prototype.fitDataset=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){if(!this.built)throw new cc("The model needs to be compiled before being used.");return[2,this.model.fitDataset(e,t)]}))}))},t.prototype.trainOnBatch=function(e,t){return Jl(this,void 0,void 0,(function(){return Yl(this,(function(n){return[2,this.model.trainOnBatch(e,t)]}))}))},t.fromConfig=function(e,n){var r,o={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new hc("Legacy serialization format not supported yet.");r=n}else Kl.oe.assert(null!=n.layers,"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=n.layers,delete n.layers,o=n;var i=new e(o);if(!(i instanceof t))throw new pc("Sequential.fromConfig called on non-Sequential input: "+i);for(var a=0,s=r;a<s.length;a++){var u=Qp(s[a]);i.add(u)}return i},Object.defineProperty(t.prototype,"stopTraining",{set:function(e){this.model.stopTraining=e},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e.push({className:r.getClassName(),config:r.getConfig()})}return e},t.className="Sequential",t}(Sd);function Ad(e){return new Sd(e)}function Pd(e){return new Td(e)}function Dd(e,t){return void 0===t&&(t=!0),function(e,t){return void 0===t&&(t=!0),Jl(this,void 0,void 0,(function(){var n;return Yl(this,(function(r){if("string"==typeof e){if(0===(n=Kl.Nb.getLoadHandlers(e)).length)n.push(Kl.Nb.browserHTTPRequest(e));else if(n.length>1)throw new hc("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,kd(e,void 0,t)]}))}))}(e,t)}function Rd(e){return ip(e)}function Md(e,t){mp.registerCallbackConstructor(e,t)}Kl.rd.registerClass(Td);var jd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.getConfig=function(){return{}},t}(Kl.rd.Serializable),Ld=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e,t){return void 0===t&&(t=1),function(e,t){if(void 0===t&&(t=1),1!==t)throw new pc("Support for alpha values other than 1 ("+t+") is not implemented yet.");return Object(Kl.nb)(e)}(e,t)},t.className="elu",t}(jd);Kl.rd.registerClass(Ld);var Vd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.pd)(e)},t.className="selu",t}(jd);Kl.rd.registerClass(Vd);var Fd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.dd)(e)},t.className="relu",t}(jd);Kl.rd.registerClass(Fd);var zd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.ee)((function(){return Object(Kl.rc)(uc(6),Object(Kl.dd)(e))}))},t.className="relu6",t}(jd);Kl.rd.registerClass(zd);var Bd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return e},t.className="linear",t}(jd);Kl.rd.registerClass(Bd);var Ud=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.ud)(e)},t.className="sigmoid",t}(jd);Kl.rd.registerClass(Ud);var Wd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return function(e){return Object(Kl.ee)((function(){var t=Object(Kl.u)(uc(.5),Object(Kl.xc)(uc(.2),e));return Object(Kl.Q)(t,0,1)}))}(e)},t.className="hardSigmoid",t}(jd);Kl.rd.registerClass(Wd);var $d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.Ed)(e)},t.className="softplus",t}(jd);Kl.rd.registerClass($d);var qd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return function(e){return Object(Kl.ee)((function(){return Object(Kl.kb)(e,Object(Kl.u)(uc(1),Object(Kl.r)(e)))}))}(e)},t.className="softsign",t}(jd);Kl.rd.registerClass(qd);var Hd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e){return Object(Kl.Vd)(e)},t.className="tanh",t}(jd);Kl.rd.registerClass(Hd);var Gd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e,t){return void 0===t&&(t=-1),Object(Kl.Dd)(e,t)},t.className="softmax",t}(jd);function Kd(e){return e.getClassName()}function Xd(e,t){return void 0===t&&(t={}),Nc(e,Kl.rd.SerializationMap.getMap().classNameMap,t,"activation")}function Zd(e){return null==e?Xd({className:"linear",config:{}}):"string"==typeof e?Xd({className:e,config:{}}):e instanceof jd?e:Xd(e)}Kl.rd.registerClass(Gd);var Qd=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.supportsMasking=!0,null!=t&&(n.maxValue=t.maxValue),n}return Zl(t,e),t.prototype.call=function(e,t){e=Wh(e);var n=Object(Kl.dd)(e);return null!=this.maxValue&&(n=Object(Kl.Q)(n,0,this.maxValue)),n},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={maxValue:this.maxValue},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ReLU",t}(rp);Kl.rd.registerClass(Qd);var Jd=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_ALPHA=.3,null==t&&(t={}),n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return Zl(t,e),t.prototype.call=function(e,t){var n=Wh(e);return Object(Kl.Qb)(n,this.alpha)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="LeakyReLU",t}(rp);Kl.rd.registerClass(Jd);var Yd=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;if(n.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==n.DEFAULT_ALPHA)throw new pc("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return Zl(t,e),t.prototype.call=function(e,t){var n=Wh(e);return Object(Kl.nb)(n)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ELU",t}(rp);Kl.rd.registerClass(Yd);var ef=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_THETA=1,null==t&&(t={}),n.theta=null==t.theta?n.DEFAULT_THETA:t.theta,n.thetaTensor=uc(n.theta),n}return Zl(t,e),t.prototype.call=function(e,t){var n=Wh(e);return n.mul(ih(n.greater(this.thetaTensor),"float32"))},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={theta:this.theta},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ThresholdedReLU",t}(rp);Kl.rd.registerClass(ef);var tf=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_AXIS=1,null==t&&(t={}),n.softmax=(new Gd).apply,n.axis=null==t.axis?n.DEFAULT_AXIS:t.axis,n}return Zl(t,e),t.prototype.call=function(e,t){var n=Wh(e);return this.softmax(n,this.axis)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={axis:this.axis},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Softmax",t}(rp);Kl.rd.registerClass(tf);var nf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t}(Kl.rd.Serializable),rf=function(e){function t(t){var n=e.call(this)||this,r=null==t||null==t.l1?.01:t.l1,o=null==t||null==t.l2?.01:t.l2;return n.hasL1=0!==r,n.hasL2=0!==o,n.l1=uc(r),n.l2=uc(o),n}return Zl(t,e),t.prototype.apply=function(e){var t=this;return Object(Kl.ee)((function(){var n=Object(Kl.xe)([1]);return t.hasL1&&(n=Object(Kl.u)(n,Object(Kl.Td)(Object(Kl.xc)(t.l1,Object(Kl.r)(e))))),t.hasL2&&(n=Object(Kl.u)(n,Object(Kl.Td)(Object(Kl.xc)(t.l2,gh(e))))),n.asScalar()}))},t.prototype.getConfig=function(){return{l1:this.l1.dataSync()[0],l2:this.l2.dataSync()[0]}},t.fromConfig=function(e,t){return new e({l1:t.l1,l2:t.l2})},t.className="L1L2",t}(nf);Kl.rd.registerClass(rf);var of={l1l2:"L1L2"};function af(e){return _c(e)}function sf(e,t){return void 0===t&&(t={}),Nc(e,Kl.rd.SerializationMap.getMap().classNameMap,t,"regularizer")}function uf(e){return null==e?null:"string"==typeof e?sf({className:e in of?of[e]:e,config:{}}):e instanceof nf?e:sf(e)}function lf(e,t,n){if("number"==typeof e)return fc(e,t);if(e.length!==t)throw new hc("The "+n+" argument must be a tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var o=e[r];if(!Yc(o))throw new hc("The "+n+" argument must be a tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+o)}return e}function cf(e,t,n,r,o){return void 0===o&&(o=1),null==e?e:Math.floor((("same"===n?e:e-(t+(t-1)*(o-1))+1)+r-1)/r)}function hf(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+rh([n-t,0]);else{if("same"!==r)throw new hc("Unsupport padding mode: "+r+".");e*=t}return e}function pf(e,t){return Object(Kl.ee)((function(){return Uc(t),"channelsFirst"===t?Object(Kl.ke)(e,[0,2,3,1]):e}))}var df=function(e){function t(n,r){var o=e.call(this,r)||this;if(o.bias=null,o.DEFAULT_KERNEL_INITIALIZER="glorotNormal",o.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyConfig(r),o.rank=n,1!==o.rank&&2!==o.rank)throw new pc("Convolution layer for rank other than 1 or 2 ("+o.rank+") is not implemented yet.");if(o.kernelSize=lf(r.kernelSize,n,"kernelSize"),o.strides=lf(null==r.strides?1:r.strides,n,"strides"),o.padding=null==r.padding?"valid":r.padding,$c(o.padding),o.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Uc(o.dataFormat),o.activation=Zd(r.activation),o.useBias=null==r.useBias||r.useBias,o.biasInitializer=Fh(r.biasInitializer||o.DEFAULT_BIAS_INITIALIZER),o.biasConstraint=Vc(r.biasConstraint),o.biasRegularizer=uf(r.biasRegularizer),o.activityRegularizer=uf(r.activityRegularizer),o.dilationRate=lf(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===o.rank&&Array.isArray(o.dilationRate)&&1!==o.dilationRate.length)throw new hc("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(o.dilationRate));if(2===o.rank)if("number"==typeof o.dilationRate)o.dilationRate=[o.dilationRate,o.dilationRate];else if(2!==o.dilationRate.length)throw new hc("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(o.dilationRate));return o}return Zl(t,e),t.verifyConfig=function(e){if(mc("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!Sc(e.kernelSize,"number",1,2))throw new hc("BaseConv expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(e.kernelSize)+".")},t.prototype.getConfig=function(){var t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Kd(this.activation),useBias:this.useBias,biasInitializer:Vh(this.biasInitializer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),biasConstraint:jc(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(rp),ff=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.kernel=null,t.verifyConfig(r),o.filters=r.filters,o.kernelInitializer=Fh(r.kernelInitializer||o.DEFAULT_KERNEL_INITIALIZER),o.kernelConstraint=Vc(r.kernelConstraint),o.kernelRegularizer=uf(r.kernelRegularizer),o}return Zl(t,e),t.prototype.build=function(e){e=$h(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new hc("The channel dimension of the input should be defined. Found "+e[t]);var n,r=e[t],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[t]=r,n)}],this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t;e=Wh(e);var r=null==n.bias?null:n.bias.read();if(1===n.rank)t=function(e,t,n,r,o,i,a){return void 0===r&&(r=1),void 0===o&&(o="valid"),void 0===a&&(a=1),Object(Kl.ee)((function(){if(null==i&&(i="channelsLast"),Uc(i),3!==e.shape.length)throw new hc("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(3!==t.shape.length)throw new hc("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new hc("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if("channelsFirst"===i&&(e=Object(Kl.ke)(e,[0,2,1])),"causal"===o)throw new pc("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=Object(Kl.Y)(e,t,r,"same"===o?"same":"valid","NWC",a);return null!=n&&(s=yh(s,n)),s}))}(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=function(e,t,n,r,o,i,a){return void 0===r&&(r=[1,1]),void 0===o&&(o="valid"),Object(Kl.ee)((function(){if(null==i&&(i="channelsLast"),Uc(i),3!==e.rank&&4!==e.rank)throw new hc("conv2dWithBias expects input to be of rank 3 or 4, but received "+e.rank+".");if(3!==t.rank&&4!==t.rank)throw new hc("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+e.rank+".");var s=pf(e,i);if("causal"===o)throw new pc("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return s=Object(Kl.Z)(s,t,r,"same"===o?"same":"valid","NHWC",a),null!=n&&(s=yh(s,n)),"channelsFirst"===i&&(s=Object(Kl.ke)(s,[0,3,1,2])),s}))}(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else if(3===n.rank)throw new pc("3D convolution is not implemented yet.");return null!=n.activation&&(t=n.activation.apply(t)),t}))},t.prototype.computeOutputShape=function(e){e=$h(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var o=cf(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(o)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i},t.prototype.getConfig=function(){var t={filters:this.filters,kernelInitializer:Vh(this.kernelInitializer),kernelRegularizer:af(this.kernelRegularizer),kernelConstraint:jc(this.kernelConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.verifyConfig=function(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new hc("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(e.filters))},t}(df),mf=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyConfig(n),r}return Zl(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,t},t.verifyConfig=function(e){if("number"!=typeof e.kernelSize&&!Sc(e.kernelSize,"number",1,2))throw new hc("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(e.kernelSize)+".")},t.className="Conv2D",t}(ff);Kl.rd.registerClass(mf);var gf=function(e){function t(t){var n=e.call(this,t)||this;if(n.inputSpec=[new Jh({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new hc("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return Zl(t,e),t.prototype.build=function(e){if(4!==(e=$h(e)).length)throw new hc("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new hc("The channel dimension of the inputs should be defined. Found `None`.");var n,r=e[t],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Jh({ndim:4,axes:(n={},n[t]=r,n)})],this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t=Wh(e);if(4!==t.shape.length)throw new hc("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+t.shape.length);var r,o,i=t.shape;"channelsFirst"===n.dataFormat?(r=2,o=3):(r=1,o=2);var a=i[o],s=n.kernelSize[1],u=n.strides[1],l=[i[0],hf(i[r],n.strides[0],n.kernelSize[0],n.padding),hf(a,u,s,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=Object(Kl.ke)(t,[0,2,3,1]));var c=Object(Kl.bb)(t,n.kernel.read(),l,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(c=Object(Kl.ke)(c,[0,3,1,2])),null!=n.bias&&(c=yh(c,n.bias.read(),n.dataFormat)),null!=n.activation&&(c=n.activation.apply(c)),c}))},t.prototype.computeOutputShape=function(e){var t,n,r,o=(e=$h(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],a=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return o[t]=this.filters,o[n]=hf(o[n],s,i,this.padding),o[r]=hf(o[r],u,a,this.padding),o},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.dilationRate,t},t.className="Conv2DTranspose",t}(mf);Kl.rd.registerClass(gf);var yf=function(e){function t(t){return e.call(this,2,t)||this}return Zl(t,e),t.className="SeparableConv2D",t}(function(e){function t(t,n){var r=e.call(this,t,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new hc("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new hc("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new hc("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=Fh(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=uf(n.depthwiseRegularizer),r.depthwiseConstraint=Vc(n.depthwiseConstraint),r.pointwiseInitializer=Fh(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=uf(n.pointwiseRegularizer),r.pointwiseConstraint=Vc(n.pointwiseConstraint),r}return Zl(t,e),t.prototype.build=function(e){if((e=$h(e)).length<this.rank+2)throw new hc("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var t,n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n]||e[n]<0)throw new hc("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[n]));for(var r=e[n],o=this.kernelSize.concat([r,this.depthMultiplier]),i=[],a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new Jh({ndim:this.rank+2,axes:(t={},t[n]=r,t)})],this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t;if(e=Wh(e),1===n.rank)throw new pc("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=Object(Kl.ke)(e,[0,2,3,1])),t=Object(Kl.qd)(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=yh(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=Object(Kl.ke)(t,[0,3,1,2])),t}))},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Vh(this.depthwiseInitializer),t.pointwiseInitializer=Vh(this.pointwiseInitializer),t.depthwiseRegularizer=af(this.depthwiseRegularizer),t.pointwiseRegularizer=af(this.pointwiseRegularizer),t.depthwiseConstraint=jc(this.depthwiseConstraint),t.pointwiseConstraint=jc(this.pointwiseConstraint),t},t.className="SeparableConv",t}(ff));Kl.rd.registerClass(yf);var vf=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyConfig(n),r.inputSpec=[{ndim:3}],r}return Zl(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,delete t.dataFormat,t},t.verifyConfig=function(e){if("number"!=typeof e.kernelSize&&!Sc(e.kernelSize,"number",1,1))throw new hc("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(e.kernelSize)+".")},t.className="Conv1D",t}(ff);Kl.rd.registerClass(vf);var bf=function(e){function t(t){var n=e.call(this,t)||this;return n.cropping="number"==typeof t.cropping?[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:t.cropping,n.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,n.inputSpec=[{ndim:4}],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return e=Wh(e),"channelsLast"===n.dataFormat?lh(lh(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2),n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3):lh(lh(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},t.prototype.getConfig=function(){var t={cropping:this.cropping,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Cropping2D",t}(rp);Kl.rd.registerClass(bf);var wf=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=null==t.size?n.DEFAULT_SIZE:t.size,n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,n}return Zl(t,e),t.prototype.computeOutputShape=function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}return[e[0],t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2],e[3]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t=Wh(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=Object(Kl.ke)(t,[0,2,3,1]);var o=n.size[0]*r[2],i=n.size[1]*r[3],a=t.resizeNearestNeighbor([o,i]);return Object(Kl.ke)(a,[0,3,1,2])}return t.resizeNearestNeighbor([o=n.size[0]*r[1],i=n.size[1]*r[2]])}))},t.prototype.getConfig=function(){var t={size:this.size,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="UpSampling2D",t}(rp);Kl.rd.registerClass(wf);var xf=function(e){function t(t){var n=e.call(this,2,t)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,n.depthwiseInitializer=Fh(t.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=Vc(t.depthwiseConstraint),n.depthwiseRegularizer=uf(t.depthwiseRegularizer),n}return Zl(t,e),t.prototype.build=function(e){if((e=$h(e)).length<4)throw new hc("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new hc("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[t]+").");var n=e[t];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t=function(e,t,n,r,o,i){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),Object(Kl.ee)((function(){null==o&&(o="channelsLast"),Uc(o);var i=pf(e,o);if(4!==e.rank)throw new hc("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(4!==t.rank)throw new hc("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return i=Object(Kl.hb)(i,t,n,"same"===r?"same":"valid","NHWC",null),"channelsFirst"===o&&(i=Object(Kl.ke)(i,[0,3,1,2])),i}))}(e=Wh(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat);return n.useBias&&(t=yh(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))},t.prototype.computeOutputShape=function(e){e=$h(e);var t="channelsFirst"===this.dataFormat?e[3]:e[2],n="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=cf("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),o=cf(t,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],n,r,o]:[e[0],r,o,n]},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Vh(this.depthwiseInitializer),t.depthwiseRegularizer=af(this.depthwiseRegularizer),t.depthwiseConstraint=jc(this.depthwiseRegularizer),t},t.className="DepthwiseConv2D",t}(df);Kl.rd.registerClass(xf);var _f=function(e){function t(t){var n=e.call(this,t)||this;if(n.rate=Math.max(Math.min(t.rate,1),0),n.rateScalar=uc(n.rate),n.noiseShape=t.noiseShape,n.seed=t.seed,null!=n.seed)throw new pc("Non-default seed is not implemented in Dropout layer yet: "+n.seed);return n.supportsMasking=!0,n}return Zl(t,e),t.prototype.getNoiseShape=function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t);var r=Wh(e);if(null!=n.noiseShape&&!Kl.oe.arraysEqual(r.shape,n.noiseShape))throw new pc("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(n.noiseShape));if(0<n.rate&&n.rate<1){var o=null!=t.training&&t.training,i=n.getNoiseShape(r);return bh((function(){return vh(r,n.rateScalar,i,n.seed)}),(function(){return r}),o)}return e}))},t.prototype.getConfig=function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Dropout",t}(rp);Kl.rd.registerClass(_f);var Nf=function(e){function t(t){var n=e.call(this,t)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){var r=null;null!=t.batchSize&&(r=t.batchSize),n.batchInputShape=[r,t.inputDim]}return n.units=t.units,n.activation=Zd(t.activation),null!=t.useBias&&(n.useBias=t.useBias),n.kernelInitializer=Fh(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=Fh(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=Vc(t.kernelConstraint),n.biasConstraint=Vc(t.biasConstraint),n.kernelRegularizer=uf(t.kernelRegularizer),n.biasRegularizer=uf(t.biasRegularizer),n.activityRegularizer=uf(t.activityRegularizer),n.inputSpec=[{minNDim:2}],n}return Zl(t,e),t.prototype.build=function(e){var t,n=(e=$h(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(t={},t[-1]=n,t)}],this.built=!0},t.prototype.computeOutputShape=function(e){var t=(e=$h(e)).slice();return t[t.length-1]=this.units,t},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t);var r=fh(Wh(e),n.kernel.read());return null!=n.bias&&(r=yh(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r)),r}))},t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),biasInitializer:Vh(this.biasInitializer),kernelRegularizer:af(this.kernelRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),biasConstraint:jc(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Dense",t}(rp);Kl.rd.registerClass(Nf);var Ef=function(e){function t(t){var n=e.call(this,t||{})||this;return n.inputSpec=[{minNDim:3}],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){for(var t=0,n=(e=$h(e)).slice(1);t<n.length;t++)if(null==n[t])throw new hc('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],eh(e,1)]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return n.invokeCallHook(e,t),function(e){if(e.rank<=1)throw new hc("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],eh(e.shape,1)];return e.reshape(t)}(Wh(e))}))},t.className="Flatten",t}(rp);Kl.rd.registerClass(Ef);var Cf=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n.activation=Zd(t.activation),n}return Zl(t,e),t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t);var r=Wh(e);return n.activation.apply(r)}))},t.prototype.getConfig=function(){var t={activation:Kd(this.activation)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Activation",t}(rp);Kl.rd.registerClass(Cf);var If=function(e){function t(t){var n=e.call(this,t)||this;return n.n=t.n,n.inputSpec=[{ndim:2}],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return function(e,t){return Object(Kl.ee)((function(){if(2!==e.shape.length)throw new hc("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return ph(ah(e,1),[1,t,1])}))}(e=Wh(e),n.n)}))},t.prototype.getConfig=function(){var t={n:this.n},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="RepeatVector",t}(rp);Kl.rd.registerClass(If);var Of=function(e){function t(t){var n=e.call(this,t)||this;n.targetShape=t.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return Zl(t,e),t.prototype.isUnknown=function(e){return e<0||null==e},t.prototype.fixUnknownDimension=function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),o=1,i=null,a=0;a<r.length;++a){var s=r[a];if(this.isUnknown(s)){if(null!==i)throw new hc("Can only specifiy one unknown dimension.");i=a}else o*=s}var u=eh(e);if(null!==i){if(0===o||u%o!=0)throw new hc(n);r[i]=u/o}else if(u!==o)throw new hc(n);return r},t.prototype.computeOutputShape=function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t);var r=Wh(e),o=r.shape,i=o.slice(0,1).concat(n.fixUnknownDimension(o.slice(1),n.targetShape));return r.reshape(i)}))},t.prototype.getConfig=function(){var t={targetShape:this.targetShape},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Reshape",t}(rp);Kl.rd.registerClass(Of);var Sf=function(e){function t(t){var n=e.call(this,t)||this;if(null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");var r=oh(1,t.dims.length+1);if(!Kl.oe.arraysEqual(t.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=t.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new Jh({ndim:n.dims.length+1})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){var t=(e=$h(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t},t.prototype.call=function(e,t){return Object(Kl.ke)(Wh(e),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var t={dims:this.dims},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Permute",t}(rp);Kl.rd.registerClass(Sf);var kf=function(e){function t(t){var n=e.call(this,t)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){var r=null;null!=t.batchSize&&(r=t.batchSize),n.batchInputShape=null==t.inputLength?[r,null]:[r].concat(vc(t.inputLength))}return n.inputDim=t.inputDim,n.outputDim=t.outputDim,n.embeddingsInitializer=Fh(t.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=uf(t.embeddingsRegularizer),n.activityRegularizer=uf(t.activityRegularizer),n.embeddingsConstraint=Vc(t.embeddingsConstraint),n.maskZero=t.maskZero,n.inputLength=t.inputLength,n}return Zl(t,e),t.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(e){},t.prototype.computeMask=function(e,t){var n=this;return Object(Kl.ee)((function(){return n.maskZero?(e=Wh(e),Object(Kl.Ec)(e,Object(Kl.ye)(e))):null}))},t.prototype.computeOutputShape=function(e){if(e=$h(e),null==this.inputLength)return e.concat([this.outputDim]);var t=vc(this.inputLength);if(t.length!==e.length-1)throw new hc('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var n=0,r=0;r<t.length;++r){var o=t[r],i=e[r+1];if(null!=o&&null!=i&&o!==i)throw new hc('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);null==o&&(t[n]=i),n++}return[e[0]].concat(t,[this.outputDim])},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t);var r=Wh(e);return"int32"!==r.dtype&&(r=ih(r,"int32")),mh(n.embeddings.read(),r.as1D()).reshape($h(n.computeOutputShape(r.shape)))}))},t.prototype.getConfig=function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Vh(this.embeddingsInitializer),embeddingsRegularizer:af(this.embeddingsRegularizer),activityRegularizer:af(this.activityRegularizer),embeddingsConstraint:jc(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Embedding",t}(rp);Kl.rd.registerClass(kf);var Tf=function(e){function t(t){var n=e.call(this,t||{})||this;return n.supportsMasking=!0,n}return Zl(t,e),t.prototype.mergeFunction=function(e){throw new pc},t.prototype.computeElementwiseOpOutputShape=function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var o=e[e.length-t.length+r],i=t[r];if(null==o||null==i||o<0||i<0)n.push(null);else if(1===o)n.push(i);else if(1===i)n.push(o);else{if(o!==i)throw new hc("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(o)}}return n},t.prototype.build=function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[$h(e)]),(e=e).length<2)throw new hc("A merge layer should be called on an Array of at least 2 inputs. Got "+e.length+" input(s).");for(var t=[],n=0,r=e;n<r.length;n++)null!=(a=r[n])&&null!==a[0]&&t.push(a[0]);if((t=Cc(t)).length>1)throw new hc("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(e)+".");for(var o=null==e[0]?null:e[0].slice(1),i=1;i<e.length;++i){var a=null==e[i]?null:e[i].slice(1);o=this.computeElementwiseOpOutputShape(o,a)}var s=e.map((function(e){return e.length}));this.reshapeRequired=-1!==e.indexOf(null)||1!==Cc(s).length},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){for(var o=rh(r),i=0,a=e;i<a.length;i++){for(var s=(p=a[i]).rank,u=0;u<o-s;++u)p=ah(p,1);t.push(p)}return n.mergeFunction(t)}for(var l=!1,c=0,h=e;c<h.length;c++){var p;if(null==(s=(p=h[c]).rank)){var d=p.shape,f=d[0],m=d.slice(1).concat([f]),g=p.reshape([f].concat(eh(d.slice(1))));g=(g=Object(Kl.ke)(g,[1,0])).reshape(m),t.push(g),l=!0}else if(s>1){var y=oh(1,s).concat([0]);t.push(Object(Kl.ke)(p,y)),l=!0}else t.push(p)}var v=n.mergeFunction(t),b=v.rank;if(l)if(null==b){var w=v.shape;m=[f=w[w.length-1]].concat(w.slice(0,w.length-1)),v=Object(Kl.ke)(v.reshape([-1,f]),[1,0]).reshape(m)}else b>1&&(y=[b-1].concat(oh(0,b-1)),v=Object(Kl.ke)(v,y));return v}return n.mergeFunction(e)}))},t.prototype.computeOutputShape=function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}for(var o=[],i=0,a=e;i<a.length;i++)null!=(r=a[i])&&null!==r[0]&&o.push(r[0]);return 1===(o=Cc(o)).length?o.concat(t):[null].concat(t)},t.prototype.computeMask=function(e,t){return Object(Kl.ee)((function(){if(null==t)return null;if(!Array.isArray(t))throw new hc("`mask` should be an Array");if(!Array.isArray(e))throw new hc("`inputs` should be an Array");if(t.length!==e.length)throw new hc("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+e.length+" vs "+t.length+")");if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:Object(Kl.tb)(e,0)})))[0],r=1;r<t.length-1;++r)n=Object(Kl.dc)(n,t[r]);return n}))},t}(rp),Af=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.mergeFunction=function(e){return Object(Kl.ee)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Object(Kl.u)(t,e[n]);return t}))},t.className="Add",t}(Tf);Kl.rd.registerClass(Af);var Pf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.mergeFunction=function(e){return Object(Kl.ee)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Object(Kl.xc)(t,e[n]);return t}))},t.className="Multiply",t}(Tf);Kl.rd.registerClass(Pf);var Df=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.mergeFunction=function(e){return Object(Kl.ee)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Object(Kl.u)(t,e[n]);return Object(Kl.xc)(uc(1/e.length),t)}))},t.className="Average",t}(Tf);Kl.rd.registerClass(Df);var Rf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.mergeFunction=function(e){return Object(Kl.ee)((function(){for(var t=e[0],n=1;n<e.length;++n)t=Object(Kl.mc)(t,e[n]);return t}))},t.className="Maximum",t}(Tf);Kl.rd.registerClass(Rf);var Mf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.mergeFunction=function(e){return Object(Kl.ee)((function(){for(var t=e[0],n=1;n<e.length;++n)t=Object(Kl.rc)(t,e[n]);return t}))},t.className="Minimum",t}(Tf);Kl.rd.registerClass(Mf);var jf=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_AXIS=-1,null==t&&(t={}),n.axis=null==t.axis?n.DEFAULT_AXIS:t.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Zl(t,e),t.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new hc("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var t=!0,n=0,r=e=e;n<r.length;n++)if(null!=(c=r[n])){t=!1;break}if(!t){for(var o=[],i=0;i<e.length;++i){var a=e[i].slice();a.splice(this.axis,1);for(var s=!1,u=0,l=o;u<l.length;u++){var c=l[u];if(Kl.oe.arraysEqual(c,a)){s=!0;break}}s||o.push(a)}if(o.length>1)throw new hc("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},t.prototype.mergeFunction=function(e){var t=this;return Object(Kl.ee)((function(){return ch(e,t.axis)}))},t.prototype.computeOutputShape=function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new hc("A `Concatenate` layer should be called on a list of inputs.");for(var t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,o=0,i=t.slice(1);o<i.length;o++){var a=i[o];if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n},t.prototype.computeMask=function(e,t){throw new pc("computeMask has not been implemented for Concatenate yet")},t.prototype.getConfig=function(){var t={axis:this.axis},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Concatenate",t}(Tf);function Lf(e,t){for(;e<0;)e+=t;return e}Kl.rd.registerClass(jf);var Vf=function(e){function t(t){var n=e.call(this,t)||this;return n.axes=t.axes,n.normalize=null!=t.normalize&&t.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Zl(t,e),t.prototype.build=function(e){Kl.oe.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),"A `Dot` layer should be called on a list of exactly 2 inputs.");var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new pc("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new hc("Dimension incompatibility: "+t[r[0]]+" !== "+n[r[1]])},t.prototype.mergeFunction=function(e){if(2!==e.length)throw new hc("A `Dot` layer must be called on exactly 2 inputs, but received "+e.length+" input(s).");var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return Lf(t,e[n].shape.length)})):[Lf(this.axes,n.shape.length),Lf(this.axes,r.shape.length)],this.normalize&&(n=yp(n,t[0]),r=yp(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new pc("batchDot is not implemented for tensors of 4D or higher rank yet");if(Kl.oe.assert(e.shape.length>=2,"batchDot requires the rank of x to be >= 2, but got "+e.shape.length),Kl.oe.assert(e.shape.length>=2,"batchDot requires the rank of y to be >= 2, but got "+t.shape.length),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new pc("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,o=t.shape.length;null==n&&(n=[r-1,o-2]);var i=n;return Object(Kl.ee)((function(){var n,a;if(r>o){n=r-o;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(o>r){for(n=o-r,s=[],u=0;u<n;++u)s.push(1);e=e.reshape(e.shape.concat(s))}else n=0;if(a=2===e.shape.length&&2===t.shape.length?i[0]===i[1]?e.mulStrict(t).sum(i[0]):e.transpose([1,0]).mulStrict(t).sum(i[1]):e.matMul(t,i[0]!==e.shape.length-1||null,i[1]===t.shape.length-1||null),n>0){var l,c=[];for(u=l=r>o?r+o-3:r-1;u<l+n;++u)c.push(u);a=a.squeeze(c)}return 1===a.shape.length&&(a=a.expandDims(1)),a}))}(n,r,t)},t.prototype.interpretAxes=function(e,t){return Array.isArray(this.axes)?this.axes:[Lf(this.axes,e.length),Lf(this.axes,t.length)]},t.prototype.computeOutputShape=function(e){Kl.oe.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),"A `Dot` layer should be called on a list of exactly 2 inputs.");var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new pc("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var o=t.concat(n);return 1===o.length&&o.push(1),o},t.prototype.computeMask=function(e,t){throw new pc("computeMask has not been implemented for Dot yet")},t.prototype.getConfig=function(){var t={axes:this.axes,normalize:this.normalize},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Dot",t}(Tf);function Ff(e,t,n,r,o,i){var a;if(void 0===i&&(i=.001),2===e.rank)a=Object(Kl.J)(e,t,n,i,o,r);else if(3===e.rank)a=Object(Kl.K)(e,t,n,i,o,r);else{if(4!==e.rank)throw new pc("batchNormalization is not implemented for array of rank "+e.rank+" yet");a=Object(Kl.L)(e,t,n,i,o,r)}return a}Kl.rd.registerClass(Vf);var zf=function(e){function t(t){var n=this;return null==t&&(t={}),(n=e.call(this,t)||this).supportsMasking=!0,n.axis=null==t.axis?-1:t.axis,n.momentum=null==t.momentum?.99:t.momentum,n.epsilon=null==t.epsilon?.001:t.epsilon,n.center=null==t.center||t.center,n.scale=null==t.scale||t.scale,n.betaInitializer=Fh(t.betaInitializer||"zeros"),n.gammaInitializer=Fh(t.gammaInitializer||"ones"),n.movingMeanInitializer=Fh(t.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=Fh(t.movingVarianceInitializer||"ones"),n.betaConstraint=Vc(t.betaConstraint),n.gammaConstraint=Vc(t.gammaConstraint),n.betaRegularizer=uf(t.betaRegularizer),n.gammaRegularizer=uf(t.gammaRegularizer),n.stepCount=0,n}return Zl(t,e),t.prototype.build=function(e){e=$h(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new hc("Axis "+t+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new Jh({ndim:e.length,axes:(r={},r[t]=n,r)})];var r,o=[n];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var r=null!=t.training&&t.training,o=Wh(e),i=o.shape,a=i.length,s=oh(0,a),u=n.axis>=0?n.axis:n.axis+a;s.splice(u,1);var l=fc(1,a);l[u]=i[u];var c=s.slice();c.sort();var h=!Kl.oe.arraysEqual(c,oh(0,a).slice(0,a-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(l),t=n.movingVariance.read().reshape(l),r=n.center?n.beta.read().reshape(l):null,i=n.scale?n.gamma.read().reshape(l):null;return Ff(o,e,t,r,i,n.epsilon)}return Ff(o,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=function(e,t,n,r,o){return void 0===o&&(o=.001),Kl.oe.arraysEqual(r.slice().sort(),oh(0,e.rank-1))?function(e,t,n,r,o){return void 0===o&&(o=.001),Object(Kl.ee)((function(){var i=Object(Kl.vc)(e,r),a=i.mean,s=i.variance;return[Ff(e,a,s,n,t,o),a,s]}))}(e,t,n,r,o):function(e,t,n,r,o){return void 0===o&&(o=.001),Object(Kl.ee)((function(){for(var i=Object(Kl.vc)(e,r),a=i.mean,s=i.variance,u=[],l=0,c=oh(0,e.rank);l<c.length;l++){var h=c[l];-1!==r.indexOf(h)?u.push(1):u.push(e.shape[h])}var p=a.reshape(u),d=s.reshape(u),f=null==t?null:t.reshape(u),m=null==n?null:n.reshape(u);return[Ff(e,p,d,m,f,o),a,s]}))}(e,t,n,r,o)}(o,n.gamma.read(),n.beta.read(),s,n.epsilon),d=p[0],f=p[1],m=p[2],g=eh(s.map((function(e){return o.shape[e]}))),y=m.mul(uc(g/(g-(1+n.epsilon))));return function(){n.stepCount++;var e=Object(Kl.wc)(n.movingMean.read(),f,n.momentum,n.stepCount);n.movingMean.write(e);var t=Object(Kl.wc)(n.movingVariance.read(),y,n.momentum,n.stepCount);n.movingVariance.write(t)}(),d}))},t.prototype.getConfig=function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Vh(this.betaInitializer),gammaInitializer:Vh(this.gammaInitializer),movingMeanInitializer:Vh(this.movingMeanInitializer),movingVarianceInitializer:Vh(this.movingVarianceInitializer),betaRegularizer:af(this.betaRegularizer),gammaRegularizer:af(this.gammaRegularizer),betaConstraint:jc(this.betaConstraint),gammaConstraint:jc(this.gammaConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="BatchNormalization",t}(rp);Kl.rd.registerClass(zf);var Bf=function(e){function t(t){var n=this;if(null==t&&(t={}),(n=e.call(this,t)||this).dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)n.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new hc("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var r=void 0,o=void 0;if("number"==typeof t.padding[0])r=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new hc("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(r=t.padding[0],2!==t.padding[1].length)throw new hc("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");o=t.padding[1]}n.padding=[r,o]}return n.inputSpec=[new Jh({ndim:4})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){return e=$h(e),"channelsFirst"===this.dataFormat?[e[0],e[1],null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null]:[e[0],null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,e[3]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return function(e,t,n){return Object(Kl.ee)((function(){if(4!==e.rank)throw new hc("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new hc("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new hc("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Object(Kl.Lc)(e,r)}))}(Wh(e),n.padding,n.dataFormat)}))},t.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ZeroPadding2D",t}(rp);function Uf(e,t,n,r,o,i){return Object(Kl.ee)((function(){var a;Uc(o),function(e){Oc(qc,"PoolMode",e)}(i),$c(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==o&&(o="channelsLast"),null==i&&(i="max"),e=pf(e,o);var s="same"===r?"same":"valid";return a="max"===i?Object(Kl.lc)(e,t,n,s):Object(Kl.G)(e,t,n,s),"channelsFirst"===o&&(a=Object(Kl.ke)(a,[0,3,1,2])),a}))}Kl.rd.registerClass(Bf);var Wf=function(e){function t(t){var n=this;if(null==t.poolSize&&(t.poolSize=2),n=e.call(this,t)||this,"number"==typeof t.poolSize)n.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new hc("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));n.poolSize=t.poolSize}if(null==t.strides)n.strides=n.poolSize;else if("number"==typeof t.strides)n.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new hc("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));n.strides=t.strides}return n.padding=null==t.padding?"valid":t.padding,$c(n.padding),n.inputSpec=[new Jh({ndim:3})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){var t=cf((e=$h(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){n.invokeCallHook(e,t),e=ah(Wh(e),2);var r=n.poolingFunction(Wh(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Object(Kl.Nd)(r,[2])}))},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(rp),$f=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return Uc(o),$c(r),Uf(e,t,n,r,o,"max")},t.className="MaxPooling1D",t}(Wf);Kl.rd.registerClass($f);var qf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return Uc(o),$c(r),Uf(e,t,n,r,o,"avg")},t.className="AveragePooling1D",t}(Wf);Kl.rd.registerClass(qf);var Hf=function(e){function t(t){var n=this;if(null==t.poolSize&&(t.poolSize=[2,2]),(n=e.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)n.strides=n.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new hc("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");n.strides=t.strides}else n.strides=[t.strides,t.strides];return n.padding=null==t.padding?"valid":t.padding,n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Uc(n.dataFormat),$c(n.padding),n.inputSpec=[new Jh({ndim:4})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){e=$h(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=cf(t,this.poolSize[0],this.padding,this.strides[0]),n=cf(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Wh(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(rp),Gf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return Uc(o),$c(r),Uf(e,t,n,r,o,"max")},t.className="MaxPooling2D",t}(Hf);Kl.rd.registerClass(Gf);var Kf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return Uc(o),$c(r),Uf(e,t,n,r,o,"avg")},t.className="AveragePooling2D",t}(Hf);Kl.rd.registerClass(Kf);var Xf=function(e){function t(t){var n=e.call(this,t)||this;return n.inputSpec=[new Jh({ndim:3})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){return[e[0],e[2]]},t.prototype.call=function(e,t){throw new pc},t}(rp),Zf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.call=function(e,t){return Object(Kl.ee)((function(){var t=Wh(e);return Object(Kl.oc)(t,1)}))},t.className="GlobalAveragePooling1D",t}(Xf);Kl.rd.registerClass(Zf);var Qf=function(e){function t(t){return e.call(this,t)||this}return Zl(t,e),t.prototype.call=function(e,t){return Object(Kl.ee)((function(){var t=Wh(e);return Object(Kl.kc)(t,1)}))},t.className="GlobalMaxPooling1D",t}(Xf);Kl.rd.registerClass(Qf);var Jf=function(e){function t(t){var n=e.call(this,t)||this;return n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Uc(n.dataFormat),n.inputSpec=[new Jh({ndim:4})],n}return Zl(t,e),t.prototype.computeOutputShape=function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]},t.prototype.call=function(e,t){throw new pc},t.prototype.getConfig=function(){var t={dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(rp),Yf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t=Wh(e);return"channelsLast"===n.dataFormat?Object(Kl.oc)(t,[1,2]):Object(Kl.oc)(t,[2,3])}))},t.className="GlobalAveragePooling2D",t}(Jf);Kl.rd.registerClass(Yf);var em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var t=Wh(e);return"channelsLast"===n.dataFormat?Object(Kl.kc)(t,[1,2]):Object(Kl.kc)(t,[2,3])}))},t.className="GlobalMaxPooling2D",t}(Jf);function tm(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new hc("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function o(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=o(t),constants:n=o(n)}}function nm(e,t,n,r,o,i,a,s){void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===s&&(s=!1);var u=t.shape.length;if(u<3)throw new hc("Input should be at least 3D, but is "+u+"D.");var l,c,h=[1,0].concat(oh(2,u));if(t=Object(Kl.ke)(t,h),null!=o)throw new pc("The rnn() function of the deeplearn.js backend does not support masking yet.");if(null!=i)throw new pc("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r&&(t=Object(Kl.fd)(t,0));for(var p=n,d=t.shape[0],f=function(n){var r=sh(t,n,1);r=r.reshape(r.shape.slice(1));var o=Object(Kl.ee)((function(){return e(r,p)}));if(c=o[0],s)if(0===n)l=c.expandDims(1);else{var i=Object(Kl.T)([l,c.expandDims(1)],1);l.dispose(),l=i}p=o[1]},m=0;m<d;++m)f(m);return[c,l,p]}Kl.rd.registerClass(em);var rm=function(e){function t(t){var n,r=e.call(this,t)||this;if(null==t.cell)throw new hc("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(t.cell)?new hm({cells:t.cell}):t.cell).stateSize)throw new hc("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=t.returnSequences&&t.returnSequences,r.returnState=null!=t.returnState&&t.returnState,r.goBackwards=null!=t.goBackwards&&t.goBackwards,r._stateful=null!=t.stateful&&t.stateful,r.unroll=null!=t.unroll&&t.unroll,r.supportsMasking=!0,r.inputSpec=[new Jh({ndim:3})],r.stateSpec=null,r.states=null,r.numConstants=null,r.keptStates=[],r}return Zl(t,e),t.prototype.getStates=function(){return null==this.states?oh(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states},t.prototype.setStates=function(e){this.states=e},t.prototype.computeOutputShape=function(e){Bh(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){for(var o=[],i=0,a=t;i<a.length;i++)o.push([e[0],a[i]]);return[n].concat(o)}return n},t.prototype.computeMask=function(e,t){Array.isArray(t)&&(t=t[0]);var n=this.returnSequences?t:null;if(this.returnState){var r=this.states.map((function(e){return null}));return[n].concat(r)}return n},t.prototype.build=function(e){if(null!=this.numConstants)throw new pc("Constants support is not implemented in RNN yet.");Bh(e)&&(e=e[0]),e=e,this.inputSpec[0]=new Jh({shape:[this.stateful?e[0]:null,null,e[e.length-1]]});var t,n=[e[0]].concat(e.slice(2));if(this.cell.build(n),t=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Kl.oe.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),t))throw new hc("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=t.map((function(e){return new Jh({shape:[null,e]})}));this.stateful&&this.resetStates()},t.prototype.resetStates=function(e,t){var n=this;void 0===t&&(t=!1),Object(Kl.ee)((function(){if(!n.stateful)throw new lc("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new hc("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states)n.states=Array.isArray(n.cell.stateSize)?n.cell.stateSize.map((function(e){return Object(Kl.xe)([r,e])})):[Object(Kl.xe)([r,n.cell.stateSize])];else if(null==e)Object(Kl.ib)(n.states),null!=n.keptStates&&(Object(Kl.ib)(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states=n.cell.stateSize.map((function(e){return Object(Kl.xe)([r,e])})):n.states[0]=Object(Kl.xe)([r,n.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==n.states.length)throw new hc("Layer "+n.name+" expects "+n.states.length+" state(s), but it received "+e.length+" state value(s). Input received: "+e);!0===t?n.keptStates.push(n.states.slice()):Object(Kl.ib)(n.states);for(var o=0;o<n.states.length;++o){var i=e[o],a=Array.isArray(n.cell.stateSize)?n.cell.stateSize[o]:n.cell.stateSize,s=[r,a];if(!Kl.oe.arraysEqual(i.shape,s))throw new hc("State "+o+" is incompatible with layer "+n.name+": expected shape="+s+", received shape="+i.shape);n.states[o]=i}}n.states.forEach((function(e){return Object(Kl.Pb)(e)}))}))},t.prototype.apply=function(t,n){var r=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var i=tm(t,r,o,this.numConstants);t=i.inputs,o=i.constants;var a=[],s=[];if(null!=(r=i.initialState)){n.initialState=r,a=a.concat(r),this.stateSpec=[];for(var u=0,l=r;u<l.length;u++)this.stateSpec.push(new Jh({shape:l[u].shape}));s=s.concat(this.stateSpec)}if(null!=o&&(n.constants=o,a=a.concat(o),this.numConstants=o.length),a[0]instanceof Yh){var c=[t].concat(a),h=this.inputSpec.concat(s),p=this.inputSpec;this.inputSpec=h;var d=e.prototype.apply.call(this,c,n);return this.inputSpec=p,d}return e.prototype.apply.call(this,t,n)},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var r=null==t?null:t.mask,o=null==t?null:t.training,i=null==t?null:t.initialState;if(e=Wh(e),null==i&&(i=n.stateful?n.states:n.getInitialState(e)),null!=r)throw new pc("Masking is not implemented for RNN yet");var a=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==a)throw new hc("RNN Layer has "+a+" state(s) but was passed "+i.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:o},u=nm((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,null,null,n.unroll,n.returnSequences),l=u[0],c=u[1],h=u[2];n.stateful&&n.resetStates(h,o);var p=n.returnSequences?c:l;return n.returnState?[p].concat(h):p}))},t.prototype.getInitialState=function(e){var t=this;return Object(Kl.ee)((function(){var n=Object(Kl.xe)(e.shape);return n=ah(n=Object(Kl.Td)(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?ph(n,[1,e]):n})):t.cell.stateSize>1?[ph(n,[1,t.cell.stateSize])]:[n]}))},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var n=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:n};var r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},t.className="RNN",t}(rp);Kl.rd.registerClass(rm);var om=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t}(rp),im=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=Zd(null==t.activation?n.DEFAULT_ACTIVATION:t.activation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=Fh(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Fh(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Fh(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=uf(t.kernelRegularizer),n.recurrentRegularizer=uf(t.recurrentRegularizer),n.biasRegularizer=uf(t.biasRegularizer),n.kernelConstraint=Vc(t.kernelConstraint),n.recurrentConstraint=Vc(t.recurrentConstraint),n.biasConstraint=Vc(t.biasConstraint),n.dropout=nh([1,rh([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=nh([1,rh([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Zl(t,e),t.prototype.build=function(e){e=$h(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){if(2!==(e=e).length)throw new hc("SimpleRNNCell expects 2 input Tensors, got "+e.length+".");var r=e[1];e=e[0];var o,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=pm((function(){return Object(Kl.Ic)(e)}),n.dropout,i)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=pm((function(){return Object(Kl.Ic)(r)}),n.recurrentDropout,i));var a=n.dropoutMask,s=n.recurrentDropoutMask;o=fh(null!=a?Object(Kl.xc)(e,a):e,n.kernel.read()),null!=n.bias&&(o=yh(o,n.bias.read())),null!=s&&(r=Object(Kl.xc)(r,s));var u=Object(Kl.u)(o,fh(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="SimpleRNNCell",t}(om);Kl.rd.registerClass(im);var am=function(e){function t(t){return t.cell=new im(t),e.call(this,t)||this}return Zl(t,e),t.prototype.call=function(t,n){var r=this;return Object(Kl.ee)((function(){return null!=r.cell.dropoutMask&&(Object(Kl.ib)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(Kl.ib)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),e.prototype.call.call(r,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.className="SimpleRNN",t}(rm);Kl.rd.registerClass(am);var sm=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=Zd(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=Zd(void 0===t.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=Fh(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Fh(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Fh(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=uf(t.kernelRegularizer),n.recurrentRegularizer=uf(t.recurrentRegularizer),n.biasRegularizer=uf(t.biasRegularizer),n.kernelConstraint=Vc(t.kernelConstraint),n.recurrentConstraint=Vc(t.recurrentConstraint),n.biasConstraint=Vc(t.biasConstraint),n.dropout=nh([1,rh([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=nh([1,rh([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Zl(t,e),t.prototype.build=function(e){var t=(e=$h(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){if(2!==(e=e).length)throw new hc("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var r=null!=t.training&&t.training,o=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=pm((function(){return Object(Kl.Ic)(e)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=pm((function(){return Object(Kl.Ic)(o)}),n.recurrentDropout,r,3));var i,a,s,u=n.dropoutMask,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Object(Kl.xc)(e,u[0]));var c=fh(e,n.kernel.read());n.useBias&&(c=yh(c,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(o=Object(Kl.xc)(o,l[0]));var h=n.recurrentKernel.read(),p=Object(Kl.Id)(h,[2*n.units,n.units],h.rank-1),d=p[1],f=fh(o,p[0]),m=Object(Kl.Id)(c,3,c.rank-1),g=m[0],y=m[1],v=m[2],b=Object(Kl.Id)(f,2,f.rank-1),w=b[0],x=b[1];i=n.recurrentActivation.apply(Object(Kl.u)(g,w)),a=n.recurrentActivation.apply(Object(Kl.u)(y,x));var _=fh(Object(Kl.xc)(a,o),d);s=n.activation.apply(Object(Kl.u)(v,_));var N=Object(Kl.u)(Object(Kl.xc)(i,o),Object(Kl.xc)(Object(Kl.u)(uc(1),Object(Kl.Bc)(i)),s));return[N,N]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),recurrentActivation:Kd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="GRUCell",t}(om);Kl.rd.registerClass(sm);var um=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new sm(t),e.call(this,t)||this}return Zl(t,e),t.prototype.call=function(t,n){var r=this;return Object(Kl.ee)((function(){return null!=r.cell.dropoutMask&&(Object(Kl.ib)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(Kl.ib)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),e.prototype.call.call(r,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),recurrentActivation:Kd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t.className="GRU",t}(rm);Kl.rd.registerClass(um);var lm=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=Zd(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=Zd(void 0===t.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=Fh(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Fh(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Fh(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=t.unitForgetBias,n.kernelRegularizer=uf(t.kernelRegularizer),n.recurrentRegularizer=uf(t.recurrentRegularizer),n.biasRegularizer=uf(t.biasRegularizer),n.kernelConstraint=Vc(t.kernelConstraint),n.recurrentConstraint=Vc(t.recurrentConstraint),n.biasConstraint=Vc(t.biasConstraint),n.dropout=nh([1,rh([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=nh([1,rh([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Zl(t,e),t.prototype.build=function(e){var t,n,r=(e=$h(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,i=this.units;t=new((n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zl(t,e),t.prototype.apply=function(e,t){var n=o.apply([i]),r=(new Eh).apply([i]),a=o.apply([2*i]);return hh(hh(n,r),a)},t}(_h)).className="CustomInit",n)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,t,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){var r=null!=t.training&&t.training;if(3!==(e=e).length)throw new hc("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var o=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=pm((function(){return Object(Kl.Ic)(e)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=pm((function(){return Object(Kl.Ic)(o)}),n.recurrentDropout,r,4));var a,s,u,l,c=n.dropoutMask,h=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Object(Kl.xc)(e,c[0]));var p=fh(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(o=Object(Kl.xc)(o,h[0])),p=Object(Kl.u)(p,fh(o,n.recurrentKernel.read())),n.useBias&&(p=yh(p,n.bias.read()));var d=Object(Kl.Id)(p,4,p.rank-1),f=d[1],m=d[2],g=d[3];a=n.recurrentActivation.apply(d[0]),s=n.recurrentActivation.apply(f),u=Object(Kl.u)(Object(Kl.xc)(s,i),Object(Kl.xc)(a,n.activation.apply(m))),l=n.recurrentActivation.apply(g);var y=Object(Kl.xc)(l,n.activation.apply(u));return[y,y,u]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),recurrentActivation:Kd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="LSTMCell",t}(om);Kl.rd.registerClass(lm);var cm=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new lm(t),e.call(this,t)||this}return Zl(t,e),t.prototype.call=function(t,n){var r=this;return Object(Kl.ee)((function(){return null!=r.cell.dropoutMask&&(Object(Kl.ib)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(Kl.ib)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),e.prototype.call.call(r,t,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:Kd(this.activation),recurrentActivation:Kd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vh(this.kernelInitializer),recurrentInitializer:Vh(this.recurrentInitializer),biasInitializer:Vh(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:af(this.kernelRegularizer),recurrentRegularizer:af(this.recurrentRegularizer),biasRegularizer:af(this.biasRegularizer),activityRegularizer:af(this.activityRegularizer),kernelConstraint:jc(this.kernelConstraint),recurrentConstraint:jc(this.recurrentConstraint),biasConstraint:jc(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t.className="LSTM",t}(rm);Kl.rd.registerClass(cm);var hm=function(e){function t(t){var n=e.call(this,t)||this;return n.cells=t.cells,n}return Zl(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var e=[],t=0,n=this.cells.slice().reverse();t<n.length;t++){var r=n[t];Array.isArray(r.stateSize)?e.push.apply(e,r.stateSize):e.push(r.stateSize)}return e},enumerable:!0,configurable:!0}),t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){for(var r=(e=e).slice(1),o=[],i=0,a=n.cells.slice().reverse();i<a.length;i++){var s=a[i];Array.isArray(s.stateSize)?o.push(r.splice(0,s.stateSize.length)):o.push(r.splice(0,1))}o.reverse();for(var u,l=[],c=0;c<n.cells.length;++c)s=n.cells[c],r=o[c],u=0===c?[e[0]].concat(r):[u[0]].concat(r),u=s.call(u,t),l.push(u.slice(1));r=[];for(var h=0,p=l.slice().reverse();h<p.length;h++)r.push.apply(r,p[h]);return[u[0]].concat(r)}))},t.prototype.build=function(e){var t;Bh(e)&&(e=e[0]),e=e;for(var n=0,r=this.cells;n<r.length;n++){var o=r[n];o.build(e),t=Array.isArray(o.stateSize)?o.stateSize[0]:o.stateSize,e=[e[0],t]}this.built=!0},t.prototype.getConfig=function(){for(var t=[],n=0,r=this.cells;n<r.length;n++){var o=r[n];t.push({className:this.getClassName(),config:o.getConfig()})}var i={cells:t},a=e.prototype.getConfig.call(this);return Object.assign(i,a),i},t.fromConfig=function(e,t,n){void 0===n&&(n={});for(var r=[],o=0,i=t.cells;o<i.length;o++)r.push(Qp(i[o],n));return new e({cells:r})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var e=[],t=0,n=this.cells;t<n.length;t++)e.push.apply(e,n[t].trainableWeights);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,n=this.cells;t<n.length;t++){var r=n[t];e.push.apply(e,r.nonTrainableWeights)}if(!this.trainable){for(var o=[],i=0,a=this.cells;i<a.length;i++)o.push.apply(o,(r=a[i]).trainableWeights);return o.concat(e)}return e},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var e=[],t=0,n=this.cells;t<n.length;t++)e.push.apply(e,n[t].weights);return Kh(e)},t.prototype.setWeights=function(e){for(var t=[],n=0,r=this.cells;n<r.length;n++)for(var o=r[n],i=e.splice(o.weights.length),a=0;a<o.weights.length;++a)t.push([o.weights[a],i[a]]);Xh(t)},t.className="StackedRNNCells",t}(om);function pm(e,t,n,r){function o(){return vh(e(),uc(t))}if(void 0===n&&(n=null),void 0===r&&(r=1),r>1){for(var i=[],a=0;a<r;a++)i.push(bh(o,e,n));return i.forEach((function(e){return Object(Kl.Pb)(e)})),i}return Object(Kl.Pb)(bh(o,e,n))}Kl.rd.registerClass(hm);var dm=function(e){function t(t){var n=e.call(this,t)||this;return n.layer=t.layer,n}return Zl(t,e),t.prototype.build=function(e){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(e){this.layer.setWeights(e)},t.prototype.getConfig=function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t,n){void 0===n&&(n={});var r=Qp(t.layer,n);delete t.layer;var o={layer:r};return Object.assign(o,t),new e(o)},t}(rp),fm=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n}return Zl(t,e),t.prototype.build=function(t){if((t=$h(t)).length<3)throw new hc("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];var n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),e.prototype.build.call(this,t)},t.prototype.computeOutputShape=function(e){var t=[(e=$h(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t);return[n[0],e[1]].concat(n.slice(1))},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){return nm((function(e,r){return[Wh(n.layer.call(e,t)),[]]}),e=Wh(e),[],!1,null,null,!1,!0)[1]}))},t.className="TimeDistributed",t}(dm);Kl.rd.registerClass(fm);var mm=["sum","mul","concat","ave"],gm=function(e){function t(t){var n=e.call(this,t)||this,r=t.layer.getConfig();if(n.forwardLayer=Qp({className:t.layer.getClassName(),config:r}),r.goBackwards=!0!==r.goBackwards,n.backwardLayer=Qp({className:t.layer.getClassName(),config:r}),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,function(e){Oc(mm,"BidirectionalMergeMode",e)}(t.mergeMode),n.mergeMode=t.mergeMode,t.weights)throw new pc("weights support is not implemented for Bidirectional layer yet.");return n._stateful=t.layer.stateful,n.returnSequences=t.layer.returnSequences,n.returnState=t.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=t.layer.inputSpec,n.numConstants=null,n}return Zl(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(e){var t=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,t)),this.backwardLayer.setWeights(e.slice(t))},t.prototype.computeOutputShape=function(e){var t,n,r,o=this.forwardLayer.computeOutputShape(e);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState?(r=o.slice(1),t=o[0]):t=o[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):yc(n)},t.prototype.apply=function(t,n){var r=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var i=tm(t,r,o,this.numConstants);if(t=i.inputs,r=i.initialState,o=i.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(null==r||0===r.length)&&null==o)return e.prototype.apply.call(this,t,n);var a=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new hc("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,a.push.apply(a,r);var l=r.map((function(e){return new Jh({shape:e.shape})}));this.forwardLayer.stateSpec=l.slice(0,u/2),this.backwardLayer.stateSpec=l.slice(u/2),s.push.apply(s,l)}if(null!=o)throw new pc("Support for constants in Bidirectional layers is not implemented yet.");for(var c=a[0]instanceof Yh,h=0,p=a;h<p.length;h++)if(p[h]instanceof Yh!==c)throw new hc("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){var d=[t].concat(a),f=this.inputSpec.concat(s),m=this.inputSpec;this.inputSpec=f;var g=e.prototype.apply.call(this,d,n);return this.inputSpec=m,g}return e.prototype.apply.call(this,t,n)},t.prototype.call=function(e,t){var n=this;return Object(Kl.ee)((function(){if(null!=t.mask)throw new pc("The support for masking is not implemented for Bidirectional layers yet.");var r,o,i,a,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),o=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),l=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),o=n.backwardLayer.call(e,Object.assign(t,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),n.returnSequences&&(o=Object(Kl.fd)(o,1)),"concat"===n.mergeMode?a=ch([r,o]):"sum"===n.mergeMode?a=Object(Kl.u)(r,o):"ave"===n.mergeMode?a=Object(Kl.xc)(uc(.5),Object(Kl.u)(r,o)):"mul"===n.mergeMode?a=Object(Kl.xc)(r,o):null==n.mergeMode&&(a=[r,o]),n.returnState?null==n.mergeMode?a.concat(i):[a].concat(i):a}))},t.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(e){var t=this;Kc(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Kc(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={mergeMode:this.mergeMode},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t){var n=Qp(t.layer);if(delete t.layer,null!=t.numConstants)throw new pc("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)},t.className="Bidirectional",t}(dm);function ym(e){return new qf(e)}function vm(e){return new Kf(e)}function bm(e){return new Qf(e)}function wm(e){return new em(e)}function xm(e){return new $f(e)}function _m(e){return new Gf(e)}Kl.rd.registerClass(gm);var Nm=Object.freeze({inputLayer:function(e){return new op(e)},elu:function(e){return new Yd(e)},reLU:function(e){return new Qd(e)},leakyReLU:function(e){return new Jd(e)},softmax:function(e){return new tf(e)},thresholdedReLU:function(e){return new ef(e)},conv1d:function(e){return new vf(e)},conv2d:function(e){return new mf(e)},conv2dTranspose:function(e){return new gf(e)},separableConv2d:function(e){return new yf(e)},cropping2D:function(e){return new bf(e)},upSampling2d:function(e){return new wf(e)},depthwiseConv2d:function(e){return new xf(e)},activation:function(e){return new Cf(e)},dense:function(e){return new Nf(e)},dropout:function(e){return new _f(e)},flatten:function(e){return new Ef(e)},repeatVector:function(e){return new If(e)},reshape:function(e){return new Of(e)},permute:function(e){return new Sf(e)},embedding:function(e){return new kf(e)},add:function(e){return new Af(e)},average:function(e){return new Df(e)},concatenate:function(e){return new jf(e)},maximum:function(e){return new Rf(e)},minimum:function(e){return new Mf(e)},multiply:function(e){return new Pf(e)},dot:function(e){return new Vf(e)},batchNormalization:function(e){return new zf(e)},zeroPadding2d:function(e){return new Bf(e)},averagePooling1d:ym,avgPool1d:function(e){return ym(e)},avgPooling1d:function(e){return ym(e)},averagePooling2d:vm,avgPool2d:function(e){return vm(e)},avgPooling2d:function(e){return vm(e)},globalAveragePooling1d:function(e){return new Zf(e)},globalAveragePooling2d:function(e){return new Yf(e)},globalMaxPooling1d:bm,globalMaxPooling2d:wm,maxPooling1d:xm,maxPooling2d:_m,gru:function(e){return new um(e)},gruCell:function(e){return new sm(e)},lstm:function(e){return new cm(e)},lstmCell:function(e){return new lm(e)},simpleRNN:function(e){return new am(e)},simpleRNNCell:function(e){return new im(e)},rnn:function(e){return new rm(e)},stackedRNNCells:function(e){return new hm(e)},bidirectional:function(e){return new gm(e)},timeDistributed:function(e){return new fm(e)},globalMaxPool1d:bm,globalMaxPool2d:wm,maxPool1d:xm,maxPool2d:_m,Layer:rp,RNN:rm,RNNCell:om,input:Rd}),Em=Object.freeze({modelFromJSON:function(e,t){return Jl(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l;return Yl(this,(function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),null!=(n=(e=e).modelTopology).model_config&&(n=n.model_config),r=Yp(n),o=Qp(r,t),null==e.weightsManifest?[3,2]:[4,Kl.Nb.loadWeights(e.weightsManifest,e.pathPrefix,o.weights.map((function(e){return e.originalName})))];case 1:for(i=c.sent(),a={},s=0,u=o.weights;s<u.length;s++)a[(l=u[s]).originalName]=i[l.originalName];o.loadWeights(a,null,!0),c.label=2;case 2:return[2,o]}}))}))}}),Cm=Object.freeze({binaryAccuracy:function(e,t){return Dp(e,t)},binaryCrossentropy:function(e,t){return Lp(e,t)},sparseCategoricalAccuracy:function(e,t){return Vp(e,t)},categoricalAccuracy:function(e,t){return Rp(e,t)},categoricalCrossentropy:function(e,t){return qp(e,t)},precision:function(e,t){return jp(e,t)},recall:function(e,t){return function(e,t){return Object(Kl.ee)((function(){var n=uc(0),r=Mp(e,t),o=function(e,t){return Object(Kl.ee)((function(){var n=uc(1),r=uc(0);return Object(Kl.dc)(e.equal(n),t.equal(r)).sum().cast("float32")}))}(e,t),i=r.add(o);return Object(Kl.ve)(Object(Kl.Gb)(i,n),r.div(i),n).cast("float32")}))}(e,t)},cosineProximity:function(e,t){return Ap(e,t)},meanAbsoluteError:function(e,t){return bp(e,t)},meanAbsolutePercentageError:function(e,t){return wp(e,t)},MAPE:function(e,t){return wp(e,t)},mape:function(e,t){return wp(e,t)},meanSquaredError:function(e,t){return vp(e,t)},MSE:function(e,t){return vp(e,t)},mse:function(e,t){return vp(e,t)}}),Im=Object.freeze({l1l2:function(e){return new rf(e)},l1:function(e){return function(e){return new rf({l1:null!=e?e.l1:null,l2:0})}(e)},l2:function(e){return function(e){return new rf({l2:null!=e?e.l2:null,l1:0})}(e)}}),Om=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t}return Zl(t,e),t.prototype.setModel=function(e){if(!(e instanceof Sd))throw new Error("model must be a Model, not some other Container");this.model=e},t}(up),Sm=n("tgWb"),km=n("oY9k"),Tm=n.n(km),Am=function(e,t){return(Am=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Pm(e,t){function n(){this.constructor=e}Am(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Dm(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function Rm(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Mm="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function jm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Lm(e,t){return e(t={exports:{}},t.exports),t.exports}var Vm=Lm((function(e){!function(e,t,n){function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new function(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}(e),o=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.alea=o}(0,e)})),Fm=Lm((function(e){!function(e,t,n){function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new function(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xor128=o}(0,e)})),zm=Lm((function(e){!function(e,t,n){function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xorwow=o}(0,e)})),Bm=Lm((function(e){!function(e,t,n){function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.x&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xorshift7=o}(0,e)})),Um=Lm((function(e){!function(e,t,n){function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n=o[i]=(n^=n>>>15)^(e^=e>>>12),t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),o=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=0==(n=s[127&i]^=r+(a=a+1640531527|0))?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,s[o]=(r^=r>>>15)^(n^=n>>>12);e.w=a,e.X=s,e.i=o}(t,e)}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&(o.X&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.xor4096=o}(0,e)})),Wm=Lm((function(e){!function(e,t,n){function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}(e),o=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,o&&("object"==typeof o&&r(o,n),i.state=function(){return r(n,{})}),i}t&&t.exports?t.exports=o:this.tychei=o}(0,e)})),$m=Lm((function(e){!function(t,r){var o,i=(0,eval)("this"),a=256,s=6,u="random",l=r.pow(a,s),c=r.pow(2,52),h=2*c,p=a-1;function d(e,n,d){var y=[],v=m(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(a):(e=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,g(t)]}}():e,3),y),b=new function(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=p&i+e[o%n]+(t=s[o])],s[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,s=r.S;e--;)t=s[o=p&o+1],n=n*a+s[p&(s[o]=s[i=p&i+t])+(s[i]=t)];return r.i=o,r.j=i,n})(a)}(y),w=function(){for(var e=b.g(s),t=l,n=0;e<c;)e=(e+n)*a,t*=a,n=b.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,m(g(b.S),t),(n.pass||d||function(e,t,n,o){return o&&(o.S&&f(o,b),e.state=function(){return f(b,{})}),n?(r[u]=e,t):e})(w,v,"global"in n?n.global:this==r,n.state)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",o=0;o<r.length;)t[p&o]=p&(n^=19*t[p&o])+r.charCodeAt(o++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+u]=d,m(r.random(),t),e.exports){e.exports=d;try{o=n(!function(){var e=new Error("Cannot find module 'crypto'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){}}}([],Math)}));$m.alea=Vm,$m.xor128=Fm,$m.xorwow=zm,$m.xorshift7=Bm,$m.xor4096=Um,$m.tychei=Wm;var qm=$m.alea,Hm=Lm((function(e,t){function n(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function r(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function o(e,t){if(void 0===t&&(t=[]),Array.isArray(e))for(var n=0;n<e.length;++n)o(e[n],t);else t.push(e);return t}function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function a(e,t){if("float32"!==t)for(var n=0;n<e.length;n++)if(isNaN(e[n]))throw Error("NaN is not a valid value for dtype: '"+t+"'.")}function s(e){return"string"==typeof e||e instanceof String}function u(e){return"boolean"==typeof e}function l(e){return"number"==typeof e}function c(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function h(e){for(;e instanceof Array;)e=e[0];return e}Object.defineProperty(t,"__esModule",{value:!0}),t.shuffle=n,t.clamp=function(e,t,n){return Math.max(e,Math.min(t,n))},t.nearestLargerEven=function(e){return e%2==0?e:e+1},t.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},t.randUniform=function(e,t){var n=Math.random();return t*n+(1-n)*e},t.distSquared=function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},t.assert=r,t.assertShapesMatch=function(e,t,n){void 0===n&&(n=""),r(i(e,t),n+" Shapes "+e+" and "+t+" must match")},t.assertNonNull=function(e){r(null!=e,"The input to the tensor constructor must be a non-null value.")},t.flatten=o,t.sizeFromShape=function(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t},t.isScalarShape=function(e){return 0===e.length},t.arraysEqual=i,t.isInt=function(e){return e%1==0},t.tanh=function(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)},t.sizeToSquarishShape=function(e){for(var t=Math.floor(Math.sqrt(e));t>1;--t)if(e%t==0)return[t,e/t];return[1,e]},t.createShuffledIndices=function(e){for(var t=new Uint32Array(e),r=0;r<e;++r)t[r]=r;return n(t),t},t.rightPad=function(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)},t.repeatedTry=function(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var i=0,a=function(){if(e())r();else{var s=t(++i);null!=n&&i>=n?o():setTimeout(a,s)}};a()}))},t.inferFromImplicitShape=function(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i},t.squeezeShape=function(e,t){for(var n=[],r=[],o=0,i=0;i<e.length;++i){if(null!=t){if(t[o]===i&&1!==e[i])throw new Error("Can't squeeze axis "+i+" since its dim '"+e[i]+"' is not 1");(null==t[o]||t[o]>i)&&1===e[i]&&(n.push(e[i]),r.push(i)),t[o]<=i&&o++}1!==e[i]&&(n.push(e[i]),r.push(i))}return{newShape:n,keptDims:r}},t.getTypedArrayFromDType=function(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n},t.getArrayFromDType=function(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n},t.checkComputationForNaN=function(e,t,n){if("float32"===t)for(var r=0;r<e.length;r++)if(isNaN(e[r]))throw Error("The result of the '"+n+"' has NaNs.")},t.checkConversionForNaN=a,t.hasEncodingLoss=function(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)},t.isTypedArray=function(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array},t.bytesPerElement=function(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)},t.bytesFromStringArray=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=2*e.length})),t},t.isString=s,t.isBoolean=u,t.isNumber=l,t.inferDtype=function(e){return e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":l(e)||e instanceof Array&&l(h(e))?"float32":s(e)||e instanceof Array&&s(h(e))?"string":u(e)||e instanceof Array&&u(h(e))?"bool":"float32"},t.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},t.nearestDivisor=function(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e},t.computeStrides=function(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n},t.toTypedArray=function(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(Array.isArray(e)&&(e=o(e)),null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return n&&a(e,t),new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)0!==Math.round(e[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+t)},t.makeOnesTypedArray=function(e,t){for(var n=c(e,t),r=0;r<n.length;r++)n[r]=1;return n},t.makeZerosTypedArray=c,t.now=function(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")}}));jm(Hm);var Gm=Lm((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=7;function r(e,t){var r;return r=Array.isArray(e)?parseFloat(e[0].toFixed(n))+" + "+parseFloat(e[1].toFixed(n))+"j":Hm.isString(e)?"'"+e+"'":parseFloat(e.toFixed(n)).toString(),Hm.rightPad(r,t)}function o(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}t.tensorToString=function(e,t,n,i){var a=Hm.computeStrides(t),s=function(e,t,n,i){var a=Hm.sizeFromShape(t),s=i[i.length-1],u=new Array(s).fill(0),l=t.length,c="complex64"===n?o(e):e;if(l>1)for(var h=0;h<a/s;h++)for(var p=h*s,d=0;d<s;d++)u[d]=Math.max(u[d],r(c[p+d],0).length);return u}(e,t,n,a),u=t.length,l=function e(t,n,i,a,s,u){void 0===u&&(u=!0);var l="complex64"===i?2:1,c=n[0],h=n.length;if(0===h)return"complex64"===i?[r(o(t)[0],0)]:[t[0].toString()];if(1===h){if(c>20){var p=Array.from(t.slice(0,3*l)),d=Array.from(t.slice(c-3*l,c));return"complex64"===i&&(p=o(p),d=o(d)),["["+p.map((function(e,t){return r(e,s[t])})).join(", ")+", ..., "+d.map((function(e,t){return r(e,s[c-3+t])})).join(", ")+"]"]}return["["+("complex64"===i?o(t):Array.from(t)).map((function(e,t){return r(e,s[t])})).join(", ")+"]"]}var f=n.slice(1),m=a.slice(1),g=a[0]*l,y=[];if(c>20){for(var v=0;v<3;v++)y.push.apply(y,e(t.slice(b=v*g,b+g),f,i,m,s,!1));for(y.push("..."),v=c-3;v<c;v++)y.push.apply(y,e(t.slice(b=v*g,b+g),f,i,m,s,v===c-1))}else for(v=0;v<c;v++){var b;y.push.apply(y,e(t.slice(b=v*g,b+g),f,i,m,s,v===c-1))}var w=2===h?",":"";for(y[0]="["+y[0]+w,v=1;v<y.length-1;v++)y[v]=" "+y[v]+w;var x=",\n";for(v=2;v<h;v++)x+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(u?"":x),y}(e,t,n,a,s),c=["Tensor"];return i&&(c.push("  dtype: "+n),c.push("  rank: "+u),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map((function(e){return"    "+e})).join("\n")),c.join("\n")}}));jm(Gm);var Km=Lm((function(e,t){var n,r=Mm&&Mm.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=Mm&&Mm.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=Mm&&Mm.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=Hm,s=function(){function e(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Hm.sizeFromShape(e),null!=n){var r=n.length;Hm.assert(r===this.size,"Length of values '"+r+"' does not match the size inferred by the shape '"+this.size+"'.")}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Hm.getArrayFromDType(t,Hm.sizeFromShape(this.shape)),this.strides=a.computeStrides(e)}return e.prototype.set=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];0===t.length&&(t=[0]),Hm.assert(t.length===this.rank,"The number of provided coordinates ("+t.length+") must match the rank ("+this.rank+")");var r=this.locToIndex(t);this.values[r]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return c.make(this.shape,{values:this.values},this.dtype)},e}();t.TensorBuffer=s;var u=null,l=null;t.setTensorTracker=function(e){u=e},t.setOpHandler=function(e){l=e};var c=function(){function e(e,t,n,r){this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Hm.sizeFromShape(e),null!=n&&Hm.assert(this.size===n.length,"Based on the provided shape, ["+e+"], and dtype "+this.dtype+", the tensor should have "+this.size+" values but has "+n.length),this.strides=a.computeStrides(e),this.dataId=null!=r?r:{},this.id=u().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",u().registerTensor(this),null!=n&&u().write(this.dataId,n)}return e.make=function(t,n,r){return new e(t,r,n.values,n.dataId)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),Hm.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.asType=function(e){return this.throwIfDisposed(),l.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Hm.assert(e.length===this.rank,"Number of coordinates in get() must match the rank of the tensor"),Hm.assert("complex64"!==this.dtype,"Tensor.get() is not supported for complex64 tensors yet."),this.throwIfDisposed(),0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.dataSync()[n]},e.prototype.buffer=function(){return l.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return this.throwIfDisposed(),[2,u().read(this.dataId)]}))}))},e.prototype.dataSync=function(){return this.throwIfDisposed(),u().readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(u().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),l.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),l.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),l.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),l.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),l.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),l.clone(this)},e.prototype.toString=function(e){void 0===e&&(e=!1);var t=this.dataSync();return Gm.tensorToString(t,this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),l.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),l.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),l.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),l.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),l.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),l.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),l.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),l.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),l.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),l.stack([this,e],t)},e.prototype.unstack=function(e,t){return void 0===t&&(t=0),l.unstack(this,t)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),l.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),this.throwIfDisposed(),l.batchNormalization(this,e,t,n,r,o)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),l.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),l.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),l.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),l.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),l.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),l.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),l.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),l.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),l.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),l.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),l.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),l.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),l.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),l.div(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),l.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),l.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),l.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),l.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),l.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),l.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),l.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),l.modStrict(this,e)},e.prototype.squaredDifference=function(e){return this.throwIfDisposed(),l.squaredDifference(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),l.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),l.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),l.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),l.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),l.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),l.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),l.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),l.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),l.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),l.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),l.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),l.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),l.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),l.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),l.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),l.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),l.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),l.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),l.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),l.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),l.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),l.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),l.sign(this)},e.prototype.exp=function(){return this.throwIfDisposed(),l.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),l.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),l.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),l.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),l.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),l.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),l.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),l.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),l.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),l.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),l.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),l.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),l.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),l.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),l.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),l.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),l.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),l.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),l.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),l.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),l.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),l.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),l.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),l.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),l.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),l.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),l.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),l.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),l.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),l.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),l.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),l.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),l.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),l.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),l.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),l.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),l.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),l.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),l.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,i){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),l.conv1d(this,e,t,n,r,o,i)},e.prototype.conv2d=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),l.conv2d(this,e,t,n,r,o,i)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),l.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),l.depthwiseConv2d(this,e,t,n,r,o,i)},e.prototype.separableConv2d=function(e,t,n,r,o,i){return void 0===o&&(o=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),l.separableConv2d(this,e,t,n,r,o,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),l.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),l.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),l.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,o){return this.throwIfDisposed(),l.pool(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),h.variable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),l.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),l.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),l.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),l.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,o){return void 0===r&&(r=0),void 0===o&&(o=0),this.throwIfDisposed(),l.stridedSlice(this,e,t,n,r,o)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),l.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),l.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),l.spectral.ifft(this)},e}();t.Tensor=c,Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.shape&&null!=e.dtype}});var h=function(e){function t(t,n,r){void 0===n&&(n=!0);var o=e.call(this,t.shape,t.dtype,null,t.dataId)||this;o.trainable=n,o.name=r,null==o.name&&(o.name=u().nextVariableId().toString());try{u().registerVariable(o)}catch(e){throw u().disposeTensor(o),e}return o}return r(t,e),t.variable=function(e,n,r,o){return void 0===n&&(n=!0),null!=o&&o!==e.dtype&&(e=e.asType(o)),new t(e,n,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!Hm.arraysEqual(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");u().disposeTensor(this),this.dataId=e.dataId,u().registerTensor(this)},t}(c);t.Variable=h,Object.defineProperty(h,Symbol.hasInstance,{value:function(e){return e instanceof c&&null!=e.assign&&e.assign instanceof Function}}),t.variable=h.variable}));jm(Km);var Xm=Lm((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.assertTypesMatch=function(e,t){Hm.assert(e.dtype===t.dtype,"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match")},t.isTensorInList=function(e,t){for(var n=0;n<t.length;n++)if(t[n].id===e.id)return!0;return!1},t.flattenNameArrayMap=function(e,t){var n=[];if(e instanceof Km.Tensor)n.push(e);else for(var r=e,o=0;o<t.length;o++)n.push(r[t[o]]);return n},t.unflattenToNameArrayMap=function(e,t){if(e.length!==t.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n},t.getTensorsInContainer=function(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof Km.Tensor)n.push(t);else if(o=t,Array.isArray(o)||"object"==typeof o){var o,i=t;for(var a in i){var s=i[a];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}}));jm(Xm);var Zm=Xm.isTensorInList,Qm=Xm.getTensorsInContainer;function Jm(e,t,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var o=t(e);if(o.recurse&&null!==o.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(o.recurse){if(tg(e)){var i=Array.isArray(e)?[]:{};for(var a in r.add(e),e){var s=Jm(e[a],t,n,r);i[a]=s}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,o.value),o.value}function Ym(e){return null===e?null:tg(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function eg(e,t){return Dm(this,void 0,void 0,(function(){var n,r,o,i,a,s;return Rm(this,(function(u){switch(u.label){case 0:n=new Map,Jm(e,t,n),r=0,o=Array.from(n.keys()),u.label=1;case 1:return r<o.length?(a=n.get(i=o[r]))instanceof Promise?[4,a]:[3,3]:[3,4];case 2:s=u.sent(),n.set(i,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,Jm(e,t,n)]}}))}))}function tg(e){return null!=e&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof Kl.o))}var ng=function(){function e(e){if(this.capacity=e,this.begin=0,this.end=0,e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}return e.prototype.wrap=function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity},e.prototype.get=function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]},e.prototype.set=function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t},e.prototype.length=function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return 0===this.length()},e.prototype.push=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(e){for(var t=0,n=e;t<n.length;t++)this.push(n[t])},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e},e.prototype.unshift=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e},e.prototype.shuffleExcise=function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n},e}(),rg=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return Pm(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(t){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,t)},t.prototype.unshift=function(t){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,t)},t.prototype.expand=function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},t.INITIAL_CAPACITY=32,t}(ng);function og(e){return new hg(e)}function ig(e){return new pg(e)}function ag(e,t){return new Ng(e,t)}function sg(e,t){return void 0===t&&(t=ug.FAIL),new Eg(e,t)}var ug,lg,cg=function(){function e(){}return e.prototype.collect=function(e,t){return void 0===e&&(e=1e3),void 0===t&&(t=100),Dm(this,void 0,void 0,(function(){var n,r,o,i;return Rm(this,(function(a){switch(a.label){case 0:return n=t>0?this.prefetch(t):this,r=[],o=0,[4,n.next()];case 1:i=a.sent(),a.label=2;case 2:return i.done?[3,4]:(r.push(i.value),++o>=e?[2,r]:[4,n.next()]);case 3:return i=a.sent(),[3,2];case 4:return[2,r]}}))}))},e.prototype.resolveFully=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:e=t.sent(),t.label=2;case 2:return e.done?[3,4]:[4,this.next()];case 3:return e=t.sent(),[3,2];case 4:return[2]}}))}))},e.prototype.resolveWhile=function(e){return Dm(this,void 0,void 0,(function(){var t,n;return Rm(this,(function(r){switch(r.label){case 0:return[4,this.next()];case 1:t=r.sent(),n=e(t.value),r.label=2;case 2:return t.done||!n?[3,4]:[4,this.next()];case 3:return t=r.sent(),n=e(t.value),[3,2];case 4:return[2]}}))}))},e.prototype.handleErrors=function(e){return new bg(this,e)},e.prototype.filter=function(e){return new yg(this,e)},e.prototype.map=function(e){return new vg(this,e)},e.prototype.mapAsync=function(e){return new wg(this,e)},e.prototype.serialMapAsync=function(e){return new wg(this,e).serial()},e.prototype.flatmap=function(e){return new _g(this,e)},e.prototype.forEach=function(e){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(t){return[2,this.map(e).resolveFully()]}))}))},e.prototype.serialForEach=function(e){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(t){return[2,this.serialMapAsync(e).resolveWhile((function(e){return!0===e}))]}))}))},e.prototype.rowMajorBatch=function(e,t){return void 0===t&&(t=!0),new gg(this,e,t)},e.prototype.columnMajorBatch=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=Ym),this.rowMajorBatch(e,t).map((function(e){return function(e,t){return void 0===t&&(t=Ym),function e(t,n,r){void 0===r&&(r=new Set);var o=t[0];if(r.has(o))throw new Error("Circular references are not supported.");var i=n(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(tg(o)){var a=Array.isArray(o)?[]:{};r.add(o);var s=function(o){var i=e(t.map((function(e){return e[o]})),n,r);a[o]=i};for(var u in o)s(u);return r.delete(o),a}throw new Error("Can't recurse into non-iterable type: "+o)}return i.value}(e,t)}(e,n)}))},e.prototype.concatenate=function(e,t){return new Ng(og([this,e]),t)},e.prototype.take=function(e){return e<0||null==e?this:new mg(this,e)},e.prototype.skip=function(e){return e<0||null==e?this:new fg(this,e)},e.prototype.prefetch=function(e){return new Cg(this,e)},e.prototype.shuffle=function(e,t){return new Ig(this,e,t)},e.prototype.serial=function(){return new dg(this)},e}(),hg=function(e){function t(t){var n=e.call(this)||this;return n.items=t,n.trav=0,n}return Pm(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(e=this.items[this.trav],this.trav++,[2,{value:e,done:!1}])}))}))},t}(cg),pg=function(e){function t(t){var n=e.call(this)||this;return n.nextFn=t,n}return Pm(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){try{return[2,this.nextFn()]}catch(e){throw e.message="Error thrown while iterating through a dataset: "+e.message,e}return[2]}))}))},t}(cg),dg=function(e){function t(t){var n=e.call(this)||this;return n.upstream=t,n.lastRead=Promise.resolve({value:null,done:!1}),n}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return[2,this.upstream.next()]}))}))},t}(cg),fg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(e=t.sent()).done?[2,e]:(Object(Kl.ib)(e.value),[3,0]);case 2:return[2,this.upstream.next()]}}))}))},t}(cg),mg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.maxCount=n,r.count=0,r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]}))}))},t}(cg),gg=function(e){function t(t,n,r){void 0===r&&(r=!0);var o=e.call(this)||this;return o.upstream=t,o.batchSize=n,o.enableSmallLastBatch=r,o.lastRead=Promise.resolve({value:null,done:!1}),o}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){var e,t;return Rm(this,(function(n){switch(n.label){case 0:e=[],n.label=1;case 1:return e.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(t=n.sent()).done?this.enableSmallLastBatch&&e.length>0?[2,{value:e,done:!1}]:[2,{value:null,done:!0}]:(e.push(t.value),[3,1]);case 3:return[2,{value:e,done:!1}]}}))}))},t}(cg),yg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:return[4,this.upstream.next()];case 1:return(e=t.sent()).done||this.predicate(e.value)?[2,e]:(Object(Kl.ib)(e.value),[3,0]);case 2:return[2]}}))}))},t}(cg),vg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.transform=n,r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Rm(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((e=s.sent()).done)return[2,{value:null,done:!0}];for(t=Qm(e.value),n=this.transform(e.value),r=Qm(n),o=0,i=t;o<i.length;o++)Zm(a=i[o],r)||a.dispose();return[2,{value:n,done:!1}]}}))}))},t}(cg),bg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,t.sent()];case 3:return e=t.sent(),this.handler(e)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}}))}))},t}(cg),wg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.transform=n,r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Rm(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:return(e=s.sent()).done?[2,{value:null,done:!0}]:(t=Qm(e.value),[4,this.transform(e.value)]);case 2:for(n=s.sent(),r=Qm(n),o=0,i=t;o<i.length;o++)Zm(a=i[o],r)||a.dispose();return[2,{value:n,done:!1}]}}))}))},t}(cg),xg=function(e){function t(){var t=e.call(this)||this;return t.outputQueue=new rg,t.lastRead=Promise.resolve({value:null,done:!1}),t}return Pm(t,e),t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){switch(e.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return e.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}}))}))},t}(cg),_g=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.transform=n,r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Rm(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((e=s.sent()).done)return[2,!1];for(t=Qm(e.value),n=this.transform(e.value),r=Qm(n),this.outputQueue.pushAll(n),o=0,i=t;o<i.length;o++)Zm(a=i[o],r)||a.dispose();return[2,!0]}}))}))},t}(xg),Ng=function(e){function t(t,n){var r=e.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=t,r}return Pm(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]}))}))},t.prototype.readFromChain=function(e){return Dm(this,void 0,void 0,(function(){var t,n;return Rm(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((t=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(e)]):[2,n]}}))}))},t}(cg);(lg=ug||(ug={}))[lg.FAIL=0]="FAIL",lg[lg.SHORTEST=1]="SHORTEST",lg[lg.LONGEST=2]="LONGEST";var Eg=function(e){function t(t,n){void 0===n&&(n=ug.FAIL);var r=e.call(this)||this;return r.iterators=t,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}return Pm(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(e){return Dm(this,void 0,void 0,(function(){function t(e){return e instanceof cg?{value:e.next().then((function(e){return n++,e.done&&r++,e.value})),recurse:!1}:{value:null,recurse:!0}}var n,r,o;return Rm(this,(function(i){switch(i.label){case 0:return[4,e];case 1:return i.sent(),n=0,r=0,[4,eg(this.iterators,t)];case 2:if(o=i.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case ug.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case ug.SHORTEST:return[2,{value:null,done:!0}]}return this.count++,[2,{value:o,done:!1}]}}))}))},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){switch(e.label){case 0:return this.currentPromise=this.nextState(this.currentPromise),[4,this.currentPromise];case 1:return[2,e.sent()]}}))}))},t}(cg),Cg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.bufferSize=n,r.buffer=new ng(n),r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(cg),Ig=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.upstream=t,o.windowSize=n,o.upstreamExhausted=!1,o.random=qm(r||Kl.oe.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return Pm(t,e),t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e=this;return Rm(this,(function(t){return this.lastRead=this.lastRead.then((function(){return e.serialNext()})),[2,this.lastRead]}))}))},t.prototype.randomInt=function(e){return Math.floor(this.random()*e)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return Dm(this,void 0,void 0,(function(){var e,t;return Rm(this,(function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(e=this.chooseIndex(),[4,this.buffer.shuffleExcise(e)]);case 2:return(t=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,t]);case 3:return[2,{value:null,done:!0}]}}))}))},t}(Cg),Og=function(){function e(){}return e.prototype.filter=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().filter((function(t){return Object(Kl.ee)((function(){return e(t)}))}))]}}))}))}))},e.prototype.map=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().map((function(t){return Object(Kl.ee)((function(){return e(t)}))}))]}}))}))}))},e.prototype.mapAsync=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().mapAsync(e)]}}))}))}))},e.prototype.batch=function(e,t){var n=this;void 0===t&&(t=!0);var r=this;return Sg((function(){return Dm(n,void 0,void 0,(function(){return Rm(this,(function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(e,t,Ag)]}}))}))}))},e.prototype.concatenate=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){var t,r;return Rm(this,(function(o){switch(o.label){case 0:return[4,n.iterator()];case 1:return r=(t=o.sent()).concatenate,[4,e.iterator()];case 2:return[2,r.apply(t,[o.sent()])]}}))}))}))},e.prototype.repeat=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){var t=this;return Rm(this,(function(r){return[2,ag(ig((function(){return Dm(t,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:return e={},[4,n.iterator()];case 1:return[2,(e.value=t.sent(),e.done=!1,e)]}}))}))})).take(e))]}))}))}))},e.prototype.take=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().take(e)]}}))}))}))},e.prototype.skip=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().skip(e)]}}))}))}))},e.prototype.shuffle=function(e,t,n){var r=this;void 0===n&&(n=!0);var o=this,i=qm(t||Kl.oe.now().toString());return Sg((function(){return Dm(r,void 0,void 0,(function(){var t;return Rm(this,(function(r){switch(r.label){case 0:return t=i.int32(),n&&(t+=i.int32()),[4,o.iterator()];case 1:return[2,r.sent().shuffle(e,t.toString())]}}))}))}))},e.prototype.prefetch=function(e){var t=this,n=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,n.iterator()];case 1:return[2,t.sent().prefetch(e)]}}))}))}))},e.prototype.collectAll=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().collect()]}}))}))},e.prototype.forEach=function(e){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,this.iterator()];case 1:return[2,t.sent().forEach(e)]}}))}))},e}();function Sg(e){return new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Pm(n,t),n.prototype.iterator=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(t){return[2,e()]}))}))},n}(Og))}function kg(e){var t=this;return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){return[2,og(e)]}))}))}))}function Tg(e){var t=this;if(!tg(e))throw new Error("The argument to zip() must be an object or array.");return Sg((function(){return Dm(t,void 0,void 0,(function(){return Rm(this,(function(t){switch(t.label){case 0:return[4,eg(e,(function(e){if(e instanceof Og)return{value:e.iterator(),recurse:!1};if(tg(e))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}))];case 1:return[2,sg(t.sent(),ug.SHORTEST)]}}))}))}))}function Ag(e){if(null===e)return null;var t=e[0];return"string"==typeof t?{value:e,recurse:!1}:tg(t)?function(e){if(null==e)return!1;if(!Array.isArray(e))return!1;for(var t in e)if("number"!=typeof e[t])return!1;return!0}(t)?{value:Pg(e),recurse:!1}:{value:null,recurse:!0}:{value:Pg(e),recurse:!1}}function Pg(e){for(var t=Dg(e[0])[0],n=[e.length].concat(t),r=new Float32Array(n.reduce((function(e,t){return e*t}))),o=0,i=0,a=e;i<a.length;i++){var s=Dg(a[i]),u=s[1];if(!Kl.oe.arraysEqual(s[0],t))throw new Error("Elements must have the same shape to be batched");r.set(u,o),o+=u.length}return Kl.o.make(n,{values:r})}function Dg(e){return e instanceof Kl.o?[e.shape,e.dataSync()]:Array.isArray(e)?[[e.length],e]:[[],[e]]}var Rg=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Pm(t,e),t.prototype.iterator=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){switch(e.label){case 0:return[4,this.input.iterator()];case 1:return[2,e.sent().decodeUTF8().split("\n")]}}))}))},t}(Og),Mg=Symbol("out"),jg=Symbol("field"),Lg=Symbol("quote"),Vg=Symbol("quoteafterquote"),Fg=Symbol("quoteinquote"),zg=function(e){function t(t,n){var r=e.call(this)||this;return r.input=t,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.base=new Rg(t),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,r.delimiter=n.delimiter?n.delimiter:",",r}return Pm(t,e),t.prototype.columnNames=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){switch(e.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:e.sent(),e.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}}))}))},t.prototype.setColumnNames=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r,o,i;return Rm(this,(function(a){switch(a.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(e=a.sent(),!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&e&&Kl.oe.assert(e.length===this.fullColumnNames.length,"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e),t=this.fullColumnNames.reduce((function(e,t){return e[t]=e[t]+1||1,e}),{}),n=Object.keys(t).filter((function(e){return t[e]>1})),Kl.oe.assert(0===n.length,"Duplicate column names found: "+n.toString()),this.columnConfigs)for(r=0,o=Object.keys(this.columnConfigs);r<o.length;r++)if(-1===this.fullColumnNames.indexOf(i=o[r]))throw new Error('The key "'+i+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}}))}))},t.prototype.maybeReadHeaderLine=function(){return Dm(this,void 0,void 0,(function(){var e;return Rm(this,(function(t){switch(t.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,t.sent().next()];case 2:if((e=t.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,e.value.split(this.delimiter)];case 3:return[2,null]}}))}))},t.prototype.iterator=function(){return Dm(this,void 0,void 0,(function(){var e,t=this;return Rm(this,(function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return e=n.sent(),this.hasHeader&&(e=e.skip(1)),[2,e.map((function(e){return t.makeDataElement(e)}))]}}))}))},t.prototype.makeDataElement=function(e){for(var t=this.parseRow(e),n={},r={},o=0;o<this.fullColumnNames.length;o++){var i=this.fullColumnNames[o],a=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||a){var s=t[o],u=null;if(""===s)if(a&&void 0!==a.default)u=a.default;else{if(a&&(a.required||a.isLabel))throw new Error("Required column "+i+" is empty in this line: "+e);u=void 0}else{var l=Number(s);if(isNaN(l))u=a&&"bool"===a.dtype?this.getBoolean(s):s;else if(a&&a.dtype)switch(a.dtype){case"float32":u=l;break;case"int32":u=Math.floor(l);break;case"bool":u=this.getBoolean(s);break;default:u=l}else u=l}a&&a.isLabel?r[i]=u:n[i]=u}}return 0===Object.keys(r).length?n:[n,r]},t.prototype.getBoolean=function(e){return"1"===e||"true"===e.toLowerCase()?1:0},t.prototype.parseRow=function(e){for(var t=[],n=0,r=e.length,o=jg,i=0;i<r;i++)switch(o){case Mg:switch(e.charAt(i)){case'"':n=i+1,o=Lg;break;case this.delimiter:t.push(""),o=Mg,n=i+1;break;default:o=jg,n=i}break;case jg:switch(e.charAt(i)){case this.delimiter:t.push(e.substring(n,i)),o=Mg,n=i+1}break;case Lg:switch(e.charAt(i)){case'"':o=Vg}break;case Vg:switch(e.charAt(i)){case this.delimiter:t.push(e.substring(n,i-1)),o=Mg,n=i+1;break;case'"':o=Lg;break;default:o=Fg}break;case Fg:switch(e.charAt(i)){case'"':o=Lg}}return t.push(o===Vg?e.substring(n,r-1):e.substring(n)),t},t}(Og),Bg=function(){},Ug=Lm((function(e,t){!function(n){var r=t,o=e&&e.exports==r&&e,i="object"==typeof Mm&&Mm;i.global!==i&&i.window!==i||(n=i);var a,s,u,l=String.fromCharCode;function c(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function h(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function p(e,t){return l(e>>t&63|128)}function d(e){if(0==(4294967168&e))return l(e);var t="";return 0==(4294965248&e)?t=l(e>>6&31|192):0==(4294901760&e)?(h(e),t=l(e>>12&15|224),t+=p(e,6)):0==(4292870144&e)&&(t=l(e>>18&7|240),t+=p(e,12),t+=p(e,6)),t+l(63&e|128)}function f(){if(u>=s)throw Error("Invalid byte index");var e=255&a[u];if(u++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function m(){var e,t;if(u>s)throw Error("Invalid byte index");if(u==s)return!1;if(e=255&a[u],u++,0==(128&e))return e;if(192==(224&e)){if((t=(31&e)<<6|f())>=128)return t;throw Error("Invalid continuation byte")}if(224==(240&e)){if((t=(15&e)<<12|f()<<6|f())>=2048)return h(t),t;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=(7&e)<<18|f()<<12|f()<<6|f())>=65536&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}var g={version:"2.1.2",encode:function(e){for(var t=c(e),n=t.length,r=-1,o="";++r<n;)o+=d(t[r]);return o},decode:function(e){a=c(e),s=a.length,u=0;for(var t,n=[];!1!==(t=m());)n.push(t);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=l((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=l(t);return o}(n)}};if(r&&!r.nodeType)if(o)o.exports=g;else{var y={}.hasOwnProperty;for(var v in g)y.call(g,v)&&(r[v]=g[v])}else n.utf8=g}(Mm)})).decode,Wg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pm(t,e),t.prototype.split=function(e){return new $g(this,e)},t}(cg),$g=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.impl=new qg(t,n),r}return Pm(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return[2,this.impl.next()]}))}))},t}(Wg),qg=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.separator=n,r.carryover="",r}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r;return Rm(this,(function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((e=o.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((t=e.value.split(this.separator))[0]=this.carryover+t[0],n=0,r=t.slice(0,-1);n<r.length;n++)this.outputQueue.push(r[n]);return this.carryover=t[t.length-1],[2,!0]}}))}))},t}(xg),Hg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pm(t,e),t.prototype.decodeUTF8=function(){return new Gg(this)},t}(cg),Gg=function(e){function t(t){var n=e.call(this)||this;return n.upstream=t,n.impl=new Kg(t),n}return Pm(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return[2,this.impl.next()]}))}))},t}(Wg),Kg=function(e){function t(t){var n=e.call(this)||this;return n.upstream=t,n.partial=new Uint8Array([]),n.partialBytesValid=0,n}return Pm(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return Dm(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return Rm(this,(function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:if((e=u.sent()).done){if(0===this.partial.length)return[2,!1];t=new Uint8Array([])}else t=e.value;for(o=r=n=this.partial.length-this.partialBytesValid,i=0;r<t.length;)o=r,i=Xg(t[r]),r=o+i;return r===t.length&&(o=r),a=Ug(String.fromCharCode.apply(null,t.slice(n,o))),n>0?(this.partial.set(t.slice(0,n),this.partialBytesValid),s=Ug(String.fromCharCode.apply(null,this.partial)),this.outputQueue.push(s+a)):this.outputQueue.push(a),o===t.length?(this.partial=new Uint8Array([]),this.partialBytesValid=0):(this.partial=new Uint8Array(new ArrayBuffer(i)),this.partial.set(t.slice(o),0),this.partialBytesValid=t.length-o),[2,!0]}}))}))},t}(xg);function Xg(e){return e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1}var Zg=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.file=t,r.options=n,Kl.oe.assert(t instanceof Uint8Array||!!Kl.f.get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),"FileChunkIterator only supports File, Blob and Uint8Array right now."),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return Pm(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return Dm(this,void 0,void 0,(function(){var e,t,n=this;return Rm(this,(function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(e=new Promise((function(e,t){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)e(new Uint8Array(n.file.slice(n.offset,r)));else{var o=new FileReader;o.onload=function(n){var r=o.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(r)},o.onabort=function(e){return t(new Error("Aborted"))},o.onerror=function(e){return t(new Error(e.type))};var i=n.file.slice(n.offset,r);o.readAsArrayBuffer(i)}n.offset=r})),t={},[4,e]);case 1:return[2,(t.value=r.sent(),t.done=!1,t)]}}))}))},t}(Hg);function Qg(e,t){return void 0===t&&(t={}),Dm(this,void 0,void 0,(function(){var n,r,o;return Rm(this,(function(i){switch(i.label){case 0:return Kl.f.get("IS_BROWSER")?[4,fetch(e)]:[3,5];case 1:return(n=i.sent()).ok?[4,n.blob()]:[3,3];case 2:return r=i.sent(),[2,new Zg(r,t)];case 3:throw new Error(n.statusText);case 4:return[3,9];case 5:if("string"!=typeof e)throw new Error("URL must be a string. Request objects are not supported in the node.js environment yet.");return[4,Tm()(e)];case 6:return(n=i.sent()).ok?[4,n.buffer()]:[3,8];case 7:return o=i.sent(),[2,new Zg(o,t)];case 8:throw new Error(n.statusText);case 9:return[2]}}))}))}var Jg=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.url=t,r.fileOptions=n,r}return Pm(t,e),t.prototype.iterator=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return[2,Qg(this.url,this.fileOptions)]}))}))},t}(Bg);function Yg(e,t){return void 0===t&&(t={}),new zg(new Jg(e),t)}var ey=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.input=t,r.options=n,r}return Pm(t,e),t.prototype.iterator=function(){return Dm(this,void 0,void 0,(function(){return Rm(this,(function(e){return[2,new Zg(this.input,this.options)]}))}))},t}(Bg),ty="0.1.2",ny={"tfjs-core":Kl.te,"tfjs-data":ty,"tfjs-layers":ed,"tfjs-converter":Sm.d,tfjs:"0.14.0"};function ry(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function oy(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var iy={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}},ay="https://storage.googleapis.com/tfjs-models/savedmodel/",sy=function(){function e(e){this.modelPath=""+ay+this.getPrefix(e)+"/tensorflowjs_model.pb",this.weightPath=""+ay+this.getPrefix(e)+"/weights_manifest.json"}return e.prototype.getPrefix=function(e){return"lite_mobilenet_v2"===e?"ssd"+e:"ssd_"+e},e.prototype.load=function(){return ry(this,void 0,void 0,(function(){var e,t,n=this;return oy(this,(function(r){switch(r.label){case 0:return e=this,[4,Object(Sm.b)(this.modelPath,this.weightPath)];case 1:return e.model=r.sent(),[4,this.model.executeAsync(Object(Kl.xe)([1,300,300,3]))];case 2:return(t=r.sent()).map((function(e){return ry(n,void 0,void 0,(function(){return oy(this,(function(t){switch(t.label){case 0:return[4,e.data()];case 1:return[2,t.sent()]}}))}))})),t.map((function(e){return ry(n,void 0,void 0,(function(){return oy(this,(function(t){return[2,e.dispose()]}))}))})),[2]}}))}))},e.prototype.infer=function(e,t){return ry(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,h,p,d;return oy(this,(function(f){switch(f.label){case 0:return n=Object(Kl.ee)((function(){return e instanceof Kl.o||(e=Object(Kl.Ab)(e)),e.expandDims(0)})),r=n.shape[1],o=n.shape[2],[4,this.model.executeAsync(n)];case 1:return i=f.sent(),a=i[0].dataSync(),s=i[1].dataSync(),n.dispose(),Object(Kl.ib)(i),u=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(this.calculateMaxScores(a,i[0].shape[1],i[0].shape[2]),2),l=u[0],c=u[1],h=Object(Kl.Db)(),Object(Kl.sd)("cpu"),p=Object(Kl.ee)((function(){var e=Object(Kl.Yd)(s,[i[1].shape[1],i[1].shape[3]]);return Kl.Mb.nonMaxSuppression(e,l,t,.5,.5)})),d=p.dataSync(),p.dispose(),Object(Kl.sd)(h),[2,this.buildDetectedObjects(o,r,s,l,d,c)]}}))}))},e.prototype.buildDetectedObjects=function(e,t,n,r,o,i){for(var a=o.length,s=[],u=0;u<a;u++){for(var l=[],c=0;c<4;c++)l[c]=n[4*o[u]+c];var h=l[0]*t,p=l[1]*e,d=l[2]*t,f=l[3]*e;l[0]=p,l[1]=h,l[2]=f-p,l[3]=d-h,s.push({bbox:l,class:iy[i[o[u]]+1].displayName,score:r[o[u]]})}return s},e.prototype.calculateMaxScores=function(e,t,n){for(var r=[],o=[],i=0;i<t;i++){for(var a=Number.MIN_VALUE,s=-1,u=0;u<n;u++)e[i*n+u]>a&&(a=e[i*n+u],s=u);r[i]=a,o[i]=s}return[r,o]},e.prototype.detect=function(e,t){return void 0===t&&(t=20),ry(this,void 0,void 0,(function(){return oy(this,(function(n){return[2,this.infer(e,t)]}))}))},e.prototype.dispose=function(){this.model&&this.model.dispose()},e}();const uy=1e3;class ly{constructor(){this.predictionChange=new To,this.predictions=[],this.trigger=new O,this.found=!1,this.viewPortWidth=480}ngOnInit(){this.getViewPortWidth(),Ul.getAvailableVideoInputs().then(e=>console.log("Detected devices:",e)),function(e){return void 0===e&&(e="lite_mobilenet_v2"),ry(this,void 0,void 0,(function(){var t;return oy(this,(function(n){switch(n.label){case 0:if(null==o)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(-1===["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(e))throw new Error("ObjectDetection constructed with invalid base model "+e+". Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.");return[4,(t=new sy(e)).load()];case 1:return n.sent(),[2,t]}}))}))}().then(e=>this.model=e).catch(e=>console.log("Cannot load model",e)),this.trigger.subscribe(()=>{this.webcamImage&&this.webcamImage.imageData&&this.model&&this.model.detect(this.webcamImage.imageData).then(e=>{this.renderPredictions(e),this.predictions=e;const t=this.mapPredictionsToResults(e);this.emitResults(t)})}),setInterval(()=>this.trigger.next(),uy)}getViewPortWidth(){this.viewPortWidth=window.innerWidth}error(e){console.error("Cannot initialize:",e)}capture(e){this.webcamImage=e}get triggerObservable(){return this.trigger.asObservable()}emitResults(e){this.found||(console.log("prediction",e),this.predictionChange.emit(e))}mapPredictionsToResults(e){return e.map(e=>({correct:e.score>this.predictionThreshold&&e.class===this.objectToPredict,object:e.class,certainty:e.score}))}renderPredictions(e){const t=this.canvas.nativeElement.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height),e.forEach(e=>{const n=e.bbox[0],r=e.bbox[1],o=e.bbox[2],i=e.bbox[3],a=e.class+" - "+(100*e.score).toFixed(0)+"%";t.strokeStyle="green",t.font="18px Arial",t.fillStyle="green",t.beginPath(),t.globalAlpha=.7,t.fillRect(n,r,o,18),t.fillStyle="white",t.fillText(a,n+3,r+14),t.rect(n,r,o,i),t.stroke()})}}var cy=Jn({encapsulation:0,styles:[[""]],data:{}});function hy(e){return ta(0,[(e()(),Bi(0,0,null,null,4,"div",[["class","d-flex"]],null,null,null,null,null)),(e()(),Bi(1,0,null,null,3,"div",[["class","video-wrapper"]],null,null,null,null,null)),(e()(),Bi(2,0,null,null,1,"webcam",[["allowCameraSwitch","false"],["height","480"],["mirrorImage","never"],["width","640"]],null,[[null,"initError"],[null,"imageCapture"]],(function(e,t,n){var r=!0,o=e.component;return"initError"===t&&(r=!1!==o.error(n)&&r),"imageCapture"===t&&(r=!1!==o.capture(n)&&r),r}),Gl,ql)),ao(3,4374528,null,0,Wl,[],{width:[0,"width"],height:[1,"height"],allowCameraSwitch:[2,"allowCameraSwitch"],mirrorImage:[3,"mirrorImage"],captureImageData:[4,"captureImageData"],imageQuality:[5,"imageQuality"],trigger:[6,"trigger"]},{imageCapture:"imageCapture",initError:"initError"}),(e()(),Bi(4,0,[[1,0],["canvas",1]],null,0,"canvas",[["id","canvas"]],[[8,"width",0],[8,"height",0]],null,null,null,null))],(function(e,t){e(t,3,0,"640","480","false","never",!0,.92,t.component.triggerObservable)}),(function(e,t){e(t,4,0,640,480)}))}function py(e){return ta(0,[(e()(),Bi(0,0,null,null,4,"div",[["class","d-flex"]],null,null,null,null,null)),(e()(),Bi(1,0,null,null,3,"div",[["class","video-wrapper"]],null,null,null,null,null)),(e()(),Bi(2,0,null,null,1,"webcam",[["allowCameraSwitch","false"],["height","420"],["mirrorImage","never"],["width","320"]],null,[[null,"initError"],[null,"imageCapture"]],(function(e,t,n){var r=!0,o=e.component;return"initError"===t&&(r=!1!==o.error(n)&&r),"imageCapture"===t&&(r=!1!==o.capture(n)&&r),r}),Gl,ql)),ao(3,4374528,null,0,Wl,[],{width:[0,"width"],height:[1,"height"],allowCameraSwitch:[2,"allowCameraSwitch"],mirrorImage:[3,"mirrorImage"],captureImageData:[4,"captureImageData"],imageQuality:[5,"imageQuality"],trigger:[6,"trigger"]},{imageCapture:"imageCapture",initError:"initError"}),(e()(),Bi(4,0,[[1,0],["canvas",1]],null,0,"canvas",[["id","canvas"]],[[8,"width",0],[8,"height",0]],null,null,null,null))],(function(e,t){e(t,3,0,"320","420","false","never",!0,.92,t.component.triggerObservable)}),(function(e,t){e(t,4,0,320,420)}))}function dy(e){return ta(0,[Hi(671088640,1,{canvas:0}),(e()(),zi(16777216,null,null,1,null,hy)),ao(2,16384,null,0,ws,[Rn,Pn],{ngIf:[0,"ngIf"]},null),(e()(),zi(16777216,null,null,1,null,py)),ao(4,16384,null,0,ws,[Rn,Pn],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.viewPortWidth>480),e(t,4,0,n.viewPortWidth<=480)}),null)}class fy{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new my(e,this.predicate,this.thisArg))}}class my extends y{constructor(e,t,n){super(e),this.predicate=t,this.thisArg=n,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}class gy{}class yy{}class vy{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const n=e.slice(0,t),r=n.toLowerCase(),o=e.slice(t+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(o):this.headers.set(r,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof vy?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new vy;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof vy?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const o=e.value;if(o){let e=this.headers.get(t);if(!e)return;0===(e=e.filter(e=>-1===o.indexOf(e))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class by{encodeKey(e){return wy(e)}encodeValue(e){return wy(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function wy(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class xy{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new by,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const n=new Map;return e.length>0&&e.split("&").forEach(e=>{const r=e.indexOf("="),[o,i]=-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],a=n.get(o)||[];a.push(i),n.set(o,a)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).join("&")}clone(e){const t=new xy({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat([e]),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(e.value),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const n=t.indexOf(e.value);-1!==n&&t.splice(n,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}function _y(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Ny(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Ey(e){return"undefined"!=typeof FormData&&e instanceof FormData}class Cy{constructor(e,t,n,r){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,o=r):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new vy),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const n=t.indexOf("?");this.urlWithParams=t+(-1===n?"?":n<t.length-1?"&":"")+e}}else this.params=new xy,this.urlWithParams=t}serializeBody(){return null===this.body?null:_y(this.body)||Ny(this.body)||Ey(this.body)||"string"==typeof this.body?this.body:this.body instanceof xy?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body?null:Ey(this.body)?null:Ny(this.body)?this.body.type||null:_y(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xy?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,i=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let s=e.headers||this.headers,u=e.params||this.params;return void 0!==e.setHeaders&&(s=Object.keys(e.setHeaders).reduce((t,n)=>t.set(n,e.setHeaders[n]),s)),e.setParams&&(u=Object.keys(e.setParams).reduce((t,n)=>t.set(n,e.setParams[n]),u)),new Cy(t,n,o,{params:u,headers:s,reportProgress:a,responseType:r,withCredentials:i})}}const Iy=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}();class Oy{constructor(e,t=200,n="OK"){this.headers=e.headers||new vy,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Sy extends Oy{constructor(e={}){super(e),this.type=Iy.ResponseHeader}clone(e={}){return new Sy({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ky extends Oy{constructor(e={}){super(e),this.type=Iy.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new ky({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Ty extends Oy{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Ay(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}class Py{constructor(e){this.handler=e}request(e,t,n={}){let r;if(e instanceof Cy)r=e;else{let o=void 0;o=n.headers instanceof vy?n.headers:new vy(n.headers);let i=void 0;n.params&&(i=n.params instanceof xy?n.params:new xy({fromObject:n.params})),r=new Cy(e,t,void 0!==n.body?n.body:null,{headers:o,params:i,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const o=function(...e){let t=e[e.length-1];switch(k(t)?e.pop():t=void 0,e.length){case 0:return function(e){return e?function(e){return new x(t=>e.schedule(()=>t.complete()))}(e):Bu}(t);case 1:return t?q(e,t):function(e){const t=new x(t=>{t.next(e),t.complete()});return t._isScalar=!0,t.value=e,t}(e[0]);default:return q(e,t)}}(r).pipe(G(e=>this.handler.handle(e),void 0,1));if(e instanceof Cy||"events"===n.observe)return o;const i=o.pipe((a=e=>e instanceof ky,function(e){return e.lift(new fy(a,void 0))}));var a;switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return i.pipe(U(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return i.pipe(U(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return i.pipe(U(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return i.pipe(U(e=>e.body))}case"response":return i;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new xy).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,n={}){return this.request("PATCH",e,Ay(n,t))}post(e,t,n={}){return this.request("POST",e,Ay(n,t))}put(e,t,n={}){return this.request("PUT",e,Ay(n,t))}}class Dy{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const Ry=new Ee("HTTP_INTERCEPTORS");class My{intercept(e,t){return t.handle(e)}}const jy=/^\)\]\}',?\n/;class Ly{}class Vy{constructor(){}build(){return new XMLHttpRequest}}class Fy{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new x(t=>{const n=this.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach((e,t)=>n.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&n.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();n.responseType="json"!==t?t:"text"}const r=e.serializeBody();let o=null;const i=()=>{if(null!==o)return o;const t=1223===n.status?204:n.status,r=n.statusText||"OK",i=new vy(n.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return o=new Sy({headers:i,status:t,statusText:r,url:a})},a=()=>{let{headers:r,status:o,statusText:a,url:s}=i(),u=null;204!==o&&(u=void 0===n.response?n.responseText:n.response),0===o&&(o=u?200:0);let l=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof u){const e=u;u=u.replace(jy,"");try{u=""!==u?JSON.parse(u):null}catch(c){u=e,l&&(l=!1,u={error:c,text:u})}}l?(t.next(new ky({body:u,headers:r,status:o,statusText:a,url:s||void 0})),t.complete()):t.error(new Ty({error:u,headers:r,status:o,statusText:a,url:s||void 0}))},s=e=>{const{url:r}=i(),o=new Ty({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});t.error(o)};let u=!1;const l=r=>{u||(t.next(i()),u=!0);let o={type:Iy.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(o.total=r.total),"text"===e.responseType&&n.responseText&&(o.partialText=n.responseText),t.next(o)},c=e=>{let n={type:Iy.UploadProgress,loaded:e.loaded};e.lengthComputable&&(n.total=e.total),t.next(n)};return n.addEventListener("load",a),n.addEventListener("error",s),e.reportProgress&&(n.addEventListener("progress",l),null!==r&&n.upload&&n.upload.addEventListener("progress",c)),n.send(r),t.next({type:Iy.Sent}),()=>{n.removeEventListener("error",s),n.removeEventListener("load",a),e.reportProgress&&(n.removeEventListener("progress",l),null!==r&&n.upload&&n.upload.removeEventListener("progress",c)),n.abort()}})}}const zy=new Ee("XSRF_COOKIE_NAME"),By=new Ee("XSRF_HEADER_NAME");class Uy{}class Wy{constructor(e,t,n){this.doc=e,this.platform=t,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=gs(e,this.cookieName),this.lastCookieString=e),this.lastToken}}class $y{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);const r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}class qy{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(Ry,[]);this.chain=e.reduceRight((e,t)=>new Dy(e,t),this.backend)}return this.chain.handle(e)}}class Hy{static disable(){return{ngModule:Hy,providers:[{provide:$y,useClass:My}]}}static withOptions(e={}){return{ngModule:Hy,providers:[e.cookieName?{provide:zy,useValue:e.cookieName}:[],e.headerName?{provide:By,useValue:e.headerName}:[]]}}}class Gy{}let Ky=(()=>{class e{constructor(e){this.http=e}getTranslation(e,t){return this.http.get(`https://api.mymemory.translated.net/get?q=${e}&langpair=en|${t}`)}}return e.ngInjectableDef=pe({factory:function(){return new e(Le(Py))},token:e,providedIn:"root"}),e})();var Xy=Jn({encapsulation:0,styles:[[""]],data:{}});function Zy(e){return ta(0,[(e()(),Bi(0,0,null,null,3,"option",[],null,null,null,null,null)),ao(1,147456,null,0,ll,[un,dn,[2,ul]],{value:[0,"value"]},null),ao(2,147456,null,0,hl,[un,dn,[8,null]],{value:[0,"value"]},null),(e()(),Ji(3,null,[" ",""]))],(function(e,t){e(t,1,0,t.context.$implicit.code),e(t,2,0,t.context.$implicit.code)}),(function(e,t){e(t,3,0,t.context.$implicit.name)}))}function Qy(e){return ta(0,[(e()(),Bi(0,0,null,null,1,"small",[],null,null,null,null,null)),(e()(),Ji(-1,null,[" Translation Limit Exceeds"]))],null,null)}function Jy(e){return ta(0,[(e()(),Bi(0,0,null,null,7,"span",[["class","spk"]],null,null,null,null,null)),(e()(),Bi(1,0,null,null,6,":svg:svg",[[":xml:space","preserve"],[":xmlns:svg","http://www.w3.org/2000/svg"],["height","14pt"],["id","layer1"],["version","1.0"],["viewBox","0 0 75 75"],["width","14pt"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(e()(),Bi(2,0,null,null,0,":svg:metadata",[["id","metadata1"]],null,null,null,null,null)),(e()(),Bi(3,0,null,null,4,":svg:g",[["id","g1"]],null,null,null,null,null)),(e()(),Bi(4,0,null,null,0,":svg:polygon",[["id","polygon1"],["points","39.389,13.769 22.235,28.606 6,28.606 6,47.699 21.989,47.699 39.389,62.75 39.389,13.769"],["style","stroke:#7c818a;stroke-width:5;stroke-linejoin:round;fill:#7c818a;"]],null,null,null,null,null)),(e()(),Bi(5,0,null,null,0,":svg:path",[["d","M 48.128,49.03 C 50.057,45.934 51.19,42.291 51.19,38.377 C 51.19,34.399 50.026,30.703 48.043,27.577"],["id","path1"],["style","fill:none;stroke:#7c818a;stroke-width:5;stroke-linecap:round"]],null,null,null,null,null)),(e()(),Bi(6,0,null,null,0,":svg:path",[["d","M 55.082,20.537 C 58.777,25.523 60.966,31.694 60.966,38.377 C 60.966,44.998 58.815,51.115 55.178,56.076"],["id","path2"],["style","fill:none;stroke:#7c818a;stroke-width:5;stroke-linecap:round"]],null,null,null,null,null)),(e()(),Bi(7,0,null,null,0,":svg:path",[["d","M 61.71,62.611 C 66.977,55.945 70.128,47.531 70.128,38.378 C 70.128,29.161 66.936,20.696 61.609,14.01"],["id","path1"],["style","fill:none;stroke:#7c818a;stroke-width:5;stroke-linecap:round"]],null,null,null,null,null))],null,null)}function Yy(e){return ta(0,[(e()(),Bi(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),Bi(1,0,null,null,8,"li",[],null,[[null,"click"]],(function(e,t,n){var r=!0,o=e.component;return"click"===t&&(r=!1!==o.speakTranslation(o.showTranslation(e.context.$implicit.object))&&r),r}),null,null)),(e()(),Bi(2,0,null,null,1,"span",[["class","object-name"]],null,null,null,null,null)),(e()(),Ji(3,null,["",""])),(e()(),Bi(4,0,null,null,3,"span",[["class","translation"]],null,null,null,null,null)),(e()(),Ji(5,null,[""," "])),(e()(),zi(16777216,null,null,1,null,Qy)),ao(7,16384,null,0,ws,[Rn,Pn],{ngIf:[0,"ngIf"]},null),(e()(),zi(16777216,null,null,1,null,Jy)),ao(9,16384,null,0,ws,[Rn,Pn],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,7,0,n.limitMessage),e(t,9,0,n.isTranslationAvailable)}),(function(e,t){var n=t.component;e(t,3,0,t.context.$implicit.object),e(t,5,0,n.showTranslation(t.context.$implicit.object))}))}function ev(e){return ta(0,[(e()(),Bi(0,0,null,null,2,"header",[],null,null,null,null,null)),(e()(),Bi(1,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),Ji(-1,null,["Multilingual object detection"])),(e()(),Bi(3,0,null,null,19,"main",[],null,null,null,null,null)),(e()(),Bi(4,0,null,null,18,"div",[["class","container"]],null,null,null,null,null)),(e()(),Bi(5,0,null,null,1,"app-webcam",[],null,[[null,"predictionChange"]],(function(e,t,n){var r=!0;return"predictionChange"===t&&(r=!1!==e.component.handlePredictionChange(n)&&r),r}),dy,cy)),ao(6,114688,null,0,ly,[],{objectToPredict:[0,"objectToPredict"]},{predictionChange:"predictionChange"}),(e()(),Bi(7,0,null,null,9,"div",[["class","lang-selection"]],null,null,null,null,null)),(e()(),Bi(8,0,null,null,8,"div",[["class","float-box"]],null,null,null,null,null)),(e()(),Bi(9,0,null,null,7,"select",[["id","lang"],["name","lang"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(e,t,n){var r=!0,o=e.component;return"change"===t&&(r=!1!==Gr(e,10).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Gr(e,10).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(o.selectedLang=n)&&r),r}),null,null)),ao(10,16384,null,0,ul,[dn,un],null,null),so(1024,null,Wu,(function(e){return[e]}),[ul]),ao(12,671744,null,0,Ll,[[8,null],[8,null],[8,null],[6,Wu]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),so(2048,null,Ku,null,[Ll]),ao(14,16384,null,0,Zu,[[4,Ku]],null,null),(e()(),zi(16777216,null,null,1,null,Zy)),ao(16,278528,null,0,vs,[Rn,Pn,On],{ngForOf:[0,"ngForOf"]},null),(e()(),Bi(17,0,null,null,5,"div",[["class","detected-objects"]],null,null,null,null,null)),(e()(),Bi(18,0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),Ji(-1,null,["Detected objects "])),(e()(),Bi(20,0,null,null,2,"ul",[["class","list-unstyled"]],null,null,null,null,null)),(e()(),zi(16777216,null,null,1,null,Yy)),ao(22,278528,null,0,vs,[Rn,Pn,On],{ngForOf:[0,"ngForOf"]},null),(e()(),Bi(23,0,null,null,2,"footer",[],null,null,null,null,null)),(e()(),Bi(24,0,null,null,1,"a",[["href","http://www.ameyraut.com"]],null,null,null,null,null)),(e()(),Ji(-1,null,["www.ameyraut.com"]))],(function(e,t){var n=t.component;e(t,6,0,n.data.objectToDetect),e(t,12,0,"lang",n.selectedLang),e(t,16,0,n.langArray),e(t,22,0,n.results)}),(function(e,t){e(t,9,0,Gr(t,14).ngClassUntouched,Gr(t,14).ngClassTouched,Gr(t,14).ngClassPristine,Gr(t,14).ngClassDirty,Gr(t,14).ngClassValid,Gr(t,14).ngClassInvalid,Gr(t,14).ngClassPending)}))}function tv(e){return ta(0,[(e()(),Bi(0,0,null,null,1,"app-root",[],null,null,null,ev,Xy)),ao(1,114688,null,0,ls,[Ky],null,null)],(function(e,t){e(t,1,0)}),null)}var nv=jr("app-root",ls,tv,{},{},[]),rv=as(us,[ls],(function(e){return function(e){const t={},n=[];let r=!1;for(let o=0;o<e.length;o++){const i=e[o];i.token===At&&!0===i.value&&(r=!0),1073741824&i.flags&&n.push(i.token),i.index=o,t[Xn(i.token)]=i}return{factory:null,providersByKey:t,providers:e,modules:n,isRoot:r}}([kr(512,rn,on,[[8,[nv]],[3,rn],ze]),kr(5120,Uo,Li,[[3,Uo]]),kr(4608,fs,ms,[Uo,[2,ds]]),kr(5120,No,Vi,[ai]),kr(4608,Xo,Xo,[]),kr(5120,Mo,jo,[]),kr(5120,On,Mi,[]),kr(5120,Sn,ji,[]),kr(4608,Tu,Au,[Es]),kr(6144,Et,null,[Tu]),kr(4608,Nu,Cu,[]),kr(5120,qs,(function(e,t,n,r,o,i,a,s){return[new xu(e,t,n),new ku(r),new Iu(o,i,a,s)]}),[Es,ai,Fo,Es,Es,Nu,Bo,[2,Eu]]),kr(4608,Hs,Hs,[qs,ai]),kr(135680,Xs,Xs,[Es]),kr(4608,nu,nu,[Hs,Xs,Mo]),kr(6144,hn,null,[nu]),kr(6144,Ks,null,[Xs]),kr(4608,di,di,[ai]),kr(4608,Uy,Wy,[Es,Fo,zy]),kr(4608,$y,$y,[Uy,By]),kr(5120,Ry,(function(e){return[e]}),[$y]),kr(4608,Vy,Vy,[]),kr(6144,Ly,null,[Vy]),kr(4608,Fy,Fy,[Ly]),kr(6144,yy,null,[Fy]),kr(4608,gy,qy,[yy,Dt]),kr(4608,Py,Py,[gy]),kr(4608,il,il,[]),kr(1073742336,Ns,Ns,[]),kr(1024,Je,Fu,[]),kr(1024,Do,(function(e){return[(t=e,Us("probe",$s),Us("coreTokens",Object.assign({},Ws,(t||[]).reduce((e,t)=>(e[t.name]=t.token,e),{}))),()=>$s)];var t}),[[2,xi]]),kr(512,Ro,Ro,[[2,Do]]),kr(131584,Ii,Ii,[ai,Bo,Dt,Je,rn,Ro]),kr(1073742336,Fi,Fi,[Ii]),kr(1073742336,zu,zu,[[3,zu]]),kr(1073742336,$l,$l,[]),kr(1073742336,Hy,Hy,[]),kr(1073742336,Gy,Gy,[]),kr(1073742336,Vl,Vl,[]),kr(1073742336,Fl,Fl,[]),kr(1073742336,us,us,[]),kr(256,At,!0,[]),kr(256,zy,"XSRF-TOKEN",[]),kr(256,By,"X-XSRF-TOKEN",[])])}));(function(){if(et)throw new Error("Cannot enable prod mode after platform setup.");Ye=!1})(),Vu().bootstrapModuleFactory(rv).catch(e=>console.error(e))},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0]]]);